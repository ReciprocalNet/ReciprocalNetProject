diff -Nrua vort-old/apollo/disp.1 vort-new/apollo/disp.1
--- vort-old/apollo/disp.1	1990-03-01 19:33:46.000000000 -0500
+++ vort-new/apollo/disp.1	1969-12-31 19:00:00.000000000 -0500
@@ -1,35 +0,0 @@
-.TH DISP 1 "May 23, 1989" "VORT 1.1"
-.SH NAME
-disp, rdisp, gdisp, bdisp, adisp \- programmes for displaying a pix
-image file.
-.SH SYNOPSIS
-.PU
-.ll +8
-.B disp
-.I "file"
-.SH DESCRIPTION
-.I Disp
-displays a pix image file on a suitable Sun workstation in greyscale. If
-the file has a colourmap (see median (1)), the image is displayed using that
-image file's colourmap.
-.LP
-.I Rdisp
-displays the red channel of a pix image file.
-.LP
-.I Gdisp
-displays the green channel of a pix image file.
-.LP
-.I Bdisp
-displays the blue channel of a pix image file.
-.LP
-.I Adisp
-displays the alpha channel of a pix image file.
-.SH "SEE ALSO"
-.IR art (1),
-.IR pixinfo (1),
-.IR median (1),
-.IR targ2pix (1),
-.IR pix2ps (1),
-.IR gamma (1),
-.IR greyscale (1),
-.IR vort (3).
diff -Nrua vort-old/apollo/disp.c vort-new/apollo/disp.c
--- vort-old/apollo/disp.c	1990-03-01 19:33:07.000000000 -0500
+++ vort-new/apollo/disp.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,232 +0,0 @@
-#include <stdio.h>
-#include "/sys/ins/base.ins.c"
-#include "/sys/ins/gpr.ins.c"
-#include "/sys/ins/pad.ins.c"
-#include "/sys/ins/kbd.ins.c"
-#include "vort.h"
-
-#define	SETSIZE			(short)3
-#define	CMAPSIZE		256
-#define COLOR_ENTRY(r, g, b)	(gpr_$pixel_value_t) ((r << 16) | (g << 8) | b)
-static	int			mapsize;
-
-static	gpr_$pixel_value_t  	color_value[CMAPSIZE];
-static	gpr_$pixel_value_t  	old_color_map[CMAPSIZE];
-static	status_$t		status;
-
-
-/*
- * program to read in a color-mapped image and display it on the apollo
- */
-main(ac, av)
-	int	ac;
-	char	**av;
-{
-	gpr_$event_t     	et;
-	char     	        ed;
-	gpr_$position_t  	pos;
-	gpr_$keyset_t        	keys;
-
-	pad_$window_desc_t	window;
-	ios_$id_t		stream_id;
-
-	gpr_$display_mode_t	mode = gpr_$direct;
-	gpr_$rgb_plane_t	hi_plane;
-	gpr_$offset_t		display_size;
-	gpr_$bitmap_desc_t	display_bm;
-	gpr_$bitmap_desc_t	mem_bm;
-	gpr_$attribute_desc_t	attrib;
-	gpr_$window_t		source;
-	gpr_$position_t		dest_pos;
-	gpr_$disp_char_t	disp_characteristics;
-	gpr_$pixel_value_t	start_index = 0;
-
-	static	short	int	disp_len = sizeof(gpr_$disp_char_t);
-	static	short	int	disp_len_returned, invisible = 0;
-	
-
-	register int	i, x, y;
-	unsigned short	h, w;
-	int		val;
-	unsigned char	*line, *red, *green, *blue;
-	image		*im;
-
-	if (ac != 2) {
-		fprintf(stderr, "disp: usage disp file.\n");
-		exit(1);
-	}
-
-	if ((im = openimage(av[1], "r")) == (image *)NULL) {
-		fprintf(stderr, "disp: can't open file %s.\n", av[1]);
-		exit(1);
-	}
-
-	/*
-	 * Determine display characteristics
-	 */
-
-	gpr_$inq_disp_characteristics(mode,
-		1,
-		disp_len,
-		disp_characteristics, 
-		disp_len_returned,
-		status
-	);
-
-	hi_plane = disp_characteristics.n_planes - 1;
-
-	window.top = 0;
-	window.left = 0;
-	window.width = w = imagewidth(im);
-	window.height = h = imageheight(im);
-
-	window.width += 5;
-	window.height += 25;
-
-	pad_$create_window("", 0,
-			pad_$transcript,
-			1,
-			window,
-			stream_id,
-			status
-	);
-
-	if (w > 128 && h > 128) {
-		fprintf(stderr, "This might take some time....\n");
-		pad_$make_invisible(stream_id, 1, status);
-		invisible = 1;
-	}
-
-	pad_$set_auto_close(stream_id, 1, true, status);
-
-	display_size.x_size = w;
-	display_size.y_size = h;
-
-	source.window_base.x_coord = 0;
-	source.window_base.y_coord = 0;
-	source.window_size.x_size = w;
-	source.window_size.y_size = h;
-	dest_pos.x_coord = 0;
-	dest_pos.y_coord = 0;
-
-	gpr_$init(mode,
-		stream_id,
-		display_size,
-		hi_plane,
-		display_bm,
-		status
-	);
-
-	gpr_$allocate_attribute_block(attrib, status);
-	gpr_$allocate_bitmap(display_size, hi_plane, attrib, mem_bm, status);
-	gpr_$set_bitmap(mem_bm, status);
-
-	gpr_$set_auto_refresh(true, status);
-	gpr_$set_cursor_active(true, status);
-
-	/*
-	 * Get the colormap
-	 */
-	gpr_$inq_color_map(start_index,
-		(short)CMAPSIZE,
-		old_color_map,
-		status
-	);
-
-
-	y = 0;
-
-	line = (unsigned char *)malloc(w);
-
-	if (colormapped(im)) {
-		mapsize = cmapsize(im);
-		for (i = 0; i < mapsize; i++)
-			color_value[i] = COLOR_ENTRY(
-						redmap(im)[i],
-						greenmap(im)[i],
-						bluemap(im)[i]
-					 );
-
-		while (y < h) {
-			if (invisible && !(y % 50))
-				fprintf(stderr, "Done %d of %d\n", y + 1, h);
-
-			readmappedline(im, line);
-			gpr_$move((short)0, (short)y, status);
-			for (x = 0; x < w; x++) {
-				gpr_$set_draw_value((int)line[x], status);
-				gpr_$line((short)x, (short)y, status);
-			}
-			y++;
-		}
-
-	} else {
-		mapsize = CMAPSIZE;
-		red = (unsigned char *)malloc(w);
-		green = (unsigned char *)malloc(w);
-		blue = (unsigned char *)malloc(w);
-
-		for (i = 0; i < CMAPSIZE; i++)
-			color_value[i] = COLOR_ENTRY(i, i, i);
-
-		while (y < h) {
-			if (invisible && !(y % 50))
-				fprintf(stderr, "Done %d of %d\n", y + 1, h);
-
-			readrgbline(im, red, green, blue);
-			gpr_$move((short)0, (short)y, status);
-			for (x = 0; x < w; x++) {
-				val = red[x] * 0.3 + green[x] * 0.59 + blue[x] * 0.11;
-				gpr_$set_draw_value((int)val, status);
-				gpr_$line((short)x, (short)y, status);
-			}
-			y++;
-		}
-	}
-
-	if (invisible) 
-		pad_$select_window(stream_id, 1, status);
-
-	gpr_$acquire_display(status);
-
-	gpr_$set_color_map(start_index,
-		    (short)mapsize,
-		    color_value,
-		    status
-	);
-
-	gpr_$set_bitmap(display_bm, status);
-	gpr_$pixel_blt(mem_bm, source, dest_pos, status);
-	gpr_$release_display(status);
-
-	/*  
-	 * Create a key set for the event interupts  
-	 * The program waits until one of the mouse buttons
-	 * is clicked.
-	 */
-
-	lib_$init_set(keys, SETSIZE);
-
-	lib_$add_to_set(keys, SETSIZE, KBD_$M1U);
-	lib_$add_to_set(keys, SETSIZE, KBD_$M2U);
-	lib_$add_to_set(keys, SETSIZE, KBD_$M3U);
-
-	gpr_$enable_input(gpr_$buttons, keys, status);
-
-	(void)gpr_$event_wait(et, ed, pos, status);
-
-	/*
-	 * Restore the old color map...
-	 */
-	gpr_$acquire_display(status);
-	gpr_$set_color_map(start_index,
-		    (short)CMAPSIZE,
-		    old_color_map,
-		    status
-	);
-	gpr_$release_display(status);
-
-	gpr_$terminate(false, status);
-
-	exit(0);
-}
diff -Nrua vort-old/apollo/disp.doc vort-new/apollo/disp.doc
--- vort-old/apollo/disp.doc	1990-03-01 19:34:15.000000000 -0500
+++ vort-new/apollo/disp.doc	1969-12-31 19:00:00.000000000 -0500
@@ -1,66 +0,0 @@
-
-
-
-DISP(1)                  USER COMMANDS                    DISP(1)
-
-
-
-NAME
-     disp, rdisp, gdisp, bdisp, adisp - programmes for displaying
-     a pix image file.
-
-SYNOPSIS
-     disp file
-
-DESCRIPTION
-     Disp displays a pix image file on a suitable Sun workstation
-     in  greyscale. If the file has a colourmap (see median (1)),
-     the image is displayed using that image file's colourmap.
-
-     Rdisp displays the red channel of a pix image file.
-
-     Gdisp displays the green channel of a pix image file.
-
-     Bdisp displays the blue channel of a pix image file.
-
-     Adisp displays the alpha channel of a pix image file.
-
-SEE ALSO
-     art(1),  pixinfo(1),  median(1),   targ2pix(1),   pix2ps(1),
-     gamma(1), greyscale(1), vort(3).
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-VORT 1.1            Last change: May 23, 1989                   1
-
-
-
diff -Nrua vort-old/apollo/Makefile vort-new/apollo/Makefile
--- vort-old/apollo/Makefile	1995-04-03 20:39:13.000000000 -0400
+++ vort-new/apollo/Makefile	1969-12-31 19:00:00.000000000 -0500
@@ -1,20 +0,0 @@
-CC=cc
-MLIBS =
-MFLAGS = -g 
-CFLAGS = $(MFLAGS) -I../lib
-LIBS = ../lib/libvort.a $(MLIBS) -lm
-OBJS = disp.o
-
-all: disp
-
-disp: disp.o ../lib/libvort.a
-	$(CC) $(CFLAGS) -o disp disp.o $(LIBS)
-
-clean:
-	rm -f *.o core
-
-clobber:
-	rm -f disp ?disp core
-
-$(OBJS):\
-../lib/vort.h 
diff -Nrua vort-old/apollo/rdisp.c vort-new/apollo/rdisp.c
--- vort-old/apollo/rdisp.c	1990-03-01 19:33:08.000000000 -0500
+++ vort-new/apollo/rdisp.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,107 +0,0 @@
-#include <stdio.h>
-#include <math.h>
-#include <suntool/sunview.h>
-#include <suntool/canvas.h>
-#include "vort.h"
-
-#define	CMAPSIZE	256
-
-extern char	*rindex();
-
-
-/*
- * simple program to display a single channel of an pixel file. Channel
- * displayed depends on the name of the program at run time.
- */
-main(ac, av)
-	int	ac;
-	char	**av;
-{
-	Frame		frame;
-	Canvas		canvas;
-	char		name[BUFSIZ], title[BUFSIZ], *pt;
-	register int	x, y, val, ox;
-	image		*im;
-	short		i, h, w;
-	u_char		r[CMAPSIZE], b[CMAPSIZE], g[CMAPSIZE], *red, *green, *blue, *alpha, *channel;
-	register Pixwin	*pw;
-
-	
-	if ((pt = rindex(av[0], '/')) != (char *)NULL)
-		strcpy(name, pt + 1);
-	else
-		strcpy(name, av[0]);
-
-	if (ac != 2) {
-		fprintf(stderr, "%s: usage %s filename.\n", av[0], av[0]);
-		exit(1);
-	}
-
-	if ((im = openimage(av[1], "r")) == (image *)NULL) {
-		fprintf(stderr, "%s: can't open file %s.\n", av[0], av[1]);
-		exit(1);
-	}
-
-	w = imagewidth(im);
-	h = imageheight(im);
-
-	red = (u_char *)malloc(w);
-	green = (u_char *)malloc(w);
-	blue = (u_char *)malloc(w);
-	alpha = (u_char *)malloc(w);
-
-	strcpy(title, name);
-	strcat(title, ": ");
-	strcat(title, imagetitle(im));
-
-	frame = window_create(0, FRAME, WIN_HEIGHT, h, WIN_WIDTH, w, FRAME_LABEL, name, 0);
-	canvas = window_create(frame, CANVAS, CANVAS_RETAINED, FALSE, WIN_HEIGHT, h, WIN_WIDTH, w, 0);
-	window_fit(frame);
-	pw =(Pixwin *)canvas_pixwin(canvas);
-
-	if (name[0] == 'r') {
-		channel = red;
-		for (i = 0; i < CMAPSIZE; i++) {
-			g[i] = b[i] = 0;
-			r[i] = i;
-		}
-	} else if (name[0] == 'g') {
-		channel = green;
-		for (i = 0; i < CMAPSIZE; i++) {
-			r[i] = b[i] = 0;
-			g[i] = i;
-		}
-	} else if (name[0] == 'b') {
-		channel = blue;
-		for (i = 0; i < CMAPSIZE; i++) {
-			r[i] = g[i] = 0;
-			b[i] = i;
-		}
-	} else if (name[0] == 'a') {
-		channel = alpha;
-		for (i = 0; i < CMAPSIZE; i++)
-			r[i] = g[i] = b[i] = i;
-	}
-
-	pw_setcmsname(pw, name);
-	pw_putcolormap(pw, 0, CMAPSIZE, r, g, b);
-
-	window_set(canvas, CANVAS_RETAINED, TRUE, 0);
-
-	pw_batch_on(pw);
-
-	y = 0;
-	x = 0;
-	val = -1;
-
-	while (readrgbaline(im, red, green, blue, alpha)) {
-		for (x = 0; x != w; x++)
-			pw_put(pw, x, y, channel[x]);
-		y++;
-	}
-
-	pw_batch_off(pw);
-	window_main_loop(frame);
-
-	exit(0);
-}
diff -Nrua vort-old/art/docs/dart.1 vort-new/art/docs/dart.1
--- vort-old/art/docs/dart.1	1993-02-10 21:05:36.000000000 -0500
+++ vort-new/art/docs/dart.1	2006-11-18 16:58:16.000000000 -0500
@@ -2,23 +2,36 @@
 .SH NAME
 dart - a distributed ray-tracer for rendering algebraic surfaces and CSG models.
 .SH SYNOPSIS
-.B dart 
+.B dart
+.RB [ -h
+.IR hostfile ]
+.RB [ -n ]
+.RB [ -o
+.IR outfile ]
+.RB [ -p
+.IR path ]
+.RB [ -v ]
 .I file width height
-.B [-n]
 
 .B in.artd
 .SH DESCRIPTION
-Dart renders the scene defined in
+.B dart
+renders the scene defined in
 .I file
-across a net work by starting up processes using inetd.
+across a network by means of remote in.artd processes, the latter normally
+started via inetd.
 .I file
 is a file containing the scene description. 
 .I width
 and
 .I height
-are the width and height of the image in pixels. The 
-.I -n
-option disables file preprocessing.
+are the width and height of the image in pixels.  It is important to note
+that unless the -p option is passed to
+.BR dart ,
+each
+.B in.artd
+assumes that it can access the scene file using the same absolute path name by
+which dart accesses it.
 
 To set dart up the additions need to be made to /etc/inetd.conf
 and /etc/services. In /etc/services add
@@ -34,7 +47,60 @@
 
 .fi
 For instructions on the scene file see the manual page for art(1).
+.SH OPTIONS
+.TP
+.BI \-h \ hostname
+Read the list of hosts to use from file
+.IR hostname .
+The default hostname file can be set at configure time, but typically is
+/usr/local/lib/vort/hosts.
+.TP
+.B \-n
+Do not preprocess the scene file.
+.TP
+.BI \-o \ outfile
+Use
+.I outfile
+to name the output file.  If
+.I outfile
+does not already end with ".pix" then ".pix" is appended.
+.TP
+.BI \-p \ path
+When this option is specified,
+.B dart
+passes
+.I path
+to each
+.B in.artd
+as the path by which to access the scene file.  This is useful when the
+filesystem containing the scene file is mounted at a different point on
+the
+.B in.artd
+systems than it is on the
+.B dart
+system.  When -p is not specified, the path is determined from the current
+working directory and any path component (absolute or relative) of the scene
+file name.
+.TP
+.B \-v
+Turn on verbose mode.  Some status messages are sent to stderr as the program
+proceeds.
 
+.SH FILES
+Each
+.B in.artd
+writes a log to its local /tmp/dartlog.  
+
+.SH BUGS
+All the
+.B in.artd
+servers must be able to access the scene file by the same absolute path name.
+.RB ( dart
+does not send the file, just the name and path.)
+.P
+The local host must have an entry in
+.I /etc/services
+for the TCP artd service, even if it is not offering artd services itself.
 .SH "SEE ALSO"
 .IR disp (1),
 .IR vortinfo (1),
diff -Nrua vort-old/art/src/art.h vort-new/art/src/art.h
--- vort-old/art/src/art.h	1999-10-12 18:25:54.000000000 -0400
+++ vort-new/art/src/art.h	2006-11-18 16:58:16.000000000 -0500
@@ -6,13 +6,11 @@
 #define smalloc(a)	smalloc(a, __FILE__, __LINE__)
 #endif
 
-#ifdef SYSV
 #include <unistd.h>
+#include <string.h>
 #define bcopy(s1, s2, l)        memcpy(s2, s1, l)
 #define bzero(s, l)     memset(s, 0, l)
-#include <string.h>
 #define rindex    strrchr
-#endif
 
 /*
  * include file for pixel data
@@ -50,10 +48,6 @@
  */
 #define	HUGE_DIST	1.0e24
 
-/* for PC EMS operations */
-#define EMS_PAGE_SIZE	16384
-#define	EMS_NULL_HDL	0xFFFF
-
 typedef float	matrix[4][4];
 typedef float	mat3x3[3][3];
 typedef float	mat2x3[2][3];
@@ -108,10 +102,6 @@
 	float		var[3];
 	unsigned short	pixw, pixh;
 	char		*map;
-#ifdef PC
-	unsigned int	EMS_h;
-	unsigned long	EMS_ofs;
-#endif
 } proctxt;
 
 typedef struct {
@@ -119,10 +109,6 @@
 	float		scalew, scaleh;
 	char		*map;
 	unsigned short	pixw, pixh;
-#ifdef PC
-	unsigned int	EMS_h;
-	unsigned long	EMS_ofs;
-#endif
 } tiletxt;
 
 typedef struct {
@@ -667,10 +653,6 @@
 		struct {
 			unsigned short	width, height;
 			char		*pic;
-#ifdef PC
-			unsigned int	EMS_h;
-			unsigned long	EMS_ofs;
-#endif
 		} tile;
 	} u;
 	struct sy	*left, *right;
@@ -774,17 +756,6 @@
 #endif
 
 
-#ifdef PC
-extern unsigned _stklen; 	/* For Turbo C */
-extern unsigned char far	*EMS_base();
-#define yywrap()	1
-#endif
-
-#ifdef VMS
-
-#define yywrap()        1
-#endif
-
 extern float	eval_fexpr();
 extern int	eval_iexpr();
 
@@ -794,30 +765,6 @@
 extern symbol	*insertsym();
 extern symbol	*findsym();
 
-#ifdef MACINTOSH
-
-/* Macintosh.  68881 doubles are fastest.
- * Breathe() is sprinkled here and there to
- * check for events and yield the processor.
- */
-typedef double real;
-extern  void   breathe();
-
-/* Other THINK_C notes.
- * Under THINK_C at least, these
- * symbols are defined in MacTraps:
- *  normal
- *  symbol
- * If you include MacTraps in your project prefix, add
- * the lines:
- *  #define symbol ArtSymbol
- *    #define normal ArtNormal
- * to the prefix text after the MacTraps line.
- */
-
-#else
 
 typedef float real;
-#define breathe()
 
-#endif
diff -Nrua vort-old/art/src/cone.c vort-new/art/src/cone.c
--- vort-old/art/src/cone.c	1999-10-12 18:24:14.000000000 -0400
+++ vort-new/art/src/cone.c	2006-11-18 16:58:16.000000000 -0500
@@ -8,20 +8,7 @@
 extern hlist	*fhlist;
 extern real	tolerance;
 
-#ifdef THINK_C
-/*
- * Think compiler has trouble with x*x + y*y > d
- * in some of the tests it appears in.
- */
-static int
-dist_gt(x, y, d)
-	double	x, y, d;
-{
-	return(x * x + y * y > d);
-}
-#else
 #define dist_gt(x, y, d) ((x) * (x) + (y) * (y) > (d))
-#endif
 
 
 
@@ -268,10 +255,6 @@
 	float	u, v, tipval;
 	int     w, h, indx;
 	tiletxt	*tp;
-#ifdef PC
-	unsigned int	page;
-	unsigned long	cp;
-#endif
 
 	tipval = o->obj.cne_tipval;
 
@@ -305,20 +288,6 @@
 		else
 			w = w % tp->pixw;
 
-#ifdef PC
-		if (tp->EMS_h != EMS_NULL_HDL) {
-			page = ((w + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) / EMS_PAGE_SIZE;
-			cp = ((w + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) % EMS_PAGE_SIZE;
-			EMS_map(tp->EMS_h, page);
-
-			pcol->r = (unsigned char)*(EMS_base()+cp) / 255.0;
-			if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-			pcol->g = (unsigned char)*(EMS_base()+cp) / 255.0;
-			if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-			pcol->b = (unsigned char)*(EMS_base()+cp) / 255.0;
-			return;
-		}
-#endif
 		indx = (w + (h % tp->pixh) * tp->pixw) * 3;
 
 		pcol->r = (unsigned char)tp->map[indx] / 255.0;
diff -Nrua vort-old/art/src/cylinder.c vort-new/art/src/cylinder.c
--- vort-old/art/src/cylinder.c	1999-10-12 18:24:14.000000000 -0400
+++ vort-new/art/src/cylinder.c	2006-11-18 16:58:16.000000000 -0500
@@ -164,11 +164,6 @@
 	float	u;
 	int	w, h, indx;
 	tiletxt	*tp;
-#ifdef PC
-	unsigned int	page;
-	unsigned long	cp;
-#endif
-
 
 	if (type == SIDE) {
 		totexture(txt, tmp, *l);
@@ -192,20 +187,6 @@
 		else
 			w = w % tp->pixw;
 
-#ifdef PC
-		if (tp->EMS_h != EMS_NULL_HDL) {
-			page = ((w + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) / EMS_PAGE_SIZE;
-			cp = ((w + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) % EMS_PAGE_SIZE;
-			EMS_map(tp->EMS_h, page);
-
-			pcol->r = (unsigned char)*(EMS_base()+cp) / 255.0;
-			if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-			pcol->g = (unsigned char)*(EMS_base()+cp) / 255.0;
-			if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-			pcol->b = (unsigned char)*(EMS_base()+cp) / 255.0;
-			return;
-		}
-#endif
 		indx = (w + (h % tp->pixh) * tp->pixw) * 3;
 
 		pcol->r = (unsigned char)tp->map[indx] / 255.0;
diff -Nrua vort-old/art/src/dart.c vort-new/art/src/dart.c
--- vort-old/art/src/dart.c	1999-10-13 08:06:52.000000000 -0400
+++ vort-new/art/src/dart.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,321 +1,674 @@
+/*
+   dart.c
+
+   A program implementing the remote art protocol.
+
+   Dart is part of the public domain VORT package by Eric Chidna
+
+   This version of dart was derived from the version of VORT 2.3.3 with the
+   implementation of many extensions and some improvements, by
+   John C. Bollinger of the Indiana University Molecular structure center.
+
+   Last modification 11/2000.
+*/
 #include <sys/types.h>
+#include <stdlib.h>
+#include <unistd.h>
+#include <errno.h>
+#include <signal.h>
+#include <stdio.h>
+#include <string.h>
+#include <sys/stat.h>
 #include <sys/socket.h>
+#include <sys/ipc.h>
+#include <sys/shm.h>
 #include <netinet/in.h>
+#include <fcntl.h>
 #include <netdb.h>
-#include <stdio.h>
-#include <unistd.h>
 #include "art.h"
+#include "readall.h"
 
-#define HOSTSFILE	"/usr/local/lib/vort/hosts"
-
-extern char	*rindex();
-
-typedef struct h {
-	int	fd;
-	int	x, y;
-	int	xdiff, ydiff;
-	int	busy;
-} host;
+#define DEF_HOSTSFILE "/usr/local/lib/vort/hosts"
+#define MAX_NAME_LEN 128
+#define MAXHOSTS 64
+#define FRAGDIMENSION 50
+#define DEFAULT_BUF_SIZE 1024
+#define DART_PORT 1992
+#define DART_TRUE (1 == 1)
+#define DART_FALSE (1 == 0)
+
+struct dart_host {
+    int    serial;
+    int    fd;
+    int    x, y;
+    int    xdiff, ydiff;
+    int    busy;
+    struct dart_host *prev, *next;
+} ;
+
+static size_t checkfilename (const char *fname);
+static void memerr (const char *pname);
+static void quithost (int hfd);
+static int sendshort (int sock, unsigned short i);
+static void usage (const char *pname);
 
 /*
- * sendshort
+ * checkfilename
+ *
+ * locate unacceptable characters in file names
  *
- *	send a short down a sockect
+ * acceptable characters are digits, upper- and lowercase letters, and ./_-~
  */
-sendshort(sock, i)
-	int	sock, i;
-{
-	unsigned short	val;
+static size_t checkfilename (const char *fname) {
+    size_t i = strspn(fname, "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz./_-~");
+    if (i > MAX_NAME_LEN) i = MAX_NAME_LEN;
+    return i;
+}
 
-	val = htons(i);
-	write(sock, &val, sizeof(unsigned short));
+/*
+ * memerr
+ *
+ * print a diagnostic and exit
+ */
+static void memerr (const char *pname) {
+    fprintf(stderr, "%s: memory allocation failure; exiting...\n");
+    exit(-2);
 }
 
 /*
- * main driver for distributed dart.
+ * quithost
+ *
+ * safely break the connection to a remote host
  */
-main(ac, av)
-	int	ac;
-	char	*av[];
-{
-	int			sock, pending;
-	struct sockaddr_in	server;
-	struct servent		*sp;
-	struct hostent		*hp, *gethostbyname();
-	unsigned short		len, screenx, screeny, preprocess;
-	int			i, j, x, y, nc, xfragsize, yfragsize;
-	int			xdiff, ydiff, nhosts;
-	char			buf[1024], c, map[100 * 100 * 3];
-	char			*p, *endp, *title, name[100];
-	image			*im;
-	long			imagestart;
-	host			hosts[50];
-	FILE			*infile;
-	fd_set			readfds;
-
-	if (ac < 4) {
-		fprintf(stderr, "dart: usage dart file.scn xpixels ypixels [-n]\n");
-		exit(1);
-	}
-
-	screenx = atoi(av[2]);
-	screeny = atoi(av[3]);
-
-	preprocess = (av[4] == (char *)NULL || strcmp(av[4], "-n") != 0);
-		
-	strcpy(name, av[1]);
-	if ((p = rindex(name, '.')) == (char *)NULL) {
-		fprintf(stderr, "dart: input file must end in .scn\n");
-		exit(1);
-	}
-
-	strcpy(p, ".pix");
-
-	if ((im = openimage(name, "w")) == (image *)NULL) {
-		fprintf(stderr, "dart: can't open output file.\n");
-		exit(1);
-	}
-
-	imagetype(im) = PIX_RGBA;
-
-	imagewidth(im) = screenx;
-	imageheight(im) = screeny;
-
-	imagedate(im) = time(0);
-
-	imagedepth(im) = 24;
-
-	title = (char *)NULL;
-
-	if (title == (char *)NULL)
-		titlelength(im) = 0;
-	else {    
-		titlelength(im) = strlen(title) + 1;
-		imagetitle(im) = title;
-	}         
-
-	/*
-	 * output header and get start of image.
-	 */
-	writeheader(im);
-
-	imagestart = lseek(im->fd, 0, 1);
-
-	sp = getservbyname("artd", "tcp");
-
-	if (sp == (struct servent *)NULL) {
-		fprintf(stderr, "dart: can't find service\n");
-		exit(1);
-	}
-
-	if ((infile = fopen(HOSTSFILE, "r")) == (FILE *)NULL) {
-		fprintf(stderr, "dart: can't open file %s\n", HOSTSFILE);
-		close(sock);
-		exit(1);
-	}
+static void quithost (int hfd) {
+    int flags;
 
-#ifdef SYSV
-        getcwd(buf, sizeof(buf) - 1);
-#else
-        getwd(buf);
-#endif
+    /* ignore any SIGPIPE received during execution of this routine */
+    signal(SIGPIPE, SIG_IGN);
 
-	nhosts = 0;
+    /* send a quit message to the remote host with a non-blocking write, and
+       close the file descriptor */
+    if ( (flags = fcntl(hfd, F_GETFL)) != -1 ) {
+        if ( fcntl(hfd, F_SETFL, flags | O_NONBLOCK) == 0 ) {
+            write(hfd, "Q", 1);
+            close(hfd);
+        }
+    }
 
-	while (fscanf(infile, "%s ", name) == 1) {
+    /* restore previous SIGPIPE handling */
+    signal(SIGPIPE, SIG_DFL);
+}
 
-		bzero(&server, sizeof(server));
+/*
+ * sendshort
+ *
+ *    send a short down a socket
+ */
+static int sendshort (int sock, unsigned short i) {
+    unsigned short    val;
 
-		if ((hp = gethostbyname(name)) == (struct hostent *)NULL) {
-			printf("dart: can't find host %s\n", name);
-			continue;
-		}
-
-		bcopy((char *)hp->h_addr, (char *)&server.sin_addr, hp->h_length);
-
-		server.sin_family = hp->h_addrtype;
-		server.sin_port = sp->s_port;
-
-		hosts[nhosts].busy = 0;
-
-		hosts[nhosts].fd = socket(hp->h_addrtype, SOCK_STREAM, 0);
-
-		if (hosts[nhosts].fd > 0 && !(connect(hosts[nhosts].fd, (struct sockaddr *)&server, sizeof(server)) < 0)) {
-			sendshort(hosts[nhosts].fd, strlen(buf));
-
-			write(hosts[nhosts].fd, buf, strlen(buf));
-
-			sendshort(hosts[nhosts].fd, strlen(av[1]));
-
-			write(hosts[nhosts].fd, av[1], strlen(av[1]));
-
-			sendshort(hosts[nhosts].fd, screenx);
-			sendshort(hosts[nhosts].fd, screeny);
-
-			sendshort(hosts[nhosts].fd, preprocess);
-
-			xfragsize = yfragsize = 50;
-
-			sendshort(hosts[nhosts].fd, xfragsize);
-			sendshort(hosts[nhosts].fd, yfragsize);
-
-			nhosts++;
-		} else
-			close(hosts[nhosts].fd);                          
-	}
-
-	fclose(infile);
-
-	if (nhosts == 0) {
-		fprintf(stderr, "dart: can't connect to any hosts\n");
-		exit(1);
-	}
-
-	if ((infile = fopen(av[1], "r")) == (FILE *)NULL) {
-		fprintf(stderr, "dart: can't open file %s\n", av[1]);
-		for (i = 0; i != nhosts; i++)
-			close(hosts[i].fd);
-		exit(1);
-	}
-
-	fclose(infile);
-
-	FD_ZERO(&readfds);
-	for (i = 0; i != nhosts; i++)
-		if (hosts[i].fd > 0)
-			FD_SET(hosts[i].fd, &readfds);
-
-	pending = 1;
-	y = 0;
-	x = 0;
-
-	while (pending) {
-		for (i = 0; i != nhosts; i++) {
-			if (hosts[i].fd > 0 && FD_ISSET(hosts[i].fd, &readfds)) {
-				if (x >= screenx) {
-					x = 0;
-					y += yfragsize;
-				}
-
-				if (y >= screeny) {
-							/*
-							 * do we have any fragments that
-							 * didn't complete?
-							 */
-					for (j = 0; j != nhosts; j++) {
-						if (hosts[j].fd < 0 && hosts[j].busy) {
-							
-							hosts[i].x = hosts[j].x;
-							hosts[i].y = hosts[j].y;
-
-							hosts[i].xdiff = hosts[j].xdiff;
-							hosts[i].ydiff = hosts[j].ydiff;
-
-							hosts[i].busy = 1;
-							hosts[j].busy = 0;
-
-							break;
-						}
-					}
-
-							/* didn't find anything */
-					if (!hosts[i].busy) {
-						write(hosts[i].fd, "Q", 1);
-						close(hosts[i].fd);
-						hosts[i].fd = -1;
-						continue;
-					}
-				}
-
-				if (!hosts[i].busy) {
-					if (y + yfragsize >= screeny)
-						ydiff = screeny - y;
-					else 
-						ydiff = yfragsize;
-
-					if (x + xfragsize >= screenx)
-						xdiff = screenx - x;
-					else
-						xdiff = xfragsize;
-
-					hosts[i].x = x;
-					hosts[i].y = y;
-
-					hosts[i].xdiff = xdiff;
-					hosts[i].ydiff = ydiff;
-
-					hosts[i].busy = 1;
-				}
-
-				write(hosts[i].fd, "F", 1);
-
-				sendshort(hosts[i].fd, hosts[i].x);
-				sendshort(hosts[i].fd, hosts[i].x + hosts[i].xdiff - 1);
-
-				sendshort(hosts[i].fd, hosts[i].y);
-				sendshort(hosts[i].fd, hosts[i].y + hosts[i].ydiff - 1);
-
-				x += xfragsize;
-			}
-		}
-
-		FD_ZERO(&readfds);
-		pending = 0;
-		for (i = 0; i != nhosts; i++)
-			if (hosts[i].fd > 0) {
-				pending = 1;
-				FD_SET(hosts[i].fd, &readfds);
-			}
-
-		if (pending)
-			if ((i = select((int)ulimit(4, 0L), &readfds, (fd_set *)NULL, (fd_set *)NULL, (struct timeval *)NULL)) < 0)
-				perror("whoops");
-
-		for (i = 0; i != nhosts; i++)
-			if (hosts[i].fd > 0 && FD_ISSET(hosts[i].fd, &readfds))  {
-				if (read(hosts[i].fd, &c, 1) != 1) {
-					hosts[i].fd = -1;
-					continue;
-				}
-
-						/* valid response? */
-				if (c != 'D') {
-					FD_CLR(hosts[i].fd, &readfds);
-					continue;
-				}
-
-				hosts[i].busy = 0;
-
-				/*
-				 * if nc comes up less than zero then
-				 * the daemon on the remote machine
-				 * has probably gone barfo. Mark the
-				 * host as busy but set fd to -1 so
-				 * we know it didn't finish.
-				 */
-				p = map;
-				endp = map + 4 * xfragsize * yfragsize;
-				while (p != endp) {
-					nc = read(hosts[i].fd, p, endp - p);
-					if (nc < 0) {
-						hosts[i].fd = -1;
-						hosts[i].busy = 1;
-						break;
-					}
-					p += nc;
-				}
-
-				/*
-				 * write out the image data
-				 */
-				for (j = 0; j != hosts[i].ydiff; j++) {
-					lseek(im->fd, (off_t)(imagestart + (((hosts[i].y + j) * screenx + hosts[i].x) * 4)), SEEK_SET); 
-					write(im->fd, map + j * hosts[i].xdiff * 4, hosts[i].xdiff * 4);
-				}
-			}
-	}
+    val = htons(i);
+    return write(sock, &val, sizeof(unsigned short));
+}
 
-	close(im->fd);
+/*
+ * usage
+ *
+ * output a usage message and exit
+ */
+static void usage (const char *pname) {
+    fprintf(stderr, "usage: %s [-g] [-h <hostfile>] [-m <shmid>] [-n] [-o <outfile>] [-p <path>] [-r <port>] [-v] <scenefile> <xpixels> <ypixels>\n", pname);
+    exit(-1);
+}
+
+/*
+ * main driver for distributed dart.
+ */
+int main (int argc, char *argv[]) {
+    unsigned short	preprocess, remoteport, screenx, screeny, verbose;
+    unsigned short	debug;
+    int			fileno, i, j, nc, nhosts, opt, pending, pfds[2], shmid;
+    int			x, xfragsize, xinc, y, yfragsize;
+    char		c, *endp, *hostfilename, *map, name[100], *outfilename;
+    char		*p, *p2, *path, *progname, *scenefilename, *shmp;
+    long		l;
+    off_t		imagesize;
+    struct sockaddr_in	server;
+    struct hostent	*hp;
+    FILE		*hostfile, *scenefile;
+    fd_set		readfds;
+    struct stat		statbuf;
+    image		*im;
+    struct dart_host	*dh, *dh2, *first_dead, *first_host, *first_idle;
+    struct dart_host	hosts[MAXHOSTS], *last_dead, *last_host, *last_idle;
+
+    /*
+       process program options and arguments
+    */
+    progname = strrchr(argv[0], '/');
+    if (progname == NULL) progname = argv[0];
+    else progname++;
+
+    /* defaults */
+    hostfilename = NULL;
+    outfilename = NULL;
+    path = NULL;
+    preprocess = DART_TRUE;
+    remoteport = DART_PORT;
+    verbose = DART_FALSE;
+    debug = DART_FALSE;
+    xfragsize = yfragsize = FRAGDIMENSION;
+    shmid = -1;
+
+    /* loop through options */
+    while ( (opt = getopt(argc, argv, "gh:m:no:p:r:v")) != -1 ) {
+        switch (opt) {
+            case 'h':    /* host file name */
+                if ( *(optarg + checkfilename(optarg)) != '\0' ) {
+                    fprintf(stderr,
+                            "%s: invalid character(s) in host file name\n",
+                            progname);
+                    exit(-10);
+                }
+                hostfilename = strdup(optarg);
+                if (hostfilename == NULL) memerr(progname);
+                break;
+            case 'm':    /* write image to a shared memory segment */
+                l = strtol(optarg, &endp, 0);
+                if (*endp != '\0' || l < 0) {
+                    fprintf(stderr, "%s: shared memory id (%s)\n", progname,
+                            optarg);
+                    exit(-14);
+                } else shmid = l;
+                break;
+            case 'n':    /* turn off preprocessor */
+                preprocess = DART_FALSE;
+                break;
+            case 'o':    /* specify output file name */
+                i = strlen(optarg);
+                if ( i != checkfilename(optarg) ) {
+                    fprintf(stderr,
+                            "%s: invalid character(s) in output file name\n",
+                            progname);
+                    exit(-8);
+                } else if ( (i < 4) ? DART_TRUE : (strcmp(optarg+i-4, ".pix")
+                            != 0) ) {
+                    outfilename = (char *) malloc(i + 5);
+                    if (outfilename == NULL) memerr(progname);
+                    strcat(strcpy(outfilename, optarg), ".pix");
+                } else {
+                    outfilename = strdup(optarg);
+                    if (outfilename == NULL) memerr(progname);
+                }
+                break;
+            case 'p':    /* specify path for remote hosts to use */
+                if ( *(optarg + checkfilename(optarg)) != '\0' ) {
+                    fprintf(stderr, "%s: invalid character(s) in remote path\n",
+                            progname);
+                    exit(-9);
+                }
+                path = strdup(optarg);
+                if (path == NULL) memerr(progname);
+                i = strlen(path) - 1;
+                if ( i > 0 && path[i] == '/') path[i] = '\0';
+                break;
+            case 'r':    /* the remote port to connect to */
+                l = strtol(optarg, &endp, 0);
+                if (*endp != '\0' || l < 1025 || l > 65535) {
+                    fprintf(stderr, "%s: invalid remote port (%s)\n", progname,
+                            optarg);
+                    exit(-7);
+                } else remoteport = l;
+                break;
+            case 'g':
+                debug = DART_TRUE;
+                /* no break -- debug mode implies verbose mode */
+            case 'v':    /* turn on verbose mode */
+                verbose = DART_TRUE;
+                break;
+            default:     /* anything else is an error */
+                usage(progname);
+        }
+    }
+
+    /* non-option arguments */
+    if (argc - optind < 2) usage(progname);
+    scenefilename = strdup(argv[optind]);
+    if (scenefilename == NULL) memerr(progname);
+    screenx = atoi(argv[optind+1]);
+    screeny = atoi(argv[optind+2]);
+    if (hostfilename == NULL) {
+        hostfilename = strdup(DEF_HOSTSFILE);
+        if (hostfilename == NULL) memerr(progname);
+    }
+
+#define VORT_HDR_SZ 62
+    if (shmid >= 0) {
+        struct shmid_ds shmdata;
+        if ( shmctl(shmid, IPC_STAT, &shmdata) != 0 ) shmp = NULL;
+        else if ( shmdata.shm_segsz >= screenx * screeny * 4 + VORT_HDR_SZ ) {
+            shmp = NULL;
+            errno = ENOMEM;
+        } else if ( (shmp = (char *) shmat(shmid, NULL, 0)) == (char *) -1 )
+            shmp = NULL;
+        else if (outfilename != NULL) strcpy(outfilename, "-");
+        else {
+            outfilename = strdup("-");
+            if ( outfilename == NULL ) memerr(progname);
+        }
+        if (shmp == NULL) {
+            perror(progname);
+            exit(-15);
+        }
+        if ( pipe(pfds) != 0 ) {
+            perror(progname);
+            exit(-16);
+        }
+    }
+#undef VORT_HDR_SZ
+
+    if (verbose) {
+        fprintf(stderr, "%s execution begins...\n", progname);
+        fprintf(stderr, "  scene file: %s  size: %d x %d\n", scenefilename,
+                screenx, screeny);
+        if (shmid >= 0) fprintf(stderr, "  using shared memory segment %d\n",
+            shmid);
+    }
+
+    /*
+      check scene file unless a remote path was specified
+    */
+    if ( path == NULL ) {
+        if ( (scenefile = fopen(scenefilename, "r")) == NULL ) {
+            perror(progname);
+            fprintf(stderr, "%s: cannot open scene file %s\n", progname,
+                    scenefilename);
+            exit(-3);
+        }
+/*
+        if ( fstat(fileno, &statbuf) != 0 ) {
+            perror(progname);
+            exit(-12);
+        }
+        close(fileno);
+        if ( ! S_ISREG(statbuf.st_mode) ) {
+            fprintf(stderr, "%s: %s is not a regular file\n", progname,
+                    scenefilename);
+            exit(-13);
+        }
+*/
+        fclose(scenefile);
+    }
+
+    /*
+      open hosts file
+    */
+    if ( (hostfile = fopen(hostfilename, "r")) == (FILE *)NULL ) {
+        fprintf(stderr, "%s: cannot open host file %s\n", progname, hostfilename);
+        exit(-4);
+    }
+
+    /*
+      determine the path to send to the remote artds
+    */
+    p = strrchr(scenefilename, '/');
+    if ( path != NULL ) {    /* a remote path has been specified */
+        if ( p != NULL ) {
+            p++;
+            memmove(scenefilename, p, strlen(p) + 1);
+        }
+    } else if ( *scenefilename == '/' ) {    /* absolute scene file name */
+        if ( p == scenefilename ) {
+            path = strdup("/");
+        } else {
+            *p = '\0';
+            path = strdup(scenefilename);
+        }
+        if ( path == NULL ) memerr(progname);
+        p++;
+        memmove(scenefilename, p, strlen(p) + 1);
+    } else {
+        path = (char *) malloc(DEFAULT_BUF_SIZE * sizeof(char));
+        if ( path == NULL ) memerr(progname);
+        getcwd(path, DEFAULT_BUF_SIZE - 1);
+        if ( p != NULL ) {
+            *p = '\0';
+            p++;
+            if ( realloc(path, 
+                         (strlen(path)+strlen(scenefilename)+2)*sizeof(char))
+                 == NULL)
+                memerr(progname);
+            if (strlen(path) > 1) strcat(path, "/");
+            strcat(path, scenefilename);
+            p++;
+            memmove(scenefilename, p, strlen(p) + 1);
+        }
+    }
+    if (verbose) fprintf(stderr, "  using '%s' as the scene file path\n", path);
+
+    if (verbose) fprintf(stderr, "  sanity checks complete (you're sane)\n");
+
+    /*
+      read entries from the host file and connect to artd servers on the
+      specified systems
+    */
+    if (debug) fprintf(stderr, "  reading host info from %s:\n", hostfilename);
+    FD_ZERO(&readfds);
+    nhosts = 0;
+    last_host = NULL;
+    while ((nhosts < MAXHOSTS) && (fscanf(hostfile, "%99s %d", name, &i) == 2)){
+
+        if (debug) fprintf(stderr, "    %s (%d jobs)\n", name, i);
+
+        /* lookup host name/IP */
+        if ((hp = gethostbyname(name)) == (struct hostent *)NULL) {
+            printf("dart: can't find host %s\n", name);
+            continue;
+        }
+
+        /* set up remote host parameters */
+        memset(&server, 0, sizeof(server));
+        memcpy(&server.sin_addr, hp->h_addr, hp->h_length);
+        server.sin_family = hp->h_addrtype;
+        server.sin_port = htons(remoteport);
+
+        /* make the specified number of connections for this host */
+        for ( ; i > 0; i--) {
+            hosts[nhosts].fd = socket(hp->h_addrtype, SOCK_STREAM, 0);
+            if ( connect(hosts[nhosts].fd, (struct sockaddr *)&server,
+                         sizeof(server)) == 0 ) {
+                hosts[nhosts].serial = nhosts;
+                hosts[nhosts].busy = DART_FALSE;
+                sendshort(hosts[nhosts].fd, strlen(path));
+                write(hosts[nhosts].fd, path, strlen(path));
+                sendshort(hosts[nhosts].fd, strlen(scenefilename));
+                write(hosts[nhosts].fd, scenefilename, strlen(scenefilename));
+                sendshort(hosts[nhosts].fd, screenx);
+                sendshort(hosts[nhosts].fd, screeny);
+                sendshort(hosts[nhosts].fd, preprocess);
+                sendshort(hosts[nhosts].fd, xfragsize);
+                sendshort(hosts[nhosts].fd, yfragsize);
+                FD_SET(hosts[nhosts].fd, &readfds);
+                hosts[nhosts].next = NULL;
+                hosts[nhosts].prev = last_host;
+                last_host = hosts + nhosts;
+                if ( hosts[nhosts].prev != NULL )
+                    hosts[nhosts].prev->next = last_host;
+                nhosts++;
+            } else {
+                if (verbose) perror(progname);
+                close(hosts[nhosts].fd);                          
+                break;
+            }
+        }
+    }
+
+    fclose(hostfile);
+
+    if (nhosts == 0) {
+        fprintf(stderr, "%s: can't connect to any hosts\n", progname);
+        exit(-5);
+    }
+    first_host = hosts;
+    first_idle = last_idle = first_dead = last_dead = NULL;
+
+    if (verbose) fprintf(stderr, "  %d remote host connections established\n",
+                         nhosts);
+
+    /*
+      Open output file and write header.
+    */
+    if (outfilename == NULL) {
+        outfilename = strdup(scenefilename);
+        if (outfilename == NULL) memerr(progname);
+        p = strrchr(outfilename, '.');
+        if ( (p == NULL) ? DART_TRUE : strcmp(p, ".scn") ) {
+            j = strlen(outfilename);
+            if ( realloc(outfilename, j + 5) == NULL ) memerr(progname);
+            p = outfilename + j;
+        }
+        strcpy(p, ".pix");
+    }
+
+    if ((im = openimage(outfilename, "w")) == NULL) {
+        fprintf(stderr, "%s: can't open output file %s.\n", progname,
+                outfilename);
+        exit(-6);
+    /*
+      if writing to shared memory then outfilename should have been dummied to
+      "-", causing openimage to assign im->fd as 1 instead of opening any
+      actual file.  In this case, pfds should also have been initialized with
+      pipe(); we use this as a hook into the image file to copy the output into
+      the shared memory segment.  In any case, we set im->fd to the writing
+      end of the pipe.
+    */
+    } else if ( shmid >= 0 ) im->fd = pfds[1];
+
+    imagetype(im) = PIX_RGBA;
+    imagewidth(im) = screenx;
+    imageheight(im) = screeny;
+    imagedate(im) = time(0);
+    imagedepth(im) = 24;
+    titlelength(im) = 0;
+
+    writeheader(im);
+    
+    /*
+      If outputting to shared memory then capture the image header, and
+      initialize map in the process.
+    */
+    if (shmid >= 0) {
+        map = shmp;
+        do {
+            nc = read(pfds[0], map, 128);
+            if (nc < 0) {
+                perror(progname);
+                exit(-18);
+            } else map += nc;
+        } while ( nc != 0 );
+        close(pfds[0]);
+    }
+
+    if (verbose) fprintf(stderr, "  image header written\n");
+
+    /*
+      If outputting to a file then set up a memory buffer for all the pixel data
+    */
+    if (shmid < 0) {
+        imagesize = screenx * screeny * 4;
+        map = (char *) malloc(imagesize);
+        if (map == NULL) memerr(progname);
+    }
+
+    /*
+      macros for managing the various host queues (normal, idle, and dead) 
+    */
+#define RMHOST(ih,f,l) do { struct dart_host *h = ih; \
+    if (h->next != NULL) h->next->prev = h->prev; else l = h->prev; \
+    if (h->prev != NULL) h->prev->next = h->next; else f = h->next; } \
+                      while (DART_FALSE)
+#define APHOST(h,f,l) do { h->prev = l; h->next = NULL; \
+                           if ( l == NULL ) f = l = h; else l = (l->next = h);}\
+                      while (DART_FALSE)
+#define INHOST(h,f,l) do { h->prev = NULL; h->next = f; \
+                           if ( f == NULL ) f = l = h; else f = (f->prev = h);}\
+                      while (DART_FALSE)
+#define WAKE(h) do { RMHOST(h, first_idle, last_idle); \
+                     INHOST(h, first_host, last_host); } while (DART_FALSE)
+#define HANGUP(h) do { quithost(h->fd); RMHOST(h, first_host, last_host); } \
+                  while(DART_FALSE)
+#define ZOMBIE(h) do { HANGUP(h); APHOST(h, first_dead, last_dead); } \
+                  while (DART_FALSE)
+
+    /*
+      Now send out the fragments and receive back the results
+    */
+    for ( x = y = 0; first_host != NULL; ) {
+        /* scan the list of active hosts */
+        for (dh = first_host; dh != NULL; dh = dh2) {
+
+            /* copy the current value of dh's next pointer to dh2 */
+            dh2 = dh->next;
+
+            /* for those that have completed their latest assignment... */
+            if ( ! dh->busy ) {
+
+                /* apply line wrapping */
+                if (x >= screenx) {
+                    x = 0;
+                    y += yfragsize;
+                }
+
+                /* have we assigned all fragments? */
+                if (y >= screeny) {
+                    /* did any fragments not complete?  */
+                    if (first_dead != NULL) {
+                        /* assign an uncompleted fragment to the host */
+                        dh->x = first_dead->x;
+                        dh->y = first_dead->y;
+                        dh->xdiff = first_dead->xdiff;
+                        dh->ydiff = first_dead->ydiff;
+                        dh->busy = DART_TRUE;
+                        if (debug) 
+                            fprintf(stderr, "  dead host %d's fragment reassigned to host %d\n",
+                                    first_dead->serial, dh->serial);
+                        /* remove the first dead host from the list */
+                        RMHOST(first_dead, first_dead, last_dead);
+                    }
+
+                    /* if all fragments are complete so far, idle the host */
+                    if (! dh->busy) {
+                        RMHOST(dh, first_host, last_host);
+                        APHOST(dh, first_idle, last_idle);
+                        if (debug)
+                            fprintf(stderr, "  no more work for host %d\n", 
+                                    dh->serial);
+                        continue;
+                    }
+                } else {
+                    /* assign a new fragment to the host */
+                    dh->ydiff = ((y + yfragsize >= screeny) ? (screeny - y) :
+                        yfragsize);
+                    dh->xdiff = ((x + xfragsize >= screenx) ? (screenx - x) :
+                        xfragsize);
+                    dh->x = x;
+                    dh->y = y;
+                    dh->busy = DART_TRUE;
+                    if (debug) 
+                        fprintf(stderr, "  host %d assigned %d %d %d %d\n", 
+                                dh->serial, x, x + dh->xdiff - 1, screeny - y,
+                                screeny - y - dh->ydiff + 1);
+                    x += xfragsize;
+                }
+
+                /* send the fragment data to the host */
+                write(dh->fd, "F", 1);
+                sendshort(dh->fd, dh->x);
+                sendshort(dh->fd, dh->x + dh->xdiff - 1);
+                sendshort(dh->fd, dh->y);
+                sendshort(dh->fd, dh->y + dh->ydiff - 1);
+                if (debug) 
+                    fprintf(stderr, "  fragment sent to host %d\n", dh->serial);
+            }
+        }
+
+        if (first_host == NULL) break;
+        /* load readfds with the fds of the remaining active hosts */
+        FD_ZERO(&readfds);
+        for (dh = first_host; dh != NULL; dh = dh->next)
+            FD_SET(dh->fd, &readfds);
+
+        if ( select(FD_SETSIZE, &readfds, NULL, NULL, NULL) < 0 )
+            perror("whoops");
+
+        for (dh = first_host; dh != NULL; dh = dh2) {
+            /* copy dh's current next pointer to dh2 */
+            dh2 = dh->next;
+
+            /* get the responses from all hosts that responded */
+            if ( FD_ISSET(dh->fd, &readfds) )  {
+
+                if (debug) 
+                    fprintf(stderr, "  response from host %d ", dh->serial);
+
+                /* has the remote host hung up? */
+                if ( read(dh->fd, &c, 1) != 1 ) {
+                    if (debug) fprintf(stderr, "is a hangup.\n");
+                    ZOMBIE(dh);
+                    if (debug) fprintf(stderr, "    host %d has bad juju\n",
+                                       dh->serial);
+                    continue;
+                }
+                /* does the host send a valid response code? */
+                if ( c != 'D' ){
+                    if (debug) fprintf(stderr,
+#ifndef STRICT
+                        "is garbage ('%c' = %x);  ignoring it.\n", c, (int) c);
+                    FD_CLR(dh->fd, &readfds);
+#else
+                        "is garbage ('%c' = %x);  hanging up.\n", c, (int) c);
+                    ZOMBIE(dh);
+#endif
+                    continue;
+                }
 
-	exit(0);
+                /*
+                  receive the fragment data from the remote host.  if we get
+                  fewer characters than the fragment size then assume the remote
+                  machine has had a fault; it is zombified.
+                */
+                p = map + (dh->y * screenx + dh->x) * 4;
+                nc = dh->xdiff * 4;
+                for (j = 0; j < dh->ydiff; j++) {
+                    if ( readall(dh->fd, p, nc) != nc ) {
+                        ZOMBIE(dh);
+                        if (debug) fprintf(stderr, "is garbled; hanging up.\n");
+                        continue;
+                    }
+                    p += screenx * 4;
+                }
+
+                /* fragment received; this host is no longer busy */
+                dh->busy = DART_FALSE;
+                if (debug) fprintf(stderr, "is good.\n");
+            }
+        }
+        /* wake up as many idle hosts as we have zombie hosts, or as many as
+           there are, whichever is fewer */
+        for (dh = first_dead; dh != NULL && first_idle != NULL; dh = dh->next) {
+            if (debug)
+                fprintf(stderr, "  waking host %d\n", first_idle->serial);
+            WAKE(first_idle);
+        }
+    }
+
+    /* Close connections to the remaining hosts (which should all be idle) */
+    for (dh = first_idle; dh != NULL; dh = dh->next) HANGUP(dh);
+
+    /*
+      Rendering is complete.  Write out the image and finish up.
+    */
+    if (verbose) fprintf(stderr, "  rendering complete, writing image...\n");
+    if ( shmid < 0 ) {
+        for (p=map; imagesize > 0; imagesize -= i) {
+            i = write(im->fd, p, imagesize);
+            if (i < 0) {
+                perror(progname);
+                break;
+            }
+            p += i;
+        }
+    }
+
+    close(im->fd);
+
+    if (verbose) fprintf(stderr, "All done.\n\n");
+
+    if (shmid >= 0) shmdt(shmp);
+    free(map);
+    free(path);
+    free(outfilename);
+    free(hostfilename);
+    free(scenefilename);
+    exit(0);
 }
diff -Nrua vort-old/art/src/descrip.mms vort-new/art/src/descrip.mms
--- vort-old/art/src/descrip.mms	1999-10-12 19:06:51.000000000 -0400
+++ vort-new/art/src/descrip.mms	1969-12-31 19:00:00.000000000 -0500
@@ -1,197 +0,0 @@
-! vort VAX/VMS make file [vort.art.src]descrip.mms
-!
-
-.FIRST
- DEFINE C$INCLUDE [--.lib]
-
-! should not be necessary to define the vax option in cflags - the default
-! but sometimes it does not work
-
-! if no optimisation wanted and NO debug planned
-CFLAGS = /DEFINE="VMS=1"/NOOPT
-
-! define where to look for usr include files (due to lex.c)
-! USRINCLUDE =
-
-! use this version of cflags if no optimisation wanted and debug planned
-! CFLAGS = /DEFINE="VMS=1"/DEBUG/NOOPT
-
-LFLAGS =	c$include:libvort/lib, -
-		c$include:clib/opt
-
-LIB =	[--.lib]libvort.olb
-
-HEAD =	[--.lib]vort.h, -
-	[--.lib]features.h
-
-OBJS = gram.obj, -
-	main.obj, -
-	lex.obj, -
-	prepro.obj, -
-	repeat.obj, -
-	message.obj, -
-	matrix.obj, -
-	solve.obj, -
-	rt.obj, -
-	stree.obj, -
-	shade.obj, -
-	light.obj, -
-	expr.obj, -
-	symbol.obj, -
-	object.obj, -
-	tile.obj, -
-	bbox.obj, -
-	comp.obj, -
-	csg.obj, -
-	sphere.obj, -
-	blob.obj, -
-	patch.obj, -
-	box.obj, -
-	grid.obj, -
-	geom.obj, -
-	interp.obj, -
-	polygon.obj, -
-	alg.obj, -
-	torus.obj, -
-	ellipse.obj, -
-	cone.obj, -
-	cylinder.obj, -
-	ring.obj, -
-	super.obj, -
-	smalloc.obj, -
-	util.obj, -
-	map.obj, -
-	mask.obj, -
-	texture.obj, -
-	noise.obj, -
-	twentyf.obj
-
-art.exe :	$(OBJS)
-! use this version if debug NOT planned
-		link/exec=art.exe $(OBJS), $(LFLAGS)
-! use this link if debug planned
-!		link/debug/exec=art.exe $(OBJS), $(LFLAGS)
-
-
-! slight overkill including HEAD rather than the required '.h' files
-! in each of the objects below - but better to be safe than sorry
-                
-gram.obj :	gram.c $(LIB) $(HEAD)
-		cc $(CFLAGS) gram 
-
-main.obj :	main.c $(LIB) $(HEAD)
-		cc $(CFLAGS) main
-
-lex.obj :	lex.c $(LIB) $(HEAD)
-		cc $(CFLAGS) -I$(USRINCLUDE) lex
-
-prepro.obj :	prepro.c $(LIB) $(HEAD)
-		cc $(CFLAGS) -I$(USRINCLUDE) prepro
-
-repeat.obj :	repeat.c $(LIB) $(HEAD)
-		cc $(CFLAGS) -I$(USRINCLUDE) repeat
-
-message.obj :	message.c $(LIB) $(HEAD)
-		cc $(CFLAGS) message
-
-matrix.obj :	matrix.c $(LIB) $(HEAD)
-		cc $(CFLAGS) matrix
-
-solve.obj :	solve.c $(LIB) $(HEAD)
-		cc $(CFLAGS) solve
-
-rt.obj :	rt.c $(LIB) $(HEAD)
-		cc $(CFLAGS) rt
-
-stree.obj :	stree.c $(LIB) $(HEAD)
-		cc $(CFLAGS) stree
-
-shade.obj :	shade.c $(LIB) $(HEAD)
-		cc $(CFLAGS) shade
-
-light.obj :	light.c $(LIB) $(HEAD)
-		cc $(CFLAGS) light
-
-expr.obj :	expr.c $(LIB) $(HEAD)
-		cc $(CFLAGS) expr
-
-symbol.obj :	symbol.c $(LIB) $(HEAD)
-		cc $(CFLAGS) symbol
-
-object.obj :	object.c $(LIB) $(HEAD)
-		cc $(CFLAGS) object
-
-tile.obj :	tile.c $(LIB) $(HEAD)
-		cc $(CFLAGS) tile
-
-grid.obj :	grid.c $(LIB) $(HEAD)
-		cc $(CFLAGS) grid
-
-bbox.obj :	bbox.c $(LIB) $(HEAD)
-		cc $(CFLAGS) bbox
-
-comp.obj :	comp.c $(LIB) $(HEAD)
-		cc $(CFLAGS) comp
-
-csg.obj :	csg.c $(LIB) $(HEAD)
-		cc $(CFLAGS) csg
-
-sphere.obj :	sphere.c $(LIB) $(HEAD)
-		cc $(CFLAGS) sphere
-
-blob.obj :	blob.c $(LIB) $(HEAD)
-		cc $(CFLAGS) blob
-
-patch.obj :	patch.c $(LIB) $(HEAD)
-		cc $(CFLAGS) patch
-
-box.obj :	box.c $(LIB) $(HEAD)
-		cc $(CFLAGS) box
-
-geom.obj :	geom.c $(LIB) $(HEAD)
-		cc $(CFLAGS) geom
-
-interp.obj :	interp.c $(LIB) $(HEAD)
-		cc $(CFLAGS) interp
-
-polygon.obj :	polygon.c $(LIB) $(HEAD)
-		cc $(CFLAGS) polygon
-
-alg.obj :	alg.c $(LIB) $(HEAD)
-		cc $(CFLAGS) alg
-
-torus.obj :	torus.c $(LIB) $(HEAD)
-		cc $(CFLAGS) torus
-
-ellipse.obj :	ellipse.c $(LIB) $(HEAD)
-		cc $(CFLAGS) ellipse
-
-cone.obj :	cone.c $(LIB) $(HEAD)
-		cc $(CFLAGS) cone
-
-cylinder.obj :	cylinder.c $(LIB) $(HEAD)
-		cc $(CFLAGS) cylinder
-
-ring.obj :	ring.c $(LIB) $(HEAD)
-		cc $(CFLAGS) ring
-
-super.obj :	super.c $(LIB) $(HEAD)
-		cc $(CFLAGS) super
-
-smalloc.obj :	smalloc.c $(LIB) $(HEAD)
-		cc $(CFLAGS) smalloc
-
-util.obj :	util.c $(LIB) $(HEAD)
-		cc $(CFLAGS) util
-
-map.obj :	map.c $(LIB) $(HEAD)
-		cc $(CFLAGS) map
-
-texture.obj :	texture.c $(LIB) $(HEAD)
-		cc $(CFLAGS) texture
-
-noise.obj :	noise.c $(LIB) $(HEAD)
-		cc $(CFLAGS) noise
-
-twentyf.obj :	twentyf.c $(LIB) $(HEAD)
-		cc $(CFLAGS) twentyf
diff -Nrua vort-old/art/src/ellipse.c vort-new/art/src/ellipse.c
--- vort-old/art/src/ellipse.c	1999-10-12 18:24:14.000000000 -0400
+++ vort-new/art/src/ellipse.c	2006-11-18 16:58:16.000000000 -0500
@@ -99,10 +99,6 @@
 	float   u, v;
 	int     w, h, indx;
 	tiletxt	*tp;
-#ifdef PC
-	unsigned int	page;
-	unsigned long	cp;
-#endif
 
 	totexture(txt, loc, *l);
 
@@ -117,20 +113,6 @@
 	w = u * tp->scalew;
 	h = v * tp->scaleh;
 
-#ifdef PC
-	if (tp->EMS_h != EMS_NULL_HDL) {
-		page = ((w % tp->pixw + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) / EMS_PAGE_SIZE;
-		cp = ((w % tp->pixw + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) % EMS_PAGE_SIZE;
-		EMS_map(tp->EMS_h, page);
-
-		pcol->r = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->g = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->b = (unsigned char)*(EMS_base()+cp) / 255.0;
-		return;
-	}
-#endif
 	indx = (w % tp->pixw + (h % tp->pixh) * tp->pixw) * 3;
 
 	pcol->r = (unsigned char)tp->map[indx] / 255.0;
diff -Nrua vort-old/art/src/gram.c vort-new/art/src/gram.c
--- vort-old/art/src/gram.c	1999-10-13 08:14:29.000000000 -0400
+++ vort-new/art/src/gram.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,4643 +0,0 @@
-#ifndef lint
-static char yysccsid[] = "@(#)yaccpar	1.9 (Berkeley) 02/21/93";
-#endif
-#define YYBYACC 1
-#define YYMAJOR 1
-#define YYMINOR 9
-#define yyclearin (yychar=(-1))
-#define yyerrok (yyerrflag=0)
-#define YYRECOVERING (yyerrflag!=0)
-#define YYPREFIX "yy"
-#line 6 "gram.y"
-#include <stdio.h>
-#include <math.h>
-#include "art.h"
-#include "macro.h"
-
-extern object	*objectinit(),
-		*compinit(),
-		*csginit(),
-		*getcsgobj(),
-		*getcsgexp(),
-		*treeinit(),
-		*gridinit();
-
-extern symbol	*lookup();
-
-extern light	*lightinit();
-extern texture	*textureinit();
-extern wlist	*waveinit();
-extern cmap	*mapinit();
-
-extern attr	*astackp;
-extern mats	*mstackp;
-
-extern object	**oblistsp;
-extern object	*subobjs;
-extern light	*lights;
-
-extern vector	org, up;
-
-extern matrix	trans;
-extern float	focallength;
-
-extern char	*title;
-extern int	maxhitlevel, raysperpix, pixelgrid;
-extern long	filetype;
-
-extern colour	backcol;
-
-extern float	fogfactor, rfactor;
-extern colour	hazecolour;
-
-extern float	huge_dist;
-
-extern float	sourceradius;
-extern float	falloff;
-extern float	ri;
-
-extern float	screenx, screeny;
-extern int	maxtreedepth;
-extern int	perspective;
-
-extern int	frameno;
-extern int	gridsize[];
-extern int	usegrid;
-
-extern int	adaptive;
-extern real	aathreshold;
-
-extern float		eval_fexpr();
-extern int		eval_iexpr();
-extern expression	*get_expr(), *get_varexpr();
-
-#ifndef M_PI
-#define M_PI	3.14159265358979323846
-#endif
-
-static int	objdefined = FALSE;
-static int	fieldtype;
-
-extern objst	*ostackp;
-
-#line 79 "gram.y"
-typedef union{
-	object		*y_obj;
-	vector		*y_pnt;
-	details		*y_det;
-	char		*y_str;
-	eqn		*y_eqn;
-	term		*y_trm;
-	expression	*y_exp;
-	symbol		*y_sym;
-	csgnode		*y_csg;
-	float		y_flt;
-	int		y_int;
-} YYSTYPE;
-#line 98 "y.tab.c"
-#define CSG 257
-#define COMPOSITE 258
-#define OBJECT_TYPE 259
-#define FLOAT 260
-#define INTEGER 261
-#define FILETYPE 262
-#define OPTION 263
-#define NAME 264
-#define LBRACE 265
-#define RBRACE 266
-#define LP 267
-#define RP 268
-#define RADIUS 269
-#define RADII 270
-#define COLOUR 271
-#define CENTER 272
-#define VERTEX 273
-#define COMMA 274
-#define PCENT 275
-#define MATERIAL 276
-#define REFI 277
-#define MINUS 278
-#define AMBIENT 279
-#define INTENSITY 280
-#define LOCATION 281
-#define DOLS 282
-#define EQUATION 283
-#define OFFFILE 284
-#define BASE 285
-#define TOP 286
-#define CONST 287
-#define COEFFS 288
-#define SCALE 289
-#define ROTATE 290
-#define TRANSLATE 291
-#define TITLE 292
-#define REFLECTANCE 293
-#define DOT 294
-#define ON 295
-#define OFF 296
-#define LOOKAT 297
-#define FIELDOFVIEW 298
-#define TRANSPARENCY 299
-#define RAYSPERPIXEL 300
-#define BACKGROUND 301
-#define SIZE 302
-#define MAXHITLEVEL 303
-#define OUTPUT 304
-#define ORDER 305
-#define ABSORPTION 306
-#define VREF1 307
-#define VREF2 308
-#define NUMRAYS 309
-#define OBJECT 310
-#define TEXTURE 311
-#define DIRECTION 312
-#define ANGLE 313
-#define UP 314
-#define TWENTYFIVEBIT 315
-#define RANGE 316
-#define MAP 317
-#define BLENDCOLOR 318
-#define SCALEFACTORS 319
-#define VORTFILE 320
-#define HAZECOLOUR 321
-#define FOGFACTOR 322
-#define RFACTOR 323
-#define FALLOFF 324
-#define QUOTE 325
-#define REPEAT 326
-#define SHADOWS 327
-#define COLOURFILE 328
-#define VNORMALFILE 329
-#define SCALEFACTOR 330
-#define SOURCE 331
-#define AMPLITUDE 332
-#define WAVELENGTH 333
-#define PHASE 334
-#define TURBULENCE 335
-#define SQUEEZE 336
-#define DAMPING 337
-#define SOURCERADIUS 338
-#define NORMAL 339
-#define COMPLEXVERTEX 340
-#define SCREENSIZE 341
-#define MAXTREEDEPTH 342
-#define BLEND 343
-#define COLOURMAP 344
-#define MAPVALUES 345
-#define PIXELGRID 346
-#define RI 347
-#define COLOURBLEND 348
-#define NORMALFILE 349
-#define BEAMDISTRIBUTION 350
-#define INSIDEANGLE 351
-#define PROJECTION 352
-#define PERSPECTIVE 353
-#define ORTHOGRAPHIC 354
-#define STRIP 355
-#define VCOLOURFILE 356
-#define TRANSFORM 357
-#define MINDIST 358
-#define CLIPVOLUME 359
-#define HEIGHTFIELD 360
-#define FRAMENO 361
-#define BLOCKSIZE 362
-#define GAPCOLOUR 363
-#define GAPSIZE 364
-#define COLOURFIELD 365
-#define ALPHA 366
-#define GEOMX 367
-#define GEOMY 368
-#define GEOMZ 369
-#define ANTIALIASING 370
-#define ADAPTIVE 371
-#define BRUTE 372
-#define THRESHOLD 373
-#define METABALL 374
-#define BASIS 375
-#define MAXSUBLEVEL 376
-#define SUBDIVISION 377
-#define GRID 378
-#define KDTREE 379
-#define PLUS 380
-#define MULT 381
-#define DIV 382
-#define POWER 383
-#define UMINUS 384
-#define EQUALS 385
-#define YYERRCODE 256
-short yylhs[] = {                                        -1,
-    0,    0,    0,    0,    0,   24,   24,   24,   24,   24,
-   24,   24,   24,   24,   24,   24,   24,   24,   24,   24,
-   24,   24,   24,   24,   24,   24,   24,   24,    7,    7,
-    7,   26,    7,   19,   19,   19,   19,   25,   25,   25,
-   27,   25,   28,   25,   29,   25,   25,   18,   18,   18,
-   18,   12,   12,   12,   13,   13,   13,   13,   13,   13,
-   13,   13,   13,   13,   13,   13,   13,   13,   13,   13,
-   13,   13,   13,   13,   13,   13,   13,   13,   13,   30,
-   13,   31,   13,   32,   13,   33,   13,   34,   13,   35,
-   13,   36,   13,   13,   13,   13,   13,   13,   13,   13,
-   13,   13,   13,   13,   13,   13,   13,   13,    1,    1,
-    1,   16,   16,   16,   16,    9,    9,   10,   10,   11,
-   11,   11,   17,   17,   17,   17,   14,   14,   14,   15,
-   15,   15,   15,   15,   15,   15,   15,   15,   15,   15,
-   15,   15,   15,   15,   22,   22,   23,   20,   20,   21,
-   21,   21,   21,   21,    6,    6,    6,    6,    8,   37,
-    8,    8,    5,    5,    5,    5,    5,    5,    3,    3,
-    3,    3,    3,    3,    4,    4,    4,    4,    2,    2,
-    2,    2,    2,    2,    2,    2,    2,    2,
-};
-short yylen[] = {                                         2,
-    0,    2,    2,    2,    2,    2,    2,    4,    2,    2,
-    6,    2,    2,    2,    2,    2,    2,    2,    3,    2,
-    8,   16,    6,    2,    2,    2,    2,    2,    4,    1,
-    4,    0,    6,    0,    2,    2,    2,    3,    1,    1,
-    0,    6,    0,   11,    0,    6,    5,    0,    2,    2,
-    6,    0,    2,    2,    8,    2,   12,    2,    2,    4,
-    6,    2,    6,    5,    6,    2,    2,    2,    2,    2,
-    2,    4,    2,    2,    2,    2,    8,    2,    2,    0,
-    3,    0,    3,    0,    3,    0,    3,    0,    3,    0,
-    3,    0,    3,    2,    2,    5,    3,    6,    8,    2,
-    2,    2,    2,    2,    8,    2,    2,   34,    1,    1,
-    1,    5,    1,    5,    3,    1,    2,    1,    3,    7,
-    5,    7,    6,    8,    8,   26,    0,    2,    2,    2,
-    4,    2,    2,    6,    4,    6,    2,    2,    2,    2,
-    4,    2,    6,    6,    1,    3,    5,    0,    2,    8,
-    2,    2,    2,    2,    0,    2,    2,    2,    5,    0,
-    7,    5,    1,    3,    3,    3,    3,    1,    1,    2,
-    3,    7,    3,    3,    1,    1,    1,    5,    1,    1,
-    1,    3,    1,    3,    3,    3,    3,    2,
-};
-short yydefred[] = {                                      1,
-    0,    0,    0,    0,    0,    0,    0,    0,   80,    0,
-    0,    0,   82,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,   84,    0,    0,   86,    0,    0,
-    0,    0,    0,   92,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,   90,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,   88,  109,  110,  111,    0,    0,
-    0,    0,    0,    0,    0,    0,    3,    5,   40,   39,
-    2,    4,    0,   32,    0,   34,    0,   52,   94,   95,
-    0,    0,  179,  180,  183,    0,    0,  181,    0,    0,
-    0,    0,    0,    0,    0,  118,    0,    0,    0,    0,
-   71,    0,    0,    0,    0,    0,    0,    0,    6,    0,
-    0,    0,    0,    0,    0,    0,   25,    0,    0,    0,
-    0,    0,    0,    0,   16,   17,    0,    0,    0,    0,
-    0,   78,   79,   74,   75,    0,    0,    0,   15,    0,
-   76,    0,    0,   27,   28,    0,   73,    0,    0,    0,
-   69,   70,    0,   18,   20,    0,    0,    0,  106,    0,
-    0,   45,    0,  160,  155,   34,    0,   52,    0,    0,
-    0,  188,    0,    0,    0,    0,    0,    0,    0,    0,
-   81,    0,    0,    0,    0,    0,   83,    0,  176,  177,
-    0,    0,    0,  169,    0,    0,    0,    0,   85,    0,
-   87,    0,   93,  127,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,   97,
-    0,    0,    0,   48,    0,   91,    0,    0,    0,   52,
-   89,    0,    0,    0,    0,    0,    0,  155,    0,    0,
-    0,    0,    0,    0,   31,   37,   36,   35,    0,   29,
-   54,   53,    0,  182,    0,    0,  186,  187,    0,    0,
-    0,    0,    0,    0,  119,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,  130,    0,    0,  138,    0,  148,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-   72,    0,    0,    0,    0,    0,    1,    1,    0,    0,
-    0,    0,    0,    0,    0,    0,  158,  156,  157,  162,
-  159,    0,    0,  127,  115,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,   96,  128,  129,    0,    0,    0,    0,    0,
-    0,  145,    0,    0,    0,    0,    0,   50,   47,    0,
-   49,    0,   64,    0,    0,    0,    0,    0,    0,  163,
-  168,    0,   33,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,   63,    0,    0,
-  123,    0,    0,    0,    0,    0,    0,  141,    0,    0,
-    0,    0,    0,  149,    0,  131,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,   42,   46,    0,  161,
-  167,    0,    0,  165,  114,    0,    0,    0,    0,    0,
-    0,  178,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,  146,    0,    0,    0,    0,   48,
-    0,    0,    0,    0,   55,  120,    0,    0,   99,    0,
-  125,  124,    0,    0,    0,    0,    0,    0,    0,  105,
-   21,    0,    0,    0,    0,    0,  172,    0,    0,    0,
-   51,    0,    0,    1,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,   44,    0,    0,    0,    0,
-    0,    0,    0,  150,    0,    0,    0,    0,    0,    0,
-    0,    0,   22,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,  126,    0,    0,    0,    0,    0,    0,
-    0,    0,  108,
-};
-short yydgoto[] = {                                       1,
-   76,  190,  283,  204,  326,  249,   77,   78,  237,  105,
-  106,  179,   79,  290,  354,  191,   80,  309,  177,  359,
-  414,  361,  362,   81,   82,  175,  245,  485,  246,  101,
-  108,  120,  123,  163,  150,  129,  248,
-};
-short yysindex[] = {                                      0,
- 6848, -219, -208, -203, -225, -261,  174,  174,    0, -251,
- 6797,  174,    0, -235, -217, -201,  174,  174,  174,  174,
- -192, -186, -181, -165,    0, -152,  174,    0,  174,  174,
-  174, -144,  174,    0,  174, -141, -138,  174, -130, -218,
-  174,  174,  174,  174,  174,  -52, -109, -101,  174,  174,
-  174, -160,    0,  -97,  174,  174, -179,  -93,  -71,  -69,
-  174,  -55,  -41,  -28,    0,    0,    0,    0, -125, -142,
-  174,  -42,  -26,  174, -105,  -14,    0,    0,    0,    0,
-    0,    0,  -12,    0,    6,    0,   19,    0,    0,    0,
-  -17,  174,    0,    0,    0,  174,   26,    0, -124,   -2,
- 6918,  174,  174,   20,   17,    0,  103, 6918,  174,   22,
-    0, -124, -124, -124,  133,  174,  174,  174,    0, 6918,
-  174, -124, 6918, -124,  540, -124,    0, -124, 6918, -124,
- 7732,  174, -124,  174,    0,    0,  664, -124, -124, -124,
- -238,    0,    0,    0,    0, -124,  788, -124,    0, 6918,
-    0, -124, -124,    0,    0, 6797,    0,  174, -124,   27,
-    0,    0, 6918,    0,    0,  174, -124,  174,    0, -124,
-  174,    0,  174,    0,    0,    0, 6969,    0, 7443,  174,
- -124,    0,  -32,  174,  174,  174,  174,  174,   54,  912,
-    0, 1036, 1160,  174, 6797,  174,    0, 1284,    0,    0,
-  -73,   22, -148,    0,  174, 1408, 1532, 1656,    0, 1961,
-    0,  174,    0,    0,  174,  174,   55,  174,  174,   58,
-  174,   42,  174,  174,  174,   48,  174,  174,  174,    0,
- 2028, 2085,  174,    0,  174,    0, 6434,   17, 2152,    0,
-    0, -124, 2209, 2276,   63,   64, 2333,    0, 7089, 7209,
-   65,   74,   81,   59,    0,    0,    0,    0, 7557,    0,
-    0,    0, 2400,    0, -127, -127,    0,    0, 2457, 7754,
-  174,  174,  174, 2524,    0, 2581,  174,   88, -128,   22,
-   22,  174,   22, 2648,  174,  174,  174,  174, 2705, 7789,
- 2772, -124,    0, 2829, 2896,    0, -124,    0, -124, -124,
- -124,  174, 2953, 3020, -124,  174,  174, 3077, 7024, -124,
-    0,   17,  174, 7671,  174,  174,    0,    0,  174, 7089,
-   67,   90,   97,   59, -234, -118,    0,    0,    0,    0,
-    0,  174,  174,    0,    0, 3144, 3201, 3268,  174,  174,
- 3325,  174,  -31,   22,   22,  -79,  174, 3392, -260, 3449,
- 3516,  174,    0,    0,    0,  174,  174,  174, 6242, 3573,
- -227,    0,  174,  174, 3640, 3697,  174,    0,    0,  174,
-    0, 3764,    0, 3821, 3888, 6485, 6606, 3945,  -84,    0,
-    0, -174,    0, -234, -234, -234, -124, -124, 7838,  174,
-  174,  174, 4012, 4069,  174, -140,   99,    0, -124,  174,
-    0,  174,  174, -124, -124, 4136, 4193,    0,   95,  174,
-  174,  174,  174,    0,  174,    0,  174, 4260, 4317,  174,
-  174, -124, -212,  174,  174,  174,    0,    0,  174,    0,
-    0,  -15,  -15,    0,    0, -124,  -44,  -39,  174,  174,
-    9,    0,  174,   43,   46, 4384,  174,  174,  174, -124,
- -124, -124, -124, 4441,    0,  174,  174,   49,   66,    0,
- 4508,   80, -124, 4565,    0,    0, -124, -124,    0, -132,
-    0,    0,  174, -124, -124, 4632,  174, -124, -124,    0,
-    0, 7144,  174,   93,  105,  174,    0, 4689,  174, -124,
-    0, 4756,  174,    0, 4813,  174, 4880,  174, 4937, 6727,
-  174, 5004,  174, 5061,  174,    0, 5128,  174,   87,  174,
- -124,  174, 5185,    0, 5252, 5309,  174,  174,  174,   91,
- 5376, 5433,    0,  174,  174, 5500, 5557,  174,  174, 5624,
- 5681,  174,  174, 5748, 5805,  174,  174, 5872, 5929,  174,
-  174, -121, 5996,    0,  174, 6053,  174, 6120,  174, 6177,
-  174, -113,    0,
-};
-short yyrindex[] = {                                      0,
-    0,    0,    0, 6364,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0, 2148,    0,
-    0,    0,    0,    0, 2272,    0,    0,    0,    0,    0,
-    0, 2396, 2520, 2644,    0,    0,    0,    0,    0,    0,
-    0, 4752,    0, 4876,    0, 5000,    0, 2768,    0, 2892,
-    0,    0, 3016,    0,    0,    0,    0, 5124, 5248, 5372,
-    0,    0,    0,    0,    0, 5496,    0, 5620,    0,    0,
-    0, 3140, 3264,    0,    0,    0,    0,    0, 3388,    0,
-    0,    0,    0,    0,    0,    0, 3512,    0,    0, 3636,
-  106,    0,    0,    0,    0,    0,    0,    0,    0,    0,
- 5744,    0,    0,    0,    0,    0,    0,    0,    0, 3760,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
- -209,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0, 6555,    0,    0,
-    0, 5868,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0, 7329,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,  288,  412,    0,    0, 3884,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0, -194,    0,    0,    0,    0,    0,    0,    0,
-    0,  536,    0,    0,    0,    0,  660,    0,  784,  908,
- 1032,    0,    0,    0, 1156,    0,    0,    0,    0, 5992,
-    0, 6676,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,  -76,  -65,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0, -188, -185, -170,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0, 4008, 4132,    0,    0,
-    0,    0, 2024,    0,    0,    0,    0,    0, 4256,    0,
-    0,    0,    0, 6116, 1280,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0, 6240,    0,    0,    0,    0,    0,    0,    0,    0,
-    0, -161,  -33,    0,    0, 4380,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0, 7091,
- 7211, 7257, 7331,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,  107,    0,    0,    0, 1900, 4504,    0,    0,
-    0,    0,    0, 1404, 1528,    0,    0, 1652, 1776,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0, -206,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
- 4628,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,
-};
-short yygindex[] = {                                   -311,
-    0,   -7,  -96,    0,   72,  120, -168, -220,    0, -106,
-  178, -137, -158,   40, -129, 7141, -162,  -85,  200,    0,
-    0,    0,  -35,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,
-};
-#define YYTABLESIZE 8202
-short yytable[] = {                                      99,
-  100,  230,   91,  104,  107,  376,  377,  401,  256,  112,
-  113,  114,  115,  203,  258,  102,  262,  184,  257,  122,
-  261,  124,  125,  126,  380,  128,  234,  130,  327,  381,
-  133,  109,  325,  137,  138,  139,  140,  141,  416,  184,
-  259,  146,  147,  148,   83,   84,  417,  152,  153,  238,
-  175,  175,  460,  159,  175,   85,   86,  175,  175,  147,
-   87,   88,  111,  167,  110,  184,  170,  147,  175,   89,
-   90,  171,  171,  170,  116,  171,  135,  136,  171,  171,
-  117,  256,  174,  170,  181,  118,  329,  258,  182,  171,
-  328,  257,  174,  431,  192,  193,  262,  173,  119,  327,
-  261,  198,  314,  384,  166,  279,  166,  173,  206,  207,
-  208,  199,  200,  210,  121,  201,  166,  127,  202,  185,
-  186,  187,  131,   92,  231,  442,  232,  355,  132,  280,
-  312,  199,  200,  487,  149,  201,  134,  184,  202,  343,
-  335,  185,  186,  187,  544,  184,  371,  383,  104,  280,
-  239,  262,  553,  184,  144,  261,  184,  329,  242,  384,
-  243,  328,  145,  244,  184,  247,  151,  185,  186,  187,
-  175,  156,  263,  154,  155,  175,  265,  266,  267,  268,
-  269,  430,  500,  344,  345,  170,  274,  104,  276,  163,
-  170,  171,  157,  384,  174,  158,  171,  284,  184,  174,
-  168,  163,  398,  160,  289,  385,  386,  291,  292,  173,
-  294,  295,  168,  297,  173,  299,  300,  301,  166,  303,
-  304,  305,  161,  465,  168,  308,  355,  310,  466,  104,
-  166,  281,  164,  184,  164,  162,  282,  169,  184,  185,
-  186,  187,  142,  143,  164,  164,  165,  185,  186,  187,
-  173,  281,  174,  186,  187,  185,  186,  187,  185,  186,
-  187,  385,  386,  336,  337,  338,  185,  186,  187,  341,
-  176,  188,  171,  172,  346,  184,  469,  348,  349,  350,
-  351,  199,  200,  178,  180,  201,  184,  185,  202,  183,
-  195,  240,  264,  194,  360,  385,  386,  184,  365,  366,
-  185,  186,  187,  163,  163,  372,  298,  374,  375,  278,
-  471,  378,  302,  472,  168,  168,  480,  270,  293,  371,
-  184,  296,   91,  184,  387,  388,  184,  317,  318,   84,
-   83,  393,  394,  481,  396,  185,  186,  187,   86,  399,
-  185,  186,  187,  184,  404,   88,  164,  484,  405,  406,
-  407,  397,  342,   85,  514,  418,  419,  184,  523,  422,
-   87,  449,  423,  443,  184,  386,  493,  320,  184,  494,
-   41,   43,  275,  389,  482,  250,  196,  185,  186,  187,
-  184,  455,  436,  437,  438,    0,    0,  441,  185,  186,
-  187,  379,  444,    0,  445,  446,  382,    0,    0,  185,
-  186,  187,  450,  451,  452,  453,  205,  454,    0,  360,
-  184,  184,  458,  459,    0,    0,  461,  462,  463,    0,
-    0,  464,  185,  186,  187,  185,  186,  187,  185,  186,
-  187,  467,  468,   93,   94,  470,    0,   95,    0,  474,
-  475,  476,    0,    0,    0,  185,  186,  187,  478,  479,
-    0,   96,    0,    0,    0,  432,  433,  434,    0,  185,
-  186,  187,    0,    0,    0,  488,  185,  186,  187,  490,
-  185,  186,  187,    0,    0,  492,    0,    0,  495,    0,
-    0,  497,  185,  186,  187,  499,    0,    0,  502,    0,
-  504,    0,    0,  507,    0,  509,    0,  511,   97,    0,
-  513,    0,  515,    0,  516,    0,    0,    0,    0,  520,
-  521,  522,  185,  186,  187,    0,  526,  527,    0,    0,
-  530,  531,    0,    0,  534,  535,    0,    0,  538,  539,
-    0,    0,  542,  543,   98,  133,    0,  546,    0,  548,
-    0,  550,    0,  552,  185,  185,  185,  185,  185,    0,
-  185,  185,  185,  185,  185,  185,  185,  185,  185,  185,
-  185,  185,    0,  185,    0,  185,  185,    0,  185,  185,
-  185,  185,  185,  185,  185,  185,  185,  185,  185,  185,
-  185,    0,    0,    0,  185,  185,  185,  185,  185,  185,
-  185,  185,  185,  185,    0,    0,  185,    0,  185,  185,
-  185,  185,  185,  185,  185,  185,  185,  185,  185,  185,
-  185,  185,  185,  185,  185,  185,  185,  185,  185,  185,
-  185,  185,  185,  185,  185,  185,    0,    0,  185,  185,
-  185,  185,    0,  185,  185,    0,  185,  185,  185,  185,
-    0,    0,  185,  185,  185,  185,  185,  185,  185,  185,
-  185,  185,  185,  185,  185,  185,  185,  185,  185,  137,
-  185,  185,  185,  185,  185,    0,    0,  185,  184,  184,
-  184,  184,  184,    0,  184,  184,  184,  184,  184,  184,
-  184,  184,  184,  184,  184,  184,    0,  184,    0,  184,
-  184,    0,  184,  184,  184,  184,  184,  184,  184,  184,
-  184,  184,  184,  184,  184,    0,    0,    0,  184,  184,
-  184,  184,  184,  184,  184,  184,  184,  184,    0,    0,
-  184,    0,  184,  184,  184,  184,  184,  184,  184,  184,
-  184,  184,  184,  184,  184,  184,  184,  184,  184,  184,
-  184,  184,  184,  184,  184,  184,  184,  184,  184,  184,
-    0,    0,  184,  184,  184,  184,    0,  184,  184,    0,
-  184,  184,  184,  184,    0,    0,  184,  184,  184,  184,
-  184,  184,  184,  184,  184,  184,  184,  184,  184,  184,
-  184,  184,  184,  139,  184,  184,  184,  184,  184,    0,
-    0,  184,  133,  133,  133,    0,    0,    0,  133,  133,
-    0,  133,  133,    0,  133,  133,  133,  133,  133,    0,
-    0,  133,    0,  212,  133,    0,  133,  184,  133,  133,
-  133,  133,  133,  133,  133,  133,  133,  133,  133,    0,
-    0,    0,  133,  133,  133,  133,  133,  133,  133,  133,
-  133,  133,    0,    0,  133,    0,  133,  133,  133,  133,
-  133,  133,  133,  133,  133,  133,  133,  133,  133,  133,
-    0,  133,  133,  133,  133,  133,  133,    0,    0,    0,
-  133,  133,    0,  133,    0,    0,  133,  133,  133,  133,
-    0,  133,  133,    0,  133,  133,  133,  133,    0,    0,
-  133,  133,  133,  133,  133,  133,    0,  133,  133,  133,
-  133,  133,  133,  133,  133,  133,  133,  140,  133,  133,
-  133,  133,  133,    0,    0,    0,  137,  137,  137,  185,
-  186,  187,  137,  137,    0,  137,  137,    0,  137,  137,
-  137,  137,  137,    0,    0,  137,    0,  233,  137,    0,
-  137,  184,  137,  137,  137,  137,  137,  137,  137,  137,
-  137,  137,  137,    0,    0,    0,  137,  137,  137,  137,
-  137,  137,  137,  137,  137,  137,    0,    0,  137,    0,
-  137,  137,  137,  137,  137,  137,  137,  137,  137,  137,
-  137,  137,  137,  137,    0,  137,  137,  137,  137,  137,
-  137,    0,    0,    0,  137,  137,    0,  137,    0,    0,
-  137,  137,  137,  137,    0,  137,  137,    0,  137,  137,
-  137,  137,    0,    0,  137,  137,  137,  137,  137,  137,
-    0,  137,  137,  137,  137,  137,  137,  137,  137,  137,
-  137,  132,  137,  137,  137,  137,  137,    0,    0,    0,
-  139,  139,  139,  185,  186,  187,  139,  139,    0,  139,
-  139,    0,  139,  139,  139,  139,  139,    0,    0,  139,
-    0,  235,  139,    0,  139,  184,  139,  139,  139,  139,
-  139,  139,  139,  139,  139,  139,  139,    0,    0,    0,
-  139,  139,  139,  139,  139,  139,  139,  139,  139,  139,
-    0,    0,  139,    0,  139,  139,  139,  139,  139,  139,
-  139,  139,  139,  139,  139,  139,  139,  139,    0,  139,
-  139,  139,  139,  139,  139,    0,    0,    0,  139,  139,
-    0,  139,    0,    0,  139,  139,  139,  139,    0,  139,
-  139,    0,  139,  139,  139,  139,    0,    0,  139,  139,
-  139,  139,  139,  139,    0,  139,  139,  139,  139,  139,
-  139,  139,  139,  139,  139,  142,  139,  139,  139,  139,
-  139,    0,    0,    0,  140,  140,  140,  185,  186,  187,
-  140,  140,    0,  140,  140,    0,  140,  140,  140,  140,
-  140,    0,    0,  140,    0,  271,  140,    0,  140,  184,
-  140,  140,  140,  140,  140,  140,  140,  140,  140,  140,
-  140,    0,    0,    0,  140,  140,  140,  140,  140,  140,
-  140,  140,  140,  140,    0,    0,  140,    0,  140,  140,
-  140,  140,  140,  140,  140,  140,  140,  140,  140,  140,
-  140,  140,    0,  140,  140,  140,  140,  140,  140,    0,
-    0,    0,  140,  140,    0,  140,    0,    0,  140,  140,
-  140,  140,    0,  140,  140,    0,  140,  140,  140,  140,
-    0,    0,  140,  140,  140,  140,  140,  140,    0,  140,
-  140,  140,  140,  140,  140,  140,  140,  140,  140,  135,
-  140,  140,  140,  140,  140,    0,    0,    0,  132,  132,
-  132,  185,  186,  187,  132,  132,    0,  132,  132,    0,
-  132,  132,  132,  132,  132,    0,    0,  132,    0,  272,
-  132,    0,  132,  184,  132,  132,  132,  132,  132,  132,
-  132,  132,  132,  132,  132,    0,    0,    0,  132,  132,
-  132,  132,  132,  132,  132,  132,  132,  132,    0,    0,
-  132,    0,  132,  132,  132,  132,  132,  132,  132,  132,
-  132,  132,  132,  132,  132,  132,    0,  132,  132,  132,
-  132,  132,  132,    0,    0,    0,  132,  132,    0,  132,
-    0,    0,  132,  132,  132,  132,    0,  132,  132,    0,
-  132,  132,  132,  132,    0,    0,  132,  132,  132,  132,
-  132,  132,    0,  132,  132,  132,  132,  132,  132,  132,
-  132,  132,  132,  134,  132,  132,  132,  132,  132,    0,
-    0,    0,  142,  142,  142,  185,  186,  187,  142,  142,
-    0,  142,  142,    0,  142,  142,  142,  142,  142,    0,
-    0,  142,    0,  273,  142,    0,  142,  184,  142,  142,
-  142,  142,  142,  142,  142,  142,  142,  142,  142,    0,
-    0,    0,  142,  142,  142,  142,  142,  142,  142,  142,
-  142,  142,    0,    0,  142,    0,  142,  142,  142,  142,
-  142,  142,  142,  142,  142,  142,  142,  142,  142,  142,
-    0,  142,  142,  142,  142,  142,  142,    0,    0,    0,
-  142,  142,    0,  142,    0,    0,  142,  142,  142,  142,
-    0,  142,  142,    0,  142,  142,  142,  142,    0,    0,
-  142,  142,  142,  142,  142,  142,    0,  142,  142,  142,
-  142,  142,  142,  142,  142,  142,  142,  136,  142,  142,
-  142,  142,  142,    0,    0,    0,  135,  135,  135,  185,
-  186,  187,  135,  135,    0,  135,  135,    0,  135,  135,
-  135,  135,  135,    0,    0,  135,    0,  277,  135,    0,
-  135,  184,  135,  135,  135,  135,  135,  135,  135,  135,
-  135,  135,  135,    0,    0,    0,  135,  135,  135,  135,
-  135,  135,  135,  135,  135,  135,    0,    0,  135,    0,
-  135,  135,  135,  135,  135,  135,  135,  135,  135,  135,
-  135,  135,  135,  135,    0,  135,  135,  135,  135,  135,
-  135,    0,    0,    0,  135,  135,    0,  135,    0,    0,
-  135,  135,  135,  135,    0,  135,  135,    0,  135,  135,
-  135,  135,    0,    0,  135,  135,  135,  135,  135,  135,
-    0,  135,  135,  135,  135,  135,  135,  135,  135,  135,
-  135,  144,  135,  135,  135,  135,  135,    0,    0,    0,
-  134,  134,  134,  185,  186,  187,  134,  134,    0,  134,
-  134,    0,  134,  134,  134,  134,  134,    0,    0,  134,
-    0,  285,  134,    0,  134,  184,  134,  134,  134,  134,
-  134,  134,  134,  134,  134,  134,  134,    0,    0,    0,
-  134,  134,  134,  134,  134,  134,  134,  134,  134,  134,
-    0,    0,  134,    0,  134,  134,  134,  134,  134,  134,
-  134,  134,  134,  134,  134,  134,  134,  134,    0,  134,
-  134,  134,  134,  134,  134,    0,    0,    0,  134,  134,
-    0,  134,    0,    0,  134,  134,  134,  134,    0,  134,
-  134,    0,  134,  134,  134,  134,    0,    0,  134,  134,
-  134,  134,  134,  134,    0,  134,  134,  134,  134,  134,
-  134,  134,  134,  134,  134,  143,  134,  134,  134,  134,
-  134,    0,    0,    0,  136,  136,  136,  185,  186,  187,
-  136,  136,    0,  136,  136,    0,  136,  136,  136,  136,
-  136,    0,    0,  136,    0,  286,  136,    0,  136,  184,
-  136,  136,  136,  136,  136,  136,  136,  136,  136,  136,
-  136,    0,    0,    0,  136,  136,  136,  136,  136,  136,
-  136,  136,  136,  136,    0,    0,  136,    0,  136,  136,
-  136,  136,  136,  136,  136,  136,  136,  136,  136,  136,
-  136,  136,    0,  136,  136,  136,  136,  136,  136,    0,
-    0,    0,  136,  136,    0,  136,    0,    0,  136,  136,
-  136,  136,    0,  136,  136,    0,  136,  136,  136,  136,
-    0,    0,  136,  136,  136,  136,  136,  136,    0,  136,
-  136,  136,  136,  136,  136,  136,  136,  136,  136,  122,
-  136,  136,  136,  136,  136,    0,    0,    0,  144,  144,
-  144,  185,  186,  187,  144,  144,    0,  144,  144,    0,
-  144,  144,  144,  144,  144,    0,    0,  144,    0,  287,
-  144,    0,  144,  184,  144,  144,  144,  144,  144,  144,
-  144,  144,  144,  144,  144,    0,    0,    0,  144,  144,
-  144,  144,  144,  144,  144,  144,  144,  144,    0,    0,
-  144,    0,  144,  144,  144,  144,  144,  144,  144,  144,
-  144,  144,  144,  144,  144,  144,    0,  144,  144,  144,
-  144,  144,  144,    0,    0,    0,  144,  144,    0,  144,
-    0,    0,  144,  144,  144,  144,    0,  144,  144,    0,
-  144,  144,  144,  144,    0,    0,  144,  144,  144,  144,
-  144,  144,    0,  144,  144,  144,  144,  144,  144,  144,
-  144,  144,  144,  121,  144,  144,  144,  144,  144,    0,
-    0,    0,  143,  143,  143,  185,  186,  187,  143,  143,
-    0,  143,  143,    0,  143,  143,  143,  143,  143,    0,
-    0,  143,    0,    0,  143,    0,  143,    0,  143,  143,
-  143,  143,  143,  143,  143,  143,  143,  143,  143,    0,
-    0,    0,  143,  143,  143,  143,  143,  143,  143,  143,
-  143,  143,    0,    0,  143,    0,  143,  143,  143,  143,
-  143,  143,  143,  143,  143,  143,  143,  143,  143,  143,
-    0,  143,  143,  143,  143,  143,  143,    0,    0,    0,
-  143,  143,    0,  143,    0,    0,  143,  143,  143,  143,
-    0,  143,  143,    0,  143,  143,  143,  143,    0,    0,
-  143,  143,  143,  143,  143,  143,    0,  143,  143,  143,
-  143,  143,  143,  143,  143,  143,  143,   59,  143,  143,
-  143,  143,  143,    0,    0,    0,  122,  122,  122,  122,
-  122,    0,  122,  122,    0,  122,  122,    0,  122,  122,
-  122,  122,  122,  122,    0,  122,    0,    0,  122,    0,
-  122,    0,  122,  122,  122,  122,  122,  122,  122,  122,
-  122,  122,  122,    0,    0,    0,  122,  122,  122,  122,
-  122,    0,  122,  122,  122,  122,    0,    0,  122,    0,
-  122,  122,  122,  122,  122,    0,    0,    0,    0,    0,
-  122,  122,  122,  122,  122,  122,  122,  122,  122,    0,
-    0,    0,    0,    0,  288,    0,    0,  122,  184,    0,
-  122,  122,    0,    0,    0,  122,  122,    0,  122,  122,
-  122,  122,    0,    0,  122,  122,  122,  122,  122,  122,
-  122,    0,    0,    0,  122,  122,  122,  122,  122,  122,
-  122,   62,  122,  122,  122,  122,  122,    0,    0,    0,
-  121,  121,  121,  121,  121,    0,  121,  121,    0,  121,
-  121,    0,  121,  121,  121,  121,  121,    0,    0,  121,
-    0,  306,  121,    0,  121,  184,  121,  121,  121,  121,
-  121,  121,  121,  121,  121,  121,  121,    0,    0,    0,
-  121,  121,  121,  121,  121,    0,  121,  121,  121,  121,
-    0,    0,  121,    0,  121,  121,  121,  121,  121,    0,
-  185,  186,  187,    0,  121,  121,  121,  121,  121,  121,
-  121,  121,  121,    0,    0,    0,    0,    0,  307,    0,
-    0,  121,  184,    0,  121,  121,    0,    0,    0,  121,
-  121,    0,  121,  121,  121,  121,    0,    0,  121,  121,
-  121,  121,  121,  121,  121,    0,    0,    0,  121,  121,
-  121,  121,  121,  121,  121,   68,  121,  121,  121,  121,
-  121,    0,    0,    0,   59,   59,   59,  185,  186,  187,
-   59,   59,    0,   59,   59,    0,   59,   59,   59,   59,
-   59,    0,    0,   59,    0,  313,   59,    0,   59,  184,
-   59,   59,   59,   59,   59,   59,   59,   59,   59,   59,
-   59,    0,    0,    0,   59,   59,   59,   59,   59,    0,
-   59,   59,   59,   59,    0,    0,   59,    0,   59,   59,
-   59,   59,   59,    0,  185,  186,  187,    0,   59,   59,
-   59,   59,    0,   59,   59,   59,   59,    0,    0,    0,
-    0,    0,  315,    0,    0,   59,  184,    0,   59,   59,
-    0,    0,    0,   59,   59,    0,   59,   59,   59,   59,
-    0,    0,   59,   59,   59,   59,   59,   59,    0,    0,
-    0,    0,   59,   59,   59,   59,   59,   59,   59,   67,
-   59,   59,   59,   59,   59,    0,    0,    0,   62,   62,
-   62,  185,  186,  187,   62,   62,    0,   62,   62,    0,
-   62,   62,   62,   62,   62,    0,    0,   62,    0,  316,
-   62,    0,   62,  184,   62,   62,   62,   62,   62,   62,
-   62,   62,   62,   62,   62,    0,    0,    0,   62,   62,
-   62,   62,   62,    0,   62,   62,   62,   62,    0,    0,
-   62,    0,   62,   62,   62,   62,   62,    0,  185,  186,
-  187,    0,   62,   62,   62,   62,    0,   62,   62,   62,
-   62,    0,    0,    0,    0,    0,  319,    0,    0,   62,
-  184,    0,   62,   62,    0,    0,    0,   62,   62,    0,
-   62,   62,   62,   62,    0,    0,   62,   62,   62,   62,
-   62,   62,    0,    0,    0,    0,   62,   62,   62,   62,
-   62,   62,   62,   66,   62,   62,   62,   62,   62,    0,
-    0,    0,   68,   68,   68,  185,  186,  187,   68,   68,
-    0,   68,   68,    0,   68,   68,   68,   68,   68,    0,
-    0,   68,    0,  332,   68,    0,   68,  184,   68,   68,
-   68,   68,   68,   68,   68,   68,   68,   68,   68,    0,
-    0,    0,   68,   68,   68,   68,   68,    0,   68,   68,
-   68,   68,    0,    0,   68,    0,   68,   68,   68,   68,
-   68,    0,  185,  186,  187,    0,   68,   68,   68,   68,
-    0,   68,   68,   68,   68,    0,    0,    0,    0,    0,
-  333,    0,    0,   68,  184,    0,   68,   68,    0,    0,
-    0,   68,   68,    0,   68,   68,   68,   68,    0,    0,
-   68,   68,   68,   68,   68,   68,    0,    0,    0,    0,
-   68,   68,   68,   68,   68,   68,   68,   58,   68,   68,
-   68,   68,   68,    0,    0,    0,   67,   67,   67,  185,
-  186,  187,   67,   67,    0,   67,   67,    0,   67,   67,
-   67,   67,   67,    0,    0,   67,    0,  339,   67,    0,
-   67,  184,   67,   67,   67,   67,   67,   67,   67,   67,
-   67,   67,   67,    0,    0,    0,   67,   67,   67,   67,
-   67,    0,   67,   67,   67,   67,    0,    0,   67,    0,
-   67,   67,   67,   67,   67,    0,  185,  186,  187,    0,
-   67,   67,   67,   67,    0,   67,   67,   67,   67,    0,
-    0,    0,    0,    0,  340,    0,    0,   67,  184,    0,
-   67,   67,    0,    0,    0,   67,   67,    0,   67,   67,
-   67,   67,    0,    0,   67,   67,   67,   67,   67,   67,
-    0,    0,    0,    0,   67,   67,   67,   67,   67,   67,
-   67,  100,   67,   67,   67,   67,   67,    0,    0,    0,
-   66,   66,   66,  185,  186,  187,   66,   66,    0,   66,
-   66,    0,   66,   66,   66,   66,   66,    0,    0,   66,
-    0,  347,   66,    0,   66,  184,   66,   66,   66,   66,
-   66,   66,   66,   66,   66,   66,   66,    0,    0,    0,
-   66,   66,   66,   66,   66,    0,   66,   66,   66,   66,
-    0,    0,   66,    0,   66,   66,   66,   66,   66,    0,
-  185,  186,  187,    0,   66,   66,   66,   66,    0,   66,
-   66,   66,   66,    0,    0,    0,    0,    0,  352,    0,
-    0,   66,  184,    0,   66,   66,    0,    0,    0,   66,
-   66,    0,   66,   66,   66,   66,    0,    0,   66,   66,
-   66,   66,   66,   66,    0,    0,    0,    0,   66,   66,
-   66,   66,   66,   66,   66,  104,   66,   66,   66,   66,
-   66,    0,    0,    0,   58,   58,   58,  185,  186,  187,
-   58,   58,    0,   58,   58,    0,   58,   58,   58,   58,
-   58,    0,    0,   58,    0,  356,   58,    0,   58,  184,
-   58,   58,   58,   58,   58,   58,   58,   58,   58,   58,
-   58,    0,    0,    0,   58,   58,   58,   58,   58,    0,
-   58,   58,   58,   58,    0,    0,   58,    0,   58,   58,
-   58,   58,   58,    0,  185,  186,  187,    0,   58,   58,
-   58,   58,    0,   58,   58,   58,   58,    0,    0,    0,
-    0,    0,  357,    0,    0,   58,  184,    0,   58,   58,
-    0,    0,    0,   58,   58,    0,   58,   58,   58,   58,
-    0,    0,   58,   58,   58,   58,   58,   58,    0,    0,
-    0,    0,   58,   58,   58,   58,   58,   58,   58,  102,
-   58,   58,   58,   58,   58,    0,    0,    0,  100,  100,
-  100,  185,  186,  187,  100,  100,    0,  100,  100,    0,
-  100,  100,  100,  100,  100,    0,    0,  100,    0,  358,
-  100,    0,  100,  184,  100,  100,  100,  100,  100,  100,
-  100,  100,  100,  100,  100,    0,    0,    0,  100,  100,
-  100,  100,  100,    0,  100,  100,  100,  100,    0,    0,
-  100,    0,  100,  100,  100,  100,  100,    0,  185,  186,
-  187,    0,  100,  100,  100,  100,    0,  100,  100,  100,
-  100,    0,    0,    0,    0,    0,  363,    0,    0,  100,
-  184,    0,  100,  100,    0,    0,    0,  100,  100,    0,
-  100,  100,  100,  100,    0,    0,  100,  100,  100,  100,
-  100,  100,    0,    0,    0,    0,  100,  100,  100,  100,
-  100,  100,  100,  101,  100,  100,  100,  100,  100,    0,
-    0,    0,  104,  104,  104,  185,  186,  187,  104,  104,
-    0,  104,  104,    0,  104,  104,  104,  104,  104,    0,
-    0,  104,    0,  364,  104,    0,  104,  184,  104,  104,
-  104,  104,  104,  104,  104,  104,  104,  104,  104,    0,
-    0,    0,  104,  104,  104,  104,  104,    0,  104,  104,
-  104,  104,    0,    0,  104,    0,  104,  104,  104,  104,
-  104,    0,  185,  186,  187,    0,  104,  104,  104,  104,
-    0,  104,  104,  104,  104,    0,    0,    0,    0,    0,
-  367,    0,    0,  104,  184,    0,  104,  104,    0,    0,
-    0,  104,  104,    0,  104,  104,  104,  104,    0,    0,
-  104,  104,  104,  104,  104,  104,    0,    0,    0,    0,
-  104,  104,  104,  104,  104,  104,  104,  103,  104,  104,
-  104,  104,  104,    0,    0,    0,  102,  102,  102,  185,
-  186,  187,  102,  102,    0,  102,  102,    0,  102,  102,
-  102,  102,  102,    0,    0,  102,    0,  390,  102,    0,
-  102,  184,  102,  102,  102,  102,  102,  102,  102,  102,
-  102,  102,  102,    0,    0,    0,  102,  102,  102,  102,
-  102,    0,  102,  102,  102,  102,    0,    0,  102,    0,
-  102,  102,  102,  102,  102,    0,  185,  186,  187,    0,
-  102,  102,  102,  102,    0,  102,  102,  102,  102,    0,
-    0,    0,    0,    0,  391,    0,    0,  102,  184,    0,
-  102,  102,    0,    0,    0,  102,  102,    0,  102,  102,
-  102,  102,    0,    0,  102,  102,  102,  102,  102,  102,
-    0,    0,    0,    0,  102,  102,  102,  102,  102,  102,
-  102,   56,  102,  102,  102,  102,  102,    0,    0,    0,
-  101,  101,  101,  185,  186,  187,  101,  101,    0,  101,
-  101,    0,  101,  101,  101,  101,  101,    0,    0,  101,
-    0,  392,  101,    0,  101,  184,  101,  101,  101,  101,
-  101,  101,  101,  101,  101,  101,  101,    0,    0,    0,
-  101,  101,  101,  101,  101,    0,  101,  101,  101,  101,
-    0,    0,  101,    0,  101,  101,  101,  101,  101,    0,
-  185,  186,  187,    0,  101,  101,  101,  101,    0,  101,
-  101,  101,  101,    0,    0,    0,    0,    0,  395,    0,
-    0,  101,  184,    0,  101,  101,    0,    0,    0,  101,
-  101,    0,  101,  101,  101,  101,    0,    0,  101,  101,
-  101,  101,  101,  101,    0,    0,    0,    0,  101,  101,
-  101,  101,  101,  101,  101,  107,  101,  101,  101,  101,
-  101,    0,    0,    0,  103,  103,  103,  185,  186,  187,
-  103,  103,    0,  103,  103,    0,  103,  103,  103,  103,
-  103,    0,    0,  103,    0,  400,  103,    0,  103,  184,
-  103,  103,  103,  103,  103,  103,  103,  103,  103,  103,
-  103,    0,    0,    0,  103,  103,  103,  103,  103,    0,
-  103,  103,  103,  103,    0,    0,  103,    0,  103,  103,
-  103,  103,  103,    0,  185,  186,  187,    0,  103,  103,
-  103,  103,    0,  103,  103,  103,  103,    0,    0,    0,
-    0,    0,  402,    0,    0,  103,  184,    0,  103,  103,
-    0,    0,    0,  103,  103,    0,  103,  103,  103,  103,
-    0,    0,  103,  103,  103,  103,  103,  103,    0,    0,
-    0,    0,  103,  103,  103,  103,  103,  103,  103,  113,
-  103,  103,  103,  103,  103,    0,    0,    0,   56,   56,
-   56,  185,  186,  187,   56,   56,    0,   56,   56,    0,
-   56,   56,   56,   56,   56,    0,    0,   56,    0,  403,
-   56,    0,   56,  184,   56,   56,   56,   56,   56,   56,
-   56,   56,   56,   56,   56,    0,    0,    0,   56,   56,
-   56,   56,   56,    0,   56,   56,   56,   56,    0,    0,
-   56,    0,   56,   56,   56,   56,   56,    0,  185,  186,
-  187,    0,   56,   56,   56,   56,    0,   56,   56,   56,
-   56,    0,    0,    0,    0,    0,  415,    0,    0,   56,
-  184,    0,   56,   56,    0,    0,    0,   56,   56,    0,
-   56,   56,   56,   56,    0,    0,   56,   56,   56,   56,
-   56,   56,    0,    0,    0,    0,   56,   56,   56,   56,
-   56,   56,   56,   60,   56,   56,   56,   56,   56,    0,
-    0,    0,  107,  107,  107,  185,  186,  187,  107,  107,
-    0,  107,  107,    0,  107,  107,  107,  107,  107,    0,
-    0,  107,    0,  420,  107,    0,  107,  184,  107,  107,
-  107,  107,  107,  107,  107,  107,  107,  107,  107,    0,
-    0,    0,  107,  107,  107,  107,  107,    0,  107,  107,
-  107,  107,    0,    0,  107,    0,  107,  107,  107,  107,
-  107,    0,  185,  186,  187,    0,  107,  107,  107,  107,
-    0,  107,  107,  107,  107,    0,    0,    0,    0,    0,
-  421,    0,    0,  107,  184,    0,  107,  107,    0,    0,
-    0,  107,  107,    0,  107,  107,  107,  107,    0,    0,
-  107,  107,  107,  107,  107,  107,    0,    0,    0,    0,
-  107,  107,  107,  107,  107,  107,  107,   98,  107,  107,
-  107,  107,  107,    0,    0,    0,  113,  113,  113,  185,
-  186,  187,  113,  113,    0,  113,  113,    0,  113,  113,
-  113,  113,  113,    0,    0,  113,    0,  424,  113,    0,
-  113,  184,  113,  113,  113,  113,  113,  113,  113,  113,
-  113,  113,  113,    0,    0,    0,  113,  113,  113,  113,
-  113,    0,  113,  113,  113,  113,    0,    0,  113,    0,
-  113,  113,  113,  113,  113,    0,  185,  186,  187,    0,
-  113,  113,  113,  113,    0,  113,  113,  113,  113,    0,
-    0,    0,    0,    0,  425,    0,    0,  113,  184,    0,
-  113,  113,    0,    0,    0,  113,  113,    0,  113,  113,
-  113,  113,    0,    0,  113,  113,  113,  113,  113,  113,
-    0,    0,    0,    0,  113,  113,  113,  113,  113,  113,
-  113,   61,  113,  113,  113,  113,  113,    0,    0,    0,
-   60,   60,   60,  185,  186,  187,   60,   60,    0,   60,
-   60,    0,   60,   60,   60,   60,   60,    0,    0,   60,
-    0,  426,   60,    0,   60,  184,   60,   60,   60,   60,
-   60,   60,   60,   60,   60,   60,   60,    0,    0,    0,
-   60,   60,   60,   60,   60,    0,   60,   60,   60,   60,
-    0,    0,   60,    0,   60,   60,   60,   60,   60,    0,
-  185,  186,  187,    0,   60,   60,   60,   60,    0,   60,
-   60,   60,   60,    0,    0,    0,    0,    0,  429,    0,
-    0,   60,  184,    0,   60,   60,    0,    0,    0,   60,
-   60,    0,   60,   60,   60,   60,    0,    0,   60,   60,
-   60,   60,   60,   60,    0,    0,    0,    0,   60,   60,
-   60,   60,   60,   60,   60,   65,   60,   60,   60,   60,
-   60,    0,    0,    0,   98,   98,   98,  185,  186,  187,
-   98,   98,    0,   98,   98,    0,   98,   98,   98,   98,
-   98,    0,    0,   98,    0,  439,   98,    0,   98,  184,
-   98,   98,   98,   98,   98,   98,   98,   98,   98,   98,
-   98,    0,    0,    0,   98,   98,   98,   98,   98,    0,
-   98,   98,   98,   98,    0,    0,   98,    0,   98,   98,
-   98,   98,   98,    0,  185,  186,  187,    0,   98,   98,
-   98,   98,    0,   98,   98,   98,   98,    0,    0,    0,
-    0,    0,  440,    0,    0,   98,  184,    0,   98,   98,
-    0,    0,    0,   98,   98,    0,   98,   98,   98,   98,
-    0,    0,   98,   98,   98,   98,   98,   98,    0,    0,
-    0,    0,   98,   98,   98,   98,   98,   98,   98,  112,
-   98,   98,   98,   98,   98,    0,    0,    0,   61,   61,
-   61,  185,  186,  187,   61,   61,    0,   61,   61,    0,
-   61,   61,   61,   61,   61,    0,    0,   61,    0,  447,
-   61,    0,   61,  184,   61,   61,   61,   61,   61,   61,
-   61,   61,   61,   61,   61,    0,    0,    0,   61,   61,
-   61,   61,   61,    0,   61,   61,   61,   61,    0,    0,
-   61,    0,   61,   61,   61,   61,   61,    0,  185,  186,
-  187,    0,   61,   61,   61,   61,    0,   61,   61,   61,
-   61,    0,    0,    0,    0,    0,  448,    0,    0,   61,
-  184,    0,   61,   61,    0,    0,    0,   61,   61,    0,
-   61,   61,   61,   61,    0,    0,   61,   61,   61,   61,
-   61,   61,    0,    0,    0,    0,   61,   61,   61,   61,
-   61,   61,   61,   77,   61,   61,   61,   61,   61,    0,
-    0,    0,   65,   65,   65,  185,  186,  187,   65,   65,
-    0,   65,   65,    0,   65,   65,   65,   65,   65,    0,
-    0,   65,    0,  456,   65,    0,   65,  184,   65,   65,
-   65,   65,   65,   65,   65,   65,   65,   65,   65,    0,
-    0,    0,   65,   65,   65,   65,   65,    0,   65,   65,
-   65,   65,    0,    0,   65,    0,   65,   65,   65,   65,
-   65,    0,  185,  186,  187,    0,   65,   65,   65,   65,
-    0,   65,   65,   65,   65,    0,    0,    0,    0,    0,
-  457,    0,    0,   65,  184,    0,   65,   65,    0,    0,
-    0,   65,   65,    0,   65,   65,   65,   65,    0,    0,
-   65,   65,   65,   65,   65,   65,    0,    0,    0,    0,
-   65,   65,   65,   65,   65,   65,   65,   57,   65,   65,
-   65,   65,   65,    0,    0,    0,  112,  112,  112,  185,
-  186,  187,  112,  112,    0,  112,  112,    0,  112,  112,
-  112,  112,  112,    0,    0,  112,    0,  473,  112,    0,
-  112,  184,  112,  112,  112,  112,  112,  112,  112,  112,
-  112,  112,  112,    0,    0,    0,  112,  112,  112,  112,
-  112,    0,  112,  112,  112,  112,    0,    0,  112,    0,
-  112,  112,  112,  112,  112,    0,  185,  186,  187,    0,
-  112,  112,  112,  112,    0,  112,  112,  112,  112,    0,
-    0,    0,    0,    0,  477,    0,    0,  112,  184,    0,
-  112,  112,    0,    0,    0,  112,  112,    0,  112,  112,
-  112,  112,    0,    0,  112,  112,  112,  112,  112,  112,
-    0,    0,    0,    0,  112,  112,  112,  112,  112,  112,
-  112,    7,  112,  112,  112,  112,  112,    0,    0,    0,
-   77,   77,   77,  185,  186,  187,   77,   77,    0,   77,
-   77,    0,   77,   77,   77,   77,   77,    0,    0,   77,
-    0,  483,   77,    0,   77,  184,   77,   77,   77,   77,
-   77,   77,   77,   77,   77,   77,   77,    0,    0,    0,
-   77,   77,   77,   77,   77,    0,   77,   77,   77,   77,
-    0,    0,   77,    0,   77,   77,   77,   77,   77,    0,
-  185,  186,  187,    0,   77,   77,   77,   77,    0,   77,
-   77,   77,   77,    0,    0,    0,    0,    0,  486,    0,
-    0,   77,  184,    0,   77,   77,    0,    0,    0,   77,
-   77,    0,   77,   77,   77,   77,    0,    0,   77,   77,
-   77,   77,   77,   77,    0,    0,    0,    0,   77,   77,
-   77,   77,   77,   77,   77,   10,   77,   77,   77,   77,
-   77,    0,    0,    0,   57,   57,   57,  185,  186,  187,
-   57,   57,    0,   57,   57,    0,   57,   57,   57,   57,
-   57,    0,    0,   57,    0,  489,   57,    0,   57,  184,
-   57,   57,   57,   57,   57,   57,   57,   57,   57,   57,
-   57,    0,    0,    0,   57,   57,   57,   57,   57,    0,
-   57,   57,   57,   57,    0,    0,   57,    0,   57,   57,
-   57,   57,   57,    0,  185,  186,  187,    0,   57,   57,
-   57,   57,    0,   57,   57,   57,   57,    0,    0,    0,
-    0,    0,  496,    0,    0,   57,  184,    0,   57,   57,
-    0,    0,    0,   57,   57,    0,   57,   57,   57,   57,
-    0,    0,   57,   57,   57,   57,   57,   57,    0,    0,
-    0,    0,   57,   57,   57,   57,   57,   57,   57,   24,
-   57,   57,   57,   57,   57,    0,    0,    0,    7,    7,
-    7,  185,  186,  187,    7,    7,    0,    7,    0,    0,
-    7,    7,    7,    7,    7,    0,    0,    7,    0,  498,
-    7,    0,    7,  184,    7,    7,    7,    7,    7,    7,
-    7,    7,    7,    7,    7,    0,    0,    0,    7,    7,
-    7,    7,    7,    0,    7,    7,    7,    7,    0,    0,
-    7,    0,    7,    7,    7,    7,    7,    0,  185,  186,
-  187,    0,    7,    7,    7,    7,    0,    7,    7,    7,
-    7,    0,    0,    0,    0,    0,  501,    0,    0,    7,
-  184,    0,    7,    7,    0,    0,    0,    7,    7,    0,
-    7,    7,    7,    7,    0,    0,    7,    7,    7,    7,
-    7,    7,    0,    0,    0,    0,    7,    7,    7,    7,
-    7,    7,    7,   12,    7,    7,    7,    7,    7,    0,
-    0,    0,   10,   10,   10,  185,  186,  187,   10,   10,
-    0,   10,    0,    0,   10,   10,   10,   10,   10,    0,
-    0,   10,    0,  503,   10,    0,   10,  184,   10,   10,
-   10,   10,   10,   10,   10,   10,   10,   10,   10,    0,
-    0,    0,   10,   10,   10,   10,   10,    0,   10,   10,
-   10,   10,    0,    0,   10,    0,   10,   10,   10,   10,
-   10,    0,  185,  186,  187,    0,   10,   10,   10,   10,
-    0,   10,   10,   10,   10,    0,    0,    0,    0,    0,
-  505,    0,    0,   10,  184,    0,   10,   10,    0,    0,
-    0,   10,   10,    0,   10,   10,   10,   10,    0,    0,
-   10,   10,   10,   10,   10,   10,    0,    0,    0,    0,
-   10,   10,   10,   10,   10,   10,   10,   13,   10,   10,
-   10,   10,   10,    0,    0,    0,   24,   24,   24,  185,
-  186,  187,   24,   24,    0,   24,    0,    0,   24,   24,
-   24,   24,   24,    0,    0,   24,    0,  508,   24,    0,
-   24,  184,   24,   24,   24,   24,   24,   24,   24,   24,
-   24,   24,   24,    0,    0,    0,   24,   24,   24,   24,
-   24,    0,   24,   24,   24,   24,    0,    0,   24,    0,
-   24,   24,   24,   24,   24,    0,  185,  186,  187,    0,
-   24,   24,   24,   24,    0,   24,   24,   24,   24,    0,
-    0,    0,    0,    0,  510,    0,    0,   24,  184,    0,
-   24,   24,    0,    0,    0,   24,   24,    0,   24,   24,
-   24,   24,    0,    0,   24,   24,   24,   24,   24,   24,
-    0,    0,    0,    0,   24,   24,   24,   24,   24,   24,
-   24,   26,   24,   24,   24,   24,   24,    0,    0,    0,
-   12,   12,   12,  185,  186,  187,   12,   12,    0,   12,
-    0,    0,   12,   12,   12,   12,   12,    0,    0,   12,
-    0,  512,   12,    0,   12,  184,   12,   12,   12,   12,
-   12,   12,   12,   12,   12,   12,   12,    0,    0,    0,
-   12,   12,   12,   12,   12,    0,   12,   12,   12,   12,
-    0,    0,   12,    0,   12,   12,   12,   12,   12,    0,
-  185,  186,  187,    0,   12,   12,   12,   12,    0,   12,
-   12,   12,   12,    0,    0,    0,    0,    0,  517,    0,
-    0,   12,  184,    0,   12,   12,    0,    0,    0,   12,
-   12,    0,   12,   12,   12,   12,    0,    0,   12,   12,
-   12,   12,   12,   12,    0,    0,    0,    0,   12,   12,
-   12,   12,   12,   12,   12,   14,   12,   12,   12,   12,
-   12,    0,    0,    0,   13,   13,   13,  185,  186,  187,
-   13,   13,    0,   13,    0,    0,   13,   13,   13,   13,
-   13,    0,    0,   13,    0,  518,   13,    0,   13,  184,
-   13,   13,   13,   13,   13,   13,   13,   13,   13,   13,
-   13,    0,    0,    0,   13,   13,   13,   13,   13,    0,
-   13,   13,   13,   13,    0,    0,   13,    0,   13,   13,
-   13,   13,   13,    0,  185,  186,  187,    0,   13,   13,
-   13,   13,    0,   13,   13,   13,   13,    0,    0,    0,
-    0,    0,  519,    0,    0,   13,  184,    0,   13,   13,
-    0,    0,    0,   13,   13,    0,   13,   13,   13,   13,
-    0,    0,   13,   13,   13,   13,   13,   13,    0,    0,
-    0,    0,   13,   13,   13,   13,   13,   13,   13,    9,
-   13,   13,   13,   13,   13,    0,    0,    0,   26,   26,
-   26,  185,  186,  187,   26,   26,    0,   26,    0,    0,
-   26,   26,   26,   26,   26,    0,    0,   26,    0,  524,
-   26,    0,   26,  184,   26,   26,   26,   26,   26,   26,
-   26,   26,   26,   26,   26,    0,    0,    0,   26,   26,
-   26,   26,   26,    0,   26,   26,   26,   26,    0,    0,
-   26,    0,   26,   26,   26,   26,   26,    0,  185,  186,
-  187,    0,   26,   26,   26,   26,    0,   26,   26,   26,
-   26,    0,    0,    0,    0,    0,  525,    0,    0,   26,
-  184,    0,   26,   26,    0,    0,    0,   26,   26,    0,
-   26,   26,   26,   26,    0,    0,   26,   26,   26,   26,
-   26,   26,    0,    0,    0,    0,   26,   26,   26,   26,
-   26,   26,   26,   38,   26,   26,   26,   26,   26,    0,
-    0,    0,   14,   14,   14,  185,  186,  187,   14,   14,
-    0,   14,    0,    0,   14,   14,   14,   14,   14,    0,
-    0,   14,    0,  528,   14,    0,   14,  184,   14,   14,
-   14,   14,   14,   14,   14,   14,   14,   14,   14,    0,
-    0,    0,   14,   14,   14,   14,   14,    0,   14,   14,
-   14,   14,    0,    0,   14,    0,   14,   14,   14,   14,
-   14,    0,  185,  186,  187,    0,   14,   14,   14,   14,
-    0,   14,   14,   14,   14,    0,    0,    0,    0,    0,
-  529,    0,    0,   14,  184,    0,   14,   14,    0,    0,
-    0,   14,   14,    0,   14,   14,   14,   14,    0,    0,
-   14,   14,   14,   14,   14,   14,    0,    0,    0,    0,
-   14,   14,   14,   14,   14,   14,   14,   19,   14,   14,
-   14,   14,   14,    0,    0,    0,    9,    9,    9,  185,
-  186,  187,    9,    9,    0,    9,    0,    0,    9,    9,
-    9,    9,    9,    0,    0,    9,    0,  532,    9,    0,
-    9,  184,    9,    9,    9,    9,    9,    9,    9,    9,
-    9,    9,    9,    0,    0,    0,    9,    9,    9,    9,
-    9,    0,    9,    9,    9,    9,    0,    0,    9,    0,
-    9,    9,    9,    9,    9,    0,  185,  186,  187,    0,
-    9,    9,    9,    9,    0,    9,    9,    9,    9,    0,
-    0,    0,    0,    0,  533,    0,    0,    9,  184,    0,
-    9,    9,    0,    0,    0,    9,    9,    0,    9,    9,
-    9,    9,    0,    0,    9,    9,    9,    9,    9,    9,
-    0,    0,    0,    0,    9,    9,    9,    9,    9,    9,
-    9,    8,    9,    9,    9,    9,    9,    0,    0,    0,
-   38,   38,   38,  185,  186,  187,   38,   38,    0,   38,
-    0,    0,   38,   38,   38,   38,   38,    0,    0,   38,
-    0,  536,   38,    0,   38,  184,   38,   38,   38,   38,
-   38,   38,   38,   38,   38,   38,   38,    0,    0,    0,
-   38,   38,   38,   38,   38,    0,   38,   38,   38,   38,
-    0,    0,   38,    0,   38,   38,   38,   38,   38,    0,
-  185,  186,  187,    0,   38,   38,   38,   38,    0,   38,
-   38,   38,   38,    0,    0,    0,    0,    0,  537,    0,
-    0,   38,  184,    0,   38,   38,    0,    0,    0,   38,
-   38,    0,   38,   38,   38,   38,    0,    0,   38,   38,
-   38,   38,   38,   38,    0,    0,    0,    0,   38,   38,
-   38,   38,   38,   38,   38,   23,   38,   38,   38,   38,
-   38,    0,    0,    0,   19,   19,   19,  185,  186,  187,
-   19,   19,    0,   19,    0,    0,   19,   19,   19,   19,
-   19,    0,    0,   19,    0,  540,   19,    0,   19,  184,
-   19,   19,   19,   19,   19,   19,   19,   19,   19,   19,
-   19,    0,    0,    0,   19,   19,   19,   19,   19,    0,
-   19,   19,   19,   19,    0,    0,   19,    0,   19,   19,
-   19,   19,   19,    0,  185,  186,  187,    0,   19,   19,
-   19,   19,    0,   19,   19,   19,   19,    0,    0,    0,
-    0,    0,  541,    0,    0,   19,  184,    0,   19,   19,
-    0,    0,    0,   19,   19,    0,   19,   19,   19,   19,
-    0,    0,   19,   19,   19,   19,   19,   19,    0,    0,
-    0,    0,   19,   19,   19,   19,   19,   19,   19,   11,
-   19,   19,   19,   19,   19,    0,    0,    0,    8,    8,
-    8,  185,  186,  187,    8,    8,    0,    8,    0,    0,
-    8,    8,    8,    8,    8,    0,    0,    8,    0,  545,
-    8,    0,    8,  184,    8,    8,    8,    8,    8,    8,
-    8,    8,    8,    8,    8,    0,    0,    0,    8,    8,
-    8,    8,    8,    0,    8,    8,    8,    8,    0,    0,
-    8,    0,    8,    8,    8,    8,    8,    0,  185,  186,
-  187,    0,    8,    8,    8,    8,    0,    8,    8,    8,
-    8,    0,    0,    0,    0,    0,  547,    0,    0,    8,
-  184,    0,    8,    8,    0,    0,    0,    8,    8,    0,
-    8,    8,    8,    8,    0,    0,    8,    8,    8,    8,
-    8,    8,    0,    0,    0,    0,    8,    8,    8,    8,
-    8,    8,    8,   30,    8,    8,    8,    8,    8,    0,
-    0,    0,   23,   23,   23,  185,  186,  187,   23,   23,
-    0,   23,    0,    0,   23,   23,   23,   23,   23,    0,
-    0,   23,    0,  549,   23,    0,   23,  184,   23,   23,
-   23,   23,   23,   23,   23,   23,   23,   23,   23,    0,
-    0,    0,   23,   23,   23,   23,   23,    0,   23,   23,
-   23,   23,    0,    0,   23,    0,   23,   23,   23,   23,
-   23,    0,  185,  186,  187,    0,   23,   23,   23,   23,
-    0,   23,   23,   23,   23,    0,    0,    0,    0,    0,
-  551,    0,    0,   23,  184,    0,   23,   23,    0,    0,
-    0,   23,   23,    0,   23,   23,   23,   23,    0,    0,
-   23,   23,   23,   23,   23,   23,    0,    0,    0,    0,
-   23,   23,   23,   23,   23,   23,   23,    0,   23,   23,
-   23,   23,   23,    0,    0,    0,   11,   11,   11,  185,
-  186,  187,   11,   11,    0,   11,    0,  408,   11,   11,
-   11,   11,   11,  409,    0,   11,    0,    0,   11,    0,
-   11,    0,   11,   11,   11,   11,   11,   11,   11,   11,
-   11,   11,   11,    0,    0,    0,   11,   11,   11,   11,
-   11,    0,   11,   11,   11,   11,    0,    0,   11,    0,
-   11,   11,   11,   11,   11,    0,  185,  186,  187,    0,
-   11,   11,   11,   11,    0,   11,   11,   11,   11,    0,
-    0,    0,    0,  410,  411,  412,    0,   11,  413,    0,
-   11,   11,    0,    0,    0,   11,   11,    0,   11,   11,
-   11,   11,    0,    0,   11,   11,   11,   11,   11,   11,
-    0,    0,    0,    0,   11,   11,   11,   11,   11,   11,
-   11,    0,   11,   11,   11,   11,   11,    0,    0,    0,
-   30,   30,   30,    0,    0,    0,   30,    0,    0,   30,
-    0,    0,   30,   30,   30,   30,   30,    0,    0,   30,
-    0,    0,   30,    0,   30,    0,   30,   30,   30,   30,
-   30,   30,   30,   30,   30,   30,   30,    0,    0,    0,
-   30,   30,   30,   30,   30,    0,   30,   30,   30,   30,
-    0,    0,   30,    0,   30,   30,   30,   30,   30,    0,
-    0,    0,    0,    0,   30,   30,   30,   30,    0,   30,
-   30,   30,   30,   93,   94,    0,    0,   95,    0,  311,
-  103,   30,    0,    0,   30,   30,    0,    0,    0,   30,
-   30,   96,   30,   30,   30,   30,    0,    0,   30,   30,
-   30,   30,   30,   30,    0,    0,    0,    0,   30,   30,
-   30,   30,   30,   30,   30,    0,   30,   30,   30,   30,
-   30,    2,    3,    4,    0,    0,    0,    5,    6,    0,
-  427,    0,    0,    7,    8,    9,   10,   11,   97,    0,
-   12,    0,    0,   13,    0,   14,    0,   15,   16,   17,
-   18,   19,   20,   21,   22,   23,   24,   25,    0,    0,
-    0,   26,   27,   28,   29,   30,    0,   31,   32,   33,
-   34,    0,    0,   35,   98,   36,   37,   38,   39,   40,
-    0,    0,    0,    0,    0,   41,   42,   43,   44,    0,
-   45,   46,   47,   48,  116,  116,    0,    0,  116,    0,
-  116,  116,   49,    0,    0,   50,   51,    0,    0,    0,
-   52,   53,  116,   54,   55,   56,   57,    0,    0,   58,
-   59,   60,   61,   62,   63,    0,    0,    0,    0,   64,
-   65,   66,   67,   68,   69,   70,    0,   71,   72,   73,
-   74,   75,    2,    3,    4,    0,    0,    0,    5,    6,
-    0,  428,    0,    0,    7,    8,    9,   10,   11,  116,
-    0,   12,    0,    0,   13,    0,   14,    0,   15,   16,
-   17,   18,   19,   20,   21,   22,   23,   24,   25,    0,
-    0,    0,   26,   27,   28,   29,   30,    0,   31,   32,
-   33,   34,    0,    0,   35,  116,   36,   37,   38,   39,
-   40,    0,    0,    0,    0,    0,   41,   42,   43,   44,
-    0,   45,   46,   47,   48,  117,  117,    0,    0,  117,
-    0,  117,  117,   49,    0,    0,   50,   51,    0,    0,
-    0,   52,   53,  117,   54,   55,   56,   57,    0,    0,
-   58,   59,   60,   61,   62,   63,    0,    0,    0,    0,
-   64,   65,   66,   67,   68,   69,   70,    0,   71,   72,
-   73,   74,   75,    2,    3,    4,    0,    0,    0,    5,
-    6,    0,  506,    0,    0,    7,    8,    9,   10,   11,
-  117,    0,   12,    0,    0,   13,    0,   14,    0,   15,
-   16,   17,   18,   19,   20,   21,   22,   23,   24,   25,
-    0,    0,    0,   26,   27,   28,   29,   30,    0,   31,
-   32,   33,   34,    0,    0,   35,  117,   36,   37,   38,
-   39,   40,    0,    0,    0,    0,    0,   41,   42,   43,
-   44,    0,   45,   46,   47,   48,   93,   94,    0,    0,
-   95,    0,    0,  103,   49,    0,    0,   50,   51,    0,
-    0,    0,   52,   53,   96,   54,   55,   56,   57,    0,
-    0,   58,   59,   60,   61,   62,   63,    0,    0,    0,
-    0,   64,   65,   66,   67,   68,   69,   70,    0,   71,
-   72,   73,   74,   75,    2,    3,    4,    0,    0,    0,
-    5,    6,    0,    0,    0,    0,    7,    8,    9,   10,
-   11,   97,    0,   12,    0,    0,   13,    0,   14,    0,
-   15,   16,   17,   18,   19,   20,   21,   22,   23,   24,
-   25,    0,    0,    0,   26,   27,   28,   29,   30,    0,
-   31,   32,   33,   34,    0,    0,   35,   98,   36,   37,
-   38,   39,   40,    0,    0,    0,    0,    0,   41,   42,
-   43,   44,    0,   45,   46,   47,   48,   93,   94,    0,
-    0,   95,    0,    0,    0,   49,    0,    0,   50,   51,
-    0,    0,    0,   52,   53,   96,   54,   55,   56,   57,
-    0,    0,   58,   59,   60,   61,   62,   63,    0,    0,
-    0,    0,   64,   65,   66,   67,   68,   69,   70,    0,
-   71,   72,   73,   74,   75,  251,  252,  253,  189,    0,
-    0,    5,  254,    0,  255,    0,    0,    7,    8,    9,
-   10,   11,   97,    0,   12,    0,    0,   13,  197,   14,
-    0,   15,   16,   17,   18,   19,   20,   21,   22,   23,
-  209,   25,    0,  211,    0,    0,    0,   28,    0,  213,
-    0,    0,    0,   33,   34,    0,    0,   35,   98,   36,
-   37,   38,  368,    0,    0,    0,    0,    0,    0,  369,
-  236,    0,    0,    0,    0,   46,   47,   48,    0,    0,
-    0,    0,    0,  241,    0,    0,    0,    0,    0,    0,
-    0,    0,   21,   22,   23,   53,    0,   54,   55,   56,
-    0,    0,    0,   58,   59,   60,   61,   62,   63,    0,
-    0,    0,    0,   64,   65,   66,   67,   68,    0,    0,
-    0,   71,   72,   73,   74,  321,  322,  323,    0,  370,
-    0,    5,  324,    0,    0,  325,  152,    7,    8,    9,
-   10,   11,  152,    0,   12,    0,    0,   13,    0,   14,
-    0,   15,   16,   17,   18,   19,   20,   21,   22,   23,
-   60,   25,    0,    0,    0,    0,    0,   28,    0,    0,
-    0,    0,    0,   33,   34,    0,    0,   35,    0,   36,
-   37,   38,  368,    0,    0,    0,    0,    0,    0,  491,
-    0,    0,    0,    0,    0,   46,   47,   48,    0,    0,
-    0,    0,  152,  152,  152,    0,    0,  152,    0,    0,
-    0,    0,   21,   22,   23,   53,    0,   54,   55,   56,
-    0,    0,    0,   58,   59,   60,   61,   62,   63,    0,
-    0,    0,    0,   64,   65,   66,   67,   68,    0,    0,
-    0,   71,   72,   73,   74,  251,  252,  253,    0,  370,
-    0,    5,  254,    0,  330,    0,  151,    7,    8,    9,
-   10,   11,  151,    0,   12,    0,    0,   13,    0,   14,
-    0,   15,   16,   17,   18,   19,   20,   21,   22,   23,
-   60,   25,    0,    0,    0,    0,    0,   28,    0,    0,
-    0,    0,    0,   33,   34,    0,    0,   35,    0,   36,
-   37,   38,  153,    0,    0,    0,    0,    0,  153,    0,
-    0,    0,    0,    0,    0,   46,   47,   48,    0,    0,
-    0,    0,  151,  151,  151,    0,    0,  151,    0,    0,
-    0,    0,    0,    0,    0,   53,    0,   54,   55,   56,
-    0,    0,    0,   58,   59,   60,   61,   62,   63,    0,
-    0,    0,    0,   64,   65,   66,   67,   68,    0,    0,
-    0,   71,   72,   73,   74,   30,   30,   30,  153,  153,
-  153,   30,   30,  153,   30,    0,  154,   30,   30,   30,
-   30,   30,  154,    0,   30,    0,    0,   30,    0,   30,
-    0,   30,   30,   30,   30,   30,   30,   30,   30,   30,
-    0,   30,    0,    0,    0,    0,    0,   30,    0,    0,
-    0,    0,    0,   30,   30,    0,    0,   30,    0,   30,
-   30,   30,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,   30,   30,   30,    0,    0,
-    0,    0,  154,  154,  154,    0,    0,  154,    0,    0,
-    0,    0,    0,    0,    0,   30,    0,   30,   30,   30,
-    0,    0,    0,   30,   30,   30,   30,   30,   30,    0,
-    0,    0,    0,   30,   30,   30,   30,   30,    0,    0,
-    0,   30,   30,   30,   30,    5,  254,    0,  260,    0,
-    0,    7,    8,    9,   10,   11,    0,    0,   12,    0,
-    0,   13,    0,   14,    0,   15,   16,   17,   18,   19,
-   20,   21,   22,   23,    0,   25,    0,    0,    0,    0,
-    0,   28,    0,    0,    0,    0,    0,   33,   34,    0,
-    0,   35,    0,   36,   37,   38,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,   46,
-   47,   48,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,   53,
-    0,   54,   55,   56,    0,    0,    0,   58,   59,   60,
-   61,   62,   63,    0,    0,    0,    0,   64,   65,   66,
-   67,   68,    0,    0,    0,   71,   72,   73,   74,    5,
-  254,    0,  331,    0,    0,    7,    8,    9,   10,   11,
-    0,    0,   12,    0,    0,   13,    0,   14,    0,   15,
-   16,   17,   18,   19,   20,   21,   22,   23,    0,   25,
-    0,    0,    0,    0,    0,   28,    0,    0,    0,    0,
-    0,   33,   34,    0,    0,   35,    0,   36,   37,   38,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,   46,   47,   48,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,   53,    0,   54,   55,   56,    0,    0,
-    0,   58,   59,   60,   61,   62,   63,    0,    0,    0,
-    0,   64,   65,   66,   67,   68,    0,    0,    0,   71,
-   72,   73,   74,    5,  254,    0,  373,    0,    0,    7,
-    8,    9,   10,   11,    0,    0,   12,    0,    0,   13,
-    0,   14,    0,   15,   16,   17,   18,   19,   20,   21,
-   22,   23,    0,   25,    0,    0,    0,    0,    0,   28,
-    0,    0,    0,    0,    0,   33,   34,    0,    0,   35,
-    0,   36,   37,   38,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,  214,   46,   47,   48,
-    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,   53,  334,   54,
-   55,   56,    0,    0,    0,   58,   59,   60,   61,   62,
-   63,    0,    0,  215,    0,   64,   65,   66,   67,   68,
-    0,    0,    0,   71,   72,   73,   74,  216,  217,  218,
-  219,  220,    0,    0,  353,  215,    0,    0,    0,    0,
-    0,  221,  222,    0,    0,    0,  223,  224,    0,  216,
-  217,  218,  219,  220,  225,  226,    0,   21,   22,   23,
-    0,    0,    0,  221,  222,    0,    0,    0,  223,  224,
-  215,    0,    0,  227,  228,  229,  225,  226,    0,    0,
-    0,    0,    0,  435,  216,  217,  218,  219,  220,    0,
-    0,    0,    0,    0,    0,  227,  228,  229,  221,  222,
-    0,    0,    0,  223,  224,    0,   21,   22,   23,    0,
-    0,  225,  226,    0,    0,    0,    0,    0,    0,  215,
-    0,    0,    0,    0,    0,   60,    0,    0,    0,    0,
-  227,  228,  229,  216,  217,  218,  219,  220,    0,    0,
-    0,    0,    0,    0,    0,    0,    0,  221,  222,    0,
-    0,    0,  223,  224,    0,    0,    0,    0,    0,    0,
-  225,  226,    0,    0,    0,    0,    0,    0,    0,    0,
-    0,    0,    0,    0,   60,    0,    0,    0,    0,  227,
-  228,  229,
-};
-short yycheck[] = {                                       7,
-    8,  131,  264,   11,   12,  317,  318,  268,  177,   17,
-   18,   19,   20,  110,  177,  267,  179,  278,  177,   27,
-  179,   29,   30,   31,  259,   33,  265,   35,  249,  264,
-   38,  267,  267,   41,   42,   43,   44,   45,  266,  278,
-  178,   49,   50,   51,  264,  265,  274,   55,   56,  156,
-  260,  261,  265,   61,  264,  264,  265,  267,  268,  266,
-  264,  265,  264,   71,  282,  278,   74,  274,  278,  295,
-  296,  260,  261,  268,  267,  264,  295,  296,  267,  268,
-  267,  250,  268,  278,   92,  267,  249,  250,   96,  278,
-  249,  250,  278,  268,  102,  103,  259,  268,  264,  320,
-  259,  109,  240,  278,  266,  202,  268,  278,  116,  117,
-  118,  260,  261,  121,  267,  264,  278,  262,  267,  380,
-  381,  382,  264,  385,  132,  266,  134,  290,  267,  278,
-  237,  260,  261,  266,  295,  264,  267,  278,  267,  268,
-  270,  380,  381,  382,  266,  278,  309,  266,  156,  278,
-  158,  314,  266,  278,  264,  314,  278,  320,  166,  278,
-  168,  320,  264,  171,  278,  173,  264,  380,  381,  382,
-  380,  265,  180,  353,  354,  385,  184,  185,  186,  187,
-  188,  266,  494,  280,  281,  380,  194,  195,  196,  266,
-  385,  380,  264,  278,  380,  265,  385,  205,  278,  385,
-  266,  278,  282,  259,  212,  380,  381,  215,  216,  380,
-  218,  219,  278,  221,  385,  223,  224,  225,  380,  227,
-  228,  229,  264,  268,  267,  233,  389,  235,  268,  237,
-  373,  380,  266,  278,  268,  264,  385,  264,  278,  380,
-  381,  382,  295,  296,  278,  371,  372,  380,  381,  382,
-  265,  380,  265,  381,  382,  380,  381,  382,  380,  381,
-  382,  380,  381,  271,  272,  273,  380,  381,  382,  277,
-  265,  274,  378,  379,  282,  278,  268,  285,  286,  287,
-  288,  260,  261,  265,  302,  264,  278,    0,  267,  264,
-  274,  265,  325,  274,  302,  380,  381,  278,  306,  307,
-  380,  381,  382,  380,  381,  313,  265,  315,  316,  383,
-  268,  319,  265,  268,  380,  381,  268,  264,  264,  482,
-  278,  264,  264,  278,  332,  333,  278,  265,  265,  265,
-  264,  339,  340,  268,  342,  380,  381,  382,  265,  347,
-  380,  381,  382,  278,  352,  265,  380,  268,  356,  357,
-  358,  383,  265,  264,  268,  363,  364,  278,  268,  367,
-  264,  267,  370,  265,  278,  381,  274,  248,  278,  265,
-  265,  265,  195,  334,  460,  176,  274,  380,  381,  382,
-  278,  417,  390,  391,  392,   -1,   -1,  395,  380,  381,
-  382,  320,  400,   -1,  402,  403,  325,   -1,   -1,  380,
-  381,  382,  410,  411,  412,  413,  274,  415,   -1,  417,
-  278,    0,  420,  421,   -1,   -1,  424,  425,  426,   -1,
-   -1,  429,  380,  381,  382,  380,  381,  382,  380,  381,
-  382,  439,  440,  260,  261,  443,   -1,  264,   -1,  447,
-  448,  449,   -1,   -1,   -1,  380,  381,  382,  456,  457,
-   -1,  278,   -1,   -1,   -1,  384,  385,  386,   -1,  380,
-  381,  382,   -1,   -1,   -1,  473,  380,  381,  382,  477,
-  380,  381,  382,   -1,   -1,  483,   -1,   -1,  486,   -1,
-   -1,  489,  380,  381,  382,  493,   -1,   -1,  496,   -1,
-  498,   -1,   -1,  501,   -1,  503,   -1,  505,  325,   -1,
-  508,   -1,  510,   -1,  512,   -1,   -1,   -1,   -1,  517,
-  518,  519,  380,  381,  382,   -1,  524,  525,   -1,   -1,
-  528,  529,   -1,   -1,  532,  533,   -1,   -1,  536,  537,
-   -1,   -1,  540,  541,  361,    0,   -1,  545,   -1,  547,
-   -1,  549,   -1,  551,  257,  258,  259,  260,  261,   -1,
-  263,  264,  265,  266,  267,  268,  269,  270,  271,  272,
-  273,  274,   -1,  276,   -1,  278,  279,   -1,  281,  282,
-  283,  284,  285,  286,  287,  288,  289,  290,  291,  292,
-  293,   -1,   -1,   -1,  297,  298,  299,  300,  301,  302,
-  303,  304,  305,  306,   -1,   -1,  309,   -1,  311,  312,
-  313,  314,  315,  316,  317,  318,  319,  320,  321,  322,
-  323,  324,  325,  326,  327,  328,  329,  330,  331,  332,
-  333,  334,  335,  336,  337,  338,   -1,   -1,  341,  342,
-  343,  344,   -1,  346,  347,   -1,  349,  350,  351,  352,
-   -1,   -1,  355,  356,  357,  358,  359,  360,  361,  362,
-  363,  364,  365,  366,  367,  368,  369,  370,  371,    0,
-  373,  374,  375,  376,  377,   -1,   -1,  380,  257,  258,
-  259,  260,  261,   -1,  263,  264,  265,  266,  267,  268,
-  269,  270,  271,  272,  273,  274,   -1,  276,   -1,  278,
-  279,   -1,  281,  282,  283,  284,  285,  286,  287,  288,
-  289,  290,  291,  292,  293,   -1,   -1,   -1,  297,  298,
-  299,  300,  301,  302,  303,  304,  305,  306,   -1,   -1,
-  309,   -1,  311,  312,  313,  314,  315,  316,  317,  318,
-  319,  320,  321,  322,  323,  324,  325,  326,  327,  328,
-  329,  330,  331,  332,  333,  334,  335,  336,  337,  338,
-   -1,   -1,  341,  342,  343,  344,   -1,  346,  347,   -1,
-  349,  350,  351,  352,   -1,   -1,  355,  356,  357,  358,
-  359,  360,  361,  362,  363,  364,  365,  366,  367,  368,
-  369,  370,  371,    0,  373,  374,  375,  376,  377,   -1,
-   -1,  380,  257,  258,  259,   -1,   -1,   -1,  263,  264,
-   -1,  266,  267,   -1,  269,  270,  271,  272,  273,   -1,
-   -1,  276,   -1,  274,  279,   -1,  281,  278,  283,  284,
-  285,  286,  287,  288,  289,  290,  291,  292,  293,   -1,
-   -1,   -1,  297,  298,  299,  300,  301,  302,  303,  304,
-  305,  306,   -1,   -1,  309,   -1,  311,  312,  313,  314,
-  315,  316,  317,  318,  319,  320,  321,  322,  323,  324,
-   -1,  326,  327,  328,  329,  330,  331,   -1,   -1,   -1,
-  335,  336,   -1,  338,   -1,   -1,  341,  342,  343,  344,
-   -1,  346,  347,   -1,  349,  350,  351,  352,   -1,   -1,
-  355,  356,  357,  358,  359,  360,   -1,  362,  363,  364,
-  365,  366,  367,  368,  369,  370,  371,    0,  373,  374,
-  375,  376,  377,   -1,   -1,   -1,  257,  258,  259,  380,
-  381,  382,  263,  264,   -1,  266,  267,   -1,  269,  270,
-  271,  272,  273,   -1,   -1,  276,   -1,  274,  279,   -1,
-  281,  278,  283,  284,  285,  286,  287,  288,  289,  290,
-  291,  292,  293,   -1,   -1,   -1,  297,  298,  299,  300,
-  301,  302,  303,  304,  305,  306,   -1,   -1,  309,   -1,
-  311,  312,  313,  314,  315,  316,  317,  318,  319,  320,
-  321,  322,  323,  324,   -1,  326,  327,  328,  329,  330,
-  331,   -1,   -1,   -1,  335,  336,   -1,  338,   -1,   -1,
-  341,  342,  343,  344,   -1,  346,  347,   -1,  349,  350,
-  351,  352,   -1,   -1,  355,  356,  357,  358,  359,  360,
-   -1,  362,  363,  364,  365,  366,  367,  368,  369,  370,
-  371,    0,  373,  374,  375,  376,  377,   -1,   -1,   -1,
-  257,  258,  259,  380,  381,  382,  263,  264,   -1,  266,
-  267,   -1,  269,  270,  271,  272,  273,   -1,   -1,  276,
-   -1,  274,  279,   -1,  281,  278,  283,  284,  285,  286,
-  287,  288,  289,  290,  291,  292,  293,   -1,   -1,   -1,
-  297,  298,  299,  300,  301,  302,  303,  304,  305,  306,
-   -1,   -1,  309,   -1,  311,  312,  313,  314,  315,  316,
-  317,  318,  319,  320,  321,  322,  323,  324,   -1,  326,
-  327,  328,  329,  330,  331,   -1,   -1,   -1,  335,  336,
-   -1,  338,   -1,   -1,  341,  342,  343,  344,   -1,  346,
-  347,   -1,  349,  350,  351,  352,   -1,   -1,  355,  356,
-  357,  358,  359,  360,   -1,  362,  363,  364,  365,  366,
-  367,  368,  369,  370,  371,    0,  373,  374,  375,  376,
-  377,   -1,   -1,   -1,  257,  258,  259,  380,  381,  382,
-  263,  264,   -1,  266,  267,   -1,  269,  270,  271,  272,
-  273,   -1,   -1,  276,   -1,  274,  279,   -1,  281,  278,
-  283,  284,  285,  286,  287,  288,  289,  290,  291,  292,
-  293,   -1,   -1,   -1,  297,  298,  299,  300,  301,  302,
-  303,  304,  305,  306,   -1,   -1,  309,   -1,  311,  312,
-  313,  314,  315,  316,  317,  318,  319,  320,  321,  322,
-  323,  324,   -1,  326,  327,  328,  329,  330,  331,   -1,
-   -1,   -1,  335,  336,   -1,  338,   -1,   -1,  341,  342,
-  343,  344,   -1,  346,  347,   -1,  349,  350,  351,  352,
-   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,  362,
-  363,  364,  365,  366,  367,  368,  369,  370,  371,    0,
-  373,  374,  375,  376,  377,   -1,   -1,   -1,  257,  258,
-  259,  380,  381,  382,  263,  264,   -1,  266,  267,   -1,
-  269,  270,  271,  272,  273,   -1,   -1,  276,   -1,  274,
-  279,   -1,  281,  278,  283,  284,  285,  286,  287,  288,
-  289,  290,  291,  292,  293,   -1,   -1,   -1,  297,  298,
-  299,  300,  301,  302,  303,  304,  305,  306,   -1,   -1,
-  309,   -1,  311,  312,  313,  314,  315,  316,  317,  318,
-  319,  320,  321,  322,  323,  324,   -1,  326,  327,  328,
-  329,  330,  331,   -1,   -1,   -1,  335,  336,   -1,  338,
-   -1,   -1,  341,  342,  343,  344,   -1,  346,  347,   -1,
-  349,  350,  351,  352,   -1,   -1,  355,  356,  357,  358,
-  359,  360,   -1,  362,  363,  364,  365,  366,  367,  368,
-  369,  370,  371,    0,  373,  374,  375,  376,  377,   -1,
-   -1,   -1,  257,  258,  259,  380,  381,  382,  263,  264,
-   -1,  266,  267,   -1,  269,  270,  271,  272,  273,   -1,
-   -1,  276,   -1,  274,  279,   -1,  281,  278,  283,  284,
-  285,  286,  287,  288,  289,  290,  291,  292,  293,   -1,
-   -1,   -1,  297,  298,  299,  300,  301,  302,  303,  304,
-  305,  306,   -1,   -1,  309,   -1,  311,  312,  313,  314,
-  315,  316,  317,  318,  319,  320,  321,  322,  323,  324,
-   -1,  326,  327,  328,  329,  330,  331,   -1,   -1,   -1,
-  335,  336,   -1,  338,   -1,   -1,  341,  342,  343,  344,
-   -1,  346,  347,   -1,  349,  350,  351,  352,   -1,   -1,
-  355,  356,  357,  358,  359,  360,   -1,  362,  363,  364,
-  365,  366,  367,  368,  369,  370,  371,    0,  373,  374,
-  375,  376,  377,   -1,   -1,   -1,  257,  258,  259,  380,
-  381,  382,  263,  264,   -1,  266,  267,   -1,  269,  270,
-  271,  272,  273,   -1,   -1,  276,   -1,  274,  279,   -1,
-  281,  278,  283,  284,  285,  286,  287,  288,  289,  290,
-  291,  292,  293,   -1,   -1,   -1,  297,  298,  299,  300,
-  301,  302,  303,  304,  305,  306,   -1,   -1,  309,   -1,
-  311,  312,  313,  314,  315,  316,  317,  318,  319,  320,
-  321,  322,  323,  324,   -1,  326,  327,  328,  329,  330,
-  331,   -1,   -1,   -1,  335,  336,   -1,  338,   -1,   -1,
-  341,  342,  343,  344,   -1,  346,  347,   -1,  349,  350,
-  351,  352,   -1,   -1,  355,  356,  357,  358,  359,  360,
-   -1,  362,  363,  364,  365,  366,  367,  368,  369,  370,
-  371,    0,  373,  374,  375,  376,  377,   -1,   -1,   -1,
-  257,  258,  259,  380,  381,  382,  263,  264,   -1,  266,
-  267,   -1,  269,  270,  271,  272,  273,   -1,   -1,  276,
-   -1,  274,  279,   -1,  281,  278,  283,  284,  285,  286,
-  287,  288,  289,  290,  291,  292,  293,   -1,   -1,   -1,
-  297,  298,  299,  300,  301,  302,  303,  304,  305,  306,
-   -1,   -1,  309,   -1,  311,  312,  313,  314,  315,  316,
-  317,  318,  319,  320,  321,  322,  323,  324,   -1,  326,
-  327,  328,  329,  330,  331,   -1,   -1,   -1,  335,  336,
-   -1,  338,   -1,   -1,  341,  342,  343,  344,   -1,  346,
-  347,   -1,  349,  350,  351,  352,   -1,   -1,  355,  356,
-  357,  358,  359,  360,   -1,  362,  363,  364,  365,  366,
-  367,  368,  369,  370,  371,    0,  373,  374,  375,  376,
-  377,   -1,   -1,   -1,  257,  258,  259,  380,  381,  382,
-  263,  264,   -1,  266,  267,   -1,  269,  270,  271,  272,
-  273,   -1,   -1,  276,   -1,  274,  279,   -1,  281,  278,
-  283,  284,  285,  286,  287,  288,  289,  290,  291,  292,
-  293,   -1,   -1,   -1,  297,  298,  299,  300,  301,  302,
-  303,  304,  305,  306,   -1,   -1,  309,   -1,  311,  312,
-  313,  314,  315,  316,  317,  318,  319,  320,  321,  322,
-  323,  324,   -1,  326,  327,  328,  329,  330,  331,   -1,
-   -1,   -1,  335,  336,   -1,  338,   -1,   -1,  341,  342,
-  343,  344,   -1,  346,  347,   -1,  349,  350,  351,  352,
-   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,  362,
-  363,  364,  365,  366,  367,  368,  369,  370,  371,    0,
-  373,  374,  375,  376,  377,   -1,   -1,   -1,  257,  258,
-  259,  380,  381,  382,  263,  264,   -1,  266,  267,   -1,
-  269,  270,  271,  272,  273,   -1,   -1,  276,   -1,  274,
-  279,   -1,  281,  278,  283,  284,  285,  286,  287,  288,
-  289,  290,  291,  292,  293,   -1,   -1,   -1,  297,  298,
-  299,  300,  301,  302,  303,  304,  305,  306,   -1,   -1,
-  309,   -1,  311,  312,  313,  314,  315,  316,  317,  318,
-  319,  320,  321,  322,  323,  324,   -1,  326,  327,  328,
-  329,  330,  331,   -1,   -1,   -1,  335,  336,   -1,  338,
-   -1,   -1,  341,  342,  343,  344,   -1,  346,  347,   -1,
-  349,  350,  351,  352,   -1,   -1,  355,  356,  357,  358,
-  359,  360,   -1,  362,  363,  364,  365,  366,  367,  368,
-  369,  370,  371,    0,  373,  374,  375,  376,  377,   -1,
-   -1,   -1,  257,  258,  259,  380,  381,  382,  263,  264,
-   -1,  266,  267,   -1,  269,  270,  271,  272,  273,   -1,
-   -1,  276,   -1,   -1,  279,   -1,  281,   -1,  283,  284,
-  285,  286,  287,  288,  289,  290,  291,  292,  293,   -1,
-   -1,   -1,  297,  298,  299,  300,  301,  302,  303,  304,
-  305,  306,   -1,   -1,  309,   -1,  311,  312,  313,  314,
-  315,  316,  317,  318,  319,  320,  321,  322,  323,  324,
-   -1,  326,  327,  328,  329,  330,  331,   -1,   -1,   -1,
-  335,  336,   -1,  338,   -1,   -1,  341,  342,  343,  344,
-   -1,  346,  347,   -1,  349,  350,  351,  352,   -1,   -1,
-  355,  356,  357,  358,  359,  360,   -1,  362,  363,  364,
-  365,  366,  367,  368,  369,  370,  371,    0,  373,  374,
-  375,  376,  377,   -1,   -1,   -1,  257,  258,  259,  260,
-  261,   -1,  263,  264,   -1,  266,  267,   -1,  269,  270,
-  271,  272,  273,  274,   -1,  276,   -1,   -1,  279,   -1,
-  281,   -1,  283,  284,  285,  286,  287,  288,  289,  290,
-  291,  292,  293,   -1,   -1,   -1,  297,  298,  299,  300,
-  301,   -1,  303,  304,  305,  306,   -1,   -1,  309,   -1,
-  311,  312,  313,  314,  315,   -1,   -1,   -1,   -1,   -1,
-  321,  322,  323,  324,  325,  326,  327,  328,  329,   -1,
-   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,  278,   -1,
-  341,  342,   -1,   -1,   -1,  346,  347,   -1,  349,  350,
-  351,  352,   -1,   -1,  355,  356,  357,  358,  359,  360,
-  361,   -1,   -1,   -1,  365,  366,  367,  368,  369,  370,
-  371,    0,  373,  374,  375,  376,  377,   -1,   -1,   -1,
-  257,  258,  259,  260,  261,   -1,  263,  264,   -1,  266,
-  267,   -1,  269,  270,  271,  272,  273,   -1,   -1,  276,
-   -1,  274,  279,   -1,  281,  278,  283,  284,  285,  286,
-  287,  288,  289,  290,  291,  292,  293,   -1,   -1,   -1,
-  297,  298,  299,  300,  301,   -1,  303,  304,  305,  306,
-   -1,   -1,  309,   -1,  311,  312,  313,  314,  315,   -1,
-  380,  381,  382,   -1,  321,  322,  323,  324,  325,  326,
-  327,  328,  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,
-   -1,  338,  278,   -1,  341,  342,   -1,   -1,   -1,  346,
-  347,   -1,  349,  350,  351,  352,   -1,   -1,  355,  356,
-  357,  358,  359,  360,  361,   -1,   -1,   -1,  365,  366,
-  367,  368,  369,  370,  371,    0,  373,  374,  375,  376,
-  377,   -1,   -1,   -1,  257,  258,  259,  380,  381,  382,
-  263,  264,   -1,  266,  267,   -1,  269,  270,  271,  272,
-  273,   -1,   -1,  276,   -1,  274,  279,   -1,  281,  278,
-  283,  284,  285,  286,  287,  288,  289,  290,  291,  292,
-  293,   -1,   -1,   -1,  297,  298,  299,  300,  301,   -1,
-  303,  304,  305,  306,   -1,   -1,  309,   -1,  311,  312,
-  313,  314,  315,   -1,  380,  381,  382,   -1,  321,  322,
-  323,  324,   -1,  326,  327,  328,  329,   -1,   -1,   -1,
-   -1,   -1,  274,   -1,   -1,  338,  278,   -1,  341,  342,
-   -1,   -1,   -1,  346,  347,   -1,  349,  350,  351,  352,
-   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,   -1,
-   -1,   -1,  365,  366,  367,  368,  369,  370,  371,    0,
-  373,  374,  375,  376,  377,   -1,   -1,   -1,  257,  258,
-  259,  380,  381,  382,  263,  264,   -1,  266,  267,   -1,
-  269,  270,  271,  272,  273,   -1,   -1,  276,   -1,  274,
-  279,   -1,  281,  278,  283,  284,  285,  286,  287,  288,
-  289,  290,  291,  292,  293,   -1,   -1,   -1,  297,  298,
-  299,  300,  301,   -1,  303,  304,  305,  306,   -1,   -1,
-  309,   -1,  311,  312,  313,  314,  315,   -1,  380,  381,
-  382,   -1,  321,  322,  323,  324,   -1,  326,  327,  328,
-  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,
-  278,   -1,  341,  342,   -1,   -1,   -1,  346,  347,   -1,
-  349,  350,  351,  352,   -1,   -1,  355,  356,  357,  358,
-  359,  360,   -1,   -1,   -1,   -1,  365,  366,  367,  368,
-  369,  370,  371,    0,  373,  374,  375,  376,  377,   -1,
-   -1,   -1,  257,  258,  259,  380,  381,  382,  263,  264,
-   -1,  266,  267,   -1,  269,  270,  271,  272,  273,   -1,
-   -1,  276,   -1,  274,  279,   -1,  281,  278,  283,  284,
-  285,  286,  287,  288,  289,  290,  291,  292,  293,   -1,
-   -1,   -1,  297,  298,  299,  300,  301,   -1,  303,  304,
-  305,  306,   -1,   -1,  309,   -1,  311,  312,  313,  314,
-  315,   -1,  380,  381,  382,   -1,  321,  322,  323,  324,
-   -1,  326,  327,  328,  329,   -1,   -1,   -1,   -1,   -1,
-  274,   -1,   -1,  338,  278,   -1,  341,  342,   -1,   -1,
-   -1,  346,  347,   -1,  349,  350,  351,  352,   -1,   -1,
-  355,  356,  357,  358,  359,  360,   -1,   -1,   -1,   -1,
-  365,  366,  367,  368,  369,  370,  371,    0,  373,  374,
-  375,  376,  377,   -1,   -1,   -1,  257,  258,  259,  380,
-  381,  382,  263,  264,   -1,  266,  267,   -1,  269,  270,
-  271,  272,  273,   -1,   -1,  276,   -1,  274,  279,   -1,
-  281,  278,  283,  284,  285,  286,  287,  288,  289,  290,
-  291,  292,  293,   -1,   -1,   -1,  297,  298,  299,  300,
-  301,   -1,  303,  304,  305,  306,   -1,   -1,  309,   -1,
-  311,  312,  313,  314,  315,   -1,  380,  381,  382,   -1,
-  321,  322,  323,  324,   -1,  326,  327,  328,  329,   -1,
-   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,  278,   -1,
-  341,  342,   -1,   -1,   -1,  346,  347,   -1,  349,  350,
-  351,  352,   -1,   -1,  355,  356,  357,  358,  359,  360,
-   -1,   -1,   -1,   -1,  365,  366,  367,  368,  369,  370,
-  371,    0,  373,  374,  375,  376,  377,   -1,   -1,   -1,
-  257,  258,  259,  380,  381,  382,  263,  264,   -1,  266,
-  267,   -1,  269,  270,  271,  272,  273,   -1,   -1,  276,
-   -1,  274,  279,   -1,  281,  278,  283,  284,  285,  286,
-  287,  288,  289,  290,  291,  292,  293,   -1,   -1,   -1,
-  297,  298,  299,  300,  301,   -1,  303,  304,  305,  306,
-   -1,   -1,  309,   -1,  311,  312,  313,  314,  315,   -1,
-  380,  381,  382,   -1,  321,  322,  323,  324,   -1,  326,
-  327,  328,  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,
-   -1,  338,  278,   -1,  341,  342,   -1,   -1,   -1,  346,
-  347,   -1,  349,  350,  351,  352,   -1,   -1,  355,  356,
-  357,  358,  359,  360,   -1,   -1,   -1,   -1,  365,  366,
-  367,  368,  369,  370,  371,    0,  373,  374,  375,  376,
-  377,   -1,   -1,   -1,  257,  258,  259,  380,  381,  382,
-  263,  264,   -1,  266,  267,   -1,  269,  270,  271,  272,
-  273,   -1,   -1,  276,   -1,  274,  279,   -1,  281,  278,
-  283,  284,  285,  286,  287,  288,  289,  290,  291,  292,
-  293,   -1,   -1,   -1,  297,  298,  299,  300,  301,   -1,
-  303,  304,  305,  306,   -1,   -1,  309,   -1,  311,  312,
-  313,  314,  315,   -1,  380,  381,  382,   -1,  321,  322,
-  323,  324,   -1,  326,  327,  328,  329,   -1,   -1,   -1,
-   -1,   -1,  274,   -1,   -1,  338,  278,   -1,  341,  342,
-   -1,   -1,   -1,  346,  347,   -1,  349,  350,  351,  352,
-   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,   -1,
-   -1,   -1,  365,  366,  367,  368,  369,  370,  371,    0,
-  373,  374,  375,  376,  377,   -1,   -1,   -1,  257,  258,
-  259,  380,  381,  382,  263,  264,   -1,  266,  267,   -1,
-  269,  270,  271,  272,  273,   -1,   -1,  276,   -1,  274,
-  279,   -1,  281,  278,  283,  284,  285,  286,  287,  288,
-  289,  290,  291,  292,  293,   -1,   -1,   -1,  297,  298,
-  299,  300,  301,   -1,  303,  304,  305,  306,   -1,   -1,
-  309,   -1,  311,  312,  313,  314,  315,   -1,  380,  381,
-  382,   -1,  321,  322,  323,  324,   -1,  326,  327,  328,
-  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,
-  278,   -1,  341,  342,   -1,   -1,   -1,  346,  347,   -1,
-  349,  350,  351,  352,   -1,   -1,  355,  356,  357,  358,
-  359,  360,   -1,   -1,   -1,   -1,  365,  366,  367,  368,
-  369,  370,  371,    0,  373,  374,  375,  376,  377,   -1,
-   -1,   -1,  257,  258,  259,  380,  381,  382,  263,  264,
-   -1,  266,  267,   -1,  269,  270,  271,  272,  273,   -1,
-   -1,  276,   -1,  274,  279,   -1,  281,  278,  283,  284,
-  285,  286,  287,  288,  289,  290,  291,  292,  293,   -1,
-   -1,   -1,  297,  298,  299,  300,  301,   -1,  303,  304,
-  305,  306,   -1,   -1,  309,   -1,  311,  312,  313,  314,
-  315,   -1,  380,  381,  382,   -1,  321,  322,  323,  324,
-   -1,  326,  327,  328,  329,   -1,   -1,   -1,   -1,   -1,
-  274,   -1,   -1,  338,  278,   -1,  341,  342,   -1,   -1,
-   -1,  346,  347,   -1,  349,  350,  351,  352,   -1,   -1,
-  355,  356,  357,  358,  359,  360,   -1,   -1,   -1,   -1,
-  365,  366,  367,  368,  369,  370,  371,    0,  373,  374,
-  375,  376,  377,   -1,   -1,   -1,  257,  258,  259,  380,
-  381,  382,  263,  264,   -1,  266,  267,   -1,  269,  270,
-  271,  272,  273,   -1,   -1,  276,   -1,  274,  279,   -1,
-  281,  278,  283,  284,  285,  286,  287,  288,  289,  290,
-  291,  292,  293,   -1,   -1,   -1,  297,  298,  299,  300,
-  301,   -1,  303,  304,  305,  306,   -1,   -1,  309,   -1,
-  311,  312,  313,  314,  315,   -1,  380,  381,  382,   -1,
-  321,  322,  323,  324,   -1,  326,  327,  328,  329,   -1,
-   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,  278,   -1,
-  341,  342,   -1,   -1,   -1,  346,  347,   -1,  349,  350,
-  351,  352,   -1,   -1,  355,  356,  357,  358,  359,  360,
-   -1,   -1,   -1,   -1,  365,  366,  367,  368,  369,  370,
-  371,    0,  373,  374,  375,  376,  377,   -1,   -1,   -1,
-  257,  258,  259,  380,  381,  382,  263,  264,   -1,  266,
-  267,   -1,  269,  270,  271,  272,  273,   -1,   -1,  276,
-   -1,  274,  279,   -1,  281,  278,  283,  284,  285,  286,
-  287,  288,  289,  290,  291,  292,  293,   -1,   -1,   -1,
-  297,  298,  299,  300,  301,   -1,  303,  304,  305,  306,
-   -1,   -1,  309,   -1,  311,  312,  313,  314,  315,   -1,
-  380,  381,  382,   -1,  321,  322,  323,  324,   -1,  326,
-  327,  328,  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,
-   -1,  338,  278,   -1,  341,  342,   -1,   -1,   -1,  346,
-  347,   -1,  349,  350,  351,  352,   -1,   -1,  355,  356,
-  357,  358,  359,  360,   -1,   -1,   -1,   -1,  365,  366,
-  367,  368,  369,  370,  371,    0,  373,  374,  375,  376,
-  377,   -1,   -1,   -1,  257,  258,  259,  380,  381,  382,
-  263,  264,   -1,  266,  267,   -1,  269,  270,  271,  272,
-  273,   -1,   -1,  276,   -1,  274,  279,   -1,  281,  278,
-  283,  284,  285,  286,  287,  288,  289,  290,  291,  292,
-  293,   -1,   -1,   -1,  297,  298,  299,  300,  301,   -1,
-  303,  304,  305,  306,   -1,   -1,  309,   -1,  311,  312,
-  313,  314,  315,   -1,  380,  381,  382,   -1,  321,  322,
-  323,  324,   -1,  326,  327,  328,  329,   -1,   -1,   -1,
-   -1,   -1,  274,   -1,   -1,  338,  278,   -1,  341,  342,
-   -1,   -1,   -1,  346,  347,   -1,  349,  350,  351,  352,
-   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,   -1,
-   -1,   -1,  365,  366,  367,  368,  369,  370,  371,    0,
-  373,  374,  375,  376,  377,   -1,   -1,   -1,  257,  258,
-  259,  380,  381,  382,  263,  264,   -1,  266,  267,   -1,
-  269,  270,  271,  272,  273,   -1,   -1,  276,   -1,  274,
-  279,   -1,  281,  278,  283,  284,  285,  286,  287,  288,
-  289,  290,  291,  292,  293,   -1,   -1,   -1,  297,  298,
-  299,  300,  301,   -1,  303,  304,  305,  306,   -1,   -1,
-  309,   -1,  311,  312,  313,  314,  315,   -1,  380,  381,
-  382,   -1,  321,  322,  323,  324,   -1,  326,  327,  328,
-  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,
-  278,   -1,  341,  342,   -1,   -1,   -1,  346,  347,   -1,
-  349,  350,  351,  352,   -1,   -1,  355,  356,  357,  358,
-  359,  360,   -1,   -1,   -1,   -1,  365,  366,  367,  368,
-  369,  370,  371,    0,  373,  374,  375,  376,  377,   -1,
-   -1,   -1,  257,  258,  259,  380,  381,  382,  263,  264,
-   -1,  266,  267,   -1,  269,  270,  271,  272,  273,   -1,
-   -1,  276,   -1,  274,  279,   -1,  281,  278,  283,  284,
-  285,  286,  287,  288,  289,  290,  291,  292,  293,   -1,
-   -1,   -1,  297,  298,  299,  300,  301,   -1,  303,  304,
-  305,  306,   -1,   -1,  309,   -1,  311,  312,  313,  314,
-  315,   -1,  380,  381,  382,   -1,  321,  322,  323,  324,
-   -1,  326,  327,  328,  329,   -1,   -1,   -1,   -1,   -1,
-  274,   -1,   -1,  338,  278,   -1,  341,  342,   -1,   -1,
-   -1,  346,  347,   -1,  349,  350,  351,  352,   -1,   -1,
-  355,  356,  357,  358,  359,  360,   -1,   -1,   -1,   -1,
-  365,  366,  367,  368,  369,  370,  371,    0,  373,  374,
-  375,  376,  377,   -1,   -1,   -1,  257,  258,  259,  380,
-  381,  382,  263,  264,   -1,  266,  267,   -1,  269,  270,
-  271,  272,  273,   -1,   -1,  276,   -1,  274,  279,   -1,
-  281,  278,  283,  284,  285,  286,  287,  288,  289,  290,
-  291,  292,  293,   -1,   -1,   -1,  297,  298,  299,  300,
-  301,   -1,  303,  304,  305,  306,   -1,   -1,  309,   -1,
-  311,  312,  313,  314,  315,   -1,  380,  381,  382,   -1,
-  321,  322,  323,  324,   -1,  326,  327,  328,  329,   -1,
-   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,  278,   -1,
-  341,  342,   -1,   -1,   -1,  346,  347,   -1,  349,  350,
-  351,  352,   -1,   -1,  355,  356,  357,  358,  359,  360,
-   -1,   -1,   -1,   -1,  365,  366,  367,  368,  369,  370,
-  371,    0,  373,  374,  375,  376,  377,   -1,   -1,   -1,
-  257,  258,  259,  380,  381,  382,  263,  264,   -1,  266,
-  267,   -1,  269,  270,  271,  272,  273,   -1,   -1,  276,
-   -1,  274,  279,   -1,  281,  278,  283,  284,  285,  286,
-  287,  288,  289,  290,  291,  292,  293,   -1,   -1,   -1,
-  297,  298,  299,  300,  301,   -1,  303,  304,  305,  306,
-   -1,   -1,  309,   -1,  311,  312,  313,  314,  315,   -1,
-  380,  381,  382,   -1,  321,  322,  323,  324,   -1,  326,
-  327,  328,  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,
-   -1,  338,  278,   -1,  341,  342,   -1,   -1,   -1,  346,
-  347,   -1,  349,  350,  351,  352,   -1,   -1,  355,  356,
-  357,  358,  359,  360,   -1,   -1,   -1,   -1,  365,  366,
-  367,  368,  369,  370,  371,    0,  373,  374,  375,  376,
-  377,   -1,   -1,   -1,  257,  258,  259,  380,  381,  382,
-  263,  264,   -1,  266,  267,   -1,  269,  270,  271,  272,
-  273,   -1,   -1,  276,   -1,  274,  279,   -1,  281,  278,
-  283,  284,  285,  286,  287,  288,  289,  290,  291,  292,
-  293,   -1,   -1,   -1,  297,  298,  299,  300,  301,   -1,
-  303,  304,  305,  306,   -1,   -1,  309,   -1,  311,  312,
-  313,  314,  315,   -1,  380,  381,  382,   -1,  321,  322,
-  323,  324,   -1,  326,  327,  328,  329,   -1,   -1,   -1,
-   -1,   -1,  274,   -1,   -1,  338,  278,   -1,  341,  342,
-   -1,   -1,   -1,  346,  347,   -1,  349,  350,  351,  352,
-   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,   -1,
-   -1,   -1,  365,  366,  367,  368,  369,  370,  371,    0,
-  373,  374,  375,  376,  377,   -1,   -1,   -1,  257,  258,
-  259,  380,  381,  382,  263,  264,   -1,  266,  267,   -1,
-  269,  270,  271,  272,  273,   -1,   -1,  276,   -1,  274,
-  279,   -1,  281,  278,  283,  284,  285,  286,  287,  288,
-  289,  290,  291,  292,  293,   -1,   -1,   -1,  297,  298,
-  299,  300,  301,   -1,  303,  304,  305,  306,   -1,   -1,
-  309,   -1,  311,  312,  313,  314,  315,   -1,  380,  381,
-  382,   -1,  321,  322,  323,  324,   -1,  326,  327,  328,
-  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,
-  278,   -1,  341,  342,   -1,   -1,   -1,  346,  347,   -1,
-  349,  350,  351,  352,   -1,   -1,  355,  356,  357,  358,
-  359,  360,   -1,   -1,   -1,   -1,  365,  366,  367,  368,
-  369,  370,  371,    0,  373,  374,  375,  376,  377,   -1,
-   -1,   -1,  257,  258,  259,  380,  381,  382,  263,  264,
-   -1,  266,  267,   -1,  269,  270,  271,  272,  273,   -1,
-   -1,  276,   -1,  274,  279,   -1,  281,  278,  283,  284,
-  285,  286,  287,  288,  289,  290,  291,  292,  293,   -1,
-   -1,   -1,  297,  298,  299,  300,  301,   -1,  303,  304,
-  305,  306,   -1,   -1,  309,   -1,  311,  312,  313,  314,
-  315,   -1,  380,  381,  382,   -1,  321,  322,  323,  324,
-   -1,  326,  327,  328,  329,   -1,   -1,   -1,   -1,   -1,
-  274,   -1,   -1,  338,  278,   -1,  341,  342,   -1,   -1,
-   -1,  346,  347,   -1,  349,  350,  351,  352,   -1,   -1,
-  355,  356,  357,  358,  359,  360,   -1,   -1,   -1,   -1,
-  365,  366,  367,  368,  369,  370,  371,    0,  373,  374,
-  375,  376,  377,   -1,   -1,   -1,  257,  258,  259,  380,
-  381,  382,  263,  264,   -1,  266,  267,   -1,  269,  270,
-  271,  272,  273,   -1,   -1,  276,   -1,  274,  279,   -1,
-  281,  278,  283,  284,  285,  286,  287,  288,  289,  290,
-  291,  292,  293,   -1,   -1,   -1,  297,  298,  299,  300,
-  301,   -1,  303,  304,  305,  306,   -1,   -1,  309,   -1,
-  311,  312,  313,  314,  315,   -1,  380,  381,  382,   -1,
-  321,  322,  323,  324,   -1,  326,  327,  328,  329,   -1,
-   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,  278,   -1,
-  341,  342,   -1,   -1,   -1,  346,  347,   -1,  349,  350,
-  351,  352,   -1,   -1,  355,  356,  357,  358,  359,  360,
-   -1,   -1,   -1,   -1,  365,  366,  367,  368,  369,  370,
-  371,    0,  373,  374,  375,  376,  377,   -1,   -1,   -1,
-  257,  258,  259,  380,  381,  382,  263,  264,   -1,  266,
-  267,   -1,  269,  270,  271,  272,  273,   -1,   -1,  276,
-   -1,  274,  279,   -1,  281,  278,  283,  284,  285,  286,
-  287,  288,  289,  290,  291,  292,  293,   -1,   -1,   -1,
-  297,  298,  299,  300,  301,   -1,  303,  304,  305,  306,
-   -1,   -1,  309,   -1,  311,  312,  313,  314,  315,   -1,
-  380,  381,  382,   -1,  321,  322,  323,  324,   -1,  326,
-  327,  328,  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,
-   -1,  338,  278,   -1,  341,  342,   -1,   -1,   -1,  346,
-  347,   -1,  349,  350,  351,  352,   -1,   -1,  355,  356,
-  357,  358,  359,  360,   -1,   -1,   -1,   -1,  365,  366,
-  367,  368,  369,  370,  371,    0,  373,  374,  375,  376,
-  377,   -1,   -1,   -1,  257,  258,  259,  380,  381,  382,
-  263,  264,   -1,  266,  267,   -1,  269,  270,  271,  272,
-  273,   -1,   -1,  276,   -1,  274,  279,   -1,  281,  278,
-  283,  284,  285,  286,  287,  288,  289,  290,  291,  292,
-  293,   -1,   -1,   -1,  297,  298,  299,  300,  301,   -1,
-  303,  304,  305,  306,   -1,   -1,  309,   -1,  311,  312,
-  313,  314,  315,   -1,  380,  381,  382,   -1,  321,  322,
-  323,  324,   -1,  326,  327,  328,  329,   -1,   -1,   -1,
-   -1,   -1,  274,   -1,   -1,  338,  278,   -1,  341,  342,
-   -1,   -1,   -1,  346,  347,   -1,  349,  350,  351,  352,
-   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,   -1,
-   -1,   -1,  365,  366,  367,  368,  369,  370,  371,    0,
-  373,  374,  375,  376,  377,   -1,   -1,   -1,  257,  258,
-  259,  380,  381,  382,  263,  264,   -1,  266,   -1,   -1,
-  269,  270,  271,  272,  273,   -1,   -1,  276,   -1,  274,
-  279,   -1,  281,  278,  283,  284,  285,  286,  287,  288,
-  289,  290,  291,  292,  293,   -1,   -1,   -1,  297,  298,
-  299,  300,  301,   -1,  303,  304,  305,  306,   -1,   -1,
-  309,   -1,  311,  312,  313,  314,  315,   -1,  380,  381,
-  382,   -1,  321,  322,  323,  324,   -1,  326,  327,  328,
-  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,
-  278,   -1,  341,  342,   -1,   -1,   -1,  346,  347,   -1,
-  349,  350,  351,  352,   -1,   -1,  355,  356,  357,  358,
-  359,  360,   -1,   -1,   -1,   -1,  365,  366,  367,  368,
-  369,  370,  371,    0,  373,  374,  375,  376,  377,   -1,
-   -1,   -1,  257,  258,  259,  380,  381,  382,  263,  264,
-   -1,  266,   -1,   -1,  269,  270,  271,  272,  273,   -1,
-   -1,  276,   -1,  274,  279,   -1,  281,  278,  283,  284,
-  285,  286,  287,  288,  289,  290,  291,  292,  293,   -1,
-   -1,   -1,  297,  298,  299,  300,  301,   -1,  303,  304,
-  305,  306,   -1,   -1,  309,   -1,  311,  312,  313,  314,
-  315,   -1,  380,  381,  382,   -1,  321,  322,  323,  324,
-   -1,  326,  327,  328,  329,   -1,   -1,   -1,   -1,   -1,
-  274,   -1,   -1,  338,  278,   -1,  341,  342,   -1,   -1,
-   -1,  346,  347,   -1,  349,  350,  351,  352,   -1,   -1,
-  355,  356,  357,  358,  359,  360,   -1,   -1,   -1,   -1,
-  365,  366,  367,  368,  369,  370,  371,    0,  373,  374,
-  375,  376,  377,   -1,   -1,   -1,  257,  258,  259,  380,
-  381,  382,  263,  264,   -1,  266,   -1,   -1,  269,  270,
-  271,  272,  273,   -1,   -1,  276,   -1,  274,  279,   -1,
-  281,  278,  283,  284,  285,  286,  287,  288,  289,  290,
-  291,  292,  293,   -1,   -1,   -1,  297,  298,  299,  300,
-  301,   -1,  303,  304,  305,  306,   -1,   -1,  309,   -1,
-  311,  312,  313,  314,  315,   -1,  380,  381,  382,   -1,
-  321,  322,  323,  324,   -1,  326,  327,  328,  329,   -1,
-   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,  278,   -1,
-  341,  342,   -1,   -1,   -1,  346,  347,   -1,  349,  350,
-  351,  352,   -1,   -1,  355,  356,  357,  358,  359,  360,
-   -1,   -1,   -1,   -1,  365,  366,  367,  368,  369,  370,
-  371,    0,  373,  374,  375,  376,  377,   -1,   -1,   -1,
-  257,  258,  259,  380,  381,  382,  263,  264,   -1,  266,
-   -1,   -1,  269,  270,  271,  272,  273,   -1,   -1,  276,
-   -1,  274,  279,   -1,  281,  278,  283,  284,  285,  286,
-  287,  288,  289,  290,  291,  292,  293,   -1,   -1,   -1,
-  297,  298,  299,  300,  301,   -1,  303,  304,  305,  306,
-   -1,   -1,  309,   -1,  311,  312,  313,  314,  315,   -1,
-  380,  381,  382,   -1,  321,  322,  323,  324,   -1,  326,
-  327,  328,  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,
-   -1,  338,  278,   -1,  341,  342,   -1,   -1,   -1,  346,
-  347,   -1,  349,  350,  351,  352,   -1,   -1,  355,  356,
-  357,  358,  359,  360,   -1,   -1,   -1,   -1,  365,  366,
-  367,  368,  369,  370,  371,    0,  373,  374,  375,  376,
-  377,   -1,   -1,   -1,  257,  258,  259,  380,  381,  382,
-  263,  264,   -1,  266,   -1,   -1,  269,  270,  271,  272,
-  273,   -1,   -1,  276,   -1,  274,  279,   -1,  281,  278,
-  283,  284,  285,  286,  287,  288,  289,  290,  291,  292,
-  293,   -1,   -1,   -1,  297,  298,  299,  300,  301,   -1,
-  303,  304,  305,  306,   -1,   -1,  309,   -1,  311,  312,
-  313,  314,  315,   -1,  380,  381,  382,   -1,  321,  322,
-  323,  324,   -1,  326,  327,  328,  329,   -1,   -1,   -1,
-   -1,   -1,  274,   -1,   -1,  338,  278,   -1,  341,  342,
-   -1,   -1,   -1,  346,  347,   -1,  349,  350,  351,  352,
-   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,   -1,
-   -1,   -1,  365,  366,  367,  368,  369,  370,  371,    0,
-  373,  374,  375,  376,  377,   -1,   -1,   -1,  257,  258,
-  259,  380,  381,  382,  263,  264,   -1,  266,   -1,   -1,
-  269,  270,  271,  272,  273,   -1,   -1,  276,   -1,  274,
-  279,   -1,  281,  278,  283,  284,  285,  286,  287,  288,
-  289,  290,  291,  292,  293,   -1,   -1,   -1,  297,  298,
-  299,  300,  301,   -1,  303,  304,  305,  306,   -1,   -1,
-  309,   -1,  311,  312,  313,  314,  315,   -1,  380,  381,
-  382,   -1,  321,  322,  323,  324,   -1,  326,  327,  328,
-  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,
-  278,   -1,  341,  342,   -1,   -1,   -1,  346,  347,   -1,
-  349,  350,  351,  352,   -1,   -1,  355,  356,  357,  358,
-  359,  360,   -1,   -1,   -1,   -1,  365,  366,  367,  368,
-  369,  370,  371,    0,  373,  374,  375,  376,  377,   -1,
-   -1,   -1,  257,  258,  259,  380,  381,  382,  263,  264,
-   -1,  266,   -1,   -1,  269,  270,  271,  272,  273,   -1,
-   -1,  276,   -1,  274,  279,   -1,  281,  278,  283,  284,
-  285,  286,  287,  288,  289,  290,  291,  292,  293,   -1,
-   -1,   -1,  297,  298,  299,  300,  301,   -1,  303,  304,
-  305,  306,   -1,   -1,  309,   -1,  311,  312,  313,  314,
-  315,   -1,  380,  381,  382,   -1,  321,  322,  323,  324,
-   -1,  326,  327,  328,  329,   -1,   -1,   -1,   -1,   -1,
-  274,   -1,   -1,  338,  278,   -1,  341,  342,   -1,   -1,
-   -1,  346,  347,   -1,  349,  350,  351,  352,   -1,   -1,
-  355,  356,  357,  358,  359,  360,   -1,   -1,   -1,   -1,
-  365,  366,  367,  368,  369,  370,  371,    0,  373,  374,
-  375,  376,  377,   -1,   -1,   -1,  257,  258,  259,  380,
-  381,  382,  263,  264,   -1,  266,   -1,   -1,  269,  270,
-  271,  272,  273,   -1,   -1,  276,   -1,  274,  279,   -1,
-  281,  278,  283,  284,  285,  286,  287,  288,  289,  290,
-  291,  292,  293,   -1,   -1,   -1,  297,  298,  299,  300,
-  301,   -1,  303,  304,  305,  306,   -1,   -1,  309,   -1,
-  311,  312,  313,  314,  315,   -1,  380,  381,  382,   -1,
-  321,  322,  323,  324,   -1,  326,  327,  328,  329,   -1,
-   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,  278,   -1,
-  341,  342,   -1,   -1,   -1,  346,  347,   -1,  349,  350,
-  351,  352,   -1,   -1,  355,  356,  357,  358,  359,  360,
-   -1,   -1,   -1,   -1,  365,  366,  367,  368,  369,  370,
-  371,    0,  373,  374,  375,  376,  377,   -1,   -1,   -1,
-  257,  258,  259,  380,  381,  382,  263,  264,   -1,  266,
-   -1,   -1,  269,  270,  271,  272,  273,   -1,   -1,  276,
-   -1,  274,  279,   -1,  281,  278,  283,  284,  285,  286,
-  287,  288,  289,  290,  291,  292,  293,   -1,   -1,   -1,
-  297,  298,  299,  300,  301,   -1,  303,  304,  305,  306,
-   -1,   -1,  309,   -1,  311,  312,  313,  314,  315,   -1,
-  380,  381,  382,   -1,  321,  322,  323,  324,   -1,  326,
-  327,  328,  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,
-   -1,  338,  278,   -1,  341,  342,   -1,   -1,   -1,  346,
-  347,   -1,  349,  350,  351,  352,   -1,   -1,  355,  356,
-  357,  358,  359,  360,   -1,   -1,   -1,   -1,  365,  366,
-  367,  368,  369,  370,  371,    0,  373,  374,  375,  376,
-  377,   -1,   -1,   -1,  257,  258,  259,  380,  381,  382,
-  263,  264,   -1,  266,   -1,   -1,  269,  270,  271,  272,
-  273,   -1,   -1,  276,   -1,  274,  279,   -1,  281,  278,
-  283,  284,  285,  286,  287,  288,  289,  290,  291,  292,
-  293,   -1,   -1,   -1,  297,  298,  299,  300,  301,   -1,
-  303,  304,  305,  306,   -1,   -1,  309,   -1,  311,  312,
-  313,  314,  315,   -1,  380,  381,  382,   -1,  321,  322,
-  323,  324,   -1,  326,  327,  328,  329,   -1,   -1,   -1,
-   -1,   -1,  274,   -1,   -1,  338,  278,   -1,  341,  342,
-   -1,   -1,   -1,  346,  347,   -1,  349,  350,  351,  352,
-   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,   -1,
-   -1,   -1,  365,  366,  367,  368,  369,  370,  371,    0,
-  373,  374,  375,  376,  377,   -1,   -1,   -1,  257,  258,
-  259,  380,  381,  382,  263,  264,   -1,  266,   -1,   -1,
-  269,  270,  271,  272,  273,   -1,   -1,  276,   -1,  274,
-  279,   -1,  281,  278,  283,  284,  285,  286,  287,  288,
-  289,  290,  291,  292,  293,   -1,   -1,   -1,  297,  298,
-  299,  300,  301,   -1,  303,  304,  305,  306,   -1,   -1,
-  309,   -1,  311,  312,  313,  314,  315,   -1,  380,  381,
-  382,   -1,  321,  322,  323,  324,   -1,  326,  327,  328,
-  329,   -1,   -1,   -1,   -1,   -1,  274,   -1,   -1,  338,
-  278,   -1,  341,  342,   -1,   -1,   -1,  346,  347,   -1,
-  349,  350,  351,  352,   -1,   -1,  355,  356,  357,  358,
-  359,  360,   -1,   -1,   -1,   -1,  365,  366,  367,  368,
-  369,  370,  371,    0,  373,  374,  375,  376,  377,   -1,
-   -1,   -1,  257,  258,  259,  380,  381,  382,  263,  264,
-   -1,  266,   -1,   -1,  269,  270,  271,  272,  273,   -1,
-   -1,  276,   -1,  274,  279,   -1,  281,  278,  283,  284,
-  285,  286,  287,  288,  289,  290,  291,  292,  293,   -1,
-   -1,   -1,  297,  298,  299,  300,  301,   -1,  303,  304,
-  305,  306,   -1,   -1,  309,   -1,  311,  312,  313,  314,
-  315,   -1,  380,  381,  382,   -1,  321,  322,  323,  324,
-   -1,  326,  327,  328,  329,   -1,   -1,   -1,   -1,   -1,
-  274,   -1,   -1,  338,  278,   -1,  341,  342,   -1,   -1,
-   -1,  346,  347,   -1,  349,  350,  351,  352,   -1,   -1,
-  355,  356,  357,  358,  359,  360,   -1,   -1,   -1,   -1,
-  365,  366,  367,  368,  369,  370,  371,   -1,  373,  374,
-  375,  376,  377,   -1,   -1,   -1,  257,  258,  259,  380,
-  381,  382,  263,  264,   -1,  266,   -1,  266,  269,  270,
-  271,  272,  273,  272,   -1,  276,   -1,   -1,  279,   -1,
-  281,   -1,  283,  284,  285,  286,  287,  288,  289,  290,
-  291,  292,  293,   -1,   -1,   -1,  297,  298,  299,  300,
-  301,   -1,  303,  304,  305,  306,   -1,   -1,  309,   -1,
-  311,  312,  313,  314,  315,   -1,  380,  381,  382,   -1,
-  321,  322,  323,  324,   -1,  326,  327,  328,  329,   -1,
-   -1,   -1,   -1,  332,  333,  334,   -1,  338,  337,   -1,
-  341,  342,   -1,   -1,   -1,  346,  347,   -1,  349,  350,
-  351,  352,   -1,   -1,  355,  356,  357,  358,  359,  360,
-   -1,   -1,   -1,   -1,  365,  366,  367,  368,  369,  370,
-  371,   -1,  373,  374,  375,  376,  377,   -1,   -1,   -1,
-  257,  258,  259,   -1,   -1,   -1,  263,   -1,   -1,  266,
-   -1,   -1,  269,  270,  271,  272,  273,   -1,   -1,  276,
-   -1,   -1,  279,   -1,  281,   -1,  283,  284,  285,  286,
-  287,  288,  289,  290,  291,  292,  293,   -1,   -1,   -1,
-  297,  298,  299,  300,  301,   -1,  303,  304,  305,  306,
-   -1,   -1,  309,   -1,  311,  312,  313,  314,  315,   -1,
-   -1,   -1,   -1,   -1,  321,  322,  323,  324,   -1,  326,
-  327,  328,  329,  260,  261,   -1,   -1,  264,   -1,  266,
-  267,  338,   -1,   -1,  341,  342,   -1,   -1,   -1,  346,
-  347,  278,  349,  350,  351,  352,   -1,   -1,  355,  356,
-  357,  358,  359,  360,   -1,   -1,   -1,   -1,  365,  366,
-  367,  368,  369,  370,  371,   -1,  373,  374,  375,  376,
-  377,  257,  258,  259,   -1,   -1,   -1,  263,  264,   -1,
-  266,   -1,   -1,  269,  270,  271,  272,  273,  325,   -1,
-  276,   -1,   -1,  279,   -1,  281,   -1,  283,  284,  285,
-  286,  287,  288,  289,  290,  291,  292,  293,   -1,   -1,
-   -1,  297,  298,  299,  300,  301,   -1,  303,  304,  305,
-  306,   -1,   -1,  309,  361,  311,  312,  313,  314,  315,
-   -1,   -1,   -1,   -1,   -1,  321,  322,  323,  324,   -1,
-  326,  327,  328,  329,  260,  261,   -1,   -1,  264,   -1,
-  266,  267,  338,   -1,   -1,  341,  342,   -1,   -1,   -1,
-  346,  347,  278,  349,  350,  351,  352,   -1,   -1,  355,
-  356,  357,  358,  359,  360,   -1,   -1,   -1,   -1,  365,
-  366,  367,  368,  369,  370,  371,   -1,  373,  374,  375,
-  376,  377,  257,  258,  259,   -1,   -1,   -1,  263,  264,
-   -1,  266,   -1,   -1,  269,  270,  271,  272,  273,  325,
-   -1,  276,   -1,   -1,  279,   -1,  281,   -1,  283,  284,
-  285,  286,  287,  288,  289,  290,  291,  292,  293,   -1,
-   -1,   -1,  297,  298,  299,  300,  301,   -1,  303,  304,
-  305,  306,   -1,   -1,  309,  361,  311,  312,  313,  314,
-  315,   -1,   -1,   -1,   -1,   -1,  321,  322,  323,  324,
-   -1,  326,  327,  328,  329,  260,  261,   -1,   -1,  264,
-   -1,  266,  267,  338,   -1,   -1,  341,  342,   -1,   -1,
-   -1,  346,  347,  278,  349,  350,  351,  352,   -1,   -1,
-  355,  356,  357,  358,  359,  360,   -1,   -1,   -1,   -1,
-  365,  366,  367,  368,  369,  370,  371,   -1,  373,  374,
-  375,  376,  377,  257,  258,  259,   -1,   -1,   -1,  263,
-  264,   -1,  266,   -1,   -1,  269,  270,  271,  272,  273,
-  325,   -1,  276,   -1,   -1,  279,   -1,  281,   -1,  283,
-  284,  285,  286,  287,  288,  289,  290,  291,  292,  293,
-   -1,   -1,   -1,  297,  298,  299,  300,  301,   -1,  303,
-  304,  305,  306,   -1,   -1,  309,  361,  311,  312,  313,
-  314,  315,   -1,   -1,   -1,   -1,   -1,  321,  322,  323,
-  324,   -1,  326,  327,  328,  329,  260,  261,   -1,   -1,
-  264,   -1,   -1,  267,  338,   -1,   -1,  341,  342,   -1,
-   -1,   -1,  346,  347,  278,  349,  350,  351,  352,   -1,
-   -1,  355,  356,  357,  358,  359,  360,   -1,   -1,   -1,
-   -1,  365,  366,  367,  368,  369,  370,  371,   -1,  373,
-  374,  375,  376,  377,  257,  258,  259,   -1,   -1,   -1,
-  263,  264,   -1,   -1,   -1,   -1,  269,  270,  271,  272,
-  273,  325,   -1,  276,   -1,   -1,  279,   -1,  281,   -1,
-  283,  284,  285,  286,  287,  288,  289,  290,  291,  292,
-  293,   -1,   -1,   -1,  297,  298,  299,  300,  301,   -1,
-  303,  304,  305,  306,   -1,   -1,  309,  361,  311,  312,
-  313,  314,  315,   -1,   -1,   -1,   -1,   -1,  321,  322,
-  323,  324,   -1,  326,  327,  328,  329,  260,  261,   -1,
-   -1,  264,   -1,   -1,   -1,  338,   -1,   -1,  341,  342,
-   -1,   -1,   -1,  346,  347,  278,  349,  350,  351,  352,
-   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,   -1,
-   -1,   -1,  365,  366,  367,  368,  369,  370,  371,   -1,
-  373,  374,  375,  376,  377,  257,  258,  259,  311,   -1,
-   -1,  263,  264,   -1,  266,   -1,   -1,  269,  270,  271,
-  272,  273,  325,   -1,  276,   -1,   -1,  279,  108,  281,
-   -1,  283,  284,  285,  286,  287,  288,  289,  290,  291,
-  120,  293,   -1,  123,   -1,   -1,   -1,  299,   -1,  129,
-   -1,   -1,   -1,  305,  306,   -1,   -1,  309,  361,  311,
-  312,  313,  259,   -1,   -1,   -1,   -1,   -1,   -1,  266,
-  150,   -1,   -1,   -1,   -1,  327,  328,  329,   -1,   -1,
-   -1,   -1,   -1,  163,   -1,   -1,   -1,   -1,   -1,   -1,
-   -1,   -1,  289,  290,  291,  347,   -1,  349,  350,  351,
-   -1,   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,
-   -1,   -1,   -1,  365,  366,  367,  368,  369,   -1,   -1,
-   -1,  373,  374,  375,  376,  257,  258,  259,   -1,  326,
-   -1,  263,  264,   -1,   -1,  267,  266,  269,  270,  271,
-  272,  273,  272,   -1,  276,   -1,   -1,  279,   -1,  281,
-   -1,  283,  284,  285,  286,  287,  288,  289,  290,  291,
-  357,  293,   -1,   -1,   -1,   -1,   -1,  299,   -1,   -1,
-   -1,   -1,   -1,  305,  306,   -1,   -1,  309,   -1,  311,
-  312,  313,  259,   -1,   -1,   -1,   -1,   -1,   -1,  266,
-   -1,   -1,   -1,   -1,   -1,  327,  328,  329,   -1,   -1,
-   -1,   -1,  332,  333,  334,   -1,   -1,  337,   -1,   -1,
-   -1,   -1,  289,  290,  291,  347,   -1,  349,  350,  351,
-   -1,   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,
-   -1,   -1,   -1,  365,  366,  367,  368,  369,   -1,   -1,
-   -1,  373,  374,  375,  376,  257,  258,  259,   -1,  326,
-   -1,  263,  264,   -1,  266,   -1,  266,  269,  270,  271,
-  272,  273,  272,   -1,  276,   -1,   -1,  279,   -1,  281,
-   -1,  283,  284,  285,  286,  287,  288,  289,  290,  291,
-  357,  293,   -1,   -1,   -1,   -1,   -1,  299,   -1,   -1,
-   -1,   -1,   -1,  305,  306,   -1,   -1,  309,   -1,  311,
-  312,  313,  266,   -1,   -1,   -1,   -1,   -1,  272,   -1,
-   -1,   -1,   -1,   -1,   -1,  327,  328,  329,   -1,   -1,
-   -1,   -1,  332,  333,  334,   -1,   -1,  337,   -1,   -1,
-   -1,   -1,   -1,   -1,   -1,  347,   -1,  349,  350,  351,
-   -1,   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,
-   -1,   -1,   -1,  365,  366,  367,  368,  369,   -1,   -1,
-   -1,  373,  374,  375,  376,  257,  258,  259,  332,  333,
-  334,  263,  264,  337,  266,   -1,  266,  269,  270,  271,
-  272,  273,  272,   -1,  276,   -1,   -1,  279,   -1,  281,
-   -1,  283,  284,  285,  286,  287,  288,  289,  290,  291,
-   -1,  293,   -1,   -1,   -1,   -1,   -1,  299,   -1,   -1,
-   -1,   -1,   -1,  305,  306,   -1,   -1,  309,   -1,  311,
-  312,  313,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
-   -1,   -1,   -1,   -1,   -1,  327,  328,  329,   -1,   -1,
-   -1,   -1,  332,  333,  334,   -1,   -1,  337,   -1,   -1,
-   -1,   -1,   -1,   -1,   -1,  347,   -1,  349,  350,  351,
-   -1,   -1,   -1,  355,  356,  357,  358,  359,  360,   -1,
-   -1,   -1,   -1,  365,  366,  367,  368,  369,   -1,   -1,
-   -1,  373,  374,  375,  376,  263,  264,   -1,  266,   -1,
-   -1,  269,  270,  271,  272,  273,   -1,   -1,  276,   -1,
-   -1,  279,   -1,  281,   -1,  283,  284,  285,  286,  287,
-  288,  289,  290,  291,   -1,  293,   -1,   -1,   -1,   -1,
-   -1,  299,   -1,   -1,   -1,   -1,   -1,  305,  306,   -1,
-   -1,  309,   -1,  311,  312,  313,   -1,   -1,   -1,   -1,
-   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  327,
-  328,  329,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
-   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  347,
-   -1,  349,  350,  351,   -1,   -1,   -1,  355,  356,  357,
-  358,  359,  360,   -1,   -1,   -1,   -1,  365,  366,  367,
-  368,  369,   -1,   -1,   -1,  373,  374,  375,  376,  263,
-  264,   -1,  266,   -1,   -1,  269,  270,  271,  272,  273,
-   -1,   -1,  276,   -1,   -1,  279,   -1,  281,   -1,  283,
-  284,  285,  286,  287,  288,  289,  290,  291,   -1,  293,
-   -1,   -1,   -1,   -1,   -1,  299,   -1,   -1,   -1,   -1,
-   -1,  305,  306,   -1,   -1,  309,   -1,  311,  312,  313,
-   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
-   -1,   -1,   -1,  327,  328,  329,   -1,   -1,   -1,   -1,
-   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
-   -1,   -1,   -1,  347,   -1,  349,  350,  351,   -1,   -1,
-   -1,  355,  356,  357,  358,  359,  360,   -1,   -1,   -1,
-   -1,  365,  366,  367,  368,  369,   -1,   -1,   -1,  373,
-  374,  375,  376,  263,  264,   -1,  266,   -1,   -1,  269,
-  270,  271,  272,  273,   -1,   -1,  276,   -1,   -1,  279,
-   -1,  281,   -1,  283,  284,  285,  286,  287,  288,  289,
-  290,  291,   -1,  293,   -1,   -1,   -1,   -1,   -1,  299,
-   -1,   -1,   -1,   -1,   -1,  305,  306,   -1,   -1,  309,
-   -1,  311,  312,  313,   -1,   -1,   -1,   -1,   -1,   -1,
-   -1,   -1,   -1,   -1,   -1,   -1,  265,  327,  328,  329,
-   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
-   -1,   -1,   -1,   -1,   -1,   -1,   -1,  347,  265,  349,
-  350,  351,   -1,   -1,   -1,  355,  356,  357,  358,  359,
-  360,   -1,   -1,  302,   -1,  365,  366,  367,  368,  369,
-   -1,   -1,   -1,  373,  374,  375,  376,  316,  317,  318,
-  319,  320,   -1,   -1,  266,  302,   -1,   -1,   -1,   -1,
-   -1,  330,  331,   -1,   -1,   -1,  335,  336,   -1,  316,
-  317,  318,  319,  320,  343,  344,   -1,  289,  290,  291,
-   -1,   -1,   -1,  330,  331,   -1,   -1,   -1,  335,  336,
-  302,   -1,   -1,  362,  363,  364,  343,  344,   -1,   -1,
-   -1,   -1,   -1,  266,  316,  317,  318,  319,  320,   -1,
-   -1,   -1,   -1,   -1,   -1,  362,  363,  364,  330,  331,
-   -1,   -1,   -1,  335,  336,   -1,  289,  290,  291,   -1,
-   -1,  343,  344,   -1,   -1,   -1,   -1,   -1,   -1,  302,
-   -1,   -1,   -1,   -1,   -1,  357,   -1,   -1,   -1,   -1,
-  362,  363,  364,  316,  317,  318,  319,  320,   -1,   -1,
-   -1,   -1,   -1,   -1,   -1,   -1,   -1,  330,  331,   -1,
-   -1,   -1,  335,  336,   -1,   -1,   -1,   -1,   -1,   -1,
-  343,  344,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
-   -1,   -1,   -1,   -1,  357,   -1,   -1,   -1,   -1,  362,
-  363,  364,
-};
-#define YYFINAL 1
-#ifndef YYDEBUG
-#define YYDEBUG 0
-#endif
-#define YYMAXTOKEN 385
-#if YYDEBUG
-char *yyname[] = {
-"end-of-file",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"CSG","COMPOSITE","OBJECT_TYPE",
-"FLOAT","INTEGER","FILETYPE","OPTION","NAME","LBRACE","RBRACE","LP","RP",
-"RADIUS","RADII","COLOUR","CENTER","VERTEX","COMMA","PCENT","MATERIAL","REFI",
-"MINUS","AMBIENT","INTENSITY","LOCATION","DOLS","EQUATION","OFFFILE","BASE",
-"TOP","CONST","COEFFS","SCALE","ROTATE","TRANSLATE","TITLE","REFLECTANCE","DOT",
-"ON","OFF","LOOKAT","FIELDOFVIEW","TRANSPARENCY","RAYSPERPIXEL","BACKGROUND",
-"SIZE","MAXHITLEVEL","OUTPUT","ORDER","ABSORPTION","VREF1","VREF2","NUMRAYS",
-"OBJECT","TEXTURE","DIRECTION","ANGLE","UP","TWENTYFIVEBIT","RANGE","MAP",
-"BLENDCOLOR","SCALEFACTORS","VORTFILE","HAZECOLOUR","FOGFACTOR","RFACTOR",
-"FALLOFF","QUOTE","REPEAT","SHADOWS","COLOURFILE","VNORMALFILE","SCALEFACTOR",
-"SOURCE","AMPLITUDE","WAVELENGTH","PHASE","TURBULENCE","SQUEEZE","DAMPING",
-"SOURCERADIUS","NORMAL","COMPLEXVERTEX","SCREENSIZE","MAXTREEDEPTH","BLEND",
-"COLOURMAP","MAPVALUES","PIXELGRID","RI","COLOURBLEND","NORMALFILE",
-"BEAMDISTRIBUTION","INSIDEANGLE","PROJECTION","PERSPECTIVE","ORTHOGRAPHIC",
-"STRIP","VCOLOURFILE","TRANSFORM","MINDIST","CLIPVOLUME","HEIGHTFIELD",
-"FRAMENO","BLOCKSIZE","GAPCOLOUR","GAPSIZE","COLOURFIELD","ALPHA","GEOMX",
-"GEOMY","GEOMZ","ANTIALIASING","ADAPTIVE","BRUTE","THRESHOLD","METABALL",
-"BASIS","MAXSUBLEVEL","SUBDIVISION","GRID","KDTREE","PLUS","MULT","DIV","POWER",
-"UMINUS","EQUALS",
-};
-char *yyrule[] = {
-"$accept : input",
-"input :",
-"input : input hitem",
-"input : input object",
-"input : input statement",
-"input : input definition",
-"hitem : TITLE NAME",
-"hitem : FIELDOFVIEW expr",
-"hitem : SCREENSIZE expr COMMA expr",
-"hitem : MAXTREEDEPTH expr",
-"hitem : RAYSPERPIXEL expr",
-"hitem : HAZECOLOUR expr COMMA expr COMMA expr",
-"hitem : FOGFACTOR expr",
-"hitem : RFACTOR expr",
-"hitem : SOURCERADIUS expr",
-"hitem : PIXELGRID ON",
-"hitem : TWENTYFIVEBIT ON",
-"hitem : TWENTYFIVEBIT OFF",
-"hitem : ANTIALIASING ADAPTIVE",
-"hitem : ADAPTIVE THRESHOLD expr",
-"hitem : ANTIALIASING BRUTE",
-"hitem : UP LP expr COMMA expr COMMA expr RP",
-"hitem : LOOKAT LP expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr RP",
-"hitem : BACKGROUND expr COMMA expr COMMA expr",
-"hitem : MAXHITLEVEL expr",
-"hitem : OUTPUT FILETYPE",
-"hitem : FALLOFF expr",
-"hitem : PROJECTION PERSPECTIVE",
-"hitem : PROJECTION ORTHOGRAPHIC",
-"object : OBJECT_TYPE LBRACE body RBRACE",
-"object : OBJECT_TYPE",
-"object : COMPOSITE LBRACE compbody RBRACE",
-"$$1 :",
-"object : CSG LBRACE $$1 csgbody csgexpr RBRACE",
-"compbody :",
-"compbody : compbody transform",
-"compbody : compbody bodyitem",
-"compbody : compbody object",
-"statement : NAME EQUALS expr",
-"statement : transform",
-"statement : bodyitem",
-"$$2 :",
-"statement : SUBDIVISION GRID $$2 LBRACE input RBRACE",
-"$$3 :",
-"statement : SUBDIVISION GRID expr COMMA expr COMMA expr $$3 LBRACE input RBRACE",
-"$$4 :",
-"statement : SUBDIVISION KDTREE $$4 LBRACE input RBRACE",
-"statement : REPEAT expr LBRACE stlist RBRACE",
-"stlist :",
-"stlist : stlist transform",
-"stlist : stlist OBJECT_TYPE",
-"stlist : stlist REPEAT expr LBRACE stlist RBRACE",
-"body :",
-"body : body transform",
-"body : body bodyitem",
-"bodyitem : CENTER LP expr COMMA expr COMMA expr RP",
-"bodyitem : THRESHOLD expr",
-"bodyitem : METABALL LP expr COMMA expr COMMA expr RP COMMA expr COMMA expr",
-"bodyitem : ORDER expr",
-"bodyitem : RADIUS expr",
-"bodyitem : RADII expr COMMA expr",
-"bodyitem : RADII expr COMMA expr COMMA expr",
-"bodyitem : VERTEX vbody",
-"bodyitem : EQUATION DOLS termlist EQUALS expr DOLS",
-"bodyitem : CLIPVOLUME OBJECT_TYPE LBRACE body RBRACE",
-"bodyitem : COEFFS expr COMMA expr COMMA expr",
-"bodyitem : CONST expr",
-"bodyitem : TOP expr",
-"bodyitem : BASE expr",
-"bodyitem : HEIGHTFIELD NAME",
-"bodyitem : COLOURFIELD NAME",
-"bodyitem : OFFFILE NAME",
-"bodyitem : STRIP LBRACE vlist RBRACE",
-"bodyitem : VCOLOURFILE NAME",
-"bodyitem : COLOURFILE NAME",
-"bodyitem : VNORMALFILE NAME",
-"bodyitem : NORMALFILE NAME",
-"bodyitem : MATERIAL expr COMMA expr COMMA expr COMMA expr",
-"bodyitem : SHADOWS ON",
-"bodyitem : SHADOWS OFF",
-"$$5 :",
-"bodyitem : COLOUR $$5 variation",
-"$$6 :",
-"bodyitem : AMBIENT $$6 variation",
-"$$7 :",
-"bodyitem : REFLECTANCE $$7 variation",
-"$$8 :",
-"bodyitem : TRANSPARENCY $$8 variation",
-"$$9 :",
-"bodyitem : ALPHA $$9 variation",
-"$$10 :",
-"bodyitem : RI $$10 variation",
-"$$11 :",
-"bodyitem : ABSORPTION $$11 variation",
-"bodyitem : OPTION ON",
-"bodyitem : OPTION OFF",
-"bodyitem : TEXTURE NAME LBRACE texture_ops RBRACE",
-"bodyitem : TEXTURE NAME textitem",
-"bodyitem : NAME NAME SIZE expr COMMA expr",
-"bodyitem : LOCATION LP expr COMMA expr COMMA expr RP",
-"bodyitem : NUMRAYS expr",
-"bodyitem : INSIDEANGLE expr",
-"bodyitem : BEAMDISTRIBUTION expr",
-"bodyitem : MINDIST expr",
-"bodyitem : ANGLE expr",
-"bodyitem : DIRECTION LP expr COMMA expr COMMA expr RP",
-"bodyitem : BASIS NAME",
-"bodyitem : MAXSUBLEVEL expr",
-"bodyitem : points LBRACE expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr RBRACE",
-"points : GEOMX",
-"points : GEOMY",
-"points : GEOMZ",
-"variation : expr COMMA expr COMMA expr",
-"variation : expr",
-"variation : TEXTURE NAME LBRACE texture_ops RBRACE",
-"variation : TEXTURE NAME textitem",
-"vlist : vbody",
-"vlist : vlist vbody",
-"vbody : vitem",
-"vbody : vbody COMMA vitem",
-"vitem : LP expr COMMA expr COMMA expr RP",
-"vitem : expr COMMA expr COMMA expr",
-"vitem : expr COMMA expr COMMA expr COMMA expr",
-"transform : ROTATE LP expr COMMA expr RP",
-"transform : TRANSLATE LP expr COMMA expr COMMA expr RP",
-"transform : SCALE LP expr COMMA expr COMMA expr RP",
-"transform : TRANSFORM LBRACE expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr COMMA expr RBRACE",
-"texture_ops :",
-"texture_ops : texture_ops textitem",
-"texture_ops : texture_ops transform",
-"textitem : MAP NAME",
-"textitem : COLOURMAP LBRACE mbody RBRACE",
-"textitem : BLEND expr",
-"textitem : RANGE expr",
-"textitem : BLENDCOLOR expr COMMA expr COMMA expr",
-"textitem : SIZE expr COMMA expr",
-"textitem : SCALEFACTORS expr COMMA expr COMMA expr",
-"textitem : SCALEFACTOR expr",
-"textitem : VORTFILE NAME",
-"textitem : TURBULENCE expr",
-"textitem : SQUEEZE expr",
-"textitem : SOURCE LBRACE wbody RBRACE",
-"textitem : GAPSIZE expr",
-"textitem : GAPCOLOUR expr COMMA expr COMMA expr",
-"textitem : BLOCKSIZE expr COMMA expr COMMA expr",
-"mbody : mitem",
-"mbody : mbody COMMA mitem",
-"mitem : expr COMMA expr COMMA expr",
-"wbody :",
-"wbody : wbody witem",
-"witem : CENTER LP expr COMMA expr COMMA expr RP",
-"witem : WAVELENGTH expr",
-"witem : AMPLITUDE expr",
-"witem : PHASE expr",
-"witem : DAMPING expr",
-"csgbody :",
-"csgbody : csgbody bodyitem",
-"csgbody : csgbody transform",
-"csgbody : csgbody definition",
-"definition : OBJECT_TYPE NAME LBRACE body RBRACE",
-"$$12 :",
-"definition : CSG NAME LBRACE $$12 csgbody csgexpr RBRACE",
-"definition : COMPOSITE NAME LBRACE compbody RBRACE",
-"csgexpr : OBJECT_TYPE",
-"csgexpr : csgexpr PLUS csgexpr",
-"csgexpr : csgexpr MULT csgexpr",
-"csgexpr : csgexpr MINUS csgexpr",
-"csgexpr : LP csgexpr RP",
-"csgexpr : NAME",
-"termlist : term",
-"termlist : termlist termlist",
-"termlist : LP termlist RP",
-"termlist : LP termlist RP POWER LBRACE expr RBRACE",
-"termlist : termlist PLUS termlist",
-"termlist : termlist MINUS termlist",
-"term : NAME",
-"term : FLOAT",
-"term : INTEGER",
-"term : NAME POWER LBRACE expr RBRACE",
-"expr : FLOAT",
-"expr : INTEGER",
-"expr : FRAMENO",
-"expr : QUOTE NAME QUOTE",
-"expr : NAME",
-"expr : expr PLUS expr",
-"expr : expr MINUS expr",
-"expr : expr MULT expr",
-"expr : expr DIV expr",
-"expr : MINUS expr",
-};
-#endif
-#ifdef YYSTACKSIZE
-#undef YYMAXDEPTH
-#define YYMAXDEPTH YYSTACKSIZE
-#else
-#ifdef YYMAXDEPTH
-#define YYSTACKSIZE YYMAXDEPTH
-#else
-#define YYSTACKSIZE 500
-#define YYMAXDEPTH 500
-#endif
-#endif
-int yydebug;
-int yynerrs;
-int yyerrflag;
-int yychar;
-short *yyssp;
-YYSTYPE *yyvsp;
-YYSTYPE yyval;
-YYSTYPE yylval;
-short yyss[YYSTACKSIZE];
-YYSTYPE yyvs[YYSTACKSIZE];
-#define yystacksize YYSTACKSIZE
-#define YYABORT goto yyabort
-#define YYREJECT goto yyabort
-#define YYACCEPT goto yyaccept
-#define YYERROR goto yyerrlab
-int
-yyparse()
-{
-    register int yym, yyn, yystate;
-#if YYDEBUG
-    register char *yys;
-    extern char *getenv();
-
-    if (yys = getenv("YYDEBUG"))
-    {
-        yyn = *yys;
-        if (yyn >= '0' && yyn <= '9')
-            yydebug = yyn - '0';
-    }
-#endif
-
-    yynerrs = 0;
-    yyerrflag = 0;
-    yychar = (-1);
-
-    yyssp = yyss;
-    yyvsp = yyvs;
-    *yyssp = yystate = 0;
-
-yyloop:
-    if (yyn = yydefred[yystate]) goto yyreduce;
-    if (yychar < 0)
-    {
-        if ((yychar = yylex()) < 0) yychar = 0;
-#if YYDEBUG
-        if (yydebug)
-        {
-            yys = 0;
-            if (yychar <= YYMAXTOKEN) yys = yyname[yychar];
-            if (!yys) yys = "illegal-symbol";
-            printf("%sdebug: state %d, reading %d (%s)\n",
-                    YYPREFIX, yystate, yychar, yys);
-        }
-#endif
-    }
-    if ((yyn = yysindex[yystate]) && (yyn += yychar) >= 0 &&
-            yyn <= YYTABLESIZE && yycheck[yyn] == yychar)
-    {
-#if YYDEBUG
-        if (yydebug)
-            printf("%sdebug: state %d, shifting to state %d\n",
-                    YYPREFIX, yystate, yytable[yyn]);
-#endif
-        if (yyssp >= yyss + yystacksize - 1)
-        {
-            goto yyoverflow;
-        }
-        *++yyssp = yystate = yytable[yyn];
-        *++yyvsp = yylval;
-        yychar = (-1);
-        if (yyerrflag > 0)  --yyerrflag;
-        goto yyloop;
-    }
-    if ((yyn = yyrindex[yystate]) && (yyn += yychar) >= 0 &&
-            yyn <= YYTABLESIZE && yycheck[yyn] == yychar)
-    {
-        yyn = yytable[yyn];
-        goto yyreduce;
-    }
-    if (yyerrflag) goto yyinrecovery;
-#ifdef lint
-    goto yynewerror;
-#endif
-yynewerror:
-    yyerror("syntax error");
-#ifdef lint
-    goto yyerrlab;
-#endif
-yyerrlab:
-    ++yynerrs;
-yyinrecovery:
-    if (yyerrflag < 3)
-    {
-        yyerrflag = 3;
-        for (;;)
-        {
-            if ((yyn = yysindex[*yyssp]) && (yyn += YYERRCODE) >= 0 &&
-                    yyn <= YYTABLESIZE && yycheck[yyn] == YYERRCODE)
-            {
-#if YYDEBUG
-                if (yydebug)
-                    printf("%sdebug: state %d, error recovery shifting\
- to state %d\n", YYPREFIX, *yyssp, yytable[yyn]);
-#endif
-                if (yyssp >= yyss + yystacksize - 1)
-                {
-                    goto yyoverflow;
-                }
-                *++yyssp = yystate = yytable[yyn];
-                *++yyvsp = yylval;
-                goto yyloop;
-            }
-            else
-            {
-#if YYDEBUG
-                if (yydebug)
-                    printf("%sdebug: error recovery discarding state %d\n",
-                            YYPREFIX, *yyssp);
-#endif
-                if (yyssp <= yyss) goto yyabort;
-                --yyssp;
-                --yyvsp;
-            }
-        }
-    }
-    else
-    {
-        if (yychar == 0) goto yyabort;
-#if YYDEBUG
-        if (yydebug)
-        {
-            yys = 0;
-            if (yychar <= YYMAXTOKEN) yys = yyname[yychar];
-            if (!yys) yys = "illegal-symbol";
-            printf("%sdebug: state %d, error recovery discards token %d (%s)\n",
-                    YYPREFIX, yystate, yychar, yys);
-        }
-#endif
-        yychar = (-1);
-        goto yyloop;
-    }
-yyreduce:
-#if YYDEBUG
-    if (yydebug)
-        printf("%sdebug: state %d, reducing by rule %d (%s)\n",
-                YYPREFIX, yystate, yyn, yyrule[yyn]);
-#endif
-    yym = yylen[yyn];
-    yyval = yyvsp[1-yym];
-    switch (yyn)
-    {
-case 3:
-#line 139 "gram.y"
-{
-		object	*obj, *head;
-
-		if ((head = objectinit(yyvsp[0].y_det->u.obj.sym, yyvsp[0].y_det->u.obj.det)) != (object *)NULL) {
-			for (obj = head; obj->nxt != (object *)NULL; obj = obj->nxt)	
-				;
-
-			obj->nxt = *oblistsp;
-			*oblistsp = head;
-		}
-
-		objdefined = TRUE;
-
-		free(yyvsp[0].y_det);
-	  }
-break;
-case 5:
-#line 156 "gram.y"
-{
-		objdefined = TRUE;
-
-		free(yyvsp[0].y_det);
-	  }
-break;
-case 6:
-#line 164 "gram.y"
-{
-		title = yyvsp[0].y_str;
-	  }
-break;
-case 7:
-#line 168 "gram.y"
-{
-		float	val;
-
-		val = eval_fexpr(yyvsp[0].y_exp);
-
-		if (val == 0.0 || val == 360.0)
-			fatal("art: idiotic angle in field of view.\n");
-
-		focallength = focallength / tan(M_PI / 360.0 * val);
-	  }
-break;
-case 8:
-#line 179 "gram.y"
-{
-		screenx = eval_fexpr(yyvsp[-2].y_exp) / 2.0;
-		screeny = eval_fexpr(yyvsp[0].y_exp) / 2.0;
-	  }
-break;
-case 9:
-#line 184 "gram.y"
-{
-		maxtreedepth = eval_iexpr(yyvsp[0].y_exp);
-	  }
-break;
-case 10:
-#line 188 "gram.y"
-{
-		raysperpix = eval_iexpr(yyvsp[0].y_exp);
-		pixelgrid = (raysperpix > 1);
-	  }
-break;
-case 11:
-#line 193 "gram.y"
-{
-		hazecolour.r = eval_fexpr(yyvsp[-4].y_exp);
-		hazecolour.g = eval_fexpr(yyvsp[-2].y_exp);
-		hazecolour.b = eval_fexpr(yyvsp[0].y_exp);
-	  }
-break;
-case 12:
-#line 199 "gram.y"
-{
-		fogfactor = eval_fexpr(yyvsp[0].y_exp);
-	  }
-break;
-case 13:
-#line 203 "gram.y"
-{
-		rfactor = eval_fexpr(yyvsp[0].y_exp);
-	  }
-break;
-case 14:
-#line 207 "gram.y"
-{
-		sourceradius = eval_fexpr(yyvsp[0].y_exp);
-	  }
-break;
-case 15:
-#line 211 "gram.y"
-{
-		pixelgrid = TRUE;
-	  }
-break;
-case 16:
-#line 215 "gram.y"
-{
-		twentyfivebit(TRUE);
-	  }
-break;
-case 17:
-#line 219 "gram.y"
-{
-		twentyfivebit(FALSE);
-	  }
-break;
-case 18:
-#line 223 "gram.y"
-{
-		adaptive = TRUE;
-	  }
-break;
-case 19:
-#line 227 "gram.y"
-{
-		aathreshold = eval_fexpr(yyvsp[0].y_exp);
-	  }
-break;
-case 20:
-#line 231 "gram.y"
-{
-		adaptive = FALSE;
-	  }
-break;
-case 21:
-#line 235 "gram.y"
-{
-		up.x = eval_fexpr(yyvsp[-5].y_exp);
-		up.y = eval_fexpr(yyvsp[-3].y_exp);
-		up.z = eval_fexpr(yyvsp[-1].y_exp);
-	  }
-break;
-case 22:
-#line 241 "gram.y"
-{
-		vector	t, u, s, eye;
-		matrix	m, tmp;
-		double	val, vy, vz, sinval, cosval;
-
-		/*
-		 * apply the twist
-		 */
-		val = eval_fexpr(yyvsp[-1].y_exp) * M_PI / 180.0;
-		sinval = sin(val);
-		cosval = cos(val);
-		mident4(m);
-		m[0][0] = cosval;
-		m[0][1] = -sinval;
-		m[1][0] = sinval;
-		m[1][1] = cosval;
-		mcpy4(tmp, trans);
-		mmult4(trans, tmp, m);
-
-		/*
-		 * calculate the lookat
-		 */
-		eye.x = eval_fexpr(yyvsp[-13].y_exp);
-		eye.y = eval_fexpr(yyvsp[-11].y_exp);
-		eye.z = eval_fexpr(yyvsp[-9].y_exp);
-
-		t.x = eye.x - eval_fexpr(yyvsp[-7].y_exp);
-		t.y = eye.y - eval_fexpr(yyvsp[-5].y_exp);
-		t.z = eye.z - eval_fexpr(yyvsp[-3].y_exp);
-
-		u.x = up.x;
-		u.y = up.y;
-		u.z = up.z;
-
-		normalise(t);
-
-		normalise(u);
-
-		vz = dprod(t, u);
-
-		if (fabs(vz) >= 1.0)
-			fatal("art: up vector and direction of view are the same.\n");
-
-		vy = sqrt(1.0 - vz * vz);
-
-		u.x = (u.x - vz * t.x) / vy;
-		u.y = (u.y - vz * t.y) / vy;
-		u.z = (u.z - vz * t.z) / vy;
-
-		xprod(s, u, t);
-
-		mident4(m);
-
-		m[0][0] = s.x;
-		m[0][1] = s.y;
-		m[0][2] = s.z;
-
-		m[1][0] = u.x;
-		m[1][1] = u.y;
-		m[1][2] = u.z;
-
-		m[2][0] = t.x;
-		m[2][1] = t.y;
-		m[2][2] = t.z;
-
-		mcpy4(tmp, trans);
-		mmult4(trans, tmp, m);
-
-		mident4(m);
-		m[3][0] = eye.x;
-		m[3][1] = eye.y;
-		m[3][2] = eye.z;
-		mcpy4(tmp, trans);
-		mmult4(trans, tmp, m);
-					/* set up initial trans data */
-		mstackp->d.omused = TRUE;
-		calctransforms(mstackp);
-	  }
-break;
-case 23:
-#line 320 "gram.y"
-{
-		backcol.r = eval_fexpr(yyvsp[-4].y_exp);
-		backcol.g = eval_fexpr(yyvsp[-2].y_exp);
-		backcol.b = eval_fexpr(yyvsp[0].y_exp);
-	  }
-break;
-case 24:
-#line 326 "gram.y"
-{
-		maxhitlevel = eval_iexpr(yyvsp[0].y_exp);
-	  }
-break;
-case 25:
-#line 330 "gram.y"
-{
-		filetype = yyvsp[0].y_int;
-	  }
-break;
-case 26:
-#line 334 "gram.y"
-{
-		falloff = eval_fexpr(yyvsp[0].y_exp);
-	  }
-break;
-case 27:
-#line 338 "gram.y"
-{
-		perspective = TRUE;
-	  }
-break;
-case 28:
-#line 342 "gram.y"
-{
-		perspective = FALSE;
-	  }
-break;
-case 29:
-#line 348 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = OBJECT;
-		yyval.y_det->u.obj.sym = yyvsp[-3].y_sym;
-		yyval.y_det->u.obj.det = yyvsp[-1].y_det;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 30:
-#line 356 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = OBJECT;
-		yyval.y_det->u.obj.sym = yyvsp[0].y_sym;
-		yyval.y_det->u.obj.det = (details *)NULL;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 31:
-#line 364 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = COMP_OBJ;
-		yyval.y_det->u.obj.sym = (symbol *)NULL;
-		yyval.y_det->u.obj.det = yyvsp[-1].y_det;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 32:
-#line 372 "gram.y"
-{
-		if (ostackp->nxt == (objst *)NULL) {
-			ostackp->nxt = (objst *)smalloc(sizeof(objst));
-			ostackp->nxt->lst = ostackp;
-			ostackp->nxt->nxt = (objst *)NULL;
-		}
-
-		ostackp = ostackp->nxt;
-		ostackp->sym = (symbol *)NULL;
-	  }
-break;
-case 33:
-#line 383 "gram.y"
-{
-		details	*d;
-		symbol	*s;
-
-		ostackp = ostackp->lst;
-
-		d = (details *)smalloc(sizeof(details));
-		d->type = yyvsp[-2].y_det->type;
-		d->u.csgobj.tree = yyvsp[-1].y_csg;
-		d->u.csgobj.det = yyvsp[-2].y_det;
-		d->nxt = (details *)NULL;
-
-		s = (symbol *)smalloc(sizeof(symbol));
-		s->type = CSG_OBJ;
-		s->u.det = d;
-
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = OBJECT;
-		yyval.y_det->u.obj.sym = s;
-		yyval.y_det->u.obj.det = (details *)NULL;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 34:
-#line 408 "gram.y"
-{
-		yyval.y_det = (details *)NULL;
-	  }
-break;
-case 35:
-#line 412 "gram.y"
-{
-		details	*d;
-
-		if (yyvsp[-1].y_det != (details *)NULL) {
-			for (d = yyvsp[-1].y_det; d->nxt != (details *)NULL; d = d->nxt)
-				;
-			d->nxt = yyvsp[0].y_det;
-			yyval.y_det = yyvsp[-1].y_det;
-		} else
-			yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 36:
-#line 424 "gram.y"
-{
-		details	*d;
-
-		if (yyvsp[-1].y_det != (details *)NULL) {
-			for (d = yyvsp[-1].y_det; d->nxt != (details *)NULL; d = d->nxt)
-				;
-			d->nxt = yyvsp[0].y_det;
-			yyval.y_det = yyvsp[-1].y_det;
-		} else
-			yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 37:
-#line 436 "gram.y"
-{
-		details	*d;
-
-		if (yyvsp[-1].y_det != (details *)NULL) {
-			for (d = yyvsp[-1].y_det; d->nxt != (details *)NULL; d = d->nxt)
-				;
-			d->nxt = yyvsp[0].y_det;
-			yyval.y_det = yyvsp[-1].y_det;
-		} else
-			yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 38:
-#line 450 "gram.y"
-{
-		defvar(yyvsp[-2].y_str, yyvsp[0].y_exp);
-	  }
-break;
-case 39:
-#line 454 "gram.y"
-{
-		switch (yyvsp[0].y_det->type) {
-		case TRANSLATE:
-			translate(yyvsp[0].y_det->u.v.x, yyvsp[0].y_det->u.v.y, yyvsp[0].y_det->u.v.z);
-			break;
-		case SCALE:
-			scale(yyvsp[0].y_det->u.v.x, yyvsp[0].y_det->u.v.y, yyvsp[0].y_det->u.v.z);
-			break;
-		case ROTATE:
-			rotate(yyvsp[0].y_det->u.rot.ang, yyvsp[0].y_det->u.rot.axis);
-			break;
-		case TRANSFORM:
-			transform(*yyvsp[0].y_det->u.trans.m);
-			free(yyvsp[0].y_det->u.trans.m);
-			break;
-		default:
-			fatal("art: bad transform type in switch.\n");
-		}
-
-		free(yyvsp[0].y_det);
-	  }
-break;
-case 40:
-#line 476 "gram.y"
-{
-		surface	*s;
-
-			/*
-			 * don't want to change someone else's
-			 * material properties
-			 */
-		if (objdefined) {
-			s = (surface *)smalloc(sizeof(surface));
-			*s = *astackp->d.s;
-			astackp->d.s = s;
-			objdefined = FALSE;
-		} else
-			s = astackp->d.s;
-
-		switch (yyvsp[0].y_det->type) {
-		case COLOUR:
-			s->c.r = yyvsp[0].y_det->u.c.r;
-			s->c.g = yyvsp[0].y_det->u.c.g;
-			s->c.b = yyvsp[0].y_det->u.c.b;
-			break;
-		case AMBIENT:
-			s->a.r = yyvsp[0].y_det->u.c.r;
-			s->a.g = yyvsp[0].y_det->u.c.g;
-			s->a.b = yyvsp[0].y_det->u.c.b;
-			break;
-		case TEXTURE:
-			yyvsp[0].y_det->u.txt->nxt = astackp->d.txtlist;
-			astackp->d.txtlist = yyvsp[0].y_det->u.txt;
-			break;
-		case MATERIAL:
-			s->ri = yyvsp[0].y_det->u.mat.ri;
-			s->kd = yyvsp[0].y_det->u.mat.kd;
-			s->ks = yyvsp[0].y_det->u.mat.ks;
-			s->ksexp = yyvsp[0].y_det->u.mat.ksexp;
-			if (s->ri == 0.0)
-				s->ri = 1.0;
-			break;
-		case REFLECTANCE:
-			s->refl = yyvsp[0].y_det->u.c;
-			break;
-		case TRANSPARENCY:
-			s->trans = yyvsp[0].y_det->u.c;
-			break;
-		case ABSORPTION:
-			s->falloff = yyvsp[0].y_det->u.f;
-			break;
-		case ON:
-			astackp->d.options |= yyvsp[0].y_det->u.i;
-			break;
-		case OFF:
-			astackp->d.options &= ~yyvsp[0].y_det->u.i;
-			break;
-		case SHADOWS:
-			astackp->d.s->shadows = yyvsp[0].y_det->u.i;
-			break;
-		default:
-			fatal("art: bad statement type in switch.\n");
-		}
-
-		free(yyvsp[0].y_det);
-	  }
-break;
-case 41:
-#line 539 "gram.y"
-{ 
-		oblistsp++;
-		*oblistsp = (object *)NULL;
-	  }
-break;
-case 42:
-#line 544 "gram.y"
-{
-		object	*divobjs, *otherobjs, *nexto, *o, *obj;
-
-		divobjs = otherobjs = (object *)NULL;
-
-		for (o = *oblistsp; o != (object *)NULL; o = nexto) {
-			nexto = o->nxt;
-			o->lastray.raynumber = 0;
-						/* algebraic surface or contains one */
-			if (o->type == ALGEBRAIC || o->bb.max[X] == huge_dist) {
-				o->nxt = otherobjs;
-				otherobjs = o;
-			} else if (o->type == NULL_OBJ)
-				free(o);
-			else {
-				o->nxt = divobjs;
-				divobjs = o;
-			}
-		}
-
-		oblistsp--;
-
-		obj = gridinit(divobjs);
-		obj->nxt = otherobjs;
-
-		/*
-		 * add our new composite to the object stack
-		 */
-		if (*oblistsp != (object *)NULL) {
-			for (o = *oblistsp; o->nxt != (object *)NULL; o = o->nxt)	
-				;
-			o->nxt = obj;
-		} else {
-			*oblistsp = obj;
-		}
-
-		/*
-		 * add the interior objects to the general object list.
-		 */
-		if (subobjs != (object *)NULL) {
-			for (o = subobjs; o->nxt != (object *)NULL; o = o->nxt)	
-				;
-			o->nxt = divobjs;
-		} else {
-			subobjs = divobjs;
-		}
-	  }
-break;
-case 43:
-#line 592 "gram.y"
-{
-		oblistsp++;
-		*oblistsp = (object *)NULL;
-	  }
-break;
-case 44:
-#line 597 "gram.y"
-{
-		object	*divobjs, *otherobjs, *nexto, *o, *obj;
-
-		divobjs = otherobjs = (object *)NULL;
-
-		for (o = *oblistsp; o != (object *)NULL; o = nexto) {
-			nexto = o->nxt;
-			o->lastray.raynumber = 0;
-						/* algebraic surface or contains one */
-			if (o->type == ALGEBRAIC || o->bb.max[X] == huge_dist) {
-				o->nxt = otherobjs;
-				otherobjs = o;
-			} else if (o->type == NULL_OBJ)
-				free(o);
-			else {
-				o->nxt = divobjs;
-				divobjs = o;
-			}
-		}
-
-		oblistsp--;
-
-		obj = gridinit(divobjs);
-		obj->nxt = otherobjs;
-
-		/*
-		 * add our new composite to the object stack
-		 */
-		if (*oblistsp != (object *)NULL) {
-			for (o = *oblistsp; o->nxt != (object *)NULL; o = o->nxt)	
-				;
-			o->nxt = obj;
-		} else {
-			*oblistsp = obj;
-		}
-
-		/*
-		 * add the interior objects to the general object list.
-		 */
-		if (subobjs != (object *)NULL) {
-			for (o = subobjs; o->nxt != (object *)NULL; o = o->nxt)	
-				;
-			o->nxt = divobjs;
-		} else {
-			subobjs = divobjs;
-		}
-	  }
-break;
-case 45:
-#line 645 "gram.y"
-{
-		oblistsp++;
-		*oblistsp = (object *)NULL;
-	  }
-break;
-case 46:
-#line 650 "gram.y"
-{
-		object	*divobjs, *otherobjs, *nexto, *o, *obj;
-
-		divobjs = otherobjs = (object *)NULL;
-
-		for (o = *oblistsp; o != (object *)NULL; o = nexto) {
-			nexto = o->nxt;
-			o->lastray.raynumber = 0;
-						/* algebraic surface or contains one */
-			if (o->type == ALGEBRAIC || o->bb.max[X] == huge_dist) {
-				o->nxt = otherobjs;
-				otherobjs = o;
-			} else if (o->type == NULL_OBJ)
-				free(o);
-			else {
-				o->nxt = divobjs;
-				divobjs = o;
-			}
-		}
-
-		oblistsp--;
-
-		obj = treeinit(divobjs);
-		obj->nxt = otherobjs;
-
-		/*
-		 * add our new composite to the object stack
-		 */
-		if (*oblistsp != (object *)NULL) {
-			for (o = *oblistsp; o->nxt != (object *)NULL; o = o->nxt)	
-				;
-			o->nxt = obj;
-		} else {
-			*oblistsp = obj;
-		}
-
-		/*
-		 * add the interior objects to the general object list.
-		 */
-		if (subobjs != (object *)NULL) {
-			for (o = subobjs; o->nxt != (object *)NULL; o = o->nxt)	
-				;
-			o->nxt = divobjs;
-		} else {
-			subobjs = divobjs;
-		}
-	  }
-break;
-case 47:
-#line 698 "gram.y"
-{
-		dorepeat(yyvsp[-3].y_exp, yyvsp[-1].y_det);
-	  }
-break;
-case 48:
-#line 704 "gram.y"
-{
-		yyval.y_det = (details *)NULL;
-	  }
-break;
-case 49:
-#line 708 "gram.y"
-{
-		yyvsp[0].y_det->nxt = yyvsp[-1].y_det;
-		yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 50:
-#line 713 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-
-		yyval.y_det->type = OBJECT;
-		yyval.y_det->u.obj.sym = yyvsp[0].y_sym;
-		yyval.y_det->u.obj.det = (details *)NULL;
-		yyval.y_det->nxt = yyvsp[-1].y_det;
-	  }
-break;
-case 51:
-#line 722 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-
-		yyval.y_det->type = REPEAT;
-		yyval.y_det->u.rpt.expr = yyvsp[-3].y_exp;
-		yyval.y_det->u.rpt.stmt = yyvsp[-1].y_det;
-		yyval.y_det->nxt = yyvsp[-5].y_det;
-	  }
-break;
-case 52:
-#line 734 "gram.y"
-{
-		yyval.y_det = (details *)NULL;
-	  }
-break;
-case 53:
-#line 738 "gram.y"
-{
-		details	*d;
-
-		if (yyvsp[-1].y_det != (details *)NULL) {
-			for (d = yyvsp[-1].y_det; d->nxt != (details *)NULL; d = d->nxt)
-				;
-			d->nxt = yyvsp[0].y_det;
-			yyval.y_det = yyvsp[-1].y_det;
-		} else
-			yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 54:
-#line 750 "gram.y"
-{
-		details	*d;
-
-		if (yyvsp[-1].y_det != (details *)NULL) {
-			for (d = yyvsp[-1].y_det; d->nxt != (details *)NULL; d = d->nxt)
-				;
-			d->nxt = yyvsp[0].y_det;
-			yyval.y_det = yyvsp[-1].y_det;
-		} else
-			yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 55:
-#line 764 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = CENTER;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-5].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-3].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[-1].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 56:
-#line 773 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = THRESHOLD;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 57:
-#line 780 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = METABALL;
-		yyval.y_det->u.mb = (mball *)smalloc(sizeof(mball));
-		yyval.y_det->u.mb->v.x = eval_fexpr(yyvsp[-9].y_exp);
-		yyval.y_det->u.mb->v.y = eval_fexpr(yyvsp[-7].y_exp);
-		yyval.y_det->u.mb->v.z = eval_fexpr(yyvsp[-5].y_exp);
-		yyval.y_det->u.mb->r = eval_fexpr(yyvsp[-2].y_exp);
-		yyval.y_det->u.mb->s = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 58:
-#line 792 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = ORDER;
-		yyval.y_det->u.i = eval_iexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 59:
-#line 799 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = RADIUS;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 60:
-#line 806 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = RADII;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-2].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 61:
-#line 814 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = RADII;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-4].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-2].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 62:
-#line 823 "gram.y"
-{
-		if (yyvsp[0].y_det->nxt == (details *)NULL) {
-			yyvsp[0].y_det->type = VERTEX;
-			yyval.y_det = yyvsp[0].y_det;
-		} else {
-			yyval.y_det = (details *)smalloc(sizeof(details));
-			yyval.y_det->type = COMPLEXVERTEX;
-			yyval.y_det->u.det = yyvsp[0].y_det;
-			yyval.y_det->nxt = (details *)NULL;
-		}
-	  }
-break;
-case 63:
-#line 835 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = EQUATION;
-		yyval.y_det->u.t = (term *)smalloc(sizeof(term));
-		yyval.y_det->u.t->coef = -eval_fexpr(yyvsp[-1].y_exp);
-		yyval.y_det->u.t->xp = 0;
-		yyval.y_det->u.t->yp = 0;
-		yyval.y_det->u.t->zp = 0;
-		yyval.y_det->u.t->nxt = yyvsp[-3].y_trm;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 64:
-#line 847 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = OBJECT;
-		yyval.y_det->u.obj.sym = yyvsp[-3].y_sym;
-		yyval.y_det->u.obj.det = yyvsp[-1].y_det;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 65:
-#line 855 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = COEFFS;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-4].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-2].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 66:
-#line 864 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = CONST;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 67:
-#line 871 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = TOP;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 68:
-#line 878 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = BASE;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 69:
-#line 885 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = HEIGHTFIELD;
-		yyval.y_det->u.s = yyvsp[0].y_str;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 70:
-#line 892 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = COLOURFIELD;
-		yyval.y_det->u.s = yyvsp[0].y_str;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 71:
-#line 899 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = OFFFILE;
-		yyval.y_det->u.s = yyvsp[0].y_str;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 72:
-#line 906 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = STRIP;
-		yyval.y_det->u.det = yyvsp[-1].y_det;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 73:
-#line 913 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = VCOLOURFILE;
-		yyval.y_det->u.s = yyvsp[0].y_str;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 74:
-#line 920 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = COLOURFILE;
-		yyval.y_det->u.s = yyvsp[0].y_str;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 75:
-#line 927 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = VNORMALFILE;
-		yyval.y_det->u.s = yyvsp[0].y_str;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 76:
-#line 934 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = NORMALFILE;
-		yyval.y_det->u.s = yyvsp[0].y_str;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 77:
-#line 941 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = MATERIAL;
-		yyval.y_det->u.mat.ri = eval_fexpr(yyvsp[-6].y_exp);
-		yyval.y_det->u.mat.kd = eval_fexpr(yyvsp[-4].y_exp);
-		yyval.y_det->u.mat.ks = eval_fexpr(yyvsp[-2].y_exp);
-		yyval.y_det->u.mat.ksexp = eval_iexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 78:
-#line 951 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = SHADOWS;
-		yyval.y_det->u.i = TRUE;
-		yyval.y_det->nxt = (details *)NULL;
-
-		astackp->d.shadows = TRUE;
-	  }
-break;
-case 79:
-#line 960 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = SHADOWS;
-		yyval.y_det->u.i = FALSE;
-		yyval.y_det->nxt = (details *)NULL;
-
-		astackp->d.shadows = FALSE;
-	  }
-break;
-case 80:
-#line 968 "gram.y"
-{ fieldtype = COLOUR; }
-break;
-case 81:
-#line 969 "gram.y"
-{
-		yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 82:
-#line 972 "gram.y"
-{ fieldtype = AMBIENT; }
-break;
-case 83:
-#line 973 "gram.y"
-{
-		yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 84:
-#line 976 "gram.y"
-{ fieldtype = REFLECTANCE; }
-break;
-case 85:
-#line 977 "gram.y"
-{
-		yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 86:
-#line 980 "gram.y"
-{ fieldtype = TRANSPARENCY; }
-break;
-case 87:
-#line 981 "gram.y"
-{
-		yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 88:
-#line 984 "gram.y"
-{ fieldtype = ALPHA; }
-break;
-case 89:
-#line 985 "gram.y"
-{
-		yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 90:
-#line 988 "gram.y"
-{ fieldtype = RI; }
-break;
-case 91:
-#line 989 "gram.y"
-{
-		yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 92:
-#line 992 "gram.y"
-{ fieldtype = ABSORPTION; }
-break;
-case 93:
-#line 993 "gram.y"
-{
-		yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 94:
-#line 997 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = ON;
-		yyval.y_det->u.i = yyvsp[-1].y_int;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 95:
-#line 1004 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = OFF;
-		yyval.y_det->u.i = yyvsp[-1].y_int;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 96:
-#line 1011 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = TEXTURE;
-		yyval.y_det->u.txt = textureinit(yyvsp[-3].y_str, yyvsp[-1].y_det, COLOUR);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 97:
-#line 1018 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = TEXTURE;
-		yyval.y_det->u.txt = textureinit(yyvsp[-1].y_str, yyvsp[0].y_det, COLOUR);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 98:
-#line 1025 "gram.y"
-{
-		details	*d1, *d2;
-
-		d1 = (details *)smalloc(sizeof(details));
-		d1->type = VORTFILE;
-		d1->u.s = yyvsp[-4].y_str;
-
-		d2 = (details *)smalloc(sizeof(details));
-		d2->type = SIZE;
-		d2->u.v.x = eval_fexpr(yyvsp[-2].y_exp);
-		d2->u.v.y = eval_fexpr(yyvsp[0].y_exp);
-
-		d1->nxt = d2;
-		d2->nxt = (details *)NULL;
-
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = TEXTURE;
-		yyval.y_det->u.txt = textureinit("tile", d1, COLOUR);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 99:
-#line 1046 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = CENTER;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-5].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-3].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[-1].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 100:
-#line 1055 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = NUMRAYS;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 101:
-#line 1062 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = INSIDEANGLE;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 102:
-#line 1069 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = BEAMDISTRIBUTION;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 103:
-#line 1076 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = MINDIST;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 104:
-#line 1083 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = ANGLE;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 105:
-#line 1090 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = DIRECTION;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-5].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-3].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[-1].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 106:
-#line 1099 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = BASIS;
-		yyval.y_det->u.s = yyvsp[0].y_str;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 107:
-#line 1106 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = MAXSUBLEVEL;
-		yyval.y_det->u.i = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 108:
-#line 1116 "gram.y"
-{
-		matrix	m;
-
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = yyvsp[-33].y_int;
-
-		mident4(m);
-
-		m[0][0] = eval_fexpr(yyvsp[-31].y_exp);
-		m[0][1] = eval_fexpr(yyvsp[-29].y_exp);
-		m[0][2] = eval_fexpr(yyvsp[-27].y_exp);
-		m[0][3] = eval_fexpr(yyvsp[-25].y_exp);
-
-		m[1][0] = eval_fexpr(yyvsp[-23].y_exp);
-		m[1][1] = eval_fexpr(yyvsp[-21].y_exp);
-		m[1][2] = eval_fexpr(yyvsp[-19].y_exp);
-		m[1][3] = eval_fexpr(yyvsp[-17].y_exp);
-
-		m[2][0] = eval_fexpr(yyvsp[-15].y_exp);
-		m[2][1] = eval_fexpr(yyvsp[-13].y_exp);
-		m[2][2] = eval_fexpr(yyvsp[-11].y_exp);
-		m[2][3] = eval_fexpr(yyvsp[-9].y_exp);
-
-		m[3][0] = eval_fexpr(yyvsp[-7].y_exp);
-		m[3][1] = eval_fexpr(yyvsp[-5].y_exp);
-		m[3][2] = eval_fexpr(yyvsp[-3].y_exp);
-		m[3][3] = eval_fexpr(yyvsp[-1].y_exp);
-
-		yyval.y_det->u.trans.m = (matrix *)smalloc(sizeof(matrix));
-
-		mcpy4(*yyval.y_det->u.trans.m, m);
-
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 109:
-#line 1153 "gram.y"
-{
-		yyval.y_int = GEOMX;
-	  }
-break;
-case 110:
-#line 1157 "gram.y"
-{
-		yyval.y_int = GEOMY;
-	  }
-break;
-case 111:
-#line 1161 "gram.y"
-{
-		yyval.y_int = GEOMZ;
-	  }
-break;
-case 112:
-#line 1167 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = fieldtype;
-		yyval.y_det->u.c.r = eval_fexpr(yyvsp[-4].y_exp);
-		yyval.y_det->u.c.g = eval_fexpr(yyvsp[-2].y_exp);
-		yyval.y_det->u.c.b = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 113:
-#line 1176 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = fieldtype;
-		yyval.y_det->u.c.r = yyval.y_det->u.c.g = yyval.y_det->u.c.b = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 114:
-#line 1183 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = TEXTURE;
-		yyval.y_det->u.txt = textureinit(yyvsp[-3].y_str, yyvsp[-1].y_det, fieldtype);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 115:
-#line 1190 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = TEXTURE;
-		yyval.y_det->u.txt = textureinit(yyvsp[-1].y_str, yyvsp[0].y_det, fieldtype);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 116:
-#line 1199 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		if (yyvsp[0].y_det->nxt == (details *)NULL)
-			yyval.y_det->type = VERTEX;
-		else
-			yyval.y_det->type = COMPLEXVERTEX;
-		yyval.y_det->u.det = yyvsp[0].y_det;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 117:
-#line 1209 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		if (yyvsp[0].y_det->nxt == (details *)NULL)
-			yyval.y_det->type = VERTEX;
-		else
-			yyval.y_det->type = COMPLEXVERTEX;
-		yyval.y_det->u.det = yyvsp[0].y_det;
-		yyval.y_det->nxt = yyvsp[-1].y_det;
-	  }
-break;
-case 118:
-#line 1221 "gram.y"
-{
-		yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 119:
-#line 1225 "gram.y"
-{
-		if (yyvsp[0].y_det->nxt != (details *)NULL)
-			yyvsp[0].y_det->nxt->nxt = yyvsp[-2].y_det;
-		else
-			yyvsp[0].y_det->nxt = yyvsp[-2].y_det;
-		yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 120:
-#line 1235 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = VERTEX;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-5].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-3].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[-1].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 121:
-#line 1244 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = COLOUR;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-4].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-2].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 122:
-#line 1253 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = COLOUR;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-6].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-4].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[-2].y_exp);
-		yyval.y_det->nxt = (details *)smalloc(sizeof(details));
-		yyval.y_det->nxt->type = TRANSPARENCY;
-		yyval.y_det->nxt->u.c.r = yyval.y_det->nxt->u.c.g = yyval.y_det->nxt->u.c.b = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt->nxt = (details *)NULL;
-	  }
-break;
-case 123:
-#line 1267 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = ROTATE;
-		yyval.y_det->u.rot.ang = eval_fexpr(yyvsp[-3].y_exp);
-		yyval.y_det->u.rot.axis = eval_iexpr(yyvsp[-1].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 124:
-#line 1275 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = TRANSLATE;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-5].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-3].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[-1].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 125:
-#line 1284 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = SCALE;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-5].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-3].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[-1].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 126:
-#line 1296 "gram.y"
-{
-		matrix	m;
-
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = TRANSFORM;
-
-		mident4(m);
-
-		m[0][0] = eval_fexpr(yyvsp[-23].y_exp);
-		m[0][1] = eval_fexpr(yyvsp[-21].y_exp);
-		m[0][2] = eval_fexpr(yyvsp[-19].y_exp);
-
-		m[1][0] = eval_fexpr(yyvsp[-17].y_exp);
-		m[1][1] = eval_fexpr(yyvsp[-15].y_exp);
-		m[1][2] = eval_fexpr(yyvsp[-13].y_exp);
-
-		m[2][0] = eval_fexpr(yyvsp[-11].y_exp);
-		m[2][1] = eval_fexpr(yyvsp[-9].y_exp);
-		m[2][2] = eval_fexpr(yyvsp[-7].y_exp);
-
-		m[3][0] = eval_fexpr(yyvsp[-5].y_exp);
-		m[3][1] = eval_fexpr(yyvsp[-3].y_exp);
-		m[3][2] = eval_fexpr(yyvsp[-1].y_exp);
-
-		yyval.y_det->u.trans.m = (matrix *)smalloc(sizeof(matrix));
-
-		minv4(*yyval.y_det->u.trans.m, m);
-
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 127:
-#line 1329 "gram.y"
-{
-		yyval.y_det = (details *)NULL;
-	  }
-break;
-case 128:
-#line 1333 "gram.y"
-{
-		yyvsp[0].y_det->nxt = yyvsp[-1].y_det;
-		yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 129:
-#line 1338 "gram.y"
-{
-		yyvsp[0].y_det->nxt = yyvsp[-1].y_det;
-		yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 130:
-#line 1345 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = MAP;
-		yyval.y_det->u.s = yyvsp[0].y_str;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 131:
-#line 1352 "gram.y"
-{
-                yyval.y_det = (details *)smalloc(sizeof(details));
-                yyval.y_det->type = MAPVALUES;
-                yyval.y_det->u.cm = mapinit(yyvsp[-1].y_det);
-                yyval.y_det->nxt = (details *)NULL;
-          }
-break;
-case 132:
-#line 1359 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = BLEND;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 133:
-#line 1366 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = RANGE;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 134:
-#line 1373 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = BLENDCOLOR;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-4].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-2].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 135:
-#line 1382 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = SIZE;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-2].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 136:
-#line 1390 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = SCALEFACTORS;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-4].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-2].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 137:
-#line 1399 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = SCALEFACTOR;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 138:
-#line 1406 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = VORTFILE;
-		yyval.y_det->u.s = yyvsp[0].y_str;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 139:
-#line 1413 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = TURBULENCE;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 140:
-#line 1420 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = SQUEEZE;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 141:
-#line 1427 "gram.y"
-{
-                yyval.y_det = (details *)smalloc(sizeof(details));
-                yyval.y_det->type = SOURCE;
-                yyval.y_det->u.w = waveinit(yyvsp[-1].y_det);
-                yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 142:
-#line 1434 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = GAPSIZE;
-		yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 143:
-#line 1441 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = GAPCOLOUR;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-4].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-2].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 144:
-#line 1450 "gram.y"
-{
-		yyval.y_det = (details *)smalloc(sizeof(details));
-		yyval.y_det->type = BLOCKSIZE;
-		yyval.y_det->u.v.x = eval_fexpr(yyvsp[-4].y_exp);
-		yyval.y_det->u.v.y = eval_fexpr(yyvsp[-2].y_exp);
-		yyval.y_det->u.v.z = eval_fexpr(yyvsp[0].y_exp);
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 145:
-#line 1461 "gram.y"
-{
-		yyval.y_det = yyvsp[0].y_det;
-	}
-break;
-case 146:
-#line 1465 "gram.y"
-{
-		yyvsp[0].y_det->nxt = yyvsp[-2].y_det;
-		yyval.y_det = yyvsp[0].y_det;
-	}
-break;
-case 147:
-#line 1472 "gram.y"
-{
-                yyval.y_det = (details *)smalloc(sizeof(details));
-                yyval.y_det->type = MAPVALUES;
-                yyval.y_det->u.v.x = eval_fexpr(yyvsp[-4].y_exp);
-                yyval.y_det->u.v.y = eval_fexpr(yyvsp[-2].y_exp);
-                yyval.y_det->u.v.z = eval_fexpr(yyvsp[0].y_exp);
-                yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 148:
-#line 1482 "gram.y"
-{
-                yyval.y_det = (details *)NULL;
-          }
-break;
-case 149:
-#line 1486 "gram.y"
-{
-                yyvsp[0].y_det->nxt = yyvsp[-1].y_det;
-                yyval.y_det = yyvsp[0].y_det;
-          }
-break;
-case 150:
-#line 1493 "gram.y"
-{
-                yyval.y_det = (details *)smalloc(sizeof(details));
-                yyval.y_det->type = CENTER;
-                yyval.y_det->u.v.x = eval_fexpr(yyvsp[-5].y_exp);
-                yyval.y_det->u.v.y = eval_fexpr(yyvsp[-3].y_exp);
-                yyval.y_det->u.v.z = eval_fexpr(yyvsp[-1].y_exp);
-                yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 151:
-#line 1502 "gram.y"
-{
-                yyval.y_det = (details *)smalloc(sizeof(details));
-                yyval.y_det->type = WAVELENGTH;
-                yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-                yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 152:
-#line 1509 "gram.y"
-{
-                yyval.y_det = (details *)smalloc(sizeof(details));
-                yyval.y_det->type = AMPLITUDE;
-                yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-                yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 153:
-#line 1516 "gram.y"
-{
-                yyval.y_det = (details *)smalloc(sizeof(details));
-                yyval.y_det->type = PHASE;
-                yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-                yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 154:
-#line 1523 "gram.y"
-{
-                yyval.y_det = (details *)smalloc(sizeof(details));
-                yyval.y_det->type = DAMPING;
-                yyval.y_det->u.f = eval_fexpr(yyvsp[0].y_exp);
-                yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 155:
-#line 1533 "gram.y"
-{
-		yyval.y_det = (details *)NULL;
-	  }
-break;
-case 156:
-#line 1537 "gram.y"
-{
-		details	*d;
-
-		if (yyvsp[-1].y_det != (details *)NULL) {
-			for (d = yyvsp[-1].y_det; d->nxt != (details *)NULL; d = d->nxt)
-				;
-			d->nxt = yyvsp[0].y_det;
-			yyval.y_det = yyvsp[-1].y_det;
-		} else
-			yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 157:
-#line 1549 "gram.y"
-{
-		details	*d;
-
-		if (yyvsp[-1].y_det != (details *)NULL) {
-			for (d = yyvsp[-1].y_det; d->nxt != (details *)NULL; d = d->nxt)
-				;
-			d->nxt = yyvsp[0].y_det;
-			yyval.y_det = yyvsp[-1].y_det;
-		} else
-			yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 158:
-#line 1561 "gram.y"
-{
-		details	*d;
-
-		if (yyvsp[-1].y_det != (details *)NULL) {
-			for (d = yyvsp[-1].y_det; d->nxt != (details *)NULL; d = d->nxt)
-				;
-			d->nxt = yyvsp[0].y_det;
-			yyval.y_det = yyvsp[-1].y_det;
-		} else
-			yyval.y_det = yyvsp[0].y_det;
-	  }
-break;
-case 159:
-#line 1575 "gram.y"
-{
-		defobj(yyvsp[-3].y_str, yyvsp[-4].y_sym->type, yyvsp[-1].y_det);
-
-		yyval.y_det = (details *)smalloc(sizeof(details));
-
-		yyval.y_det->type = OBJECT;
-		yyval.y_det->u.obj.sym = lookup(yyvsp[-3].y_str);
-		yyval.y_det->u.obj.det = (details *)NULL;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 160:
-#line 1586 "gram.y"
-{
-		if (ostackp->nxt == (objst *)NULL) {
-			ostackp->nxt = (objst *)smalloc(sizeof(objst));
-			ostackp->nxt->lst = ostackp;
-			ostackp->nxt->nxt = (objst *)NULL;
-		}
-
-		ostackp = ostackp->nxt;
-		ostackp->sym = (symbol *)NULL;
-	  }
-break;
-case 161:
-#line 1597 "gram.y"
-{
-		details	*d;
-
-		ostackp = ostackp->lst;
-
-		d = (details *)smalloc(sizeof(details));
-
-		d->type = yyvsp[-1].y_csg->type;
-		d->u.csgobj.tree = yyvsp[-1].y_csg;
-		d->u.csgobj.det = yyvsp[-2].y_det;
-		d->nxt = (details *)NULL;
-
-		defobj(yyvsp[-5].y_str, CSG_OBJ, d);
-
-		yyval.y_det = (details *)smalloc(sizeof(details));
-
-		yyval.y_det->type = OBJECT;
-		yyval.y_det->u.obj.sym = lookup(yyvsp[-5].y_str);
-		yyval.y_det->u.obj.det = (details *)NULL;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 162:
-#line 1619 "gram.y"
-{
-		defobj(yyvsp[-3].y_str, COMP_OBJ, yyvsp[-1].y_det);
-
-		yyval.y_det = (details *)smalloc(sizeof(details));
-
-		yyval.y_det->type = OBJECT;
-		yyval.y_det->u.obj.sym = lookup(yyvsp[-3].y_str);
-		yyval.y_det->u.obj.det = (details *)NULL;
-		yyval.y_det->nxt = (details *)NULL;
-	  }
-break;
-case 163:
-#line 1633 "gram.y"
-{
-		yyval.y_csg = (csgnode *)smalloc(sizeof(csgnode));
-		yyval.y_csg->type = OBJECT;
-		yyval.y_csg->u.sym = yyvsp[0].y_sym;
-	  }
-break;
-case 164:
-#line 1639 "gram.y"
-{
-		yyval.y_csg = (csgnode *)smalloc(sizeof(csgnode));
-		yyval.y_csg->type = CSG_ADD;
-		yyval.y_csg->u.branch.left = yyvsp[-2].y_csg;
-		yyval.y_csg->u.branch.right = yyvsp[0].y_csg;
-	  }
-break;
-case 165:
-#line 1646 "gram.y"
-{
-		yyval.y_csg = (csgnode *)smalloc(sizeof(csgnode));
-		yyval.y_csg->type = CSG_INT;
-		yyval.y_csg->u.branch.left = yyvsp[-2].y_csg;
-		yyval.y_csg->u.branch.right = yyvsp[0].y_csg;
-	  }
-break;
-case 166:
-#line 1653 "gram.y"
-{
-		yyval.y_csg = (csgnode *)smalloc(sizeof(csgnode));
-		yyval.y_csg->type = CSG_SUB;
-		yyval.y_csg->u.branch.left = yyvsp[-2].y_csg;
-		yyval.y_csg->u.branch.right = yyvsp[0].y_csg;
-	  }
-break;
-case 167:
-#line 1660 "gram.y"
-{
-		yyval.y_csg = yyvsp[-1].y_csg;
-	  }
-break;
-case 168:
-#line 1664 "gram.y"
-{
-		char	buf[BUFSIZ];
-
-		sprintf(buf, "art: object %s not defined.\n", yyvsp[0].y_str);
-		fatal(buf);
-	  }
-break;
-case 169:
-#line 1673 "gram.y"
-{
-		yyval.y_trm = yyvsp[0].y_trm;
-	  }
-break;
-case 170:
-#line 1677 "gram.y"
-{
-		term	*t, *p, *np, *prod;
-
-		prod = (term *)NULL;
-		for (p = yyvsp[-1].y_trm; p != (term *)NULL; p = p->nxt) {
-			for (np = yyvsp[0].y_trm; np != (term *)NULL; np = np->nxt) {
-				t = (term *)smalloc(sizeof(term));
-				*t = *np;
-				t->coef *= p->coef;
-				t->xp += p->xp;
-				t->yp += p->yp;
-				t->zp += p->zp;
-				t->nxt = prod;
-				prod = t;
-			}
-		}
-
-		for (t = yyvsp[-1].y_trm; t != (term *)NULL; t = np) {
-			np = t->nxt;
-			free(t);
-		}
-
-		for (t = yyvsp[0].y_trm; t != (term *)NULL; t = np) {
-			np = t->nxt;
-			free(t);
-		}
-
-		yyval.y_trm = prod;
-	  }
-break;
-case 171:
-#line 1707 "gram.y"
-{
-		yyval.y_trm = yyvsp[-1].y_trm;
-	  }
-break;
-case 172:
-#line 1711 "gram.y"
-{
-		term	*t, *p, *np, *prod, *nprod;
-		int	i, power;
-
-		prod = yyvsp[-5].y_trm;
-		power = eval_iexpr(yyvsp[-1].y_exp);
-
-		for (i = 1; i != power; i++) {		
-			nprod = (term *)NULL;
-			for (p = yyvsp[-5].y_trm; p != (term *)NULL; p = p->nxt) {
-				for (np = prod; np != (term *)NULL; np = np->nxt) {
-					t = (term *)smalloc(sizeof(term));
-					*t = *np;
-					t->coef *= p->coef;
-					t->xp += p->xp;
-					t->yp += p->yp;
-					t->zp += p->zp;
-					t->nxt = nprod;
-					nprod = t;
-				}
-			}
-			if (prod != yyvsp[-5].y_trm)
-				for (t = prod; t != (term *)NULL; t = np) {
-					np = t->nxt;
-					free(t);
-				}
-			prod = nprod;
-		}
-
-		for (t = yyvsp[-5].y_trm; t != (term *)NULL; t = np) {
-			np = t->nxt;
-			free(t);
-		}
-
-		yyval.y_trm = prod;
-	  }
-break;
-case 173:
-#line 1748 "gram.y"
-{
-		term	*p;
-
-		for (p = yyvsp[0].y_trm; p->nxt != (term *)NULL; p = p->nxt)
-			;
-		yyval.y_trm = yyvsp[0].y_trm;
-		p->nxt = yyvsp[-2].y_trm;
-	  }
-break;
-case 174:
-#line 1757 "gram.y"
-{
-		term	*p, *lp;
-
-		for (p = yyvsp[0].y_trm; p != (term *)NULL; p = p->nxt) {
-			p->coef *= -1.0;
-			lp = p;
-		}
-
-		yyval.y_trm = yyvsp[0].y_trm;
-		lp->nxt = yyvsp[-2].y_trm;
-	  }
-break;
-case 175:
-#line 1771 "gram.y"
-{
-		char	*p;
-
-		yyval.y_trm = (term *)smalloc(sizeof(term));
-		yyval.y_trm->coef = 1;
-		yyval.y_trm->xp = 0;
-		yyval.y_trm->yp = 0;
-		yyval.y_trm->zp = 0;
-		yyval.y_trm->nxt = (term *)NULL;
-
-		for (p = yyvsp[0].y_str; *p != 0; p++)
-			switch (*p) {
-			case 'x':
-				yyval.y_trm->xp += 1;
-				break;
-			case 'y':
-				yyval.y_trm->yp += 1;
-				break;
-			case 'z':
-				yyval.y_trm->zp += 1;
-				break;
-			default:
-				fatal("art: illegal name in equation.\n");
-			}
-	  }
-break;
-case 176:
-#line 1797 "gram.y"
-{
-		yyval.y_trm = (term *)smalloc(sizeof(term));
-		yyval.y_trm->coef = yyvsp[0].y_flt;
-		yyval.y_trm->xp = 0;
-		yyval.y_trm->yp = 0;
-		yyval.y_trm->zp = 0;
-		yyval.y_trm->nxt = (term *)NULL;
-	  }
-break;
-case 177:
-#line 1806 "gram.y"
-{
-		yyval.y_trm = (term *)smalloc(sizeof(term));
-		yyval.y_trm->coef = yyvsp[0].y_int;
-		yyval.y_trm->xp = 0;
-		yyval.y_trm->yp = 0;
-		yyval.y_trm->zp = 0;
-		yyval.y_trm->nxt = (term *)NULL;
-	  }
-break;
-case 178:
-#line 1815 "gram.y"
-{
-		char	*p;
-		int	power;
-
-		yyval.y_trm = (term *)smalloc(sizeof(term));
-		yyval.y_trm->coef = 1;
-		yyval.y_trm->xp = 0;
-		yyval.y_trm->yp = 0;
-		yyval.y_trm->zp = 0;
-		yyval.y_trm->nxt = (term *)NULL;
-
-		power = eval_iexpr(yyvsp[-1].y_exp);
-
-		for (p = yyvsp[-4].y_str; *p != 0; p++)
-			switch (*p) {
-			case 'x':
-				yyval.y_trm->xp += 1;
-				break;
-			case 'y':
-				yyval.y_trm->yp += 1;
-				break;
-			case 'z':
-				yyval.y_trm->zp += 1;
-				break;
-			default:
-				fatal("art: illegal name in equation.\n");
-			}
-
-		p--;
-
-		switch (*p) {
-		case 'x':
-			yyval.y_trm->xp += power - 1;
-			break;
-		case 'y':
-			yyval.y_trm->yp += power - 1;
-			break;
-		case 'z':
-			yyval.y_trm->zp += power - 1;
-			break;
-		default:
-			fatal("art: illegal name in equation.\n");
-		}
-	  }
-break;
-case 179:
-#line 1862 "gram.y"
-{
-		yyval.y_exp = (expression *)smalloc(sizeof(expression));
-		yyval.y_exp->type = EXP_FLOAT;
-		yyval.y_exp->u.f = yyvsp[0].y_flt;
-	  }
-break;
-case 180:
-#line 1868 "gram.y"
-{
-		yyval.y_exp = (expression *)smalloc(sizeof(expression));
-		yyval.y_exp->type = EXP_INT;
-		yyval.y_exp->u.i = yyvsp[0].y_int;
-	  }
-break;
-case 181:
-#line 1874 "gram.y"
-{
-		yyval.y_exp = (expression *)smalloc(sizeof(expression));
-		yyval.y_exp->type = EXP_INT;
-		yyval.y_exp->u.i = frameno;
-	  }
-break;
-case 182:
-#line 1880 "gram.y"
-{
-		yyval.y_exp = (expression *)smalloc(sizeof(expression));
-		yyval.y_exp->type = EXP_INT;
-		yyval.y_exp->u.i = *yyvsp[-1].y_str;
-		free(yyvsp[-1].y_str);
-	  }
-break;
-case 183:
-#line 1887 "gram.y"
-{
-		yyval.y_exp = get_varexpr(yyvsp[0].y_str);
-	  }
-break;
-case 184:
-#line 1891 "gram.y"
-{
-		yyval.y_exp = get_expr(EXP_ADD, yyvsp[-2].y_exp, yyvsp[0].y_exp);
-	  }
-break;
-case 185:
-#line 1895 "gram.y"
-{
-		yyval.y_exp = get_expr(EXP_SUB, yyvsp[-2].y_exp, yyvsp[0].y_exp);
-	  }
-break;
-case 186:
-#line 1899 "gram.y"
-{
-		yyval.y_exp = get_expr(EXP_MUL, yyvsp[-2].y_exp, yyvsp[0].y_exp);
-	  }
-break;
-case 187:
-#line 1903 "gram.y"
-{
-		yyval.y_exp = get_expr(EXP_DIV, yyvsp[-2].y_exp, yyvsp[0].y_exp);
-	  }
-break;
-case 188:
-#line 1907 "gram.y"
-{
-		yyval.y_exp = get_expr(EXP_UMINUS, yyvsp[0].y_exp, (expression *)NULL);
-	  }
-break;
-#line 4588 "y.tab.c"
-    }
-    yyssp -= yym;
-    yystate = *yyssp;
-    yyvsp -= yym;
-    yym = yylhs[yyn];
-    if (yystate == 0 && yym == 0)
-    {
-#if YYDEBUG
-        if (yydebug)
-            printf("%sdebug: after reduction, shifting from state 0 to\
- state %d\n", YYPREFIX, YYFINAL);
-#endif
-        yystate = YYFINAL;
-        *++yyssp = YYFINAL;
-        *++yyvsp = yyval;
-        if (yychar < 0)
-        {
-            if ((yychar = yylex()) < 0) yychar = 0;
-#if YYDEBUG
-            if (yydebug)
-            {
-                yys = 0;
-                if (yychar <= YYMAXTOKEN) yys = yyname[yychar];
-                if (!yys) yys = "illegal-symbol";
-                printf("%sdebug: state %d, reading %d (%s)\n",
-                        YYPREFIX, YYFINAL, yychar, yys);
-            }
-#endif
-        }
-        if (yychar == 0) goto yyaccept;
-        goto yyloop;
-    }
-    if ((yyn = yygindex[yym]) && (yyn += yystate) >= 0 &&
-            yyn <= YYTABLESIZE && yycheck[yyn] == yystate)
-        yystate = yytable[yyn];
-    else
-        yystate = yydgoto[yym];
-#if YYDEBUG
-    if (yydebug)
-        printf("%sdebug: after reduction, shifting from state %d \
-to state %d\n", YYPREFIX, *yyssp, yystate);
-#endif
-    if (yyssp >= yyss + yystacksize - 1)
-    {
-        goto yyoverflow;
-    }
-    *++yyssp = yystate;
-    *++yyvsp = yyval;
-    goto yyloop;
-yyoverflow:
-    yyerror("yacc stack overflow");
-yyabort:
-    return (1);
-yyaccept:
-    return (0);
-}
diff -Nrua vort-old/art/src/gram.h vort-new/art/src/gram.h
--- vort-old/art/src/gram.h	1999-10-13 08:14:29.000000000 -0400
+++ vort-new/art/src/gram.h	1969-12-31 19:00:00.000000000 -0500
@@ -1,143 +0,0 @@
-#define CSG 257
-#define COMPOSITE 258
-#define OBJECT_TYPE 259
-#define FLOAT 260
-#define INTEGER 261
-#define FILETYPE 262
-#define OPTION 263
-#define NAME 264
-#define LBRACE 265
-#define RBRACE 266
-#define LP 267
-#define RP 268
-#define RADIUS 269
-#define RADII 270
-#define COLOUR 271
-#define CENTER 272
-#define VERTEX 273
-#define COMMA 274
-#define PCENT 275
-#define MATERIAL 276
-#define REFI 277
-#define MINUS 278
-#define AMBIENT 279
-#define INTENSITY 280
-#define LOCATION 281
-#define DOLS 282
-#define EQUATION 283
-#define OFFFILE 284
-#define BASE 285
-#define TOP 286
-#define CONST 287
-#define COEFFS 288
-#define SCALE 289
-#define ROTATE 290
-#define TRANSLATE 291
-#define TITLE 292
-#define REFLECTANCE 293
-#define DOT 294
-#define ON 295
-#define OFF 296
-#define LOOKAT 297
-#define FIELDOFVIEW 298
-#define TRANSPARENCY 299
-#define RAYSPERPIXEL 300
-#define BACKGROUND 301
-#define SIZE 302
-#define MAXHITLEVEL 303
-#define OUTPUT 304
-#define ORDER 305
-#define ABSORPTION 306
-#define VREF1 307
-#define VREF2 308
-#define NUMRAYS 309
-#define OBJECT 310
-#define TEXTURE 311
-#define DIRECTION 312
-#define ANGLE 313
-#define UP 314
-#define TWENTYFIVEBIT 315
-#define RANGE 316
-#define MAP 317
-#define BLENDCOLOR 318
-#define SCALEFACTORS 319
-#define VORTFILE 320
-#define HAZECOLOUR 321
-#define FOGFACTOR 322
-#define RFACTOR 323
-#define FALLOFF 324
-#define QUOTE 325
-#define REPEAT 326
-#define SHADOWS 327
-#define COLOURFILE 328
-#define VNORMALFILE 329
-#define SCALEFACTOR 330
-#define SOURCE 331
-#define AMPLITUDE 332
-#define WAVELENGTH 333
-#define PHASE 334
-#define TURBULENCE 335
-#define SQUEEZE 336
-#define DAMPING 337
-#define SOURCERADIUS 338
-#define NORMAL 339
-#define COMPLEXVERTEX 340
-#define SCREENSIZE 341
-#define MAXTREEDEPTH 342
-#define BLEND 343
-#define COLOURMAP 344
-#define MAPVALUES 345
-#define PIXELGRID 346
-#define RI 347
-#define COLOURBLEND 348
-#define NORMALFILE 349
-#define BEAMDISTRIBUTION 350
-#define INSIDEANGLE 351
-#define PROJECTION 352
-#define PERSPECTIVE 353
-#define ORTHOGRAPHIC 354
-#define STRIP 355
-#define VCOLOURFILE 356
-#define TRANSFORM 357
-#define MINDIST 358
-#define CLIPVOLUME 359
-#define HEIGHTFIELD 360
-#define FRAMENO 361
-#define BLOCKSIZE 362
-#define GAPCOLOUR 363
-#define GAPSIZE 364
-#define COLOURFIELD 365
-#define ALPHA 366
-#define GEOMX 367
-#define GEOMY 368
-#define GEOMZ 369
-#define ANTIALIASING 370
-#define ADAPTIVE 371
-#define BRUTE 372
-#define THRESHOLD 373
-#define METABALL 374
-#define BASIS 375
-#define MAXSUBLEVEL 376
-#define SUBDIVISION 377
-#define GRID 378
-#define KDTREE 379
-#define PLUS 380
-#define MULT 381
-#define DIV 382
-#define POWER 383
-#define UMINUS 384
-#define EQUALS 385
-typedef union{
-	object		*y_obj;
-	vector		*y_pnt;
-	details		*y_det;
-	char		*y_str;
-	eqn		*y_eqn;
-	term		*y_trm;
-	expression	*y_exp;
-	symbol		*y_sym;
-	csgnode		*y_csg;
-	float		y_flt;
-	int		y_int;
-} YYSTYPE;
-extern YYSTYPE yylval;
diff -Nrua vort-old/art/src/hfield.c vort-new/art/src/hfield.c
--- vort-old/art/src/hfield.c	2000-09-09 23:18:05.000000000 -0400
+++ vort-new/art/src/hfield.c	2006-11-18 16:58:16.000000000 -0500
@@ -904,10 +904,6 @@
 	vector		loc;
 	transdata	*td;
 	tiletxt		*tp;
-#ifdef PC
-	unsigned int	page;
-	unsigned long	cp;
-#endif
 
 	totexture(txt, loc, *l);
 
@@ -931,20 +927,6 @@
 	else
 		h = tp->pixh - 1 - (h % tp->pixh);
 
-#ifdef PC
-	if (tp->EMS_h != EMS_NULL_HDL) {
-		page = ((w + (unsigned long)h * tp->pixw) * 3L) / EMS_PAGE_SIZE;
-		cp = ((w + (unsigned long)h * tp->pixw) * 3L) % EMS_PAGE_SIZE;
-		EMS_map(tp->EMS_h, page);
-
-		pcol->r = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->g = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->b = (unsigned char)*(EMS_base()+cp) / 255.0;
-		return;
-	}
-#endif
 	indx = (w + h * tp->pixw) * 3;
 
 	pcol->r = (unsigned char)tp->map[indx] / 255.0;
diff -Nrua vort-old/art/src/in.artd vort-new/art/src/in.artd
--- vort-old/art/src/in.artd	2001-10-08 08:13:05.000000000 -0400
+++ vort-new/art/src/in.artd	1969-12-31 19:00:00.000000000 -0500
@@ -1,552 +0,0 @@
-ELF              p4   T     4    (      4   44                                                   44             E                                /lib/ld-linux.so.2           GNU                %   1      	           !              /                   (   +   
-         -      0                        ,   #   &   %                                                                                                                                                         "                $           '   *   )       .                   $        2   8        <      r   <      K           }   "      =      X  6        (8        87         H*         X      k   h#         x7         4               w        d   *                    "   D   `     9  d                7      R                 @  (      n  8        HK     +   X/         h=      2  x               =      M        
-  *              ~   1         h     R        _       *  *      F                   (         8=                     $   X        __gmon_start__ libm.so.6 libc.so.6 strcpy printf __strtod_internal stdout ungetc __strtol_internal fscanf pclose feof malloc isatty mktemp fflush lseek popen strrchr write fprintf __deregister_frame_info chdir stdin ferror rand read strncmp unlink realloc _IO_getc sscanf fread ntohs strcmp fgetc sprintf fclose stderr fputc fwrite exit fopen fileno _IO_stdin_used __libc_start_main open __register_frame_info close free GLIBC_2.1 GLIBC_2.0                                                                ii        ii         /  `  d  h'                   	   
-  $  (  ,  0  4  8  <  @  D  H  L  P  T  X  \  `  d  h  l  p   t!  x"  |#  $  %  &  (  *  +  ,  -  .  /  0  US    [K     t  v k  J [   5%    %h    % h   %h   %h   %h    %h(   %h0   %h8   p%h@   `% hH   P%$hP   @%(hX   0%,h`    %0hh   %4hp    %8hx   %<h   %@h   %Dh   %Hh   %Lh   %Ph   %Th   %Xh   p%\h   `%`h   P%dh   @%hh   0%lh    %ph   %th    %xh   %|h   %h  %h  %h  %h   %h(  %h0  %h8  p%h@  `%hH  P%hP  @%hX  0        1^PTRhhdQVhU=4 u>4P4 48 uth4   UUthlhUUv UWVS}1   t& )PD+PWt}EPje[^_U|  WVS`hh8j s W Sj \ S Sh VVa   j !W Sj /   ShVVa   j j  j PWhVe Vaa  R ;~= h(   tPa   t   Pa  t@Pa   5tra  t    ?    ?    ?    ?$             jO  jH= B@D    B@0  ?B@    @    B@     B@(    @$    B@,    B@  ?@  ?   ?B$PPXB@4  ?@@  ?B@8    B@<@    @   @         @    @    jj      @    @    P     P Sj.Suh~_   ~    Ph SSr hSu!Sh SS_   V PZ  V  P PjU     @x   Ph   j-     @y   Ph   j     @z   Ph   j jh  j j h   j jh  j jh   j j
-h  j jh   j j	h  j jh%~   j jh*j  j jh7Y   j jh<E  j jhA4   j jhG    t         hO StKP tS  R5$ Ph` SXS\   5<jx <<X        <  tMZ8fB0  :uB8#:uRB8u=   x8 '  Pn~   =T t Tz8 t
-R8z8 uB8
-T @`@`@`(0t?BZBZBZBZBZBZR8u B4@%XB4@%XB4@%XB4@XB4@XB4@XHv = tG BbBbBb(0B8 8hhh hh`   hhh hh`   hhh hh`U:  hhh hh`  hhh hh`  hhh hh`x  hhh hh`  hhh hh`ur  hhh hh`  hhh hh`  hhh hh`	   hhh hh`,  hhh hh`V  hhh hh`{   hhh hh`}   .pix@ ;
-jW jW  jW jW  =  te B4@$B4@$B4@$B4@$B4@$B4@$h P@ PV  j  j PQhP R[PH  jPj S&  GPj[ Qt  j >j 2 j )j ) == c  <H=@ H)5@9St& P$+5$ S   C@9~+59  h+5$$R   ;C&    )PPPRWS   C;~;   ))@))
-LTDC;vJBAAAO;  9   ;   )PPPRWSh   C;~;   ))@))TDLC;~O;RQPVPh
-RQ QOjhj PPjjPj  Qj <U8EPU)EEH5$U)EE5$JO  f=< }&Tt&    f@0  @8uf< PM}fEf fEm]UmEM}fEf fEm]UmEM}fEf fEm]UmEM}fEf fEm]UmEU<WVShE+EE5$HU)EE5$0N  UCC]D@]D@]D@]FDFDFDGFGFGF = i  EPE+EEX5$E+EE5$(M  EE]EE]EE]EE]    ;   EPE+EEt=;x=ut=445t& t= 5t=$E+EEt=;x=ut=445t= 5t=$AL  EE]EE]EE]EE] C;EE@H  E t=;x=u2t=44}fUf fUm]Em.t& t= }fUf fUm]Emt=UE t=;x=u.t=44}fUf fUm]Em*t= }fUf fUm]Emt=UE t=;x=ut=44   v t= }fUf fUm]Emt=}t& E }fUf fUm]EmUE }fUf fUm]EmUE }fUf fUm]EmUE }fUf fUm]EmUf=< }$Ttt& f@0  @8uf< e[^_U!  WVS,         (@$@1f@  ]@  = }0  }
-    ]|E   x|
-   p9u]=(&/  ((pNf$$,=  5 *]ItCx5
-   );upN   =  uh`I  ,=        t& ( E|Etj   x^
-   Rf u?=(&.  ((pNf$$,=(@.  ($Y= {.  Mb?   )$0=   ,  $ $r pn  t{8 t
-I8y8 u<A8=   "  $ ,  $0  E@tD@uhH  ]E===,  &    $pH  <$0+  < +  $0F  <+  t& $0)  <%   =+  t& $p  h=$p  l= $0  p=6+  &    $0i  `=+      $0I  d=*      $0)  *      =   *  j *  j 
- *     *  $0  u*          c*  $p  <$p   = $pi  =*      $pH  5xVF  ]Ex|]]h =8SNF   VSh =F  $p  ] $p  ]$p  ] $pu  m]$p_  m] $pF  mdU<U =U=UEE]EUUdd]]EUUUdE@shD  EM]EUEM]EUEM]EUMM]MM]MM]xVqD  ExE|E]E]E]E]E]E]E]h =8SD   VSh =D  VD  E]E]E] h =SC  VSh =XD  t    5t &  $p  <$p  < $0  <&  &    $0  <f&  &    $ <Q&  $0  <4&  t& <   #&  <    &  j 0 6  0$AB0AB  j 0 6  0$ Bu  j 0    0@    0$@BJ  &    @ja $B BCBCC    j5 F^ j 0 6  0p  $x   Hy L  v Iy u;  $x T  Hy   t& Iy u  $x $  Hy   t& Iy u  $0pB  X$  $  ="     =!  t\   &    =#  t=e        $@$@$@$  i  $@$@$@$  0  $p@$K 
-      $ p $ pD   t& h   v == t7jH5 p   X=    
-X$  8X  $$@@[@[?  $@[@[@[  t& $PAB@A   $@[@@[4@[8@fC>C@D@   C@  ?   v $BC$BC(BC,   $BCBCBC lt& $ @[DX$R	C$ @!-    P$ @B<h@=  $0Rd!  t& 11<tOY8fA0  9tA<D@uy8    9uQq8u<V z8<8 ty8 t	I8y8 uQ8<=T   Ty8       I8y8 u  11<tOY8fA0  9tA<D@uy8    9uQ*q8u<V z8<8 ty8 t	I8y8 uQ8<=T    Ty8        I8y8 u   <<       11<tHY8fA0  9tA<D@uy89uQJq8u<VB^  z8<8 ty8 t	I8y8 uQ8<=T tTy8 t	I8y8 uq8  5T  $ppM   j 0 6  0$B0@    0AB  t& j~ 0 F  0$BA0BA0BA;  $x   Hy   Iy u{  $x   Hy ]  t& Iy uK  j 0 u        j 0 v  j$ 0P $p}  0@$p}  0@X $p}  0@X$py}  0@X $0\}  0@X  t& j~ 0 1  $0d}    &    j~ 0         j~ 0   $p|  0X $0|  0X7  t& j^~ 0   $p|  0X $ph|  0X$0d  $z u    j} 0 T  0$ B      j} 0   j(} 0P $p{  0@0@@    0@@    0@@    0P$@B$  v j.} 0 6  0$AB0AB  j| 0    $p{  0X $p {  0X$0  j| 0   R      j~| 0   2      j^| 0         j>| 0 h  0$ B      j| 0 m  0$ B      j{ 0   0$ B      j{ 0 c  0$@BX  t& j~{ 0 d  0$ B)      jN{ 0 H  0$ B      j{ 0 I  0$ B      jz 0 ]  0$ B      jz 0   $px  0X $px  0X$px  0X $0x  0P  j=z 0 G  0@   0@    @      jy 0 G  0@    0@    @              %    +    n  s  [  c  2  S  jNy 0 '  0$@B  t& jy 0 (  0$@B  t& jx 0 7  h  $pp s  jx 0 7  h  $0pj B  jx @  $@Fjnx .   $pv  [$0v  [^C     j'x 0 7  h  Vhd 
-  jw 0 5    jw 0 _        jw 0 ^  r      jw 0 f  R      j~w 0 9  2      j^w 0 8  c      j>w 0 w  0$ B      jw 0 x  $04u  06f6f f44006B  jv 0$|S_1   $pt  $pt   $pt  $pot   $pVt   $p@t   $p't  $pt   $ps  $ps   $ps  $ps   $ps   $ps  $ $pks  ($pUs  , j@u 0PS0p/  ?  0o    0p    0q    jt 0$pr  0X $pr  0X$0  jNt 0$0pr  0PPXz
-  t& jt 0 7  5$pp   js 0 7  5$0p `  js 0$ x u	  0 T  0$ B0@    V  t& jNs 0$ x u      0 T  0$B0AB  v $x tPA
-$@B[
-  jr 0     jr 0   $pp  0X $pp  0X$0  &    jNr 0   $psp  0X $pXp  0X$p@p  0X jq 0P0@ +  $0p  0@PPX0@  jq 0 "  $po  0X $po  0P"  jMq 0 #  R  t& j.q 0 !  3      jq 0 e  S+   $p!o  $po   $pn  $pn   $pn  $pn   $pn  $p~n   $pen  $pOn   $p6n  $p n   j@o 0PS0p&-  
-  t& jo 0 =  0$ BI      jno 0 Y  $p       j>o 0 W        jo 0 <        jn 0 >  $p#m  0X $pm  0X$0  jn 0 .  $pl  0X $0l  0X0  j[n 0 ?  $pl  0X $pel  0X$0a      jm 0 J        jm 0 @  0$ B      jm 0 O  b      jm 0 P  B      jnm 0 K  $p[ 0P  j:m 0 l    jm 0 k  $pCk  0X $p(k  0X$0$  jl 0 j  $pj  0X $pj  0X$0   $PQ  j\l 0 Y  $pj  0X $pfj  0X$0e$PQ  jk 0   $pj  0X $p j  0X$pi  0X  v jk 0 M  Ejwk 0 L  .j^k 0 N  jGk 0 Q  $0mi  0X}  0    	  $x   Hy tZIy uNt& $x d  Hy t1Iy u&$x A  Hy tt& Iy u$Q  $rB@Pr   x u$j_j PB@@    @     '  t& @jj $B BABAA    Qjr	l   ji 0 6  $pl  0P0@    0@       &    $pjpk  jii 0 6   $pk  0P0@    0@      ji 0 6    jh 0    .jh 0    jh 0    0$AB0B  $0hiSS"   o  $ 0^      $@tx$tZt& j(.h 
-   @BABABB$[$uR$u$PtZ$Ru$tZ$Rxu0x      $@0`  $Pxpe  lp   9p       t    $Xtpx|tYj(f |
-   CBCBCBtB$t|R$|u[$u$x;Ht)t#t& B$|RV|utxpl9p$Pt B$|R|ux0  $y$ tv I$y$ u$0@A$  $ tt&  h@$u$0@hA$  j(e 0     @  ?0@    0@    0@    0@$    $; 2  <yt<xt
-2<zt*0@00@&    0@    hc  C; u  t& j(d 0$ t& j(d 0$ 0@    0@    0@    0@$    _  j(^d 0     @  ?0@    0@    0@    0@$    $pb  $X ; tX<yt<xt
-2<zt*0@00@&    0@    h#  C; uC<yt'<xtK<zt/Et& 0BHBn  0BHBZ  0BHBF  t& h  -  j,c 0    0$X  t& jb 0    0$P       jb 0    0=B   jb 0    0$B Ar[ p$0^  W$0pjA$0pj0$0pj$0pjj $0j`  0()()$M=uau]   ((f  $$0= }   }
-    =    E$Nt4x,
-    9upNt& U0E=(&s(((f$$0whM     1H[^_U`  WVS= tl    = u
-   = u
-h= u
-`= uh @  5$    =    @f<] t=] E 9t<  ]  ~@^B9u] E Gf<] TYu=+ =   c  $=    {  L      z  <      y  ,      x        w        v  
-      u  
-      k  
-      l  
-      V  
-      U  
-      K  
-      L  
-      M  |
-      Q  l
-      N  \
-      n  L
-  J  B
-  R  8
-  O  ,
-      P  
-    
-  m  
-  h  	      `  	      b  	      a  	      H  	      ]  	      I  	      d  	      @  |	      r  l	      s  \	      t  L	        <	        ,	        	      g  	               1                        e        i        ,       ,     ~  '  t  (  j  t&   \    R    H    <      %  ,      2        +        A        B        C        D        [        F                        c  |      8  l      9  \      _  L      ^  <      f  ,      5        o        p        q                        7        =        X        <        W  |      >  l      ?  \  j  R  .  H    <      #  ,      "        !        )        :        *        ,        Z        G        $        -        /  |      0  l      ;  \      ,     B  ,     .  ,       t& ,       5Z  ,t
-    = PSX ,5U  t& j j
-j 5G,    j j 5,  d  |  Z  t&   L      ~  <      }  ,                                                              ;
-t;uh  C`  <"u  PV ,SPR  F  	  <      
-  ,      E        1
-    G  |
-u hPhP9u29t%"t/B9t:"u/9uP1B:"t%9t 3BC:"t9u  v    5Pv 
-uP  *t
-/tu  
-uP*u/uO/u*uG5Ptut	MVh SoS   '    5j55O 1  +Kz$ uBB$   B9wP  S  t==/v    t	tsL   >     t*J   t& = 55    =t& B  =Kh`*	  k[^_v UWVSX5@9vh   x  u*H9u   @     4      ==19}FCB9|x$       @    y  C5){ t7SCCCPsZ  CC    { uh   s5X)Ky    ~    x ~   *   1@F9}58t
-u
-u@
-Fu%5th,N  5J5Sj@Pzu%5`th,  B= u*u   5c     X$1@ @D @e[^_UWVS5;5   E> t@EEf<M t5M UE 9t6  M  ~
-@]O]B9uM UE F;u_[^_v UWVSMEf<M tM UE 9t7@  M  ~]N]B9uM UE 1  t[^_v UWVS5=_C9sYG9vIJ;Pw)EPP@9sh`u  NEE5e[^_US9    B9s    )t$tXb    uW5m    tU= l5?   V&       ]U= uh @  5   u5E  X   UM9tA= t#BB      UAQUVSuj(  uhu  sFP  CuhL  C   uSN   e[^US]t/;u
-    { tsO  SC  ]UVSu]VI   F    t)SUP%   Ft& F    e[^UUt5B    B  B@ BBB   B$    ;uvUWVS}uv|7 u|7 t
-1l    j(6  uh   FC{{C        CC    C   C     C$    Se[^_UU1: t@< uPR   UWVSu~W   uh V   19}t& M
-B9|D3  WSuh)   C   e[^_UuhG5dj
-UuUuuUuU   WVShKEPu$EPhM SS5   EPhkEP       1P@ d  *u/u/u*u
-u    i   Pn    ShuPus ~*4~	    u5|=DPEP PEPPhEP =EPjiEPP EPPoPPPu[^_ULWVSEE}]E]E=< tJUUUUE    =U]E]]']]E    E    E    ]E<]E<]<]E    <fEf<E    5 uVZ  tj SVW/.  G  ?!<<_<_G    tBJue[^_US]S5Ph h5d S5Ph h5 = t5jUuh5dLUu5153US]S5d;`t
-SP]US]S5d;`tSPjUEUH@9t9uUUJ@9t     9u  ?B  ?B(  ?B<  ?UWVS11E    U}UAuFu[^_UMUEBHBH BH0HBHBH$BH4YHBHBH(BH8YHBHBH,BH<YBBHBH BH0YBHBHBH$BH4YBHBHBH(BH8YBHBHBH,BH<YB B$HB(H B,H0Y B HB$HB(H$B,H4Y$B HB$HB(H(B,H8Y(B HB$HB(H,B,H<Y,B0B4HB8H B<H0Y0B0HB4HB8H$B<H4Y4B0HB4HB8H(B<H8Y8B0HB4HB8H,B<H<Y<v U|WVS]EPLSEPE     t& uE]At3<0EEu]Au;]tC1EE]    }}AuED@uh1]UE<Eu<Au1}}EE;Mt\EU]1E]UUt&     }EE,E},FuAuE}x[^_U$S]E@H @H@H@H [@H@H[@H@H S H @H[@H H[@H@HS@H H[ H@H[ HHUD@uhE;E{[E{[E{[E{[E{[E{[E{[E{ [ ]v UEE]EP@9t9uU$S]ShC$C$C$$h@C$C$C$C$h0C,$C($C$$C $hT0C<$C8$C4$C0$h ]UEUw7$ saWK    tu&    UUEE &     9sUWVS]u1Vd9wOt& AJEtD@uBE@tGd9v[^_UWVS}uE    uuFP65]^d9wQ4uuCP3EEtED@uE]d9vEe[^_v UWVSu}E    ED@us_d9   4    DLEtD@uDE@tEd9vzuuGP7]_d9wS4uuCP3EEtED@uE]d9vEe[^_v U   VSEEu UEA9r  9sEu1  t& 8Eus  8EuS  1
-t& ]A9rt& E 9sE8EuEEu   8E   Eu$EEu;@/EEu
-@C  
-HEu6$$$h]S SE   x[^U|WVSu}(1EEU$VEPD  E )   WuuuuFP6 F  1EEU$VEP  EEuEeuEuwEet& 9M uE]	v E]C  ~   uCEeEu.$uuuuh`]S SEruE]	v E]C  E   uCEeEu.$uuuuh`]S Sx[^_U   WVSE +E$U,Em  E(PuuuuEPU2 tE,      t& 1EEU$UREP4  EEuEeuEeEt!9] uE]t& E]G  ~   u2Ee$uuuuh]S SEE(E,    (  U,RE(PSU RuuuuEPUR0U,PU(PE$PSuuuuUREPu0_1EEU$UREP  u )+U$Ut^u
-E]E]G  ~   u`h ]SS EPVUREe$uuuuh@S0SEE(h[^_UWVS]}WLC9w 9vE\Eup3)Nxv     D8\8yU3)   UX9|.    D9E)DUL\9K9}NyGU3)x<UX9|+    E)DULl9\9K9}NyE0Nx0DD@u&    NxDE@t}1[^_UWVS}u~8DD@ut& O~DE@t    1   t& >GFd}ELVh^   9MEA9~   .DTC9r9sdSCP8PuC[)i)\e[^_UWVS]ME    1DQd9w>4DE@tEuGd9vtD
-DQd9wTtD	DE@tEu	Ed9vEUE8)[^_v UWVS}uE    uuFP6]^d9wS4uuCP3EE@tEu	E]d9vEe[^_UWVS1u   URVUR`EtkucEEu2t     ZJu}*&    Utt& ZBuv8he[^_USMy$   A$BBBBBBX~   BEuBEuBEuBEuBEuBEu[uQEuYQEuYQEuYQEuYQEuYQEuY[v UWVSE]E8  j(w/ Ej(j/ E@$    UB$    1]]}_$ tKUv s;E\:Eu}E\:Eu}G$C_$Ku  Ex$    ]S$}]Zt%UEu][u9  }sEEujr. MA$BQ$UB$CZ$u   ]{$    }W$]]Zt)UUEu][u   }sEEuj- MA$BQ$UB$CZ$u<t4sj- MA$BQ$}G$C_$u}u   }u   EE]TU\SNMQB]C @}G UB ME[S {$e[^_UPVSu~$ K  F$x >  F ;</  FF]FF]FFUE    E    E    E    E    E    E    E    E    V$   EE
-QEuEQEuEEQEuE&    QEuEEQEuEQEuEERvEMM~+'VUUU)&    MEEU]EEUEEEUE;]}:9}9~L       E;EuE;E}9M~,       9M~hyE;E}1;Eu E;E}9M_E$Vj *O9M~Et& E;Eu E;E}9M+E$Vj9ME$Vje[^U,WVS1E@$E  UC0Uf;BuvC(E@  = t5Fj* C(C,F;t
-;t;uC4@Ft& ^F    }   UBfC0C(    :uCx< /  < tCPEP;5    URSUR`   [(FC,E8upXEua{$ u[SBD@uCBD@u4B D@u'tJBu  uWt& Eu%tJBut& tt& JBuURU  ((Eu7EXEuWt& JBu1L  EXEu#tJBuv , ,Eu3EXEu[tJBuwEXEu+`t& JBu?0$0Eu;EXEucJBut& EXEu+t& JBue[^_U,WVS}];uSW*  ;uSSW  3    ](]E[Eu`C PW1  us Wq1H  ]#  S$    EluElcC$PW1  us$W1  ]E@  S     EluEluu      u	   11   4    ](UE@   EluEluEu,E  E  Et*,E   E   EuEu20rEE   rEE       ](UE@t>EluEluEuEt;Eu>1JEEtJEEu1&    RWe[^_U(EU] ]$](],]0]@@ @$@ (@$,@(0r4PEE E$E(E,E0UWVS]j<" E j(" Ex4\8    <    @    @ G$    G     C_C_C_C_C_C_ t.jf" G$C3VGPw-  _$ v8uEw   Ee[^_UVSuEUM]@<    F<$B<    A<   C<   [^U   WVSE(Ex<   <MfQf<   M< ufQ0A(    UB@M 4   UBfF0F(    < tFPR-  u$,RVMQ`u5 EPMEXuQtt& JBu5 UR5 MQ<t& 1E@h@ l@$p8  Ctp   s$~$ tWE    E    E    E@ @]@$@]@(@]tPsEPEPVu  ED@u$ED@uEE@#  EPEu\tX9suF$HD]EMhhMllMppK   UB BZB$BZB(BZ<fBf<B#ZM9t
-9t9uUBMfA0A(    C5 EPSC,t`EPt	Cx tUB@M         EP@CM t1JBuUB@M     E@U:u  M9  A4E@   (A4^f^f f\\TTX^D@uEu   TXTD@uA	uY} t	t"HH]EE@0E@tM(EX,Eu
-+t& (EP0EtE`,@0`,]E<v <]EhUlBZpBZEX%   [^_U   WVSU]Mu E8uW@C }GC$GC(CBCBCK AK$AK(E      }G"S GbS$GbS(]E[ [$[(C EC$EC(EMAMAMEt6M9u9EI]EIE]EIEUY,Eu1\  CBCBCSUB    B        My8  A(E@  E@  A(]E]EI(]EI(|[q8  EE    E    UE;P8d  t& }   }Gt=;x=ut=44t= t=]EE@t=;x=ut=44t= t=]EUBM|D|EP$$uuuG[ EEUEEUEEU ]E]]]}$WE$EPEPURMQ tE   E}E;x8E&U$RE$MQS}WEPh[^_v U  WVSUB EB$EB(EEM	]E	]E	]BE]BE]BE]Ys   UB t'H    :       K4y4 t?UBQHTA8P@Q4 @@IC4x( t>PEPMqS]  C4x,   PEPEpSY     C4x    PEPUrS  rS4z( ti PEPr(PR   MqS}W0Rs {$   ,    (    $    PEp$PWSk $ E@   (E@   ,E@   048$$((,,0$0448,80N4N8N lN$N(N,pN0N4N8tlptUJ J$J(Eu9llpptt   1]]]                        5  ]UBEMQPlPEPEPEPVS7   MMME@T  l`pdth``ddhhE`TEdXE\TX\E@ @$X@(Eu^P$SMMMvDMUMZMZD@u&D@uE@t9UBZBZE@  E@  U;<  D@u*D@uE@8  lHpLtP{ut;t@<t& ]UBuB H<B$L@B(PDEj  l<]p@]tD]<f|f<x   ]UBE;t
-;t;u|fC0C(    5 xW{tgXE@PVWEP-MMMAYMAY7<E <@X<@Xt PHuU;<  D@u*D@uE@a  llppttUB l]B$]B(t]<f|f<MA]x   ]MAE< ufS0C(    5 xWtCE@PVWEPvME M@XM@X7<U<BZ<BZtPHuD@r  U;<c  D@u*D@uE@%  UB EB$EB(E<f|f<]x   ]MAE;t
-;t;u|fC0C(    5 xWtCE@PVWEPME M@XM@X7<U<BZ<BZtPHuE@  @U
-M	IYIYUB EB$EB(E<f|f<]x   ]MAE;t
-;t;u|fC0C(    5 xWtkEPVWEPt@UHM]M]M1<]<]<]tPHuMEAEYAE   `=E@   `=U
-%d=h=El=HXp=HX@U
-M	IYIYEEu
-    EEuUMYEuEXEuUBMYYEuEXEuUBMYh[^_U`VS]5t[M jH F(    V0^,F4    F8       B ^B@^ B@^$B@<F<   =8     0=  tY=  O    &    =5  }    =^  e  =9  (    v =_  +  p  tCH@CHPCH`@p^CHDCHTCHd@t^CHHCHXCHh@x^"  C[C[C]ESCC]ECSCS{StH@HPH`^CHDCHTCHd^CHHCHXCHh^   }C^(ut& C5^,ZC5^0Dt& C^48C}fUf fUm]EmF8t& h[P*[>uF, D@u   F8~^F8~ ^ F8~$^$<@Pj? F@1;<<F@    B9~FD5e[^UWVSuF> t>=uuh [C; t;.u Wh  ;.u@Ph7FPZ@Ph:FPYe[^_US]uh  BttCZCBh@KSY]U   WVS]j S5   u!Sh` SYS Ft	tF_FGh[^_U   WVS]S5V  uSh S YS_~u	~=t& ~u3Fff f[^_U   VS]S5  uSh SeXS~uF	~u	F[^UEUu J&    8u:t*8u:u   (t& 8u:t
-8u:u   t& Ev UUt
-uBB]RwWh Ev USUt
-u2ZB}fEf fEm]]mRWt& h]UWVS]EPuVSj   C  $ht
-t!     EP_     uV&G  t& tt6     EP]uVE_  t&    EPuV_j      tt69     EPF]uV7m_(  t&    EPVuVH)_       tt6      EP]uV}_   t&    EPuVO   tt3Y   EPf]uVWM_K&       EPvuVhGh Kh@<e[^_UVS]ut>V3Ru*}Vs    Vs1e[^v UVS]u; tBV0|RuF}VP1t& VPj  0@    @    e[^UVS]uu5]Xpe[^UVSu[u	1t& V3te[^v U|   WVS]t{uEPSn    {uURSR    x u$j  PB@@    @p   t$   u3h(    t$     $  $      t$  t   H   t   PC@    }p   j<G  CB B8        1 { tU[tNj  SQ@   uW[u} u    E    1
-  {u    _  $C]C]C]     t& C]C]C]   q  t& KBACBS      C]C]C]CfE   )  CECECE     CECECE      t& C]      C]      CE      C$C$C$4     t& C$C$C$5  esC$2 SO e    sm7 sO "t& K	t& C!SOt& Ct$jHq  Pu   B@D@u&B@D@uB@ E@t(B@@D@u
-B@@  ?  $,t    D@u-  D@uRQ     RP    QP&    t& RQ>  k  t& PRR  K  t& QPi  +  t& RQj    t& PR     t& QP.     t& RQ     t& PRz     t& QP  nRQ VPRb- >P $RhSLS:@t   tx[^_U   WVS}W5t!CUfC
-MfCUW  hWN u!Wh S$LS WhF$fCMfF&fC
-UfF$P   F$P  F$P   F&@PF$P  CU31f~$ t*v 
-C
-C:CBF$9|WPRV~ t	sV QJ PJWJ[^_UMUBQEuYBEuBQEuYBQEuYBQEuYBQEuYUUMBQuLE@s@BQu1YE@s$BQuYE@  B BE@teEuAE  ) E  iEu.&QEH  E=  B$BE@   EuAE   iAE   iE   EuE   Eu'%QE   YEt{B(BE@tlEuAEt@iAEt'iEtEu4
-   #QEtYEt1UUMB BE@teEuAE  ) E  iEu.&QE  Ex  B$BE@   EuAE5  iAE  iE   EuE   Eu+)QE   YE   B(BE@tsEuAEtwiAEt^iEtIEuEt0Eu12QEtYEu1v EE   U,WVSuE@4E@    @PV u-UBEPMqV`    1UBPVu$MAEPqV`v 19u
-1  v E@EM9t} %   EIutIuuiEu0t
-^[YA} M+} t
-VRQAt?ut7t3^EM   JBu   t& t<} t6VEUtkt& JBuM&    F    M1tJButJBu} tE@UBEe[^_U,WVSuE@4E@    @PVu)UBEPMqV`u1  UBPVru!MAEPqV`1E@EM9t} %   EIutE8uA@IuuiEu0t
-^[YA} M+} t
-VRQAt<ut4t0^EM   JBu   t<} t6VEUtkt& JBuM&    F    M1tJButJBu} tE@UBEe[^_UhYv UUB4@ uuuuuR Uuu,UWVSut)   p    =6  J  W  j<N  EjA  UB4@BC        v|CvnCC@C@Es     j<  Ej  UB4@BC       vCvCC@C@CS@REuUZC@MYCS@REuUZC@MYCS@REuUZC@MYCS@REuUZC@MYCS@REuUZC@MYCS@REW  Z  t& j<n  Eja  }G4@GC         vCvCC@C@CS@REu_C@UZCS@REuUZC@MYCS@REuUZC@MYCS@REuUZC@MYCS@REuUZC@MYCS@REuUZ/C@MYj vZEh 	l}G8    Ee[^_v UlWVSx u$j  PB@@    @p   t$   u3h(  o  t$     $  $      t$  t   H   t   P}p   1UBpt9j  VSs*  u]t& MY]vu} u
-1t& E1  ='  s  q=    +=     ~  i  =    Y  ="    =!    <  =#    =%  
-  !  =6  %  3=+    =(          =2      =G    =7  tl  &    =e  u  =n       t& F]F]F]     t& F]F]F]   t  t& NBAFBV      F]F]F]FfE   ,  FEFEFE     FEFEFE      t& F]      F]      FE      F$F$F$E     t& F$F$F$Q  hvF$ Ov  v9 5t& V	$t& F!h 	+NMu}1V8u*t$jH  Pu   UBp@t   te[^_UVSUEM]u@,J@0J@4JB,pFB0HB4HA,KA0KA4KC,   C0   C4   F,   F0   F4   [^UlWVS]x u$j  PB@@    @p   t$   u3h(  h  t$     $  $      5t& t$  t   H   t   P}p   E     t<[t5j  SVZ%  } uuEpu[uE    } uEE    v E1  =%    q=  V  )  P    =     }  =!    =     `  ="    =#    E  v =6  7  C=(    ='          =+     =2  
-    t& =G    =7  tl  &    =e    =n       t& C]C]C]     t& C]C]C]     t& KBACBh      C]C]C]CfE   >  CECECE   "  CECECE     t& C]     C]     CE     C$C$C$    t& C$C$C$!  w  t& sC$ V  &    s} s3 4  S	#  C!  t&jH  Pu   1ss   x8 tbv @8x8 uTt& t&jHJ  Pu   1sj Itrx8 t	@8x8 uMH8UX    t&jH  Pu   1j sUP8Eh`	su
-uE    Sl2@t   tEe[^_U0VSEuV4@bU@bU@bUH ]H$E]H(EU"]UE   UEuE   E]= tBj  EeEuDs~ tk= tBj>  SEE7&    EEEuB1rB    Ee[^UMUE@ HBH$BH0HBH(BH4YH BH,BH8Y A@YA@YU<WVSMu}]FHGH$GH0]HH(H4]H H,H8UE UE@U@UHUHUHUA p]p]p]EPEPEP- NEI}fUf fUm]EmEI}fUf fUm]umQU}AE}E484vAEE	AD0EE[AD0EE[e[^_U0VSu]E    E    E    E  ?tp    =  t=  u5CECECE1C]]uh	h 
-[PE.uEE@t$$${  ED@u ED@uEE@t*E$E$E$4  5to h  ?j h  ?j h  ?j (
-$$$Vy PV jw  V4UUUt@@@PH`@pZV4EHDEHTEHd@tZV4EHHEHXEHh@xZV4  e[^v UVSuEUM] [Yx[        [^U\WVSUuF BHBH$BH0]HH(H4]H H,H8]B HB$H$B(H0UHH(H4]H H,H8]E UE@]E@]E    @
-]E@t~Eu(Ea  ]EE   1+E2  ]E1E   ]UEu0E    'E  E  EEE@   Eu)E  ]E      ,Er  ]E      UEC  UEu]UE!  UEu1]U+E   E   EEE@   Eu)E   ]E      ,E   ]E      UEtUUEu]UEt7UEu6]U6EtEu1       1EE}   = tAj  sECE~ t5= tAj  KqyEA    MEEu== tAt& j~  s{EC    Ee[^_UEU     @    @    w[$
-t& 
-S    
-XBt& 
-X2t&    ?%@  ?@  ?    h`
-CUv ULWVS}]E    E    E    UU]   t[;  u.tCECECE1$CECECEh
-[P'uEUEu]EE]E]EUEu]EE]E]EUEu]EE]E]Ee$Ee$Ee$  E$E$E$
-  5t h  ?j h  ?j h  ?j j j j j j j W# PW e[^_v UVSuEUM]@cF0_B dA   C    [^UVSEu]1tEEtS= tBt& j~  EBEB= uB    &uBt& CBS;ue[^U,WVS}E]$]EM ]R$EuUQ$Eu6E)@9uEu;]C Euc9v_t& EUB EuD9w>v UUB Eu%9v!EEP Eu9Mw;]  CE  CE  C$E  C E|  C@UTUDEEhElEpE@  Eu= 
-  EtExE|C
-E  SE  SE  S$E  S Er  1KUAE   EuHQEu	F   v QUE$EEU$E<AEEuAUE$UUE$UEuFAUAE   QEuEQE   QUAE$EEU$E>AEEuBQUE$UUE$UEuFAUEufQEuEtBEu7A$M$EuF   t>E(P+E @EP$s(;]"e[^_U,WVSE]$]EM R$EuQ$Eu5)@9uEu=G Eua9v]&    G EuC9w=&    }G Eu#9vv W Eu9w9  FEg  FES  F$E<  F E(  F@UTUDEEhElEpE@  Eu=   EtExE|F
-E|  VE^  VEM  V$E/  V E  E    N\At& EEuEEu   EE@rzEEuEEuMEE@r=M$M$EEuEY;N>Mt>E(P+E @EP$(9we[^_v U|WVSUB MAHAH$AH0]HH(H4]H H,H8]A HA$H$A(H0]HH(H4]H H,H8]E ]E@]E@]EPEPr4EPu1T  EtExE|EhElEphEuEht]EEht]Eht]lEuElx]EElx]Elx]pEuEp|]E    Ep|]Ep|]    UZ4KCsHE    {X    EEEExl|pC@E{D{L t.URCLDPVCp$sdWMQj 0CL;CXt?EPCXDPCLP   $s|WURECLPU0CX4E{\    EEEEth|pC<E{D{P t0URCPDPVCt$shWMQEP0CP;C\tBURC\DPCPP   $   WMQECPPb0C\4E{`    EEEEthxlC<E{@{T t0URCTDPVCx$slWMQEP0CT;C`t?URC`DPCTP   $   WMQECTPo= t1UE;P,u&BM;A0uJBx[^_U4SEEE U$M(],]E]E}u1@ ] `]@`]B"]b]Bb/ `]@ ]@`]b]B"]Bb]@MBM] MM]@MBM]MMEMMEMMEAAAHAHH[AHAHH[[v U   WVSEEU M$](]E]EBBB
-AAAUl3uBUApCE]xEBUA|CE]]EBUAUCE]]E]]uUUU]UUUtE,EEEE1\    G9   WXU&    ;XtNlEuE   v lE   ]EuEubEt_lT    E@t7$T$Eu
-\FG9$\uu(U,U0U,BU0BU,BU0B;E0P    D*P*lPD*P$$EPu-8[^_U   WVS]MEp4FHt:v,UB@MB@YB@ Y  &    tlzUB HAH$AH0]HH(H4]H H,H8UE ]E@U@U;^X}e1;ltLMhEdt&     _F@h_FDdC;lup       FXF\9}dEE1;ltHU`M\    _F<`_FD\C;lup   iEE1;ltOMXET&        _F<X_F@TC;lup   1;lt`}UPMLEH[tAXF,LP
-:HC;lulu=UREPEPEP$$tPpQ`   v UB@MB@YB@ Y]MUE 
-]CAB@]CAB@]EPEPEPEPEP$$pRtQ([^_U   WVS]MEp4FHU:v3UB EB@UZUB@EX~      EUxUB HAH$AH0]HH(H4]H H,H8UE ]E@U@U;^X}J1;]t<EEUUv     _F@E_FDUC;]u1   FXF\9}REE1;]t>EEUUt&     _F<E_FDUC;]u   NEE1;]t<EEUUv     _F<E_F@UC;]u   1;]t*Mt& EPF0X@F(C;]u}u7UREPEPEP$$EPW       UB EB@UZUB@EX]MUE 
-]CAB@]CAB@]UREPEPEPEP$$WEP8h[^_U   WVS}MEGHU:v(BO@]TSDC  EpU;WX}nAA19tVEEW@UEEWDU    pNEUpNEUpA9uE       GXG\9E}kA19tWUUG<EUUGDE    pNUEpNUEpA9uE   nA19t\EEW<UEEW@U        pNEUpNEUpA9uE   $ u519tfU|W v N@|A9u=    19t1Exw$W }GH@xA9uu4EPEPEPEP$$EPUR}vv ]MUE 
-]CAB@]CAB@]]SEPEPEPEP$$}WEP]X[^_UWVS}]uN4UQHAAtuF HCH$CH0]HH(H4]H H,H8UE ]E@]@]WEPEPQ BI@TWDGe[^_UWVS]UMEtt
-!t}uv h mSS[S$[    ;U}   CPCEu[CPCEu[CPC Eu[ "t& CPC$Eu[$B;Uue[^_UWVS}EL9v,8u	9u8t9w9wEHE11;]}/uNDEB$X$EuTE   A9|uEHEt& 1M;M}1uNDEB$X$EuTE   A9|u[^_U   WVSuEP5tCUCCMx  h ]SO`u!Sh"S=Sk PPPh@`P t$URh`SSGk MQh_h     LCLEB4    B8    B(    B0    B     B$    B,     B j  LA<jw  LB@ jU  LADj6  dL@H    LtLXp j  \MLP|t j  >&        CMCUEPEPRh`SEEEEE    ;  ]EPEPSh`Vu ]EuE]Eu	E]EuE]Eu	E]EuE]Eu	EEEE@;LXXXXXj(  Tj  P | tG    ;t/R@    @         B;ul    x    pA    A        tC    C            l;  Ph`PVTXxfPld4XXrVh`Qf    ;t(^Ph`P f^C;uV$UV$UV$UVF$]VF$]VF$]MM]MM]MM]EXBEBEBE]E]E]ED@u$ED@uEE@  EEE]]]| tP1;tF^@E^@DE\^@DE\C;uEEEu(EEEu:P 8EEEuPPPputQSPPPXSx@U\UTUT]]]EMEMEMX[<xuVPhSSb l;|        ;   v    D@uADD@u1DD@u#UR@PhSSb KIDDD\|\;9p7j  Ewj  E wj  EG    G            ;}QuPpTp;|j(  LAHh        dDL|@p<   t44E41;tXHU<h<H7LyH4
-   Cp;uthLSHD@ ;t*EQ EuA Ct;uL\;ptp;   h)LFH@;B tp)p;t,EQ EuA Cp;uL   phl;t.MQRh S[ S^PSTV uu u`Wx([^_U   WVSuEP5tBBU#  h EPu$URh` S~S] PPhWj   jj  E0URhBr1 ;t2v [PRPRPhW C;u1;t)&    ^PhWff^C;uW[^_U   WVSEP5t@U       h EP'u$URh SSu\ PhWt$EPh SS4\ j  U2EPh5p1 ;t)[PRPRPhW4 C;uW[^_U,   WVSu}V5ktBBU  h Vu!Vh  SSG[ PPPhBPs t!Vh` SSZ j  j  U VhZB1;t6&    PRPRPhR G;uj%      1;   PhPm4P41;t$^PhP0C;u1;tf^C;uG;jP[^_U,   WVSu}V5/tBBU  t& h Vu!Vh SSY PPPhBP3 t!Vh SVSX jv  jb  U VhZB1;t6&    PRPRPhR G;uj      1;   PhP-4P41;t$^PhPC;u1;tf^C;uG;jPc[^_U   WVS    1} tUrBEuuEh    ptv hvu1dhMqt8>  u~d   >  t>+  u   OvujWV  E4Ih     \E\8G4    G8    G(    G0    G     G$     tjP  G,    \B,     \ASj  \G<Sjq  G@ SjZ  GDVjF  | Pj,  xExGH    L\XSj  pEp8\P u	d ttQj  t]    9tFRt@    @         B9ut& }        }   v U=     =T  U  hrT  IXIT>  uS~"FXtF\F\tFFFH>  u&TFF\F\>+  uFO^VCzUrFFFIB B@\B@\VKh R}wW#u]      Eu(EuEu*EuEu+v Eu9\_____Pj(  lRj  `1yy9 98  l4fVV|{xFt-VUUU)fCAfKf+    VUUU)fAfKfCS$US$US$USC$]SC$]SC$]MM]MM]MM]EFEFEFED@u$ED@uEE@U  EEEU]]    d    @t@DE\@DE\C@EC@DE\C@DE\C@EC@DE\C@DE\EEEu(EEEu;` 9EEEu```
-jPRQ`PV@UpUTUT]]]EMEMEM^9Ph`SuStL 9        9   &    I    tD@uCDD@u3DD@u'RhSSK SItDDD\|\9)E    E    E    : t2jQ  Ey tqj2  E{ tsj  EG    G            9}Uut& `l9|Qj(u  \CH        dL< ?  44E4TH    H;t[P]HP\yHH4
-   @H;u\WHL@ H;t;EHS EuC HH;u\p`SilWZ uLuA u3([^_UpVSu]E    E    E    E    E    E    E    E    E    E    E    E    e      =]     %=H  tz=  tQ  =I       =d     =c        =h     =m        t& EPEPEPs   &    EPEPsY   EPs   t& EPEPsnEPEPsY    EPs	=  BEPsH<  1EPEPEPEPEPs hF[Pd5t  }    EF4UEB4UEB8UEB(UEB0} tUEUEB} tUEB UEB$E@$    UEB F4@]@]@] ]@]@]EEP]EE]EE]E$E$E$E$E$E$L} tXUV4EBE@@$h  ?j h  ?j E@@$j j j j V   @&    h ;EV  e[^UVSuEUM]@FToB    A   C   [^UEEEUM ]E]EH@HH@HH@ JJ
-JJJYJJ JYv U   WVSEE]E]EEH AAAX<<AAAA<<Qx|AQEUAQEUAQEUAQEUAQEUAQEUQEU]u]u]u]u1v D    G9   W@x;@tS|EuE   |E   xEuEubEt_|8    E@t72$18$2Eu
-DCG9$Duu2UU$UBU$BUBU$B  &    E8uh@   x    $]   $]$]|$]$]$yt& U: uB	v E@    x   $]   $]$]|$]$]$]   xM|M]    MM]   MM]MMEMMEMMEt_t    t& |   	      UTBXB\B`BdB   UBTBXB\B`BdB mUBTBXB \B$`B(dB,8    UB$TB(XB,\`BdBh`ETU$dHXZhH\Z[^_v U,WVSu}U]t	t3v t)Bt& ]B]#v ]B]v h\?f~u)SEPv E$E$<t& f~u SE$E$EPWV7G[G[e[^_U  WVSu>uUBx< X  MI4lP    T    X    \    y    A|PqV`@  @9|uX@ X| P@tt& SCuUB FHFH$FH0PHH(H4TH H,H8XF HF$H$F(H0\HH(H4`H H,H8dP PT@TX@X1l;1"D    D    Fl;7~S<PlPJ  udlL9r4Et#9rEuE@   Sl2-MpXD@uSpP\C\XPpRCTPPpQ+D)tt@lz    55PpQMC)tu1  X`P1%u`XP`PF?TPPpPfC)Uz u
-;tuttMy    pPSWTP\XPpW)F0= t@@t& j  @p@MJB    }u     l;0E    Fl;2~EPpPSWTP\XPpQ,G0= t=@Gj~  @@1;t   EDx    xD;<|       H    LH)p}{= tC@jM~  CZxxDL;<|F;tXCB    E@([^_UVSu]MUtBBBR$u[^UL  WVSUEH4@ HBH$BH0HH(H4H H,H8 @@@]UH   ;AU    L@;A~   ;B@v L@;A~   ;Bv L@;A~W@V]Sp$UUWVSq(?EX WVSr,%MYD@u)AD@uAD@uY[^_v U<WVS}u_t+sF $F$3   [u_t)sF$$F$3Q   [u_t)sF($F$3!   [u }  E x  @$U  t& Mq    QUE  M	 MJy  Ep    UJME`  M	 MJyD  Ep    UJ ME  M	 MJy  E@EURUMyAMEE}   ]U| JyMy  E@EURUMyA MEE} [  v ]U| JyMy%  E@EURUMyA MEE}    v ]U| JyMy   EpPUHM    UJMzZ E|~UUM	MU|U|=MMMt& E]M| IyJyNyh2E@$Ee[^_UWVS}]]4EE@   tt,EE[   EEM[E[yWuu8Eu9wJ)+E
-9v'    C    9rWuu8e[^_U   WVS]u5t  S  SS[SS[ j0v  C4D@    d    =  t'=6  u0vv.yDB@ v FDA h0vP:uD    G    G    G    G$    G(    G,    G    G    G    G @t^v @Z$t;v C@;Au#C;AuC;Au    C    [$u@$@u1D@ ]@D@u8tB$C$    @B$DA @W'@@@$@u1]MU       @~DR @  &    DA@;G}GADB@;A}ABDG@;B}BG@AAAD9}@@    x    @   j(Wt  @
-   @HIJ@
-DG$B$W$@BHu<0 uUjt  @A@Pj5t  @WJKDBCZGH0 @AHA@    Oj(s  @
-   @HIJ@
-DG(B$W(@BHu<0 uUj.s  @A@Pjas  @WJ|KDBCZGH0 @AH|A@    Oj(r  @
-   @HIJ@
-DG,B$W,@BHu<0 uUjZr  @A@Pjr  @WJLKDBCZGH0 @AHLA @$@D@ @tK@rrrr2h
-S S+@I$@u([^_UVSuEUM]@4FB    A    C   [^U  WVSU XTP$LHDMA BHBH$BH0pHH(H4tH H,H8xB HB$H$B(H0|HH(H4H H,H8p pt@tx@x4P0PDP\P.~  0(Eu]0%$|pp$tt$xx&    $    E@4 pp||ttxx                 0      t& 1t&     98 988D\F~ 8D8\8FSj9,SPe/ j j S,Rc09t2$P,Q/)(u1h  (1G@$P,P/)Uz u
-;(u(tMy    PSV$$P,W20= t=Gjl  $EGG    U:V  E    E    E    EPPSV$$P,Q30= t=Gjnk      (9   M1;4}l$(US= tC@    jj  CZF;4|(9iCB    E[^_U$SMUEX4@ HBH$BH0]HH(H4UH H,H8]E U@UE@UE8MYMY[v UlWVS]uM}FHAH$AH0]HH(H4]H H,H8UE UE@U@UHUHUHUC p]p]p]EEEEEEE    EE]EU]]EuEu@]]Eu%E]E5HE]E5H]EEMEMUEC4 EP]EUE    MU]EU]]EuEu@]]Eu'E]E5HE]E5H]ENI}fUf fUm]EmI}fUf fUm]]mQU}AE}E0[AEEXADEE_ADEE_[^_U<WVS}]jf  G4EE    E    E       {t& =  t'	=  t.D=  u=CECECE9C]C]*tC]1C]h`C [PuE$$$   E$E$E$  EuE] 5t)  E$$$E$$$W4  PW  e[^_UVSuEUM]@(hF(B(A(   C(   [^U  WVS]EUM ]@]@]]B]B]]A]A]EeUEeUEeUEe]Ee]Ee]MM[MM[ MM[$CC EuCC$Eu( &v C C$Eu
-t& CD@u@C D@u1C$D@u$hTSS+  <~   tG  v <   7  v CEeEe$EeEe(EEE^    C EeEe$EeEe(EEE(EaC$EeEe$EeEe(EEE(E$,hCC C$SS S$MMM[([,[0[4$[8([<,[@EEE   uI    2Eu
-2&v I<    UEuI<    UEu#I<    UEuI<    UEu#I<    UEuA%%[%[%[[[[[^_U,WVSu=P  ? t:uG9BuB    E U]]@FBC]@FBC]]SVPGPSEPVG`P SURuV   PSEPUR   P=    ][    5uwTD
-GX__\   E@T         5      D  uH  L  ]CZBWD
-FDCWD
-FDCW]EG_G__]wse[^_v U$SU]CJ ]C J$E]C$J(EUE@  CJC JC$JC(uUEi  <tQt       <      v EJ$BUSE#  [E  .v EJ BUSE   [E   EJ(BUSE   [Eub   EJ BUSE   [E   EJ$BUSEtu[EukhEK,EK0C4Et<Et0EK8EK<C@EtEu1"E48<@   ]v U<WVS}]Uu{ ukBUBU]U]D]]BUD]]]]VEPEPEPEPS [SWatF= tAj[  4qA    	  &    CPPWt== tAv jn[  4    @      PWt9= tAj[  4    N   PWctH= tAjZ  4    AA    t& 1e[^_UWVSuPU8 t 8 u9Pu@    Uuh C$C$=  u
-   =,  uK1t9S$x u#@    C$    K$u}    E+E}M;]}  U965
-Eu
-    EuB9~;U15
-EuEuB;U~C;]x   E)<0MM9RUEt& MU;U.u
-EuEuB;U~C9~;]VU=MU;U3
-Eu
-    EuB;U~C;]~UZZB    ZZB    E  Pe[^_U<WVS}1EHEE]E]E]E]G]G]G]SEP cO  E+Eu.E+Eu#EEPSWEP  t& U+UE+E9    ujEPEPEPEPWW ]]E@EEXuYEPEPSEPwEP   EX E@n  EPEPEPS   v EPEPEPSGPEP )  EX   EPEPS    uj EPEPEPEPWZ ]]E@EEXu\SEPEPEPwEP    EX$E@suEPSEPEPGPQ    EPSEPEPGPEP u-EX$uSEPEPEPwEPLe[^_U@VSUuF BHBH$BH0]HH(H4]H H,H8]B HB$H$B(H0]HH(H4]H H,H8]E ]E@]E@]^4C9~
-CC$K0C4S(C,C t&t@ R$uC(        HPj HPj sEPC$C0C4C(C,t@C8[<[re[^U\WVSM}]u 9~CFEEUE]EE]E]UE]EE]U]EUE]EEE]EU]EeUEeUEeUEe]Ee]EeUMEMMPMMP]EXX[^_U<WVSEUx4w}B}B$)t)tat/t=Tt& [ED[8D[ED@#T@U@@E[Eh`[@BD]@B@B@]@B@B@]GG]EEMM	EMIMEHMYEHMMIEXe[^_v U   VS]hSduSh]SYS
- EPEPhVuVjjEPEEEE@PjCP  EVEE@PjRx[^U   WVS]}hSu!ShTSS
- 4P0PhV=u Vjj0P50404PjzO  $V04Pj$P$ ,    049,tj04,$ Eu (,$Eu,9,uj8aN  $P04Bj7N  p h@ N  X4@0    hP M  H$,     ,D D D    D D D         T(T$,,  u<     @,  ,    ,    T  P  ,,	  uL  ^^F       04PjEM  x ,    Q      (    0H9((  H&    ,0(40$R0@PCPSP 4[7H7D7L\7D7P\77BHZ@LX@PX0@@HX0@D@LX0@D@PX 40$P0P0@PSR7 HD7L\7D7P\70@@HX0@D@LX0@D@PX0@H0@DL\0[DP\ (0H9(,4H9,,    049,}ov ,RDDDDD\|\B,049|	@     [^_U$S]E@4H= tr@@]EQDBBADBHBHADH[BHBHADH[AA CA$C[U,WVS]MU}AHBH$BH0]HH(H4]H H,H8UE UE@U@UHUHUH]C pUpUqN}fEf fEm]]mN}fUf fUm]Mm]EuVU}FE}B])]EuVU}t& FE}BM)F@VUE VTUE_VDEE_[^_UVSuEUM]@@F@B@A@   C@   [^U,WVSUu}^4CJ ]CJ$E]CJ(EUE@  Eu
-{   CJCJCJCuUEe  tF	t         EJ$BUVE%  ^E  +EJ BUVE   ^E   EJ(BUVE   ^Eue   EJ BUVE   ^E   EJ$BUVEtz^Euph@; S E
-EJBEt<Et0EJEJBEtEu1   = tC&    j.E  EsC    ~ t:= tBjD  ErB    Se[^_U,WVSUu}^4CJ ]CJ$E]CJ(EUE@  Eu
-{    CJCJCJCuUE  tI	t         EJ$BUVE  ^E  .v EJ BUVE[  ^EO  EJ(BUVE0  ^Eun#  EJ BUVE  ^E   EJ$BUVE   ^Eu   hZ1S CDEEREuEXEuqEEXE@rZEEuEEu?EEE@r*E "@bE(EhEuAUBE;S au1   = tC    j>B  EsC    ~ t:= tBjA  ErB    Se[^_U$S]EP4z$ tESur$BPRCC]E[BB[B[]v U,WVS]MU}AHBH$BH0]HH(H4]H H,H8UE UE@U@UHUHUH]C pUpUqN}fEf fEm]]mN}fUf fUm]Mm]EuVU}t& FE}B])]EuVU}FE}BM)F@VUExVTUE_VDEE_[^_U  WVS}5tO  1tGWuj,~?  UB4d`    X    \    J  \P\L`HdD=  t=T       &    `@GP
-GD
-GD
-tGH@GHPGH`@pL
-GHDGHTGHd@tH
-GHHGHXGHh@xD`D  t& \t	Xu6`uhp\ t
-\   X   T    wt&    Tvuwy,@0<48`R4>  $  T   XIV@VTVT<8pp@<8<X   FP4
-FD
-FD
-tFH@FHPFH`@pL
-FHDFHTFHd@tH
-FHHFHXFHh@xD/v \IF
-FD
-FD
-\T^Vh[P`dfG $Gh\hl`lpdpth\xl`|pd`Wp\hdWh`l\W\`d_GGEu!GGEu, 0    dAAEu	dh\hl`lpdpth\xl`|pd`dYp\hdYh`l\YAD@uLAD@u=AD@u05Ph tSSU*  dAAAppAYAYyYX    `   XWjx9  dP$,0B4BdQ$8B<B@BQ$DBHBLB u2Q$PB$TB(XB,t& dG$    \    `   \Pj8  dQ(BBQ(BBBQ(BBB \u-Q(B$ B(B,dG(    `F  `Pj7  dB tl
-t        1;`  `d    dW I0W \A;`ur  v 1;`a  \d    dP I0dW \A;`u  1;`  \`v dP I0dW \A;`u  h`  d   	t$  e    dA`x]l`]xl]d|]pd]|p]xM|M]`MdM]l   dGt\]\h]ht]|d]dp]p|]tM|M]\MdM]hMp   &    d@\t]h\]th]`x]l`]xl]tMxM]\M`M]hMlM]h`j$4  dB EB EXB EXB EXB EXB EXB EXB EXB EX Mx B  h\ l`$pd(thhxll|pplhplhpp $(ppEP ]$](]]]]]]]\M`MdMtMMMxMMM|   ;`E  \`dE0E,E(E$E EEEEI00,(t$0 x0|EutEutxEu
-xxEuxA;`h  ?j $$\l   tP]SSEPtPB d$`$\$j  dB    B    B  ?\`d    ;`  \I    Eu&I4    \EuI4    `Eu*t& I4    `EuI4    dEu-&    I4    dEuA;`M  \`d   ;`   \I    Eu&I4    \EuI4    `Eu
-)v I4    `EuI4    dEu-&    I4    dEuA;`ppppUZZZZZZ5tvr  MQVo   \ tF`~=jH,  Ur   BBXBX[^_UVSuEUM]@FBA    C    @8F8B8A8    C8    [^U`VSUuF BHBH$BH0]HH(H4]H H,H8]B HB$H$B(H0UHH(H4UH H,H8UE UE@UE@U]E]E]]EMEu1   v 1]EuUu]uu= tAjz*  Es~ t4= tAt& j>*  KEqA    MEu== tA&    j)  EsC    Ee[^UMUE@ HBH$BH0HBH(BH4YH BH,BH8Y A@YA@YU<WVSMu}]FHGH$GH0]HH(H4]H H,H8UE UE@U@UHUHUHUA p]p]p]EPEPEPv|  NEI}fUf fUm]EmEI}fUf fUm]umQU}AE}E484vAEEAD0EE[AD0EE[e[^_U0VSu]E    E    E    UU]tv=  t&	=  t1==  u6CECECE2CECECECUU]h[P'}uED@u ED@uEE@t*E$E$E$0c   ED@u ED@uEE@t*E$E$E$`   5t(l  h  ?j h  ?j h  ?j $$$V2n  PVh  e[^v UVSuEUM]@ F 	B A    C     [^U\WVSU]C BHBH$BH0]HH(H4]H H,H8]B HB$H$B(H0UHH(H4UH H,H8UE UE@UE@UMME  ]C41D@   U   MEu ueu]     euUeu]EuEE  EMEEMEE        X  ]E      UUMEMEE@sC  u'  EuGEu7EuE      eu]_E@s`   eu]E@F  EMEEMEEtu   eu]  E@      euUMEEMEEu7E@s1     eu]   E@s{   gE@s   JuJ   euUMEEMEEu   eu]EUEuE]]E~   = tAjM!  YEEFx t7= tAj!  NyEEAA    MEu== tAj   ~EEFF    Ee[^_UUMEukE@ HAH$AH0HAH(AH4ZH AH,AH8Z B@ZB@8t& u    B    B  ?t&     B     ZUlWVSM]UuA4}R  CHBH$BH0]HH(H4]H H,H8UE UE@U@UHUHUHUI qUq]q]Eu]Eu]E]EEE@t]EuEuEu]E5]E[K}fEf fEm]}mC]Eu$}fUf fUm]Mm}fEf fEm]Mm]EuSU}B})CE}CE}C<SUEST:UE^SL:ME^[^_U\WVS]1   E    E    E    UUUU]E    E       =     =  t\   =  t=     CECECE}uCECECECECECEGNtCU]1=CU]2tC]C]1C]C]h [P'r'U]   E]EuQUM]EEEEEEUM]]]MMUUEEEEEE]MUEuEX4EeEeME]EeEeME]EeEeME]E@4    EEH]EE]EE]E$E$E$jW   uuuuuuY   5t`  h  ?j h  ?j h  ?j E@4$P$$Pb  PEPA]  e[^_UVSuEUM]@TF BA   C    [^U\WVSU]C BHBH$BH0]HH(H4]H H,H8]B HB$H$B(H0UHH(H4UH H,H8]E UE@UE@]MM]E1EtD@   E   EE@   Eu]eu]EEuEE   EUEuE]]                       ]EUUMEMEEuEtEuEu1s  &    Eu   eu]Eu   Eu]Eu   eu]Eu   Eu]E   = tAt& j^  qEECx t8= tAj  KyEEAA    MEu== tAj  {EECC    Ee[^_UMUEukE@ HBH$BH0HBH(BH4YH BH,BH8Y A@YA    <    u    A    A  ?t&     A    `YUlWVSMUu}  AHBH$BH0]HH(H4]H H,H8UE UE@U@UHUHUHUUR rUr]r]Eu]Eud]E]E5h]EYEK}fEf fEm]}mC]Eu$}fUf fUm]Mm}fEf fEm]Mm]EuSU}B})t& CE}CE}C<SUEpST:UE^SL:ME^[^_U<WVS}]   U]   =  tv=  tJ   t& =     tCECECE1   CECECElt& CUUuThBC]C]Ut]u#hzh 3[Ph#ED@uEE@t(h  ?j E$E$N   ED@uAED@u2ED@u#ED@uxED@ukETED@uOED@u@ED@u1ED@u"ED@uEE@t!uuuuuuaP   5tTW  h  ?j h  ?j h  ?j j j 0$$W`Y  PW T  e[^_UVSuEUM]@$DF$B$A$   C$    [^UPVSUuF BHBH$BH0]HH(H4]H H,H8]B HB$H$B(H0]HH(H4]H H,H8UE ]E@]E@]V4E@tVEuUEt;EMEEMEEtZEu1   = tC&    j  EsC    E~ t7= tBj|  ErZv e[^v UE     @    @  ?U\WVSMu]}FHCH$CH0]HH(H4]H H,H8UE UE@U@UHUHUHUA pUpUA4`]EE@t?E@t3]E]]]EEu]Eu@]]Eu%E]E5HE]E5H]ENI}fUf fUm]EmI}fUf fUm]]mQU}AE}E0[AEEPADEE_ADEE_[^_U<WVS]j  UB4E    E    E       U]E       =  tW	=  t|=  uuCECECEqtCU]CU]1V    CU]Et& tCU]CU]1&    C]C]h`K[PaGh  ?j E$E$H   E$E$E$F   EEE@tu_EE_G    G    5t
-Q  55h  ?j h  ?j 55$$URS  PEPM  e[^_v UVSuEUM]@&F$B&A   C    [^U   WVSU}G BHBH$BH0]HH(H4]H H,H8]B HB$H$B(H0]HH(H4]H H,H8]E ]E@]E@]EPEPh0EPu1d  &    1G4EEE=]E]E   SE$]SE$] SE$EE]EE@s+E)E      E      E%]SEME$(]SEME$] SEME$EE]EM5DDE   D   ]SEME$]SEME$cx SEME$@Ex]EUEmE]EEU]DE>   EE  USME$pSEME${h SEME$Xph]EDE   ]SEME$`SEME$X SEME$`X]EUGEmE]E"EU]DE8EEu@= t5Fj  ~EF    E0EEu== tBj  zEr~ uE08[^_U VSuMUB4B HAH$AH0]HH(H4UH H,H8UE U@]@]EuCP$CPE$]EuCPE$CPE$^]EuCPE$CPE$s^e[^v U<WVSMu}]FHGH$GH0]HH(H4UH H,H8]E U@UE@UHUHUHUA pUpUpU]E]]]EPEPEPV  NEI}fUf fUm]EmEI}fUf fUm]umQU}AE}E484vAEEAD0EE[AD0EE[e[^_U<WVS]jR  UB4   UU]UU]o=  t	=1  t4>tCECECE14t& CECECECt& h[PWuEeEeEeEE]EE]EE]$$$=   E$E$E$;   5tF  h  ?j h  ?j h  ?j  $$$EPH  PURcC  e[^_v UVSuEUM]@0F0+B1A   C    [^UEu1&	~t& 	t& UEu1.~@"~4	t& (U   VS]STuSh@ SUS:[^U   VS]]SYTuSh SUS[^U<WVSUM1 ]B ]B ] ]A ]A ]EEW  v UC0Uf;BuqC(E@  = t5FjC(C,F;t
-;t;uC4@F^F       C]E  C]E  C]E  C]Ev  C]Eb  C]EQ  UBfC0C(    :uCx< -  < tCPEP	  URSUR`   [(FC,E8uzXEuk{$ ueSBD@uIBD@u:B D@u1t    JBu  t& uKEu"tJButJBuURU  E@ @X Eu0EXEuRJBu1?  EEu&t    JBuUB$BZ$Eu4EXEu\tJBut& EXEu+et& JBuDUB(BZ(Eu9EXEuaJBuEXEu+JBut& e[^_U  WVS]u4P0PVS%	i  4t30K C]0K$C]0K(C,&    040    C]C]C]Efv$>f>f f<<,>Efv(>f>f f<<(>Efv,>f>f f<<88>,;FuH,(;VuJ(;~ uO,N$FUF$](N(FUF(]88N,FUF,][ EuH$C ~$Ees  EXU{&    [ Eu-$   VF$s Ees %v $    , EXUL[$EuF C$~(Ees$E\Uyt& [$Eu-    VF(s$Ees$%v      (E\UP[(EuFC(~,Ees(E`Ust& [(Eu-   V F,s(Ees(v     E`UT;  CK CUfv$>f>f f<<88>~FH9}$CK$CUfv(>f>f f<<88>~FH9} CK(CUfv,>f>f f<<88>~F H9}K ]K$]K(]K ]K$]K(]K ]K$]K(] K E| K$E] K(E]K EpK$EtK(ExK EdK$EhK(ElF0,( E   E|  |EEEEEt&rRLPXPS   $,9,    |EEEEEEE|EE]EE]E   pEtExEt&rRLPXPSG    (9(   pEtExEEEpEEtEEx>dEhElEt"rRLPXPS u`;tPdEhElEEEdEEhEE1[^_UEp4uAv U<WVSj<EE j45EX4<             @ UBXBXBXBXBXBXU t%v MQVE@8Euu   c=[$Cc=[(Cc=[,=PXC0E    E;=   t& =P'C0M1;==t\&    =PC0M1;5=t t& C0U    F;5=uG;==uEM;=i=C=C=C EE  v UBcs$}fMf fMm]EmBcs$}fUf fUm]mM;KuIMUBcs(}fMf fMm]mBcs(}fUf fUm]mM;KuIMUBcs,}fMf fMm]mBcs,}fUf fUm]mM;K uIMEU9       };}   t& u;u   t& C0M< u`j,C0MB    EK$CRC$}EK(CRC(ZuEK,CRC,ZjEC0M@BC0PF;uLG;}2EE9EUR8UEe[^_v UVSEUM]u@LtCBL    AL    CL   FL   [^UlWVSEE]E]EE    E  ?]]1EEUU}    1    E    U}8}EA~F~1UU}}t& E    1    Ut&     }UU:};;A~F~1]EE    1    }}A~F~MEEE[^_U|WVSEE]E]EE  ?UU]1EEUU&    }    1    Et&     U}8}EA~F~1UU}}t& E    1    Ut&     }UU:};;A~F~1]EE    1    }}A~F~MEE]E[^_UlWVSEE]E]EE  ?UU]1EEUU}    1    E    U}8}EA~F~1UU}}t& E    1    Ut&     }UU:};;A~F~1]EE    1    }}A~F~MEEE[^_U   WVSEE]]Ep41  t& h`SEx|xEptpX%] hS|xtp&%] EE]EE(  ~]E  h`SEhlhE`d`] h`Slhd`] hSlhd`] hSlhd`EMEMEME]EMEME]E] G2>EE  EE  Ew  EEc  ES  = tCjECEE^E@ ]E@$]EEuFE@(EuvFP  PE$E$E`p wE@(Eu0FHP  PE$E$E`p$1   P  PE$E$WE`p(EtC    E C1H[^_v U,WVSu]1;u:EPC(C$$C C$EPV<  ; uF]F ;uF]F$;uF]F(]E[E@suC PVuEPEPs VE]E@      C$PV7   EPEPs$}v C$PVuEPEPs$V]tK E
-Eu.u*C PVuEPEPs Vxe[^_U,WVSME@4EAI(AI$AI AI(AI$AI ]EIIII(I$I I(I$I ]EIII1Ev 1}8U}D8HU8   U`BuCuuEP@4  Qe[^_v ULWVSEX4C   EP  V]uu]uu]   WVuuuu] H  SVuuuuu] EPVuuuu] WVuuuu] SVuuuur]EMEMEMEMXMMXe[^_v UWVSuE]HF4 I}fUf fUm]}m@I}fEf fEm]umQU}AE}E484vAEE AD0EE[AD0EE[[^_UWVSMuE Q}QYQYE    1Ut& E}Eu
-E<}AE8Eu	E8Y<}AE8EuE8Y<}AE8Eu	E8Y<}A>Eu>Y<}A>Eu>YC;E}![^_U  WVSE E(E0E8E@9ED  UD  j4MA h`}WP URQS}WSEP URS|Q}WS<V VPRP   Y YQ(HY$ED@PU@R$x|xptpEPURVQWP6Pj49<UB$hMQWq EPWS`URSQL }WSP5URSV' VQW<P<    X XX(P$PU@R$|xtpMQ}WVPR<QP  j4}G h`EPSF URSlQ)lWS SEPUhRSMQ|dW SEP<VVWhRP2   Q HXTTYY(Q$ ED@PPU@RHLH@D@\X$EPURVWhQW@j4<UB$hMQS }WSlPlRSa SMQhWSEPdR~ SMQVmVdWhP<P<   TZ ZZ(Z$ PPU@RLHD@$\XMQ}WVdPhR<QR@E   E@<XEu<BMY}G<XEu<B_MA<XEu<BYMA<XEu<BYMA<XEu<BYMA<XEu<BYA<aGaGaEu!EuU    *M   EuU   	M    }tW	t   t}   @<XEuUJ$<z UB$@Z   A<XEuUJ$<J }G$@_I@<XEuUJ$<z UB$@Zh ([^_U   WVSh  EUB4hE  PE    }   M	e  $EpE    U   U}1]v U8Eu*ExEuxAuE}uUZZ(  MqE    E  E}H1]E:Eu*EHxEuxAuE}uUZZ   MqE    EH  |}   1]|:Eu,E   xEuxAuE}uUZZV+   t& MqP    u
-h@EpW	    u
-h Ur`    uh`E  P!,hhMIMt& h{EPUP+} Y5t  E    }uH]   t1E8U0UUJ@JPJ`BpUJDJTJdBt]JHJXJhBx]8E0EAuE}xj4TEM  E    u   @     @  ?@(    @$  ?E  PEPoE     ]1U4Eu    AuE}uj URh  ?j j j h  ?j j j EPE  PE   PEHPEPMQb}u   @5t  EP  X[^_UVSuEUM]@DRFDQBDSAD   CD    [^UVS]M; u     H$5Eu&EuEt& r$Et+3Eu&    r$Et; u ;3uq$t& q$J$ @$    [^U(MEUE]E@"U@bU@bUBH H$H(]EJYBYJYBYJv U  WVSUMA BHBH$BH0HH(H4H H,H8B HB$H$B(H0HH(H4H H,H8 @@        A4p  v &UfUfUFEm  EuET  E   = tC$j(~sC   C    C$    SWQ= tC$t& j(sC   C    `Eua= tC$j(sC   C   C$    SWv  #  p                         $    (    UB4 |       t& tpsPCPzC@     { tU|   C $$CCCC[$k   lt& | u;<  lPj$lRVC $lQV9ud{   C@    C $$CCCC       PRW$$lPVS0= tBjEAA    U
-`C@   C $$CCCC[$;tC$S$uX[^_U4S]UMA HBH$BH0]HH(H4]H H,H8UE ]E@]@]C    C        A4@   E]E]E]     x    @E UE`UE`UHMMMHMC[MMMHMC[@ U[Uv U,WVSujUB4G    G=u  t=v  u^GC _Ft& h {vP
-u5t   uh`wG CEXG cUZG@CZG@cZG@CZG@cZGX    CEPEuUZcEPEuUZCCEPEuUZCcEPEuUZCCEPEuUZCcEPEuUZ[ @E@$@$@$@$@$@$P  @UR)
-  e[^_UVSuEUM]@HjFHldBH    AH    CH   [^U   SEElEPl5]E]Eyt.xtzt3Et& UU]]<U]]](UU]]    ht   P|S&SEPt   Pt  XU   VSEEExtpuVx]t]p]t   P|S SVt   Pt  X[^v U   VSEEExtpuVDx]t]p]tP|S SVtPyt   X[^v U   VSEEElhduVl}]h}]d}]t   P|SJ SVt   Plt    h    d    EuEu.    ;hdEt
-dt    t  H[^v U   VSEEElhduV\~l}]h}]d}]tP|S ~ SVtP~lt    h    d    EuEu.    ;hdEt
-dt    t   H[^v U`VS]t   PuV}VSt   P}CC]ECCC]EC C$C(]Et            EuEu!    $Eut    t  e[^U   VSEedEe`Ee\d`\PP$h  ?j h  ?j + uV{U]tP]Sk{ SVtP{`E@   P`llEuEullhuVzh]l]h]l]tP]Sz SVtP{dD@u\E@  d\dl\hlEuEulhEuEuhuVyh]lU]h]tP]SVy SVtPyuVQyE]E]E]tP]Sy SVtPyt   8[^UEEU$]E]EEEED@uD@u]EE@t)Z    ZZv U   WVS@UBt  B B$    EPxttx  v x;tz ttQ  xp2  V|j   UB$CZ${ ut  C   sF]F]F ]F$]F(]F,]F0]F4]F8]]F]F]j<4EPtPEPwwt  F  F  FE^E^E^ E^$E^(E^,E^0E^4E^8EE^E^s |xIxt   tnX[^_v UWVS]}   ;T  usj=Es   Ex tBjUr   Z{ tjs   CUEPx;e  u$j@MAsPhuR    ;t;6  u?1st6jVS uEXt& _vue[^_U   WVSu           tw   PEPt    tlE<@&    <P      PW8uW<Pt        u   PEP]t   PEP@StSh =Vt VF@Pv      5      ts   PEPs    thE8@v 8P      PWXtW8Ps        u   PEP}sEPh =VtVF@Pv j<  ZFZFZ FZ$FZ(FZ,F Z0F$Z4F(Z8F0F4ZF8Z  B  B  B       [^_U8UEEEE$E,E4]E]]]E]E]EUE]E]tH@EHPEH`@pUHDEHTEHd@tUHHEHXEHh@xURRRZRZUUUH@HPH`@pUHDHTHd@t]HHHXHh@x]EuZB]EuEZB]EuEZB]EuEZB]EuEZv B]EuEZUUUtH@HPH`@pUHDHTHd@t]HHHXHh@x]BEuZB]EuEZB]EuEZB]EuEZB]EuEZt& B]EuEZUE]UtH@EHPH`@pUHDEHTHd@t]HHEHXHh@x]BEuZB]EuEZB]EuEZB]EuEZB]EuEZB]EuEZUUE]tH@HPEH`@pUHDHTEHd@t]HHHXEHh@x]BEuZB]EuEZB]EuEZ&    B]EuEZB]EuEZt& B]EuEZUE]UtH@EHPH`@pUHDEHTHd@t]HHEHXHh@x]BEuZB]EuEZB]EuEZ&    B]EuEZB]EuEZt& B]EuEZUUE]tH@HPEH`@pUHDHTEHd@t]HHHXEHh@x]BEuZB]EuEZB]EuEZB]EuEZB]EuEZB]EuEZUE]E]tH@EHPEH`@pUHDEHTEHd@t]HHEHXEHh@x]BEuZB]EuEZB]EuEZt& B]EuEZB]EuEZt& B]EuEZjZjZjZBZBZBZU<   WVShEPu$URh  SSj     l#uV
-tRuKVPNPPh$V tMQh@S+Sj 1tV0u]fC fC"@PC$t$EPh SSj 1]  #u'&    V
-<  u2  VP^PPPhV0t$URh S+Si ]K$(ff fEH$(ff fAEP$(ff fBG9}VM}9t$]Sh  SSh Vc[^_U,   WVS]1t@Guj~jWO >   ;Y     xKff fxKff fAxKff fBO0t& 5Ph@P~Qf [P.[^_UDSUM]BEuEu]E5E@   E@   UBUE    ]EU]]EuEu]E]E5]Eu&    
-    [U(E]EEuDH}fUf fUm]EmEEP]EEu0XEtP
-]Ev U,WVS}]w$   ECECEEPEPEPEPVW F=%  tS=  tl=  ttv =+  t=[  tD_E[E[E[KE[E[E[ 5E[$E[(E[,[@t& EE[E[v6e[^_U0VSEuE  ?E    ` ]@]@]19}Sv EP$!  EE]h}]h}]h}]5h]C9|pm]Ee[^U,WVSMu] < tiECECEuEPuuVQF M F M K[F M K[xKK]Ee[^_v U0VSuU]FHBH$BH0]HH(H4]H H,H8UE UE@U@UH]H]H]F@t=;x=ut=44]t=]t=FH]Ep]    E$U]uVBBCB C  VtHE]Eu;EJ$eFEH(K[FEH,K[E$|]F    Ep]E]Eu
-]E$4]E%VtG]Eu?EJ$eFEH(K[FEH,K[F    Ep]E]Eu
-]E$UEVtG]Eu?EJ$eFEH(K[FEH,K[e[^U0VSuU]FHBH$BH0]HH(H4UH H,H8]E U@UE@UHUH]H]VB$B(CB,CFH] t*p$H]EteF t)Ep$]Et.F t:Ep$]EuVBBCB Ce[^v UU0VSMUAHBH$BH0]HH(H4]H H,H8UE UE@U@UH]H]H]YC}fEf fEm]umsEPCMK]E   9}t& E]@9|E$uS{  Ee[^U0VSMUuAHBH$BH0]HH(H4]H H,H8UE UE@U@UH]H]H]YsEPKU$VS  Ee[^U0VSMUuAHBH$BH0]HH(H4]H H,H8UE UE@U@UHUHUH]YK]EP(  KEK]E$VS  Ee[^v U0VSMUAHBH$BH0]HH(H4UH H,H8]E U@UE@UHUHUH]YC}fEf fEm]um]EK]sEPKE]E   9}E]@9|E$uS  Ee[^v U<WVS}U]uGHBH$BH0]HH(H4]H H,H8UE UE@U@UH]H]H]EPEP  GEHEHC[EHC[C^C^CC]Ee[^_U<WVSMUuE  ?AHBH$BH0]HH(H4]H H,H8UE UE@U@UH]H]H]Y1;{}^EM]EM]EM]EPEP  EKEKF^EKF^E]G;{|EFXFXFF]Ee[^_U<WVS}U]GHBH$BH0]HH(H4]H H,H8UE UE@U@UH]H]H]uV  UWZEuHEPVn  GE``]EHUMEMC[EMC[ECXCXCC]Ee[^_U$S]UCHBH$BH0]HH(H4]H H,H8UE UE@U@UH]H]H]EP  USREubb]EJ]	E  ?E$uso  E]v U4SMUAHBH$BH0]HH(H4]H H,H8UE UE@U@UH]HUH]Ycs]CE@tsEPeKE]E]uuuS  E]E]U(%  EE]Ex=-4HEE}fUf fUm]EmU,WVSu]}4t=;x=ut=44t= t=FH]t=;x=ut=44t= t=FH]t=;x=ut=44t= t=FH]ECE[CE[C_C_CC]E[^_U<WVSMU]}AHBH$BH0]HH(H4]H H,H8UE UE@U@UHUHUHUQ1;J   5&    I$UdUdUD@u]EJJB]EM]M]M]ECE[CE[A;J^C_C_CC ]E[^_v UPVSMU]uAHBH$BH0]HH(H4]H H,H8UE UE@U@UHUHUHUQ   ]t& E"UbUbUD@u]EJBE@t+B]E]EBJ]EM]M]M]ECE[CE[R-C^C^CC]E[^UWVS}=    Wj19}uuE]] ]vPEP  D\D\F9|   e[^_v U VS]j V^F    F       =M  tE=  t=L  t({v =N  tY=Q  tbhCC^C^eC^]t& CE@tC=^9^-t& C^C^h@cN[PAe[^U<WVSu}E]E~$ uvEut& EuNNO_N/      F EE}fEf fEm]]m}1F 9~XK[IV$EE]DEE]DEE]EE]D
-EE]D
-EE]EeF EEE]EeF EEE]EeF EEE]M&M&O_M&O_[^_U   WVSX    T    0    = u%}    tn     j,@    \    \    EP   G\vX u!URh]SmSK u,q\<u  uA,8Hu]jP,BP  ?A  ?A  ?   t& X   ,@v ,?t? u"j0,B  0   Hj(vL,AL  ?F$    F   F  ?F    F    H  ?@    D    4    8    <    1x u jPB@X@@   t$   u3h(  t$     $  $      t$  t   H   t   PJt        UK}  $     ,9Huh]  t& uvLWC      UB LA$B@fA fA"   ,>Huh   }G~f~f f||xx~LA  uF,GTPOT  v ,>Hu}GPo  UBL\  ,>Huh`9  0 t),GUBX$GBX(GBX,  MAL^A^A^  ,?Huh  v E@D8     t& ,8Huh  t& UB@4   u  t& ,8Huh M  t& UBHBDB@4   8   <     0 t,BMAXB  ,>Huh`  }GH<     v fPdP`PEp,:Hu_`PAdfAffAdxxIYfxxIY$  t& `LF$dfF ffF"  &    ,?Hu&P@EpPZBpZ  h  0   ,AuFX  0 ~  ,GUBXGBXGBX U  t& 0 C  MAEu,BAXBMAEu,BAXBMAE   ,BAXB      MqA$      uF$F$F$ k   }G$G$G$ ;   Ep0Urr t& hCEHMPF} A   j<G,Nt   Y   Y   Y    Y$   Y(   Y,   Y0   Y4   Y8      Y   Y  Q  Q  At& ,G    ,8u
-j2,:Htb0 uYLQQY< tHQQY8 tDLX4 t@LX@t   t,[^_UlWVSuP ]EEu]E}fMf fMmUUm  Z  }fMf fMmUEmEEU]P F]EEu]E}fMf fMmU}m  O  }fEf fEmUmEU]P F]EEu]E}fEf fEmUum  F%  E}fEf fEmUmE]]EEEU]EEX ]EE]E]EE@EEHHE@EEHHME@EEHH4vEEHHMMMMIEEHEHEE@EEHEHMEE@EEHEH]][EEHEHM` ]E[^_v U,WVS1=   h0  Oh  =4v ;u4t&  ];u4 ];u4 ]EUEEE@sN]EEu]]]vEE\E\F  1t& 4F  ~14h }fEf fEm]MmF  ~15   I   D  D  A  ~   e[^_U,WVS]}p +]p k]p k]uV2p ]p k]x C]V_ ]C]C] V_e[^_UE$%U,WVSx u$jjPB@@    @p   t$   u3h(  t$     $  $      5tt$  t   H   t   P;E    } t_EG}uuEE    9E  }  =#  tt=!  t=="       =F     =6     s  =e     c  G$G$G$ H  v G$G$G$   t& wG$\   &    wwb    j w   {8 t	I8y8 u<A8   v E    E    wtEjVS } u]&    MY]E@    vuj~GP QEPQ0 h 93EM9M}t_WVu@t   te[^_UWVSu}F =   #  1=   V  =     y  t& =     e  = /    = '  t#L  &    = 7  tn= ?    .  1f~$ 2  V    FhMFlMFpUt;CF$9|  1f~$   V}    U}p   F$9  VJ  FhMFlMFpUt;MCM   F$9|   t& V  FhMEFlMEFpUEt;C} tAF$9  MEUMEUt;MC} tF$9|F$9  t& 1f~$   v V?  {  FhMFlMFpUtV   ;v V  CF$9|,      1f~$   v V    U   ,  F$9  V  FhMFlMFpUtVR  ;t& V?  MCM   F$9|   &    V  FhMEFlMEFpUEtV  ;E	V  C} tDF$9  MEUMEUtM;MC} tF$9|F$9  1f~$   VJ    EV-  UV  M t;CF$9|M  &    1f~$ 9  v V    EV  UV  M tV  ;	V  CF$9|      1f~$   v V_    U}r   F$9  V,  UV  M V  Ut;MCM   F$9|   t& V  UEV  ME V  UEt;C} tAF$9  MEUMEUt;MC} tF$9|F$9  v 1f~$ y  v V  [  U   ,  F$9?  V  MV  U V  MtV  ;t& V  MCE   F$9|   Vw  UEVe  ME VP  UEtV7  ;E&    V  C} tDF$9}[t& MEUMEUtM;MC} tF$9|F$9h   1   e[^_Uj uuuuUuuuuuUU w  w   v%   v UVSu]jEPV+    EE2#jEPVth   E	M}uEe[^UVSu]EEjEPVth !  E%   E 	E%   E 	E%   E 	E]Kx+jD+PV#th !*  KyE@e[^USM]A    	#	Au[UWVSu}jEPVEEPV u5uh`!  uSV;Eth!v  EG_e[^_UWVS]jj 3}EjEP3 s8jFP3NE jEP3Vs83%E  jEP3jGP3 s8s<3+Ee[^_UWVS]jj 3EjEP3F jj3EjEP3 jCdP3cE jEP3 jGP38CdPsh3 CdPsl3CdPsp3)e[^_v UWVSuEjEP6ljj 6E jj6EjEP64 F$P%   PF$P6iE jEP6F&P %   PF&P6)EjEP6 F(P]%   PF(P61 F!t.EjEP6oj j 6    F!t0EjEP6;E jEP6%G F!t0EjEP6E jEP6G F!t/EjEP6E jEP6 EjEP6EjEP6 F!tF@EjEP6hF!tFDEjEP6GF!tFHEjEP6&E	jEP6jv46X F!t/EjEP6E jEP6 F! t*E
-jEP6jv6 ~    EjEP6tF*P jF*P6EjEP6; F,PjF,P6tE jEP6F.P jF.P68EjEP6 F0PljF0P6 E jEP6jCP6 j EP6jC+EP6+E@e[^_UEv U VS]jj SxjEPS7 ujh!EPtj VS91   jthu1   F<!F8    F    FTF   P)FXuh!  EP6Ij u6 ]S6mSV   uFTFXF\F`j v6ne[^U,!  WVS]}   jt  @    @    @    @<!@8    @    "    u@   1)"    th":  A  E6"    t#h  RP}  ~ %   BTPFXuh@"	  x u@XB\  jEP6o  jhw"EP   EPhz"S@h"S uURh"   6HS^F    jEPRtS>   jh!EP   P0j 2 ]S6SV   uFTFXF\F`j v6$EPh"SSW  1[^_U    VSu|jtu1c&    C    C    C    C<!C8    C    3CTP;CXuh@"  CXC\[^UWVS}E8th #k  G     G    UrB9}  v U  $L#EPFP	EG0  EPFPEfG$  t& EPFPEfG&  t& EPFPEfG(  t& O!EPFP  &    O!EPFPh  &    O!EPFPHu  &    O!EPFP(U  &       G!tFG@   G!t2GDBG!"  2GH  t& EPFPEG4   t& EPFPEGO! j u7 ]S7SW    u&   O!EPFPQ~   EPFP<EfG*^&    EPFPEfG,>&    EPFPEfG.&    EPFPEfG0G   FtUBB9e[^_UWVSu}?th#  E    _G9sQt& t0u,EPCPNEPCP<EfFdC\GG9rj u6mFdPVh FdPR6FdP{Vl FdPR6FdPVVp FdPR6e[^_UWVS}u>th#  G8    E    ^F9sKtt+EPCP<EPCP*EG8C\FF9r8 tJw8G<t(j u7Aw8w<7&    h $  e[^_v UWVS}E8 th`$  UZB9   u;ucEPCPej u7 V7pEtt$VW
-VWu C\UBB9re[^_US]C\;C`u(sTsX3CXC\S`C\ C\]US]EEC   KXST
-9C\u!RQ3wt& CXC\C\UC\   ]UWVSu~ u2~ t,VXF\)PR6 u   &    vX~8 tv<F! t'vhvl vp|E~^VeuEP	We[^_v US]{ u({ t"SXC\)PR3RuXsX{8 ts<C! t'shsl spS]Uu5djcv Uu5dU   ]US=t;u[UUS    [8  [                                                     000 pic.pix w /tmp/dartlog %s
- image size %d %d
-                art: output file should end with ".pix".
-                       art: input file should end with ".scn".
- /tmp/%sXXXXXX          art: unable to open temporary file %s.
- x y z geometry sphere ellipsoid box torus algebraic cylinder cone superquadric ring disk light polygon r                in.artd: unable to open file %s.
- .pix                          world bounding box: %+11.4f %+11.4f %+11.4f
-                    %+11.4f %+11.4f %+11.4f
- frag size %d %d
- %c - %d %d %d %d
- D     B=      ?-C6?8         o@      ?     o@      ?syntax error                    art: idiotic angle in field of view.
-                           art: up vector and direction of view are the same.
-             art: bad transform type in switch.
-                             art: bad statement type in switch.
- tile art: object %s not defined.
-                           art: illegal name in equation.
- yacc stack overflow          v@9RF?      ?-DT!	@     f@6EV0` 0@Pp`2tp@p  P 7 `  0 @` 0`  s0s@sPs`spss"S  @`3$35s2B@p7 0PpspPg #Xt`pGspQ08rWWWWtWW(WWWWWWWWWWWWWW$WWWWWWWW WWWWPWWWWWWWWWWWWWWW@                      n n     |   u  x y t q w r o s n z m v m m m m m m m m m m m m m m m m m m m m m } ~ { o p  o n m m m m m m m m m m m m m m m m m m m m m m m m m m m m m m m m m m m 2 m m m m m m m m m m @ m m m m m m m m m m m m m m m m _ m m m m m p p m m m m m m m m m m m m m m m m m m m m , m m m m m m m m m m m m m m m m Q m m m m m m m 3 m m m m m m m m m m m m m m i j m m m m m m m m m m m m & m m m m m m m m m m m m m m m m ' m m m m m m m m m m m m m m m m m m m m m m m  m m m m m m m m m m m m m m m m m m m m m m m m m m m m m m k l m m m m Y m m m m m m m m m m m m m m m m m  m m F m m m  m T m m % m m m m 7 m m m m m m m m m m m m m K L M m m m m m m m m m m m m m m m m + m m m  m m m C m S m m m m m ] m m m m D m m m d m m m m m m m m m m m m m m m m m m m 5 6 m m m m m m m m m m m m m m m m m m m  m ^ m m m m m m  m m m m g m m m m B m m A m \ m m m  m m m m m m m m m m m N m m m m m 8 m m m m m m m m m m m m m m  m m ? m m / m 	  m m m m m m m m m I m J  m m m m m m m > m m c m  m P m m m m m m m m m m m $ m m m m m m m m m m m m R m ( m Z m m  m m m m O 4 m m m  m m m m m m m m m m m m m m m m m m m m " m m  m m m m m W X m m m  - E m = < m m m m m m m m m m b m m m m m m m  . [ m m m m m m : m 1 e m U m ) m  m m m m m m  m m m  m m m  m m m  m ! m  m m m `  G f  m m  m m 9  m  m m   # m * 
-  0 a V  ; m m h m m H                                                                                                                            	   
-                                                                                                                                                                                                          !   "   #   $   %   &   '   (   )   *   +   ,   -   .   /   0      1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ! %     $ % " . 4 9 : - ; ? M R ` ] n S u c   l D m   q |u q ~k   w z{ t|    s konphmjm{iu  jfhd_ xdbigcbda ^\feSRU^TRN  PZ]QPUM Q USPMCSH  M PL9A;FFB9548@::;.4:;<;:.442$0+/,$  !, #$      	     	                                     ~|    ~x~{t|{lpoxwotx  i  vjiog^  k]j\  jdYV  WT  U  eRQQ]X[PO\[VTSF  KJGKN  NPG::A215@ 832  66  -3       27101766-  /    6"4+*"0  -&  -             
-                                                                                                                                                      /   > X                                                                                                               	 
-                          ! " # $ % &  ' ( ) * + ,    - . 0  3 1 4 6 C 7 ; 1   < ? D 8 9 : F = @  A J > G B K M R U H N S I W V T [ L \ ] X z  z Y _ { Z ^ ` a b f c   d g h e 3  4 u i v j m k l n o 0 w x 1  p  0 q 1 1 r  s   1                z  z   {    3 +,    7  8`4EFGaNoOp5 o~}|{zyxwvuNtsrqnmlkjihgfedcba`_^]\[ZYXWVUTSRQPMLKJIHGFEDCBA@?>=<;:9876543210/.-,+*)('&%$#"! 
-	 7~}|{zyxwvutsrqponmlkjihgfedcb_^]\[ZYXWVUTSRQPONMLKJIHDCBA@?>=<;:965210/.-*)('&%$#"! 
-	                                         {                                                 ~ } | y t Q P O E 2 /                                                                      =         > =          >        # $   #  % $ # &  & & % 1 : 1 % ' 1 % & ' ' ' ( '  : ' ( ( ' 4  4 + ( + ( ) ( ( ) ) 0 + + 0 9 ) ; 3 ) 0 3 ) A ) Q T 3 Y 9 A A A ; R \ T Q R f _ ` R z Y z   z \ _ `     f     _       r7uur7rCC}|{yxwvutrpnkihgfed`_^]\[ZXWVUTSRQPOLHGFBA@?=<:9876543210/.-,+*)('%$# 
-	 ~}|{zyxwvtsponlkjihgfedca_^][ZYWVUTSRQPONMLKJIHDCBA@?>=<;:98654310/.,+*('%$#"! 
-	                                                                                                                     ~ } | { y x w v u s r q p o n m l k j i h g e d b a ^ ] [ Z W V U S P O N M L K J I H G F E D C B @ ? < 8 7 6 , * " !     	  syntax error %d art: unterminated comment - started line %d.
-                   fatal flex scanner internal error--no action found    0@P`p 
-
- 0::DP`p  0@P`p 0@P`p  0@P`p 0@P`p (@T  0@P`p 0@                 fatal flex scanner internal error--end of buffer missed         fatal error - scanner input buffer overflow input in flex scanner failed                        flex scanner push-back overflow out of dynamic memory in yy_create_buffer()                     out of dynamic memory in yy_scan_buffer()                       out of dynamic memory in yy_scan_bytes() bad buffer in yy_scan_bytes() %s
- r art: unable to open file %s.
- # 1 "%s"
- clude %s .frameid # %d "%s"
-     art: %s line %d - %s
- (%03d)           art: singular matrix in minv4.
- matrix %x
- %e %e %e %e
-         W_cgq{modrf overflow %f %f %f
-    |=      ?MbP?                sbisect: overflow min %f max %f diff %e
-              ?|=MbP?                        csgsbisect: overflow min %f max %f diff %e
-                     csgsbisect: roots too close together
-                           csgsbisect: overflow min %f max %f diff %e nroot %d n1 %d n2 %d
-              ?|=   ?           @Sg                   art: illegal field in light ignored.
-      @         f@-DT!	@       @                        bad assignment in -D.
- %f %i    art: bad expression in defvar.
- art: variable %s not defined.
-  art: bad variable in get_varexpr.
- art: symbol %s not defined.
- art: bad type in eval_fexpr.
- art: bad type in eval_iexpr.
-     art: bad subexpression type in get_expr.
-                       art: bad expression type in get_expr.
-  P556065    art: unkown object type %d in objectinit.
-  :P<P<P<P<:P<P<:P<P<P<P<P<P<P<P<P<;;;P<;P< <0<P<P<0;P<P<P<P<P<P<P;P<P<P<P<:P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<p;P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P<P< <P<P<P<P<P<P<P<P<`;===== > >@>`>>>??????>>?>r                               art: error opening tile file %s.
-   SgSg                    art: csgn called!
-              art: illegal type in csgtree.
-  art: bad detail in csg ignored.
-                                art: bad detail in composite ignored.
-                               o@                        art: sphere radius must be > 0.
-                                art: illegal field in sphere ignored.
-                        Sg                            art: illegal face type in boxn.
-      cccccdart: illegal field in box ignored.
-                             -C6?-C6?  >  >  >  >calc2dbbox: bad type in switch
- r art: cannot open offfile %s.
- %d %d %d
-                       art: can't find header info in offfile %s.
- %f %f %f
- %d %hd    polygon %d in geometry file %s not a polygon!
-                  vertex %d unused in geometry file %s
-                           number of edges should be %d not %d in file %s
-                 art: cannot open colourfile %s.
- %d %d  %f %f %f  %hd           art: cannot open normalfile %s.
- %d                             art: bad header in normalfile %s.
-                              art: cannot open vcolourfile %s.
- %d %d %d                      art: bad header in vcolourfile %s.
-                             art: cannot open vnormalfile %s.
-                               art: bad header in vnormalfile %s.
-                             art: unknown construct in strip.
-                               polygon %d in triangular strip is not a polygon!
-               vertex %d with dud triangle in strip.
-                          art: illegal field in geometry ignored.
-                        art: no geometry data given in geometry.
-             ?  >art: bad axis in interp.
-           MbP?5^I @  art: bad type in buildp.
-    @0                art: illegal field in algebraic ignored.
- %f %d %d %d
-  SSg      @       @             @      -DT!@       @     o@art: illegal field in torus ignored.
-                           invalid polygon in heightfield
- art: bad axis in maketriangle.
-       ?art: bad axis in inttri.
-                               ran out of nodes in heightfield - increase MAXNODES           ?getcol: bad value in switch.
-         ?r                       can't open colourfield data file %s.
- COLORFIELD %d %d          can't open heightfield data file %s.
- HEIGHTFIELD %d %d              o@                        art: bad axis in inttri.
- art: bad axis in polyi.
-           o@art: can't interpolate across a polygon with more than 4 vertices.
-                             art: illegal field in polygon ignored.
-                         invalid polygon in file before line %d
-                         art: bad axis in polygoninit.
-  -C6?      ?                     o@                        art: illegal field in ellipsoid ignored.
-                         -DT!@     o@        art: illegal field in cone ignored.
-          ?                  -DT!@     o@        art: cylinder radius must be > 0.0.
-                            art: cylinder radii must be > 0.0.
-                             art: illegal field in cylinder ignored.
-                            -DT!@     o@        art: illegal field in ring ignored.
-    -C6?-C6             @-C6?      I@8         o@                        art: illegal field in superquadric ignored.
-         ?      ?                              smalloc: request for %d bytes from malloc returns NULL.
-        scalloc: request for %ld bytes from malloc returns NULL.
-       hh>Sg              @@          @{Gz?      ?     o@                        subdivide: unknown type in switch.
-           ?bezier cardinal bspline art: unknown basis in patch.
-                           art: illegal field in patch ignored.
-   -C6?B^^f_```````           @                            art: illegal field in blob ignored.
-                            blobbyinit: no metaballs in blobby!
-       ?                    art: bad axis name in rotate.
-  -DT!	@     f@      -C6?r                               art: can't open ascii map file %s.
- %d %d                       art: improper header in ascii map file %s.
-                     art: no header in ascii map file %s.
- %f %f %f                  art: improper data in ascii map file %s.
-                       art: ascii map file %s too short.
-           o@                art: illegal field in map value ignored (line %d).
-          o@      -DT!	@      -DT!@image tile wavey waves ripples ripple bricks blocks spotted stucco fuzzy fuzz wrinkled granite colourblend colorblend bumpy bump oldwood wood2 wood1 wood marble            ?      @      @w/^@V$?333333?333333?zG?)\(?      ?      ?      ?-DT!	@      ?      ?      @      @      @      ?       ?            @-DT!	@      @      @Y@_vOVV@HPY@                        art: illegal field in wave source ignored (line %d of %s).
-     -DT!@@         o@        art: unknown procedural texture %s.
-                            art: map in tile texture ignored.
-                              art: range in tile texture ignored.
-                            art: blendcolour in tile texture ignored.
-                      art: turbulence in tile texture ignored.
-                       art: squeeze in tile texture ignored.
-                          art: scalefactors in tile texture ignored.
-                     art: scalefactor in tile texture ignored.
-                      art: size in procedural texture ignored.
-                       art: illegal field in procedural texture ignored.
-      >```````````````````````W `````````a``````````0```````````5````      @      @      ? C    y@e@@A@ZBA@                        art: bad type in repeat loop.
- readrgba: bad file format.
-      readlongval: unable to read value.
-                             writelongval: unable to write value.
-                           readvortobj: unable to find space for object.
-                  readvortobj: unable to read object.
- VORT01                     readimage: unable to allocate space for image buffer.
- r w openimage: bad open flag.
- -         openimage: unable to allocate space for image buffer.
-  uncompress < %s                       Unable to open compressed file %s
-                              openimage: %s is not a vort file.
-                              getimagedata: object passed not an image.
-  0Pp0P                      getcolormapdata: object passed not a colourmap.
-                gettextdata: object passed not text.
-                           gettextdata: unable to allocate space for string.
-              setupimage: main object not a directory.
-                                                   h>*W?x>>+>b?0O<?1#>hv>0?q=\f?x'>">v?0?+?9>>8>p>?X>=Y>}[?$q?@)?X?4;>0X?HI?P>{?>??Y> b? > > >`c>$?@???@1>x	'?H>PEr?o>q?h;??> <P?Q>`?,s= >h> 9d?>85?>k]?8,?0>u? QF?P>X j>p>P>u+?08?`?(S?H>Q?X?8>`q?>XJ?8p=i?a?B??>10?B?P]>A >!>8c>_?`?T:J\?H+<P?x>>8:w?o?6O?>0ka>?>b>(>)2>p2:o7=pv> >3?+c>@ ? G=?>}>`_>`>Hj?@P>QE>MX>8"?`g[=H?G<`>4>Xn?h?>h'_?2? n?>>d?@1?HV?\=?&?-?(?(>uo?t)?3B=> B?1>0.>%?@o<dW?=@>?>@f? [>h>hX>8&?X>!j>x>vq?>`E>x? >u]?>X.? IU?U`?hP&?=(f?`>`?W?0T?>A?=Y?00?`[?h>1?>d?mu?HP=xF{?aa=a?*= >?PX>h?@t?(Q?8>P<>0>>``H><`T??0=X;?`= Ce>(r?x2=?pDR?X}S?p>hS>'>>P?f>l>^?;=`>>P\?#>`R?Hr>x=hY>`j?zz? >Pf?hv>`>@?Xh>f?>X?0px?.>h>c7>|\>h>>H27=/?~=&?0>S>02 ?`=v?x:?jN?(>|4?x:?`W?0?8t?Xr>? <p?B=?'>`g?>&>Z?8;?=P>>3|?-!?xT?(>J?@s=`
->8?2n?b?@>@>X[[? >=?G?8>pO???>XB> ]>f><?7?q>1?G?CC?=>m?D?C>0{?0>=+?<A?>@>P^>?hR>0zI???!>> Y?`g>PU?0I>@x>Xls?~>> >}>b?+?|/?w?:>[?@<`P> !> /?P>[X>p=PE>f?`4H?>`>Q}?L?b>N:>f> <?? ,*?N>	>?=>0<Z?xc?=	~=h>7>0e?xJ	>r?x> =hH?(>(>3?X`B>?>@~>m(?8>B>HR?@b<xl?`>p?>>0?@?p/>N>P">h>8[?><0?pV?HP?G=b=@>??>>=B?L$?#<?H#?=y;?`a?H?>r?.>@>`3?5>O?@da?:V=>{? >Q?hZ?->P?<=w?.?e>P9?pl?%&?oj?@?	?z?0o>`M> ?G?XL>Pf?<>m?C?>n?F<y>P]>X:?6?Ht-??p>0=>]?g?> s?m>?P?@>xz? ?#>
-?.E>
->X>>a?                  ?  ?#               Sg      ?      ?                            ?                  ?                  ?                  ?    <  ?  ?  ?4<                                                          @(#)yaccpar	1.9 (Berkeley) 02/21/93                                                                                                !  "  #  $                        	 	 
- 
-                                         %                                                                                                                                                        "                                                                                                      P       R                       T     V           \                                     Z                       X m n o                   ( '         "   4 ^ _                           v         G                                                         N O J K          L         I       E F           j     -     "   4                        Q           S                    U   W   ]                                a       0   [       4 Y                           % $ #    6 5                      w                                                                    H                                       s                                   `                          2 /   1   @                 !                             ?     {                                                * .          r                                               0         7 x     c   } |               i                   3                            ,                                                                         ~                 l  L   F M N  i j  O "b P 5 gijQ R    e l x {       %05       '7    @FK[  h      p    sv ~&        `    M         r                                           g              4                                                9          6            l   x           7   :  *    0      %      " h    ? @ 	  )A J Q ;               `	      	J   	  
- X     X
-    
-m
-  P       p           C Z a ;                 H      @y          b    8q          0Ui    R      tc        (a  _             ,                  	    + .     Y    1 B   P       |           ] i    Q        IG      W   A     [  9    |  1  t  )  l     !                                                                                                                                                                                                       d                      \		T
-                    
-  L                      x        D          <                  4j                   p                                    /                                                                                                                             ,                          >                                        h                                                          DGV                                                                                  $                                                           `                  _                              +Y                  k       l          |    t                    2                                                                                                                                H x X$   wb( ^                                   c d  [ h k xy p q r s  f  z | } ~ |   G} m E         S T        U V    W X o  n     Y Z    t      u     v I  H    w G :         y         \   c 8       WO     sh  )   I  H             	
-XY h             !#$ &' ) +,- /01  4c6h                             PQR   U    Z \]^_            h mn     t*vwz.  %s ([   =>T S    V     X  VU  W  @ ) +              {  ~          h                   ] ^   _              `                                                     a               	
-                     b    "  $  &  (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            z                                                                                                                                                      y                                                                                                                                                         ;            z z z z z   z z   z z   z z z z z z   z     z   z   z z z z z z z z z z z       z z z z z   z z z z     z   z z z z z           z z z z z z z z z                z    z z       z z   z z z z     z z z z z z z       z z z z z z z > z z z z z       y y y y y   y y   y y   y y y y y     y   2y   y  y y y y y y y y y y y       y y y y y   y y y y     y   y y y y y        y y y y y y y y y           3    y    y y       y y   y y y y     y y y y y y y       y y y y y y y D y y y y y       ; ; ;    ; ;   ; ;   ; ; ; ; ;     ;   9;   ;  ; ; ; ; ; ; ; ; ; ; ;       ; ; ; ; ;   ; ; ; ;     ;   ; ; ; ; ;        ; ; ; ;   ; ; ; ;           ;    ;    ; ;       ; ;   ; ; ; ;     ; ; ; ; ; ;         ; ; ; ; ; ; ; C ; ; ; ; ;       > > >    > >   > >   > > > > >     >   <>   >  > > > > > > > > > > >       > > > > >   > > > >     >   > > > > >        > > > >   > > > >           ?    >    > >       > >   > > > >     > > > > > >         > > > > > > > B > > > > >       D D D    D D   D D   D D D D D     D   LD   D  D D D D D D D D D D D       D D D D D   D D D D     D   D D D D D        D D D D   D D D D           M    D    D D       D D   D D D D     D D D D D D         D D D D D D D : D D D D D       C C C    C C   C C   C C C C C     C   SC   C  C C C C C C C C C C C       C C C C C   C C C C     C   C C C C C        C C C C   C C C C           T    C    C C       C C   C C C C     C C C C C C         C C C C C C C d C C C C C       B B B    B B   B B   B B B B B     B   [B   B  B B B B B B B B B B B       B B B B B   B B B B     B   B B B B B        B B B B   B B B B           `    B    B B       B B   B B B B     B B B B B B         B B B B B B B h B B B B B       : : :    : :   : :   : : : : :     :   d:   :  : : : : : : : : : : :       : : : : :   : : : :     :   : : : : :        : : : :   : : : :           e    :    : :       : :   : : : :     : : : : : :         : : : : : : : f : : : : :       d d d    d d   d d   d d d d d     d   fd   d  d d d d d d d d d d d       d d d d d   d d d d     d   d d d d d        d d d d   d d d d           k    d    d d       d d   d d d d     d d d d d d         d d d d d d d e d d d d d       h h h    h h   h h   h h h h h     h   lh   h  h h h h h h h h h h h       h h h h h   h h h h     h   h h h h h        h h h h   h h h h           o    h    h h       h h   h h h h     h h h h h h         h h h h h h h g h h h h h       f f f    f f   f f   f f f f f     f   f   f  f f f f f f f f f f f       f f f f f   f f f f     f   f f f f f        f f f f   f f f f               f    f f       f f   f f f f     f f f f f f         f f f f f f f 8 f f f f f       e e e    e e   e e   e e e e e     e   e   e  e e e e e e e e e e e       e e e e e   e e e e     e   e e e e e        e e e e   e e e e               e    e e       e e   e e e e     e e e e e e         e e e e e e e k e e e e e       g g g    g g   g g   g g g g g     g   g   g  g g g g g g g g g g g       g g g g g   g g g g     g   g g g g g        g g g g   g g g g               g    g g       g g   g g g g     g g g g g g         g g g g g g g q g g g g g       8 8 8    8 8   8 8   8 8 8 8 8     8   8   8  8 8 8 8 8 8 8 8 8 8 8       8 8 8 8 8   8 8 8 8     8   8 8 8 8 8        8 8 8 8   8 8 8 8               8    8 8       8 8   8 8 8 8     8 8 8 8 8 8         8 8 8 8 8 8 8 < 8 8 8 8 8       k k k    k k   k k   k k k k k     k   k   k  k k k k k k k k k k k       k k k k k   k k k k     k   k k k k k        k k k k   k k k k               k    k k       k k   k k k k     k k k k k k         k k k k k k k b k k k k k       q q q    q q   q q   q q q q q     q   q   q  q q q q q q q q q q q       q q q q q   q q q q     q   q q q q q        q q q q   q q q q               q    q q       q q   q q q q     q q q q q q         q q q q q q q = q q q q q       < < <    < <   < <   < < < < <     <   <   <  < < < < < < < < < < <       < < < < <   < < < <     <   < < < < <        < < < <   < < < <               <    < <       < <   < < < <     < < < < < <         < < < < < < < A < < < < <       b b b    b b   b b   b b b b b     b   b   b  b b b b b b b b b b b       b b b b b   b b b b     b   b b b b b        b b b b   b b b b               b    b b       b b   b b b b     b b b b b b         b b b b b b b p b b b b b       = = =    = =   = =   = = = = =     =   =   =  = = = = = = = = = = =       = = = = =   = = = =     =   = = = = =        = = = =   = = = =               =    = =       = =   = = = =     = = = = = =         = = = = = = = M = = = = =       A A A    A A   A A   A A A A A     A   A   A  A A A A A A A A A A A       A A A A A   A A A A     A   A A A A A        A A A A   A A A A               A    A A       A A   A A A A     A A A A A A         A A A A A A A 9 A A A A A       p p p    p p   p p   p p p p p     p   p   p  p p p p p p p p p p p       p p p p p   p p p p     p   p p p p p        p p p p   p p p p               p    p p       p p   p p p p     p p p p p p         p p p p p p p  p p p p p       M M M    M M   M M   M M M M M     M   M   M  M M M M M M M M M M M       M M M M M   M M M M     M   M M M M M        M M M M   M M M M               M    M M       M M   M M M M     M M M M M M         M M M M M M M 
- M M M M M       9 9 9    9 9   9 9   9 9 9 9 9     9   9   9  9 9 9 9 9 9 9 9 9 9 9       9 9 9 9 9   9 9 9 9     9   9 9 9 9 9        9 9 9 9   9 9 9 9               9    9 9       9 9   9 9 9 9     9 9 9 9 9 9         9 9 9 9 9 9 9  9 9 9 9 9                                                                                                                                                                       
- 
- 
-    
- 
-   
-     
- 
- 
- 
- 
-     
-   
-   
-  
- 
- 
- 
- 
- 
- 
- 
- 
- 
- 
-       
- 
- 
- 
- 
-   
- 
- 
- 
-     
-   
- 
- 
- 
- 
-        
- 
- 
- 
-   
- 
- 
- 
-               
-    
- 
-       
- 
-   
- 
- 
- 
-     
- 
- 
- 
- 
- 
-         
- 
- 
- 
- 
- 
- 
-  
- 
- 
- 
- 
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	                                                                                                                                                                &                                                                                                                                                                            	 	 	    	 	   	     	 	 	 	 	     	   	   	  	 	 	 	 	 	 	 	 	 	 	       	 	 	 	 	   	 	 	 	     	   	 	 	 	 	        	 	 	 	   	 	 	 	               	    	 	       	 	   	 	 	 	     	 	 	 	 	 	         	 	 	 	 	 	 	  	 	 	 	 	       & & &    & &   &     & & & & &     &   &   &  & & & & & & & & & & &       & & & & &   & & & &     &   & & & & &        & & & &   & & & &               &    & &       & &   & & & &     & & & & & &         & & & & & & &  & & & & &                                                                                                                                                                                                  !                                                                        #                                                                                        %                                                                        '                                                                                                                                                                                                                                                                                                                            ] ^     _   7g                `                                                        	 
-  a                                         ! "     # b $ % & ' (           ) * + ,   - . / 0 t t     t   t t 1     2 3       4 5 t 6 7 8 9     : ; < = > ?         @ A B C D E F   G H I J K                    	 
-  t                                         ! "     # t $ % & ' (           ) * + ,   - . / 0 u u     u   u u 1     2 3       4 5 u 6 7 8 9     : ; < = > ?         @ A B C D E F   G H I J K                    	 
-  u                                         ! "     # u $ % & ' (           ) * + ,   - . / 0 ] ^     _     g 1     2 3       4 5 ` 6 7 8 9     : ; < = > ?         @ A B C D E F   G H I J K                      	 
-  a                                         ! "     # b $ % & ' (           ) * + ,   - . / 0 ] ^     _       1     2 3       4 5 ` 6 7 8 9     : ; < = > ?         @ A B C D E F   G H I J K                    	 
-  a                                           ! "     # b $ % & p            q         . / 0                               5   6 7 8       : ; < = > ?         @ A B C D       G H I J ABC  r   D    E   	 
-                         <                       ! "     #   $ % & p                      . / 0                            5   6 7 8       : ; < = > ?         @ A B C D       G H I J      r      J     	 
-                         <                       ! "     #   $ % &                         . / 0                               5   6 7 8       : ; < = > ?         @ A B C D       G H I J                                                                                                                                                                                            	 
-                                                  ! "     #   $ % &                           . / 0                                   5   6 7 8       : ; < = > ?         @ A B C D       G H I J     K      	 
-                                                  ! "     #   $ % &                           . / 0                                   5   6 7 8       : ; < = > ?         @ A B C D       G H I J     u      	 
-                                                  ! "     #   $ % &                          . / 0                                   5 N6 7 8       : ; < = > ?        @ A B C D       G H I J          a                                                                                                                                       <                                                                                   <                 =>     n         ! 	#  & ) * + , - 
- 1 2 3 	7 8  	= 	
-	G J '('( \   `   f g @m  
- t u v y |}~ 
- " 
-'|}~
-5
-  :
-:@  @  |}~|	 ab     
-|   
-||	 
- |}  |      |      u|
-|}~'(st|}~	|	}~|}~|}~|}|}~	z{ 	.  	E.|}23|}~|}9	;<?	|}LM			STV|}~	[|}~`	|def	klor	} 			 N |}~|}~@E|}~  |}~|}~|}~|}~|}~|}~|}~|}~E |}~i  !#%'	
- !"#$%)*+,-./0125789:;<=>?@ABCDEFGHIJKLMNOPQRUVWXZ[]^_`cdefghijklmnopqrs  uvwxy|	
- !"#$%)*+,-./0125789:;<=>?@ABCDEFGHIJKLMNOPQRUVWXZ[]^_`cdefghijklmnopqrs  uvwxy|
- !"#$%)*+,-./0125789:;<=>?@ABCDFGHIJKOPRUVWXZ[]^_`cdefghjklmnopqrs  uvwxy|}~
- !"#$%)*+,-./0125789:;<=>?@ABCDFGHIJKOPRUVWXZ[]^_`cdefghjklmnopqrs  uvwxy|}~
- !"#$%)*+,-./0125789:;<=>?@ABCDFGHIJKOPRUVWXZ[]^_`cdefghjklmnopqrs  uvwxy|}~
- !"#$%)*+,-./0125789:;<=>?@ABCDFGHIJKOPRUVWXZ[]^_`cdefghjklmnopqrs  uvwxy|}~
- !"#$%)*+,-./0125789:;<=>?@ABCDFGHIJKOPRUVWXZ[]^_`cdefghjklmnopqrs  uvwxy|}~
- !"#$%)*+,-./0125789:;<=>?@ABCDFGHIJKOPRUVWXZ[]^_`cdefghjklmnopqrs  uvwxy|}~
- !"#$%)*+,-./0125789:;<=>?@ABCDFGHIJKOPRUVWXZ[]^_`cdefghjklmnopqrs  uvwxy|}~
- !"#$%)*+,-./0125789:;<=>?@ABCDFGHIJKOPRUVWXZ[]^_`cdefghjklmnopqrs  uvwxy|}~
- !"#$%)*+,-./0125789:;<=>?@ABCDFGHIJKOPRUVWXZ[]^_`cdefghjklmnopqrs  uvwxy|}~
- !"#$%)*+,-./0125789:;<=>?@ABCDFGHIJKOPRUVWXZ[]^_`cdefghjklmnopqrs  uvwxy|}~
- !"#$%)*+,-./0125789:;<=>?@ABCDFGHIJKOPRUVWXZ[]^_`cdefghjklmnopqrs  uvwxy
- !"#$%)*+,-/0125789:;ABCDEFGHIRUVZ[]^_`cdefghimnopqrs  uvwxy
- !"#$%)*+,-/0125789:;|}~ABCDEFGHIRUVZ[]^_`cdefghimnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrs  uvwxy|}~
- !"#$%)*+,-/0125789:;|}~ABCDFGHIRUVZ[]^_`cdefghmnopqrsuvwxy|}~
-
- !"#$%)*+,-/0125789:;|}~ABCDFGHILMNRQUVZ[]^_`cdefghmnopqrsuvwxy
- !"#$%)*+,-/0125789:;ABCDFGHI
-RUVZ[]^_`cdefghmnopqrsuvwxy
-E !"#$%)*+,-/0125i789:;ABCDFGHI
-RUVZ[]^_`cdefghmnopqrsuvwxy
-E !"#$%)*+,-/0125i789:;ABCDFGHI
-RUVZ[]^_`cdefghmnopqrsuvwxy
-E !"#$%)*+,-/0125i789:;ABCDFGHIRUVZ[]^_`cdefghmnopqrsuvwxyE !"#$%)*+,-/0125i789:;ABCDFGHIRUVZ[]^_`cdefghmnopqrsuvwxy7
-El  !"#x %{ + 125i789
- GHI !"#[]^_cdefghmnopquvwxF
- !"#e%+125789
-GHILMNQ!"#[]^_cdefghmnopquvwxF
-
- !"#e%+125789
-GHILMNQ[]^_cdefghmnopquvwxLMNQ
-
- !"#%+125789GHILMNQ[]^_cdefghmnopquvwx
- !"#%+125789GHI[]^_cdefghmnopquvwx
- !"#%+125789GHI[]^_cdefghmnopquvwx
- !"#%+125789	GHI[	]^_cdefgh.mnopquvwx<=>?@
-.JKOP<=>?@WX!"#JKOP.jklWX
-<=>?@jklJKOP!"#WX.ejkl<=>?@JKOPWXejkl                                                         ?      ?       @      @      8@      ^@     @     @     @     &A    KA    A  ?  ?  ?                                  >  >        >  >        >    >>    >>        >                            >     >              >      >              >  >   >   >   >      >    >  >  >   >  >     >                 ?          ?                                               *?    *6?>6>6?6                >6?*?    >66*    6?    >6?*>6?*    6*6*>                                  @?->    -]?  @->  @-    -]  @?-  @?      >ff&?  ff&?  @      ff&  >ff&  >/]>    ->  ?5^>  /]    -  >?5^     >`	   >   L<     >`   )\>   Q=   =`                       >                  >                   ?                  ?   >              >  >          >   ?   ?       >  >   ?  ?    @@  @  ?  @@    @@      @  @@          ?                 ?     ?  ?      @             ?          ?        *   ?   *>   ?     ?              ?    *>*?*>        :d   58   /8   ),   !,   T   T         |   H         x                         H   H             ?  ?  ?4<                           .>N^n~.>N^n~.>N^                   d      (      
-                        `                           oo   oR                 GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.7.2.3  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)           01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01    .symtab .strtab .shstrtab .interp .note.ABI-tag .hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.got .rel.bss .rel.plt .init .plt .text .fini .rodata .data .eh_frame .ctors .dtors .got .dynamic .sbss .bss .comment .note                                                                       #                              1         ((  `               7                         ?                            G   o   RR  b                T   o     0                c   	                       l   	                       u   	        `              ~         dd	  1                           	                           pp  <H                         T                            T O                           4 <                           D                            D                            D                            D                           E                          X`F                             ``F                                 `F q	                               O                                S                                 LY p*              	               /                                                         (                              R                                   	          
-     d                    p                              4                                                            X          `                                                                                                                      "   4      &         4   4      @         V         i         t   l     ~                     4                                                                                                                    0                                                  !       +       3        A        H       Q       Z              @       a  =$     j  =     u                     @                                     `      @       @        b      b                                       $  (     *       5       K       \  d    o         x&                                                                                         l                                          @         d @                   `                                H                           %               .       -              01       4       9              07       B              8       K              `?       R       X              A       _              pF       e              T       l              Y       u              0_       {              f                                            f                                                        h              t                                   tU      u      ~                  @                            %  `     *  8     /                     7                     @      M       R       X       c  T	    j  `    t       z         L                                                                                               	                                                                $                     0+         0                   p5                     5                     6           H     0              G       8  `@     ;       >  @     A       D       G       J              b       Q        Y       a              n       h                     n                     x                                                 x                                   D                            `                                                                            $         LB       T     j  |    "  @l     (  <     4  l     ?              P  e;     [  =     c        t  xs    ~  ;       pFC      l       =                     8       B       &L      <        @       d      t8      D    !       .  (     6  8N     @  <      P  :     X  x    f      n   d     z         <8=       *;              @               <       (d              (       K      `              `       =       xO      4       0     3  s     D       P      Y  F     c  <     k  <     x  }   "     6:      @       \      =                      6        |ET      T;       4     	  j    	  <     	  (8      (	  <     2	       ;	  0     A	  87      R	  46N     Z	  n    a	            h	   )    s	       z	  `[     	       	  T    	       	  H*      	         	j    	  X      	  h#      	  H     	  `@     	  pN@    	       	  =     	
-  `     
-      (
-  x7      :
-  t     F
-  (*     M
-  T     W
-  d    ^
-  @0    f
-  T     l
-  &    q
-  8     
-       
-       
-   R    
-  4      
-  (    
-  @T    
-   v     
-  D     
-  @     
-  }H    
-  (5;     
-  h=     
-  c       `@                .    !       )   P     1  $     7  ;     E  IT    N  `(     \  @t    f  0rE    p  z    |  =       P       h       J       Yh                  Hp       T              TK                           :      ,%    	   '       `?           '  q     -  d      3        D  "x    L      T  p     [  $!     e  `T     p  |=     x  DK      (       h4\       \             <       (      R      i            +             (      T       *               ;      o        %    $  t     0        A  4    K  D    S  K
-    _     "     D      A       \       4j      S       JD      +       `       ;       d       =              ,       $I[      S              {@    .       4  <     ?  H     K  d     X  0     ^  <     g  x=     n  8    t       {  (2       H;              `@       jd             c       ]      	      1b       p        @      07Y       =       $      K0               	+    	  7             $       /  |J    =  3    G  O|    O  X     Z  {    d  t=     j   d     o  D                     H        b      (4=       H.      b;             tC              Q      <     	        GT      b?z            0  k    9  #     H  .    O  (      `  `n;     l       t  G;        T       X       `=       b                   L             ToC      r      |8      $NL       8       x[r      ldn      0+X       1    '       *  4     3  t     ;         	    C  HK     V  (     e      l  8     r  <    {  p57       3]       T       @              4         <      p;              2       X/        p               h               h=      '  -     3       <       C  h     R  A{    ]       i  x     {  4                     (_      8,                           (       d=       \      {      x,              0__      =        t+    (  `@    1   =@     7  <K     A  <            D  <     P  xxl    \  ^6     j        z  0EL       c      (8       C      Hl      01              ;       a      5?       *        X        x                     .  H     3  &     9  |X     =  =     I  w     d  @    l  1      ~  TT       5J       !            h       l$      ^       H        @       H      |       	^       ,       D                    .  H?    9  U    C  @    P        W       a  4     i       x  x&      T      pI            [p       @!      =z             T       4             *        $               7x              4              $;     %        9  |    G  X3n     P      [       e  E    o  (        4              <                                0Q      @      8=        f                    <       D                   	  lr       X       #  t      gcc2_compiled. Letext crtstuff.c p.3 __DTOR_LIST__ completed.4 __do_global_dtors_aux __EH_FRAME_BEGIN__ fini_dummy object.11 frame_dummy init_dummy force_to_data __CTOR_LIST__ __do_global_ctors_aux __CTOR_END__ __DTOR_END__ __FRAME_END__ in.artd.c totobjs xoff yoff yscale xscale topline extrarays totrays averagefactor others ysperpix xsperpix gram.c yysccsid objdefined fieldtype lex.c yy_current_buffer yy_c_buf_p yy_init yy_start yy_accept yy_ec yy_meta yy_base yy_def yy_nxt yy_chk yy_hold_char yy_last_accepting_state yy_last_accepting_cpos input yy_n_chars yy_get_previous_state yy_try_NUL_trans yy_get_next_buffer yy_did_buffer_switch_on_eof yy_fatal_error yy_flex_realloc yyunput yy_flex_alloc yy_flex_free prepro.c gensamp.c message.c matrix.c solve.c modp rt.c stree.c treesurface.405 shade.c light.c expr.c vars symbol.c object.c tile.c tiles bbox.c csg.c comp.c sphere.c box.c geom.c geoms colours normals vcolours vnormals addhit hitlist obj minv maxv minu maxu fnorms dir backfacing org diru orgu dirv orgv interp3 interp4 interp interp.c alg.c fact eval torus.c hfield.c maketriangle tris norms xfieldsize inttri checkleaf zvals count.399 split freenodes treenodes freecount reset fieldsize yfieldsize orgs dirs polygon.c ellipse.c cone.c cylinder.c ring.c super.c sqbox mask.c smalloc.c grid.c gridsurface.396 patch.c H1 D1 H2 D2 P1 P2 blob.c end.387 lst.388 util.c map.c texture.c noise_inited ripples_inited white ripples noise.c p g twentyf.c twentyfivemodemask repeat.c readrgba.c readrgba imageio.c ibufsize vorterr.c yy_delete_buffer printmatrix blobc maxhitlevel calc2dbbox writecolormapobj boxtabinit usegrid fgetc@@GLIBC_2.0 transform treetabinit csgaddi sortpolys frameno points4x4 bp __strtod_internal@@GLIBC_2.0 yyrestart ringc ferror@@GLIBC_2.0 half2 getcolormapdata obj_transform readgeometry readrgbaline circle7 readshort feof@@GLIBC_2.0 mident4 setattributes alginit currentfile imagebufsize lookup ringtabinit sample4x4 bezier ungetc@@GLIBC_2.0 screeny boxinit _DYNAMIC intersect points2x2 getimagedata trace gridsize findnode yy_scan_buffer yy_load_buffer_state yy_create_buffer colourblend coneinit transpose screenx maxtreedepth __register_frame_info@@GLIBC_2.0 checkvoxel power gensample write@@GLIBC_2.0 cylc yyerrflag fileno@@GLIBC_2.0 yysindex hfieldtabinit randtable readcolours up strcmp@@GLIBC_2.0 huge_dist treeinit usage close@@GLIBC_2.0 scalloc rotate _fp_hw shrinkbbox yytext writebyte tracelight getnodebbox adaptive fprintf@@GLIBC_2.0 astackp fflush@@GLIBC_2.0 pclose@@GLIBC_2.1 tile bspline yytable fhlist pixelgrid circle19Points readheightfield unlink@@GLIBC_2.0 readlongval smult4 checkbbox marble yyparse conen fuzz circle7Points tmpname turbulance conei mktemp@@GLIBC_2.0 buildp yydefred evalat0 twentyfivebit circle19 makebbox supertabinit hazecolour calcfunction half1 makeimage lightinit logfile oblists yyvsp ellipstabinit yyrindex circle5Points torusinit obj_scale copydetails debug linecount torusn csgn spherei texturec openimage obj_translate subobjs finishimage makecsgtree checklight bricks mcpy4 gridtrace wood2 message tileinit writetextobj polyn _init popen@@GLIBC_2.1 cylinit hfieldi yywrap vorterror intersects frameid inbbox yyssp eval_iexpr minv4 malloc@@GLIBC_2.0 falloff ringinit patchn blocks ripple readimage title torusc selfshadowing fscanf@@GLIBC_2.0 spotted algi translate minv3x3 gettextdata fread@@GLIBC_2.0 treetrace sbisect textureinit __deregister_frame_info@@GLIBC_2.0 mmult4 adjustbbox corona get_expr patchc eval_f evalpoly stdout@@GLIBC_2.0 geomtabinit stderr@@GLIBC_2.0 defname inthfield yynerrs eval_fdv csgtabinit geomn calctransforms yyout raysperpix vortwarning writelongval yyval oblistsp erandp modrf Vnoise get_varexpr conetabinit fatal blobn yyleng boxn patchinit numroots defvar _start yyss findsym focallength ringi csgc ntohs@@GLIBC_2.0 ellipsi chdir@@GLIBC_2.0 tolerance numchanges writeimageobj superinit csginit setupimage interpcol randp boxc yy_flush_buffer ellipsinit __strtol_internal@@GLIBC_2.0 points3x3 csgsbisect eval_fexpr wrinkled patchtabinit hfieldc gridi sourceradius patchi raynumber cyli eval_fdu yylen strncmp@@GLIBC_2.0 intpolys yy_scan_string prepro fputc@@GLIBC_2.0 blobtabinit dostrip gridtabinit tilefun __bss_start fogfactor inserthit texturetable main splitleaf triwave geomi ellipsc objectinit yygindex __libc_start_main@@GLIBC_2.0 spherec blobi superi superc rp circle13 mstackp circle5 realloc@@GLIBC_2.0 extractlongval getcol wood1 calcnorm getSquareSampleMask get_type normal yy_scan_bytes data_start readvcolours algtabinit mapinit get_ival printf@@GLIBC_2.0 ellipsn yyin readcolourfield _fini lseek@@GLIBC_2.0 getlongsize waveinit sstack circle13Points missedbbox aathreshold fclose@@GLIBC_2.1 readvortobj lights strrchr@@GLIBC_2.0 polygoninit defobj torusi printprogress sample2x2 yydebug rfactor sphereinit conec readnormals ambient boxi open@@GLIBC_2.0 init_noise dorepeat trans getcsgobj ri perspective interptrans spheretabinit exit@@GLIBC_2.0 yydgoto geometryinit warning gridinit blobinit doassignment ostackp torustabinit noise getCircularSampleMask sscanf@@GLIBC_2.0 _edata evalata _GLOBAL_OFFSET_TABLE_ free@@GLIBC_2.0 _end ringn rnd shadow_rays generatePerturbationVector yycheck isatty@@GLIBC_2.0 yy_switch_to_buffer smalloc evalatb trianglei stdin@@GLIBC_2.0 dotrace1 yy_init_buffer readbyte cardinal shade granite polytabinit yylval suptolerance sstackp fopen@@GLIBC_2.1 csgsubinti subdivide readvnormals oblist dotexture hitdata _IO_stdin_used stucco compinit scale polyi spheren yylex yylhs hfieldn bump algn closeimage sprintf@@GLIBC_2.0 streei fwrite@@GLIBC_2.0 insertsym treeobjs __data_start dotrace2 cyltabinit _IO_getc@@GLIBC_2.0 maketriangles get_fval buildsturm sample3x3 spheremap rand@@GLIBC_2.0 init_ripples erp filetype waves readascmap otherobjs polyc supern yyvs read@@GLIBC_2.0 inttris yychar fhnlist backcol cyln __gmon_start__ yyerror strcpy@@GLIBC_2.0 readrgbline 
\ No newline at end of file
diff -Nrua vort-old/art/src/in.artd.c vort-new/art/src/in.artd.c
--- vort-old/art/src/in.artd.c	1999-10-12 18:38:35.000000000 -0400
+++ vort-new/art/src/in.artd.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,60 +1,27 @@
 #include <stdio.h>
+#include <stdlib.h>
 #include <math.h>
-#ifdef PC
-#include <signal.h>
-#include <fcntl.h>
 #include <string.h>
-#define rindex strrchr
-#else
-#ifdef SYSV
 #include <fcntl.h>
-#else
-#ifdef VMS
-#include <types.h>
-#include <file.h>
-#else
-#include <sys/types.h>
-#include <sys/file.h>
-#endif
-#endif
-#endif
-#ifdef VMS
-#include <string.h>
-#define rindex strrchr
-#endif
-#ifdef MIPS
-#include <string.h>
-#define rindex strrchr
-#endif
-#ifdef PC
-#ifdef TC
-#include <time.h>
-#ifdef _STKLEN
-unsigned _stklen = _STKLEN;
-#else
-unsigned _stklen = 8192 * 2 * 2;
-#endif
-#else
-#include <sys/timeb.h>
-#endif
-#else
+#include <signal.h>
+#include <sys/wait.h>
+#include <errno.h>
 #include <sys/times.h>
-#endif
-#ifdef CRAY
-#include <string.h>
-#define rindex strrchr
-#endif
+#include <sys/resource.h>
 
 #include "art.h"
 #include "objs.h"
 #include "macro.h"
 #include "gram.h"
 #include "random.h"
+#include "readall.h"
 
-extern char	*rindex();
 extern hlist	*trace();
 extern void	shade();
-extern time_t	time();
+
+static u_int32_t dotrace1(int x, int y);
+static u_int32_t dotrace2(int x, int y);
+static void traceblock(u_int32_t *mp, int xstart, int xend, int ystart, int yend);
 
 extern object	*treeinit();
 
@@ -87,7 +54,7 @@
 short	raynumber = 1;		/* initial raynumber */
 
 float	screenx = 1.0,		/* half screen width */
-	screeny = 1.0;		/* half screen height */
+    screeny = 1.0;		/* half screen height */
 
 real	tolerance;		/* tolerance value */
 
@@ -129,10 +96,10 @@
 float	focallength = -1.0;
 
 matrix	trans = {
-	1.0, 0.0, 0.0, 0.0,
-	0.0, 1.0, 0.0, 0.0,
-	0.0, 0.0, 1.0, 0.0,
-	0.0, 0.0, 0.0, 1.0
+    1.0, 0.0, 0.0, 0.0,
+    0.0, 1.0, 0.0, 0.0,
+    0.0, 0.0, 1.0, 0.0,
+    0.0, 0.0, 0.0, 1.0
 };
 
 /*
@@ -144,7 +111,7 @@
  * haze stuff
  */
 float	fogfactor = 0.0,		/* the fog factor */
-	rfactor = 0.03;			/* the mysterious "r" factor */
+    rfactor = 0.03;			/* the mysterious "r" factor */
 
 
 colour	hazecolour = { 1.0, 1.0, 1.0 };	/* the haze colour */
@@ -160,7 +127,7 @@
  * random number pointers
  */
 float	*randp = randtable,
-	*erandp = &randtable[sizeof(randtable) / sizeof(float)];
+    *erandp = &randtable[sizeof(randtable) / sizeof(float)];
 
 /*
  * function pointer tables for intersections, normals, etc...
@@ -197,14 +164,14 @@
  */
 int		pixelgrid = FALSE;	/* pixel grid on or off */
 static int	extrarays,      	/* spare rays for jittering */
-		totrays;        	/* total number of rays per pixel */
+        totrays;        	/* total number of rays per pixel */
 
 static pixel	*topline;       /* scanline of sample grid at top of current scanline */
 
 static pixel	others[2];      /* bottom 2 samples of pixel grid */
 
 static float	averagefactor;	/* number to divide final samples through by */
-			      
+                  
 int		adaptive;
 float		aathreshold;
 
@@ -228,12 +195,6 @@
 static struct tms       buffer;
 #endif
 
-#ifdef PC
-int	EMS_available = FALSE;
-void	ctrl_C(void);	/* CTRL-C trap processor */
-
-#endif
-
 static int	totobjs;
 
 extern FILE	*yyin;
@@ -263,506 +224,480 @@
  *
  *      read a short value from a socket.
  */
-int
-readshort(sock)
-	int	sock;
+static int readshort(sock)
+    int	sock;
 {
-	unsigned short  val;
-	int		count;
+    unsigned short  val;
+    int		count;
 
-	count = 0;
+    count = 0;
 
-	while ((count += read(sock, (char *)&val + count, sizeof(unsigned short) - count)) != sizeof(unsigned short) && count >= 0)
-		;
-		
-	return((int)ntohs(val));
+    while ((count += read(sock, (char *)&val + count, sizeof(unsigned short) - count)) != sizeof(unsigned short) && count >= 0)
+        ;
+        
+    return((int)ntohs(val));
 }
 
 /*
  * main driver
  */
-main(ac, av)
-	int	ac;
-	char	*av[];
-{
-	int		y, x, len, indx, standardin, preprocess, nameset;
-	char		c, *p, name[BUFSIZ], buf[BUFSIZ], path[BUFSIZ];
-	char		scenename[BUFSIZ];
-	FILE		*infile, *logf;
-	unsigned char	*red, *green, *blue, *alpha, *map;
-	int		i, fragment, xsize, ysize, xstart, xend, ystart, yend;
-	int		xfrag, yfrag;
-	object		*o, *nexto;
-	float		k1, k2;
-	expression	*e;
-#ifdef LOSINGTRACK
-	char		hostname[65], pathname[513];
-#endif
-
-#ifndef VMS
-	logfile = stdout;
-#endif
-
+main(int ac, char *av[]) {
+    int		len, indx, preprocess, debug, tempfd;
+    char	c, *p, *name, buf[BUFSIZ], *path, *scenename;
+    FILE	*infile, *logf;
+    u_int32_t	*map;
+    int		i, xsize, ysize, xstart, xend, ystart, yend;
+    int		xfrag, yfrag, fragsize, thissize;
+    object	*o, *nexto;
+    expression	*e;
+
+    /* stdout and stderr streams must be redirected so as to not send garbage
+       back to the server.  Filehandle 1 is still used to send data back,
+       however, so we don't want to close it. */
+    freopen("/dev/null", "a", stderr);
+    stdout = stderr;
 #ifdef TIME_STATS
-	times(&buffer);
-	start_time = buffer.tms_utime + buffer.tms_stime;
+    times(&buffer);
+    start_time = buffer.tms_utime + buffer.tms_stime;
 #endif
+    debug = (1==0);
+    if (ac > 1) {
+        if (strcmp(av[1], "-debug") == 0) debug = (1==1);
+    }
+    buf[BUFSIZ - 1] = '\0';
+
+    /* Attempt to improve the group's priority, but ignore any error */
+    setpriority(PRIO_PGRP, 0, getpriority(PRIO_PROCESS, 0) - 1);
+
+    /* open the log file */
+    logf = fopen("/tmp/dartlog", "w");
+    logfile = logf;
+
+    /*
+     * read in working directory for in.artd
+     */
+    len = readshort(0);
+
+    path = (char *) smalloc(len + 1);
+    readall(0, path, len);
+    path[len] = 0;
+
+    chdir(path);
+    snprintf(buf, BUFSIZ - 1, "%s\n", path);
+    free(path);
+    message(buf);
+
+    /*
+     * read in name of scene file
+     */
+    len = readshort(0);
+
+    scenename = (char *) smalloc(len+1);
+    readall(0, scenename, len);
+    scenename[len] = '\0';
+    snprintf(buf, BUFSIZ - 1, "%s\n", scenename);
+    message(buf);
+
+    /*
+     * get size of total image in pixels.
+     */
+    xsize = readshort(0);
+    ysize = readshort(0);
+
+    /*
+     * get flags
+     */
+    preprocess = readshort(0);
+
+    snprintf(buf, BUFSIZ - 1, "image size %d %d\n", xsize, ysize);
+    message(buf);
+    fflush(logf);
 
-	logf = fopen("/tmp/dartlog", "w");
-
-	logfile = logf;
-
-	/*
-	 * read in working directory for art
-	 */
-	len = readshort(0);
-
-	read(0, path, len);
-	path[len] = 0;
-
-	chdir(path);
-	sprintf(buf, "%s\n", path);
-	message(buf);
-
-	/*
-	 * read in name of scene file
-	 */
-	len = readshort(0);
-
-	read(0, scenename, len);
-	name[len] = 0;
-	sprintf(buf, "%s\n", scenename);
-	message(buf);
-
-	/*
-	 * get size of total image in pixels.
-	 */
-	xsize = readshort(0);
-	ysize = readshort(0);
-
-	/*
-	 * get flags
-	 */
-	preprocess = readshort(0);
-
-	sprintf(buf, "image size %d %d\n", xsize, ysize);
-	message(buf);
-	fflush(logf);
+    xstart = 0;
+    xend = xsize - 1;
 
-	xstart = 0;
-	xend = xsize - 1;
-
-	ystart = ysize - 1;
-	yend = 0;
+    ystart = ysize - 1;
+    yend = 0;
 
 #ifndef OLDFOV
-	if (xsize > ysize)
-		focallength = -(float)xsize / (float)ysize;
-	else
-		focallength = -(float)ysize / (float)xsize;
-#endif
-
-	nameset = FALSE;
-	standardin = FALSE;
-	fragment = FALSE;
-					/* check for other options */
-	sourceradius = 100.0;
-
-	mstackp = (mats *)smalloc(sizeof(mats));
-	mident4(mstackp->d.om);
-	mident4(mstackp->d.vm);
-	mident4(mstackp->d.obj2ray);
-	mident4(mstackp->d.ray2obj);
-	mstackp->d.maxscale = 1.0;
-	mstackp->d.nscales.x = mstackp->d.nscales.y = mstackp->d.nscales.z = 1.0;
-
-	mstackp->lst = mstackp->nxt = (mats *)NULL;
-
-	astackp = (attr *)smalloc(sizeof(attr));
-
-	astackp->d.s = (surface *)smalloc(sizeof(surface));
-	astackp->d.s->falloff = 0.0;
-	astackp->d.s->alpha = 1.0;
-	astackp->d.s->trans.r = astackp->d.s->trans.g = 0.0;
-	astackp->d.s->trans.b = 0.0;
-	astackp->d.s->refl.r = astackp->d.s->refl.g = 0.0;
-	astackp->d.s->refl.b = 0.0;
-	astackp->d.s->c.r = astackp->d.s->c.g = astackp->d.s->c.b = 1.0;
-	astackp->d.s->a.r = astackp->d.s->a.g = astackp->d.s->a.b = 0.1;
-	astackp->d.s->ri = astackp->d.s->kd = 1.0;
-	astackp->d.s->ks = 0.0;
-	astackp->d.s->shadows = TRUE;
-	astackp->d.txtlist = (texture *)NULL;
-	astackp->d.shadows = TRUE;
-	astackp->d.slevel = 0;
-	astackp->d.options = 0;
-
-	astackp->lst = astackp->nxt = (attr *)NULL;
-
-	ostackp = (objst *)smalloc(sizeof(objst));
-	ostackp->sym = (symbol *)NULL;
-
-	ostackp->lst = ostackp->nxt = (objst *)NULL;
-
-	linecount = 1;
-
-	if (nameset) {
-		strcpy(name, defname);
-
-		if ((p = rindex(name, '.')) == (char *)NULL)
-			fatal("art: output file should end with \".pix\".\n");
-	} else {
-		strcpy(name, scenename);
-
-		if ((p = rindex(name, '.')) == (char *)NULL)
-			fatal("art: input file should end with \".scn\".\n");
-		standardin = FALSE;
-	}
-
-#ifdef LOSINGTRACK
-	gethostname(hostname, 64);
-	getwd(pathname, 512);
-	fprintf(logfile, "Host: %s	Directory: %s\n", hostname, pathname);
-	fflush(logfile);
-#endif
-
-	if (preprocess) {
-		sprintf(name, "/tmp/%sXXXXXX", scenename);
-		mktemp(name);
-
-		if ((infile = fopen(name, "w")) == NULL) {
-			sprintf(buf, "art: unable to open temporary file %s.\n", name);
-			fatal(buf);
-		}
-
-		prepro(scenename, infile);
-
-		fclose(infile);
-	} else
-		strcpy(name, scenename);
-
-	/*
-	 * initialise variable symbol table
-	 */
-	e = (expression *)smalloc(sizeof(expression));
-	e->type = EXP_INT;
-	e->u.i = 'x';
-	defvar("x", e);
-
-	e = (expression *)smalloc(sizeof(expression));
-	e->type = EXP_INT;
-	e->u.i = 'y';
-	defvar("y", e);
-
-	e = (expression *)smalloc(sizeof(expression));
-	e->type = EXP_INT;
-	e->u.i = 'z';
-	defvar("z", e);
-
-	/*
-	 * initialise object symbol table
-	 */
-	defobj("geometry", GEOMETRY, (details *)NULL);
-	defobj("sphere", SPHERE, (details *)NULL);
-	defobj("ellipsoid", ELLIPSOID, (details *)NULL);
-	defobj("box", BOX, (details *)NULL);
-	defobj("torus", TORUS, (details *)NULL);
-	defobj("algebraic", ALGEBRAIC, (details *)NULL);
-	defobj("cylinder", CYLINDER, (details *)NULL);
-	defobj("cone", CONE, (details *)NULL);
-	defobj("superquadric", SUPERQUADRIC, (details *)NULL);
-	defobj("ring", RING, (details *)NULL);
-	defobj("disk", RING, (details *)NULL);
-	defobj("light", LIGHT, (details *)NULL);
-	defobj("polygon", POLYGON, (details *)NULL);
-
-	if (preprocess)
-		tmpname = name;
-	else
-		tmpname = (char *)NULL;
-
-	if ((yyin = fopen(name, "r")) != (FILE *)NULL) {
-		fflush(logf);
-		if (preprocess)
-			unlink(name);
-
-		yyparse();
-		fflush(logf);
-
-		fclose(yyin);
-	} else {
-		sprintf(buf, "in.artd: unable to open file %s.\n", name);
-		fatal(buf);
-	}
-
-	
-
+    if (xsize > ysize)
+        focallength = -(float)xsize / (float)ysize;
+    else
+        focallength = -(float)ysize / (float)xsize;
+#endif
+
+                	/* check for other options */
+    sourceradius = 100.0;
+
+    mstackp = (mats *)smalloc(sizeof(mats));
+    mident4(mstackp->d.om);
+    mident4(mstackp->d.vm);
+    mident4(mstackp->d.obj2ray);
+    mident4(mstackp->d.ray2obj);
+    mstackp->d.maxscale = 1.0;
+    mstackp->d.nscales.x = mstackp->d.nscales.y = mstackp->d.nscales.z = 1.0;
+
+    mstackp->lst = mstackp->nxt = (mats *)NULL;
+
+    astackp = (attr *)smalloc(sizeof(attr));
+
+    astackp->d.s = (surface *)smalloc(sizeof(surface));
+    astackp->d.s->falloff = 0.0;
+    astackp->d.s->alpha = 1.0;
+    astackp->d.s->trans.r = astackp->d.s->trans.g = 0.0;
+    astackp->d.s->trans.b = 0.0;
+    astackp->d.s->refl.r = astackp->d.s->refl.g = 0.0;
+    astackp->d.s->refl.b = 0.0;
+    astackp->d.s->c.r = astackp->d.s->c.g = astackp->d.s->c.b = 1.0;
+    astackp->d.s->a.r = astackp->d.s->a.g = astackp->d.s->a.b = 0.1;
+    astackp->d.s->ri = astackp->d.s->kd = 1.0;
+    astackp->d.s->ks = 0.0;
+    astackp->d.s->shadows = TRUE;
+    astackp->d.txtlist = (texture *)NULL;
+    astackp->d.shadows = TRUE;
+    astackp->d.slevel = 0;
+    astackp->d.options = 0;
+
+    astackp->lst = astackp->nxt = (attr *)NULL;
+
+    ostackp = (objst *)smalloc(sizeof(objst));
+    ostackp->sym = (symbol *)NULL;
+
+    ostackp->lst = ostackp->nxt = (objst *)NULL;
+
+    linecount = 1;
+
+    if (preprocess) {
+        if (debug) {
+            snprintf(buf, BUFSIZ - 1, "preprocessing scene file... ");
+            message(buf);
+        }
+        name = (char *) smalloc(strlen(scenename) + 12);
+        sprintf(name, "/tmp/%sXXXXXX", scenename);
+
+        if ((tempfd = mkstemp(name)) < 0) {
+            snprintf(buf, BUFSIZ - 1, "in.artd: unable to open temporary file %s.\n", name);
+            fatal(buf);
+	} else if ((infile = fdopen(tempfd, "w")) == NULL) {
+		perror("in.artd");
+		fatal("");
+        }
+
+        prepro(scenename, infile);
+
+        fclose(infile);
+        tmpname = name;
+        if (debug) {
+            snprintf(buf, BUFSIZ - 1, "done.\n");
+            message(buf);
+        }
+    } else {
+        if (debug) {
+            snprintf(buf, BUFSIZ - 1, "no preprocessing.\n");
+            message(buf);
+        }
+        name = strdup(scenename);
+        if (name == NULL) {
+            snprintf(buf, BUFSIZ - 1, "in.artd: memory allocation failure.\n");
+            fatal(buf);
+        }
+        tmpname = NULL;
+    }
+
+    /*
+     * initialise variable symbol table
+     */
+    e = (expression *)smalloc(sizeof(expression));
+    e->type = EXP_INT;
+    e->u.i = 'x';
+    defvar("x", e);
+
+    e = (expression *)smalloc(sizeof(expression));
+    e->type = EXP_INT;
+    e->u.i = 'y';
+    defvar("y", e);
+
+    e = (expression *)smalloc(sizeof(expression));
+    e->type = EXP_INT;
+    e->u.i = 'z';
+    defvar("z", e);
+
+    /*
+     * initialise object symbol table
+     */
+    defobj("geometry", GEOMETRY, (details *)NULL);
+    defobj("sphere", SPHERE, (details *)NULL);
+    defobj("ellipsoid", ELLIPSOID, (details *)NULL);
+    defobj("box", BOX, (details *)NULL);
+    defobj("torus", TORUS, (details *)NULL);
+    defobj("algebraic", ALGEBRAIC, (details *)NULL);
+    defobj("cylinder", CYLINDER, (details *)NULL);
+    defobj("cone", CONE, (details *)NULL);
+    defobj("superquadric", SUPERQUADRIC, (details *)NULL);
+    defobj("ring", RING, (details *)NULL);
+    defobj("disk", RING, (details *)NULL);
+    defobj("light", LIGHT, (details *)NULL);
+    defobj("polygon", POLYGON, (details *)NULL);
+
+    if (debug) {
+        snprintf(buf, BUFSIZ - 1, "processing scene file %s\n", name);
+        message(buf);
+    }
+    if ((yyin = fopen(name, "r")) != (FILE *)NULL) {
+        fflush(logf);
+        if (preprocess)
+            unlink(name);
+
+        yyparse();
+        fflush(logf);
+
+        fclose(yyin);
+    } else {
+        snprintf(buf, BUFSIZ - 1, "in.artd: unable to open file %s.\n", name);
+        fatal(buf);
+    }
+
+    if (debug) {
+        snprintf(buf, BUFSIZ - 1, "initializing data objects\n", name);
+        message(buf);
+    }
+    
 #ifdef TIME_STATS
-	printtime("Preprocessing time		:");
+    printtime("Preprocessing time		:");
 #endif
 
-	/*
-	 * initialise shade stack
-	 */
-	sstack = (shadedata *)scalloc(sizeof(shadedata), maxhitlevel);
-
-	sstack[0].ri = ri;
-	sstack[0].falloff = falloff;
-
-	sstackp = sstack;
-
-	treeobjs = otherobjs = (object *)NULL;
-
-	oblist = *oblistsp;
-
-	for (o = oblist; o != (object *)NULL; o = nexto) {
-		nexto = o->nxt;
-		o->lastray.raynumber = 0;
-
-		if (o->type == ALGEBRAIC) {
-			o->nxt = otherobjs;
-			otherobjs = o;
-			totobjs++;
-		} else if (o->type == NULL_OBJ) 
-			free(o);
-		else {
-			o->nxt = treeobjs;
-			treeobjs = o;
-			totobjs++;
-		}
-	}
-
-	if (treeobjs != (object *)NULL && treeobjs->nxt != (object *)NULL) {
-		oblist = treeinit(treeobjs);
-
-		/*
-		 * add the interior objects to the general object list.
-		 */
-		if (subobjs != (object *)NULL) {
-			for (o = subobjs; o->nxt != (object *)NULL; o = o->nxt)
-				;
-			o->nxt = treeobjs;
-		} else {
-			subobjs = treeobjs;
-		}
-
-		tolerance = sqrt(sqr(oblist->bb.max[X] - oblist->bb.min[X]) + sqr(oblist->bb.max[Y] - oblist->bb.min[Y]) + sqr(oblist->bb.max[Z] - oblist->bb.min[Z])) / 2.0 * TOLERANCE;
-
-		for (o = treeobjs; o != (object *)NULL; o = o->nxt) {
-			o->bb.min[X] -= tolerance;
-			o->bb.min[Y] -= tolerance;
-			o->bb.min[Z] -= tolerance;
-
-			o->bb.max[X] += tolerance;
-			o->bb.max[Y] += tolerance;
-			o->bb.max[Z] += tolerance;
-		}
-
-		oblist->obj.tree->bb.min[X] -= tolerance;
-		oblist->obj.tree->bb.min[Y] -= tolerance;
-		oblist->obj.tree->bb.min[Z] -= tolerance;
-
-		oblist->obj.tree->bb.max[X] += tolerance;
-		oblist->obj.tree->bb.max[Y] += tolerance;
-		oblist->obj.tree->bb.max[Z] += tolerance;
-
-		oblist->nxt = otherobjs;
-	} else if (treeobjs != (object *)NULL) {
-		oblist = treeobjs;
-		tolerance = sqrt(sqr(oblist->bb.max[X] - oblist->bb.min[X]) + sqr(oblist->bb.max[Y] - oblist->bb.min[Y]) + sqr(oblist->bb.max[Z] - oblist->bb.min[Z])) / 2.0 * TOLERANCE;
-		oblist->nxt = otherobjs;
-	} else {
-		oblist = otherobjs;
-		tolerance = TOLERANCE;
-	}
-
-	/*
-	 * set up intersection and normal function pointers
-	 */
-	spheretabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	boxtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	torustabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	cyltabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	conetabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	ellipstabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	geomtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	polytabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	supertabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	ringtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	csgtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	algtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	hfieldtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	treetabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-	gridtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
-
-	strcpy(p, PIX_SUFFIX);
-
-	xoff = xsize / 2;
-	yoff = ysize / 2;
-
-	if (xsize > ysize)
-		xscale = yscale = ysize / 2;
-	else
-		xscale = yscale = xsize / 2;
-
-	red = (unsigned char *)scalloc(xsize, 1);
-	green = (unsigned char *)scalloc(xsize, 1);
-	blue = (unsigned char *)scalloc(xsize, 1);
-	alpha = (unsigned char *)scalloc(xsize, 1);
-
-	if (oblist != (object *)NULL)
-		sprintf(buf, "world bounding box: %+11.4f %+11.4f %+11.4f\n                    %+11.4f %+11.4f %+11.4f\n",
-		oblist->obj.tree->bb.min[X], oblist->obj.tree->bb.min[Y], oblist->obj.tree->bb.min[Z],
-		oblist->obj.tree->bb.max[X] , oblist->obj.tree->bb.max[Y] , oblist->obj.tree->bb.max[Z]);
-
-	message(buf);
+    /*
+     * initialise shade stack
+     */
+    sstack = (shadedata *)scalloc(sizeof(shadedata), maxhitlevel);
+
+    sstack[0].ri = ri;
+    sstack[0].falloff = falloff;
+
+    sstackp = sstack;
+
+    treeobjs = otherobjs = (object *)NULL;
+
+    oblist = *oblistsp;
+
+    for (o = oblist; o != (object *)NULL; o = nexto) {
+        nexto = o->nxt;
+        o->lastray.raynumber = 0;
+
+        if (o->type == ALGEBRAIC) {
+            o->nxt = otherobjs;
+            otherobjs = o;
+            totobjs++;
+        } else if (o->type == NULL_OBJ) 
+            free(o);
+        else {
+            o->nxt = treeobjs;
+            treeobjs = o;
+            totobjs++;
+        }
+    }
+
+    if (treeobjs != (object *)NULL && treeobjs->nxt != (object *)NULL) {
+        oblist = treeinit(treeobjs);
+
+        /*
+         * add the interior objects to the general object list.
+         */
+        if (subobjs != (object *)NULL) {
+            for (o = subobjs; o->nxt != (object *)NULL; o = o->nxt)
+                ;
+            o->nxt = treeobjs;
+        } else {
+            subobjs = treeobjs;
+        }
+
+        tolerance = sqrt(sqr(oblist->bb.max[X] - oblist->bb.min[X]) + sqr(oblist->bb.max[Y] - oblist->bb.min[Y]) + sqr(oblist->bb.max[Z] - oblist->bb.min[Z])) / 2.0 * TOLERANCE;
+
+        for (o = treeobjs; o != (object *)NULL; o = o->nxt) {
+            o->bb.min[X] -= tolerance;
+            o->bb.min[Y] -= tolerance;
+            o->bb.min[Z] -= tolerance;
+
+            o->bb.max[X] += tolerance;
+            o->bb.max[Y] += tolerance;
+            o->bb.max[Z] += tolerance;
+        }
+
+        oblist->obj.tree->bb.min[X] -= tolerance;
+        oblist->obj.tree->bb.min[Y] -= tolerance;
+        oblist->obj.tree->bb.min[Z] -= tolerance;
+
+        oblist->obj.tree->bb.max[X] += tolerance;
+        oblist->obj.tree->bb.max[Y] += tolerance;
+        oblist->obj.tree->bb.max[Z] += tolerance;
+
+        oblist->nxt = otherobjs;
+    } else if (treeobjs != (object *)NULL) {
+        oblist = treeobjs;
+        tolerance = sqrt(sqr(oblist->bb.max[X] - oblist->bb.min[X]) + sqr(oblist->bb.max[Y] - oblist->bb.min[Y]) + sqr(oblist->bb.max[Z] - oblist->bb.min[Z])) / 2.0 * TOLERANCE;
+        oblist->nxt = otherobjs;
+    } else {
+        oblist = otherobjs;
+        tolerance = TOLERANCE;
+    }
+
+    /*
+     * set up intersection and normal function pointers
+     */
+    spheretabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    boxtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    torustabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    cyltabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    conetabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    ellipstabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    geomtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    polytabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    supertabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    ringtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    csgtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    algtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    hfieldtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    treetabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+    gridtabinit(intersects, normal, tilefun, checkbbox, selfshadowing);
+
+    xoff = xsize / 2;
+    yoff = ysize / 2;
+
+    if (xsize > ysize)
+        xscale = yscale = ysize / 2;
+    else
+        xscale = yscale = xsize / 2;
+
+
+    if (oblist != (object *)NULL)
+        snprintf(buf, BUFSIZ - 1, "world bounding box: %+11.4f %+11.4f %+11.4f\n                    %+11.4f %+11.4f %+11.4f\n",
+        oblist->obj.tree->bb.min[X], oblist->obj.tree->bb.min[Y], oblist->obj.tree->bb.min[Z],
+        oblist->obj.tree->bb.max[X] , oblist->obj.tree->bb.max[Y] , oblist->obj.tree->bb.max[Z]);
+
+    message(buf);
+
+
+    xfrag = readshort(0);
+    yfrag = readshort(0);
+    fragsize = xfrag * yfrag * sizeof(u_int32_t);
 
-
-	xfrag = readshort(0);
-	yfrag = readshort(0);
-
-	fprintf(logf, "frag size %d %d\n", xfrag, yfrag);
-	fflush(logf);
+    fprintf(logf, "frag size %d %d\n", xfrag, yfrag);
+    fflush(logf);
 
 #ifdef TIME_STATS
-	times(&buffer);
-	tstart_time = buffer.tms_utime + buffer.tms_stime;
+    times(&buffer);
+    tstart_time = buffer.tms_utime + buffer.tms_stime;
 #endif
 
-	map = (unsigned char *)smalloc(xfrag * yfrag * 3);
-
-	read(0, &c, 1);
-
-	map = (unsigned char *)smalloc(xfrag * yfrag * 4);
-	topline = (pixel *)scalloc(sizeof(pixel), xsize + 3);
-
-	while (c != 'Q') {
-		xstart = readshort(0);
-		xend = readshort(0);
-
-		ystart = ysize - readshort(0);
-		yend = ysize - readshort(0);
-
-		if (pixelgrid) {
-			extrarays = raysperpix - 1;
-			totrays = extrarays + 4;
-
-			averagefactor = 255.0 / totrays;
-
-			k2 = (ystart + 1 - yoff) / yscale;
-
-			for (i = xstart; i <= xend + 1; i++)
-				gensample((i - xoff) / xscale, k2, &topline[i]);
-
-			k1 = (xstart - xoff) / xscale;
-
-			for (y = ystart; y >= yend; y--) {
-
-				gensample(k1, (y - yoff) / yscale, &others[0]);
-
-				for (x = xstart; x <= xend; x++) {
-					dotrace2(x, y, &red[x - xstart], &green[x - xstart], &blue[x - xstart], &alpha[x - xstart]);
-				}
-
-				for (x = xstart; x <= xend; x++) {
-					map[((ystart - y) * (xend - xstart + 1) + x - xstart) * 4] = red[x - xstart];
-					map[((ystart - y) * (xend - xstart + 1) + x - xstart) * 4 + 1] = green[x - xstart];
-					map[((ystart - y) * (xend - xstart + 1) + x - xstart) * 4 + 2] = blue[x - xstart];
-					map[((ystart - y) * (xend - xstart + 1) + x - xstart) * 4 + 3] = alpha[x - xstart];
-				}
-
-				topline[xend + 1] = others[1];
-			}
-
-		} else {
-			for (y = ystart; y >= yend; y--) {
+    topline = (pixel *)scalloc(sizeof(pixel), xsize + 3);
 
-				for (x = xstart; x <= xend; x++)
-					dotrace1(x, y, &red[x - xstart], &green[x - xstart], &blue[x - xstart], &alpha[x - xstart]);
-
-				for (x = xstart; x <= xend; x++) {
-					map[((ystart - y) * (xend - xstart + 1) + x - xstart) * 4] = red[x - xstart];
-					map[((ystart - y) * (xend - xstart + 1) + x - xstart) * 4 + 1] = green[x - xstart];
-					map[((ystart - y) * (xend - xstart + 1) + x - xstart) * 4 + 2] = blue[x - xstart];
-					map[((ystart - y) * (xend - xstart + 1) + x - xstart) * 4 + 3] = alpha[x - xstart];
-				}
-			}
-		}
-
-		fprintf(logf, "%c - %d %d %d %d\n", c, xstart, xend, ystart, yend);
-		fflush(logf);
-		write(1, "D", 1);
-
-		write(1, map, xfrag * yfrag * 4);
-
-		read(0, &c, 1);
-	}
-
-#ifdef PC
-	/* deallocate storage used by tile patterns, esp. EMS */
-	uninit_tiles();
-#endif
+    if (pixelgrid) {
+        extrarays = raysperpix - 1;
+        totrays = extrarays + 4;
+        averagefactor = 255.0 / totrays;
+    }
+
+    map = (u_int32_t *)smalloc(fragsize);
+
+        /* receive instructions from the remote master */
+    read(0, &c, 1);
+    while (c != 'Q') {
+        /* receive fragment definition */
+        xstart = readshort(0);
+        xend = readshort(0);
+        ystart = ysize - readshort(0);
+        yend = ysize - readshort(0);
+
+        /* log it */
+        fprintf(logf, "%c - %d %d %d %d\n", c, xstart, xend, ystart, yend);
+        fflush(logf);
+
+	/* Has the master gone psycho and sent us too big a fragment request? */
+        thissize = (xend-xstart+1) * (ystart-yend+1) * sizeof(u_int32_t);
+	if ( thissize > fragsize || thissize < 0 ) {
+            if (debug) {
+                fprintf(logf, "  -- invalid fragment size --\n");
+                fflush(logf);
+            }
+            break;
+        }
+
+        traceblock(map, xstart, xend, ystart, yend);
+
+        /* return the fragment to the master and get next instruction */
+        if (debug) {
+            fprintf(logf, "sending %d-byte fragment data\n", fragsize);
+            fflush(logf);
+        }
+        write(1, "D", 1);
+        write(1, map, thissize);
+        read(0, &c, 1);
+    }
 
 #ifdef TIME_STATS
-	printtime("Total time taken		:");
+    printtime("Total time taken		:");
 #endif
 
 #ifdef STATS
-	sprintf(buf, "Total number of objects		: %d\n", totobjs);
-	message(buf);
+    snprintf(buf, BUFSIZ - 1, "Total number of objects		: %d\n", totobjs);
+    message(buf);
 
-	if (treeobjs != (object *)NULL) {
-		mininleaf = totobjs;
+    if (treeobjs != (object *)NULL) {
+        mininleaf = totobjs;
 
-		getstats(oblist->obj.tree);
-
-		sprintf(buf, "Total number of tree nodes	: %d\n", totnodes);
-		message(buf);
-		sprintf(buf, "Number of leaf nodes not entered: %d\n", neverentered);
-		message(buf);
-		sprintf(buf, "Number of leaf nodes entered	: %d\n", totleafs);
-		message(buf);
-		sprintf(buf, "Number of object pointers	: %d\n", numobjptrs);
-		message(buf);
-		sprintf(buf, "Min number of objects in a leaf	: %d\n", mininleaf);
-		message(buf);
-		sprintf(buf, "Max number of objects in a leaf	: %d\n", maxinleaf);
-		message(buf);
-		sprintf(buf, "Max depth of a leaf node	: %d\n", maxfinaldepth);
-		message(buf);
-		sprintf(buf, "Number of empty nodes		: %d\n", emptynodes);
-		message(buf);
-	}
-#endif
+        getstats(oblist->obj.tree);
 
-	exit(ALLOK);
+        snprintf(buf, BUFSIZ - 1, "Total number of tree nodes	: %d\n", totnodes);
+        message(buf);
+        snprintf(buf, BUFSIZ - 1, "Number of leaf nodes not entered: %d\n", neverentered);
+        message(buf);
+        snprintf(buf, BUFSIZ - 1, "Number of leaf nodes entered	: %d\n", totleafs);
+        message(buf);
+        snprintf(buf, BUFSIZ - 1, "Number of object pointers	: %d\n", numobjptrs);
+        message(buf);
+        snprintf(buf, BUFSIZ - 1, "Min number of objects in a leaf	: %d\n", mininleaf);
+        message(buf);
+        snprintf(buf, BUFSIZ - 1, "Max number of objects in a leaf	: %d\n", maxinleaf);
+        message(buf);
+        snprintf(buf, BUFSIZ - 1, "Max depth of a leaf node	: %d\n", maxfinaldepth);
+        message(buf);
+        snprintf(buf, BUFSIZ - 1, "Number of empty nodes		: %d\n", emptynodes);
+        message(buf);
+    }
+#endif
+    fprintf (logf, "task complete.\n");
+    fflush (logf);
+    free(name);
+    free(scenename);
+    exit(ALLOK);
 }
 
 /*
  * dotrace1
  *
- *	Generate a straight no-nonsense sampling for the image, if you
+ *	Generate a straight no-nonsense sampling for the image; if you
  * like weird filters and postprocessing this is the one for you!
  */
-dotrace1(x, y, r, g, b, a)
-	int		x, y;
-	unsigned char	*r, *g, *b, *a;
+static u_int32_t dotrace1(x, y)
+    int		x, y;
 {
-	pixel	pix;
-	object	*o;
-
-	gensample((x - xoff + 0.5) / xscale, (y - yoff + 0.5) / yscale, &pix);
-
-	if (raynumber < 0) {
-		for (o = subobjs; o != (object *)NULL; o = o->nxt)
-			o->lastray.raynumber = 0;
-		raynumber = 1;
-	}
-
-	*r = pix.r * 255.0;
-	*g = pix.g * 255.0;
-	*b = pix.b * 255.0;
-	*a = pix.a * 255.0;
+    u_int32_t	rgba;
+    pixel	pix;
+    object	*o;
+
+    gensample((x - xoff + 0.5) / xscale, (y - yoff + 0.5) / yscale, &pix);
+
+    if (raynumber < 0) {
+        for (o = subobjs; o != (object *)NULL; o = o->nxt)
+            o->lastray.raynumber = 0;
+        raynumber = 1;
+    }
+
+    rgba =   (((u_int32_t) (pix.r * 255.0)) << 24)
+           | (((u_int32_t) (pix.g * 255.0)) << 16)
+           | (((u_int32_t) (pix.b * 255.0)) <<  8)
+           |  ((u_int32_t) (pix.a * 255.0));
+    return htonl(rgba);
 }
 
 /*
@@ -771,61 +706,90 @@
  *	traces the neccessary number of rays and calculates r,
  * g, b, and alpha info averaging the samples at the end.
  */
-dotrace2(x, y, r, g, b, a)
-	int		x, y;
-	unsigned char	*r, *g, *b, *a;
+static u_int32_t dotrace2(x, y)
+    int		x, y;
 {
-	int	i;
-	pixel	sample;
-	float	red, green, blue, alpha;
-	object	*o;
-
-	red = green = blue = alpha = 0.0;
-
-	gensample((x + 1 - xoff) / xscale, (y - yoff) / yscale, &others[1]);
-
-	red = (topline[x].r + topline[x + 1].r + others[0].r + others[1].r);
-	green = (topline[x].g + topline[x + 1].g + others[0].g + others[1].g);
-	blue = (topline[x].b + topline[x + 1].b + others[0].b + others[1].b);
-	alpha = (topline[x].a + topline[x + 1].a + others[0].a + others[1].a);
-
-	topline[x] = others[0];
-	others[0] = others[1];
-
-	if (extrarays) {
-		gensample((x - xoff + 0.5) / xscale, (y - yoff + 0.5) / yscale, &sample);
-		red += sample.r;
-		green += sample.g;
-		blue += sample.b;
-		alpha += sample.a;
-
-		for (i = 1; i != extrarays; i++) {
-			gensample((x - xoff + randnum()) / xscale, (y - yoff + randnum()) / yscale, &sample);
-
-			red += sample.r;
-			green += sample.g;
-			blue += sample.b;
-			alpha += sample.a;
-		}
-	}
-
-	if (alpha != 0.0) {
-		*r = red * averagefactor + randnum();
-		*g = green * averagefactor + randnum();
-		*b = blue * averagefactor + randnum();
-		*a = alpha * averagefactor;
-	} else {
-		*r = red * averagefactor;
-		*g = green * averagefactor;
-		*b = blue * averagefactor;
-		*a = alpha * averagefactor;
-	}
-
-	if (raynumber < 0) {
-		for (o = subobjs; o != (object *)NULL; o = o->nxt)
-			o->lastray.raynumber = 0;
-		raynumber = 1;
-	}
+    u_int32_t	rgba;
+    int	i;
+    pixel	sample;
+    float	red, green, blue, alpha;
+    object	*o;
+
+    red = green = blue = alpha = 0.0;
+
+    gensample((x + 1 - xoff) / xscale, (y - yoff) / yscale, &others[1]);
+
+    red = (topline[x].r + topline[x + 1].r + others[0].r + others[1].r);
+    green = (topline[x].g + topline[x + 1].g + others[0].g + others[1].g);
+    blue = (topline[x].b + topline[x + 1].b + others[0].b + others[1].b);
+    alpha = (topline[x].a + topline[x + 1].a + others[0].a + others[1].a);
+
+    topline[x] = others[0];
+    others[0] = others[1];
+
+    if (extrarays) {
+        gensample((x - xoff + 0.5) / xscale, (y - yoff + 0.5) / yscale, &sample);
+        red += sample.r;
+        green += sample.g;
+        blue += sample.b;
+        alpha += sample.a;
+
+        for (i = 1; i != extrarays; i++) {
+            gensample((x - xoff + randnum()) / xscale, 
+                      (y - yoff + randnum()) / yscale,
+                      &sample);
+            red += sample.r;
+            green += sample.g;
+            blue += sample.b;
+            alpha += sample.a;
+        }
+    }
+
+    if (alpha != 0.0) {
+        rgba =  (((u_int32_t) (red * averagefactor + randnum())) << 24)
+             |(((u_int32_t) (green * averagefactor + randnum())) << 16)
+             |(((u_int32_t) (blue * averagefactor + randnum()))  <<  8)
+             | ((u_int32_t) (alpha * averagefactor));
+    } else {
+        rgba = (((u_int32_t) (red * averagefactor))   << 24)
+             | (((u_int32_t) (green * averagefactor)) << 16)
+             | (((u_int32_t) (blue * averagefactor))  <<  8)
+             |  ((u_int32_t) (alpha * averagefactor));
+    }
+
+    if (raynumber < 0) {
+        for (o = subobjs; o != (object *)NULL; o = o->nxt)
+            o->lastray.raynumber = 0;
+        raynumber = 1;
+    }
+    return htonl(rgba);
+}
+
+static void traceblock(u_int32_t *mp, int xstart, int xend, int ystart, int yend) {
+    int x, y;
+    float k1, k2;
+
+    if (pixelgrid) {
+        k2 = (ystart + 1 - yoff) / yscale;
+        for (x = xstart; x <= xend + 1; x++)
+            gensample((x - xoff) / xscale, k2, &topline[x]);
+        k1 = (xstart - xoff) / xscale;
+        for (y = ystart; y >= yend; y--) {
+            gensample(k1, (y - yoff) / yscale, &others[0]);
+            for (x = xstart; x <= xend; x++) {
+                *mp = dotrace2(x, y);
+                mp++;
+            }
+            topline[xend + 1] = others[1];
+        }
+    } else {
+        for (y = ystart; y >= yend; y--) {
+            for (x = xstart; x <= xend; x++) {
+                *mp = dotrace1(x, y);
+                mp++;
+            }
+        }
+    }
 }
 
 #ifdef STATS
@@ -836,35 +800,35 @@
  * root.
  */
 getstats(root)
-	stree	*root;
+    stree	*root;
 {
-	olist	*obs;
-	int	count;
+    olist	*obs;
+    int	count;
 
-	totnodes++;
+    totnodes++;
 
-	if (root->type == SPLITABLELEAF)
-		neverentered++;
-	else if (root->type == LEAF) {
-		if (maxfinaldepth < root->u.leaf.depth)
-			maxfinaldepth = root->u.leaf.depth;
-		if (root->u.leaf.oblist == (olist *)NULL)
-			emptynodes++;
-		else {
-			count = 0;
-			for (obs = root->u.leaf.oblist; obs != (olist *)NULL; obs = obs->nxt)
-				count++;
-			numobjptrs += count;
-			if (mininleaf > count)
-				mininleaf = count;
-			if (maxinleaf < count)
-				maxinleaf = count;
-			totleafs++;
-		}
-	} else {
-		getstats(root->u.branch.left);
-		getstats(root->u.branch.right);
-	}
+    if (root->type == SPLITABLELEAF)
+        neverentered++;
+    else if (root->type == LEAF) {
+        if (maxfinaldepth < root->u.leaf.depth)
+            maxfinaldepth = root->u.leaf.depth;
+        if (root->u.leaf.oblist == (olist *)NULL)
+            emptynodes++;
+        else {
+            count = 0;
+            for (obs = root->u.leaf.oblist; obs != (olist *)NULL; obs = obs->nxt)
+                count++;
+            numobjptrs += count;
+            if (mininleaf > count)
+                mininleaf = count;
+            if (maxinleaf < count)
+                maxinleaf = count;
+            totleafs++;
+        }
+    } else {
+        getstats(root->u.branch.left);
+        getstats(root->u.branch.right);
+    }
 }
 #endif
 
@@ -875,31 +839,20 @@
  *      print out how much time has been taken up.
  */
 printtime(s)
-	char    *s;
+    char    *s;
 {
-	float           diff;
-	time_t          now;
-	char            buf[BUFSIZ];
+    float           diff;
+    time_t          now;
+    char            buf[BUFSIZ];
 
-	times(&buffer);
+    times(&buffer);
 
-	diff = buffer.tms_utime + buffer.tms_stime - start_time;
+    diff = buffer.tms_utime + buffer.tms_stime - start_time;
 
-	sprintf(buf, "%s %.2f seconds.\n", s, diff / 60.0);       
-	message(buf);
+    buf[BUFSIZ - 1] = '\0';
+    snprintf(buf, BUFSIZ - 1, "%s %.2f seconds.\n", s, diff / 60.0);       
+    message(buf);
 }
 
 #endif
 
-#ifdef PC
-/****
- * Handle user abort requests.
- **/
-
-void 	ctrl_C()
-{
-	signal(SIGINT, SIG_IGN);	/* ignore any abort requests in this routine */
-	uninit_tiles();
-	exit(1);
-}
-#endif
diff -Nrua vort-old/art/src/in.netartd vort-new/art/src/in.netartd
--- vort-old/art/src/in.netartd	2001-10-08 08:09:27.000000000 -0400
+++ vort-new/art/src/in.netartd	1969-12-31 19:00:00.000000000 -0500
@@ -1,23 +0,0 @@
-ELF               4   D      4    (      4   44                                       
-  
-           
-    ,           8  88                               /lib/ld-linux.so.2           GNU                             	                                         
-                                                                                                    }   "   (   =         $7      .   4*      ^   D/      !   T         dV      6   t   "   N   7      c   7              p        w         |            l     h   *      Y   =      T   &                      __gmon_start__ libc.so.6 execve fflush write fprintf __deregister_frame_info chdir wait read fork nice sprintf fclose exit fopen _IO_stdin_used __libc_start_main __register_frame_info close GLIBC_2.1 GLIBC_2.0                                    ii         ii          4                   	  
-         $  (  ,  0  US    [  P    t{v   2  [   5%    %h    %h   %h   %h   % h    %h(   %h0   %h8   p%h@   `%hH   P%hP   @%hX   0% h`    %$hh   %(hp    %,hx   %0h               1^PTRhLhQVhcU= u>P 8 utth   UUthh;UUjEPuEf%  U  WVShphrj
-bG  jGPj <    GQ  `8(4jGPj `j B S8Pj ?8 RhWf Wz8P }
-<   j S4Rj 4  j j  VhPShHPz SV4RhW W< 7  t*@PL@ <   j Gj= j08(<@HDGYuH        HL        P8PhjA< uKjhjwjGPj D GPhWkW jhj,< uGQWj US=t;u[UUS    [  [     w /tmp/in.netartd path %s
- %d name %s - %d %d
- art -n /usr/local/bin/art D %c
- E                        8        
-*:JZjz
-                L   (      
-                                     8   0            o o   o         GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)           01.01             01.01             01.01             01.01             01.01             01.01    .symtab .strtab .shstrtab .interp .note.ABI-tag .hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.got .rel.plt .init .plt .text .fini .rodata .data .eh_frame .ctors .dtors .got .dynamic .sbss .bss .comment .note                                                                       #                              1         ((                  7           @              ?                             G   o     (                T   o       0                c   	      00                 l   	      88                 u           1                  {                                         ,                          LL
-                             hh
-  Y                           
-                             
-                             
-                             
-                             
-  T                          88                                                                                                                              x                                j                                    `     6         	                                                                         (                                                   0          8     	          
-                          L          h                                                            8                                                                                                   D          D                      P       "         &         4         @   P      V         i         t        ~                                                                                 D                                    L                                &       8        }   "   0  =      A  $7      R            Y  4*      l  D/      |  T        dV             
-   t   "              7        7                                   *  L      0       B        R       Y        o       t          l       *                =        &                     gcc2_compiled. Letext crtstuff.c p.3 __DTOR_LIST__ completed.4 __do_global_dtors_aux __EH_FRAME_BEGIN__ fini_dummy object.11 frame_dummy init_dummy force_to_data __CTOR_LIST__ __do_global_ctors_aux __CTOR_END__ __DTOR_END__ __FRAME_END__ in.netartd.c readshort _DYNAMIC __register_frame_info@@GLIBC_2.0 write@@GLIBC_2.0 close@@GLIBC_2.0 _fp_hw fprintf@@GLIBC_2.0 fork@@GLIBC_2.0 fflush@@GLIBC_2.0 execve@@GLIBC_2.0 _init __deregister_frame_info@@GLIBC_2.0 _start chdir@@GLIBC_2.0 nice@@GLIBC_2.0 __bss_start main __libc_start_main@@GLIBC_2.0 data_start _fini fclose@@GLIBC_2.1 exit@@GLIBC_2.0 _edata _GLOBAL_OFFSET_TABLE_ _end fopen@@GLIBC_2.1 _IO_stdin_used sprintf@@GLIBC_2.0 __data_start read@@GLIBC_2.0 wait@@GLIBC_2.0 __gmon_start__ 
\ No newline at end of file
diff -Nrua vort-old/art/src/in.netartd.c vort-new/art/src/in.netartd.c
--- vort-old/art/src/in.netartd.c	1993-03-14 20:32:46.000000000 -0500
+++ vort-new/art/src/in.netartd.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,4 +1,5 @@
 #include <stdio.h>
+#include <stdlib.h>
 #include <sys/types.h>
 #include <sys/socket.h>
 #include <sys/times.h>
diff -Nrua vort-old/art/src/lex.c vort-new/art/src/lex.c
--- vort-old/art/src/lex.c	1999-10-13 08:14:36.000000000 -0400
+++ vort-new/art/src/lex.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,2659 +0,0 @@
-/* A lexical scanner generated by flex */
-
-/* Scanner skeleton version:
- * $Header: /usr/local/cvs/recipnet/native/vort-recipnet-rendering/vort-recipnet-rendering.patch,v 1.2 2006-11-18 22:46:59 jobollin Exp $
- */
-
-#define FLEX_SCANNER
-#define YY_FLEX_MAJOR_VERSION 2
-#define YY_FLEX_MINOR_VERSION 5
-
-#include <stdio.h>
-
-
-/* cfront 1.2 defines "c_plusplus" instead of "__cplusplus" */
-#ifdef c_plusplus
-#ifndef __cplusplus
-#define __cplusplus
-#endif
-#endif
-
-
-#ifdef __cplusplus
-
-#include <stdlib.h>
-#include <unistd.h>
-
-/* Use prototypes in function declarations. */
-#define YY_USE_PROTOS
-
-/* The "const" storage-class-modifier is valid. */
-#define YY_USE_CONST
-
-#else	/* ! __cplusplus */
-
-#if __STDC__
-
-#define YY_USE_PROTOS
-#define YY_USE_CONST
-
-#endif	/* __STDC__ */
-#endif	/* ! __cplusplus */
-
-#ifdef __TURBOC__
- #pragma warn -rch
- #pragma warn -use
-#include <io.h>
-#include <stdlib.h>
-#define YY_USE_CONST
-#define YY_USE_PROTOS
-#endif
-
-#ifdef YY_USE_CONST
-#define yyconst const
-#else
-#define yyconst
-#endif
-
-
-#ifdef YY_USE_PROTOS
-#define YY_PROTO(proto) proto
-#else
-#define YY_PROTO(proto) ()
-#endif
-
-/* Returned upon end-of-file. */
-#define YY_NULL 0
-
-/* Promotes a possibly negative, possibly signed char to an unsigned
- * integer for use as an array index.  If the signed char is negative,
- * we want to instead treat it as an 8-bit unsigned char, hence the
- * double cast.
- */
-#define YY_SC_TO_UI(c) ((unsigned int) (unsigned char) c)
-
-/* Enter a start condition.  This macro really ought to take a parameter,
- * but we do it the disgusting crufty way forced on us by the ()-less
- * definition of BEGIN.
- */
-#define BEGIN yy_start = 1 + 2 *
-
-/* Translate the current start state into a value that can be later handed
- * to BEGIN to return to the state.  The YYSTATE alias is for lex
- * compatibility.
- */
-#define YY_START ((yy_start - 1) / 2)
-#define YYSTATE YY_START
-
-/* Action number for EOF rule of a given start state. */
-#define YY_STATE_EOF(state) (YY_END_OF_BUFFER + state + 1)
-
-/* Special action meaning "start processing a new file". */
-#define YY_NEW_FILE yyrestart( yyin )
-
-#define YY_END_OF_BUFFER_CHAR 0
-
-/* Size of default input buffer. */
-#define YY_BUF_SIZE 16384
-
-typedef struct yy_buffer_state *YY_BUFFER_STATE;
-
-extern int yyleng;
-extern FILE *yyin, *yyout;
-
-#define EOB_ACT_CONTINUE_SCAN 0
-#define EOB_ACT_END_OF_FILE 1
-#define EOB_ACT_LAST_MATCH 2
-
-/* The funky do-while in the following #define is used to turn the definition
- * int a single C statement (which needs a semi-colon terminator).  This
- * avoids problems with code like:
- *
- * 	if ( condition_holds )
- *		yyless( 5 );
- *	else
- *		do_something_else();
- *
- * Prior to using the do-while the compiler would get upset at the
- * "else" because it interpreted the "if" statement as being all
- * done when it reached the ';' after the yyless() call.
- */
-
-/* Return all but the first 'n' matched characters back to the input stream. */
-
-#define yyless(n) \
-	do \
-		{ \
-		/* Undo effects of setting up yytext. */ \
-		*yy_cp = yy_hold_char; \
-		YY_RESTORE_YY_MORE_OFFSET \
-		yy_c_buf_p = yy_cp = yy_bp + n - YY_MORE_ADJ; \
-		YY_DO_BEFORE_ACTION; /* set up yytext again */ \
-		} \
-	while ( 0 )
-
-#define unput(c) yyunput( c, yytext_ptr )
-
-/* The following is because we cannot portably get our hands on size_t
- * (without autoconf's help, which isn't available because we want
- * flex-generated scanners to compile on their own).
- */
-typedef unsigned int yy_size_t;
-
-
-struct yy_buffer_state
-	{
-	FILE *yy_input_file;
-
-	char *yy_ch_buf;		/* input buffer */
-	char *yy_buf_pos;		/* current position in input buffer */
-
-	/* Size of input buffer in bytes, not including room for EOB
-	 * characters.
-	 */
-	yy_size_t yy_buf_size;
-
-	/* Number of characters read into yy_ch_buf, not including EOB
-	 * characters.
-	 */
-	int yy_n_chars;
-
-	/* Whether we "own" the buffer - i.e., we know we created it,
-	 * and can realloc() it to grow it, and should free() it to
-	 * delete it.
-	 */
-	int yy_is_our_buffer;
-
-	/* Whether this is an "interactive" input source; if so, and
-	 * if we're using stdio for input, then we want to use getc()
-	 * instead of fread(), to make sure we stop fetching input after
-	 * each newline.
-	 */
-	int yy_is_interactive;
-
-	/* Whether we're considered to be at the beginning of a line.
-	 * If so, '^' rules will be active on the next match, otherwise
-	 * not.
-	 */
-	int yy_at_bol;
-
-	/* Whether to try to fill the input buffer when we reach the
-	 * end of it.
-	 */
-	int yy_fill_buffer;
-
-	int yy_buffer_status;
-#define YY_BUFFER_NEW 0
-#define YY_BUFFER_NORMAL 1
-	/* When an EOF's been seen but there's still some text to process
-	 * then we mark the buffer as YY_EOF_PENDING, to indicate that we
-	 * shouldn't try reading from the input source any more.  We might
-	 * still have a bunch of tokens to match, though, because of
-	 * possible backing-up.
-	 *
-	 * When we actually see the EOF, we change the status to "new"
-	 * (via yyrestart()), so that the user can continue scanning by
-	 * just pointing yyin at a new input file.
-	 */
-#define YY_BUFFER_EOF_PENDING 2
-	};
-
-static YY_BUFFER_STATE yy_current_buffer = 0;
-
-/* We provide macros for accessing buffer states in case in the
- * future we want to put the buffer states in a more general
- * "scanner state".
- */
-#define YY_CURRENT_BUFFER yy_current_buffer
-
-
-/* yy_hold_char holds the character lost when yytext is formed. */
-static char yy_hold_char;
-
-static int yy_n_chars;		/* number of characters read into yy_ch_buf */
-
-
-int yyleng;
-
-/* Points to current character in buffer. */
-static char *yy_c_buf_p = (char *) 0;
-static int yy_init = 1;		/* whether we need to initialize */
-static int yy_start = 0;	/* start state number */
-
-/* Flag which is used to allow yywrap()'s to do buffer switches
- * instead of setting up a fresh yyin.  A bit of a hack ...
- */
-static int yy_did_buffer_switch_on_eof;
-
-void yyrestart YY_PROTO(( FILE *input_file ));
-
-void yy_switch_to_buffer YY_PROTO(( YY_BUFFER_STATE new_buffer ));
-void yy_load_buffer_state YY_PROTO(( void ));
-YY_BUFFER_STATE yy_create_buffer YY_PROTO(( FILE *file, int size ));
-void yy_delete_buffer YY_PROTO(( YY_BUFFER_STATE b ));
-void yy_init_buffer YY_PROTO(( YY_BUFFER_STATE b, FILE *file ));
-void yy_flush_buffer YY_PROTO(( YY_BUFFER_STATE b ));
-#define YY_FLUSH_BUFFER yy_flush_buffer( yy_current_buffer )
-
-YY_BUFFER_STATE yy_scan_buffer YY_PROTO(( char *base, yy_size_t size ));
-YY_BUFFER_STATE yy_scan_string YY_PROTO(( yyconst char *yy_str ));
-YY_BUFFER_STATE yy_scan_bytes YY_PROTO(( yyconst char *bytes, int len ));
-
-static void *yy_flex_alloc YY_PROTO(( yy_size_t ));
-static void *yy_flex_realloc YY_PROTO(( void *, yy_size_t ));
-static void yy_flex_free YY_PROTO(( void * ));
-
-#define yy_new_buffer yy_create_buffer
-
-#define yy_set_interactive(is_interactive) \
-	{ \
-	if ( ! yy_current_buffer ) \
-		yy_current_buffer = yy_create_buffer( yyin, YY_BUF_SIZE ); \
-	yy_current_buffer->yy_is_interactive = is_interactive; \
-	}
-
-#define yy_set_bol(at_bol) \
-	{ \
-	if ( ! yy_current_buffer ) \
-		yy_current_buffer = yy_create_buffer( yyin, YY_BUF_SIZE ); \
-	yy_current_buffer->yy_at_bol = at_bol; \
-	}
-
-#define YY_AT_BOL() (yy_current_buffer->yy_at_bol)
-
-typedef unsigned char YY_CHAR;
-FILE *yyin = (FILE *) 0, *yyout = (FILE *) 0;
-typedef int yy_state_type;
-extern char *yytext;
-#define yytext_ptr yytext
-
-static yy_state_type yy_get_previous_state YY_PROTO(( void ));
-static yy_state_type yy_try_NUL_trans YY_PROTO(( yy_state_type current_state ));
-static int yy_get_next_buffer YY_PROTO(( void ));
-static void yy_fatal_error YY_PROTO(( yyconst char msg[] ));
-
-/* Done after the current pattern has been matched and before the
- * corresponding action - sets up yytext.
- */
-#define YY_DO_BEFORE_ACTION \
-	yytext_ptr = yy_bp; \
-	yyleng = (int) (yy_cp - yy_bp); \
-	yy_hold_char = *yy_cp; \
-	*yy_cp = '\0'; \
-	yy_c_buf_p = yy_cp;
-
-#define YY_NUM_RULES 132
-#define YY_END_OF_BUFFER 133
-static yyconst short int yy_accept[688] =
-    {   0,
-      110,  110,  133,  132,  129,  128,  124,  130,  132,  117,
-      127,  120,  121,  116,  113,  119,  114,  111,  115,  110,
-      122,  109,  118,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  125,  126,  123,  111,  112,  131,
-      111,  110,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,   50,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,   64,  109,
-
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,   95,  109,  109,  109,  109,
-      109,  112,  112,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,   44,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-       81,  109,  109,  109,  109,  109,  109,  109,   51,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  105,  106,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,   38,  109,  109,
-
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,   39,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,    2,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  107,
-      108,  109,  109,  109,  109,   89,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,   17,  109,  109,   70,  109,  109,  109,
-
-        5,  109,   84,  109,  109,   37,  109,  109,  109,  109,
-       55,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,   75,   76,   77,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,   43,  109,  109,  109,   16,  109,  109,
-      109,   67,  109,   83,  109,  109,  109,  109,  109,   93,
-      109,  109,  109,  109,   68,  109,  109,  109,  100,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,   53,   54,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-
-      109,  109,  109,  109,  109,  109,  109,  109,  109,    1,
-      109,   94,  109,  109,  109,  109,  109,  109,   19,  109,
-      109,  109,  109,  103,  109,  109,  109,  109,   66,  109,
-      109,   65,  109,   92,  109,  109,  109,   12,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,   78,
-      109,  109,  109,  109,  109,   56,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-       15,  109,  109,   63,  109,  109,   47,  109,    9,   23,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,   73,
-      109,   74,   24,  109,  109,  109,  109,  109,  109,  109,
-
-       62,  109,  109,   99,  109,   22,  109,   80,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,   36,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,   82,  109,   40,  109,   90,  109,  109,    8,
-      109,  109,  109,  109,   79,   52,  109,  109,  109,    6,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-       34,  109,  109,   13,  109,  109,  109,  109,  109,   87,
-       88,  109,  109,  109,   30,   45,   69,  109,   61,   60,
-      109,  109,  109,  109,  109,  109,  109,  109,  109,  109,
-
-       98,  109,  109,  109,  109,  109,  109,  109,    7,   46,
-       91,  109,  109,  109,  109,  109,  109,   58,  109,   49,
-      101,  109,   85,  109,   41,  109,   25,  109,  109,  109,
-      109,  109,  109,   31,  109,  109,  109,   27,  109,  109,
-      109,   11,  109,  109,  109,   21,  109,   33,  109,   14,
-      109,  109,  109,   96,   26,   71,  102,    4,  109,  109,
-       29,  109,  109,   57,   18,  109,    3,  109,  109,   32,
-       35,  109,   42,   10,   28,   48,   97,   86,   20,   59,
-      109,  109,  104,  109,  109,   72,    0
-    } ;
-
-static yyconst int yy_ec[256] =
-    {   0,
-        1,    1,    1,    1,    1,    1,    1,    1,    2,    3,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    2,    1,    4,    5,    6,    7,    1,    8,    9,
-       10,   11,   12,   13,   14,   15,   16,   17,   17,   17,
-       17,   17,   17,   17,   17,   17,   17,    1,    1,    1,
-       18,    1,    1,    1,   19,   19,   19,   19,   20,   19,
-       19,   19,   19,   19,   19,   19,   19,   19,   19,   19,
-       19,   19,   19,   19,   19,   19,   19,   19,   19,   19,
-        1,    1,    1,   21,   19,    1,   22,   23,   24,   25,
-
-       26,   27,   28,   29,   30,   31,   32,   33,   34,   35,
-       36,   37,   38,   39,   40,   41,   42,   43,   44,   45,
-       46,   47,   48,    1,   49,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1
-    } ;
-
-static yyconst int yy_meta[50] =
-    {   0,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    2,    2,    2,    1,    2,    2,
-        1,    2,    2,    2,    2,    2,    2,    2,    2,    2,
-        2,    2,    2,    2,    2,    2,    2,    2,    2,    2,
-        2,    2,    2,    2,    2,    2,    2,    1,    1
-    } ;
-
-static yyconst short int yy_base[689] =
-    {   0,
-        0,    0,  709,  710,  710,  710,  710,  710,  702,  710,
-      710,  710,  710,  710,  710,  710,  710,   33,  696,   37,
-      710,    0,  710,   32,   36,   37,   34,  668,   46,   52,
-       57,  670,  679,  667,   58,   45,   59,   63,   77,   82,
-       96,  665,   93,  679,  710,  710,  710,  110,   83,  710,
-      117,   99,    0,  660,  677,  661,  108,   68,  109,  675,
-       25,   30,  661,  665,  113,  666,  659,  653,  649,  657,
-      663,  660,  665,  649,  649,  654,  636,  652,  641,  639,
-      117,  113,  638,  107,  639,  643,  649,    0,  119,  634,
-      635,  129,  628,  636,  131,  130,  649,  647,    0,  643,
-
-      627,  133,  645,  619,  623,  622,  624,  639,  616,  621,
-      618,  621,  635,  617,  629,    0,  618,  614,  616,  612,
-      607,  147,  632,  612,  610,  617,  615,  611,  610,  612,
-      609,  143,  606,  604,  614,  613,  595,  594,  597,  606,
-      596,  594,  590,    0,  592,  602,  605,  593,  592,  597,
-      589,  138,   81,  597,  595,  592,  589,  579,  595,  584,
-        0,  589,  134,  592,  588,  569,  577,  571,  582,  582,
-      578,  569,  565,  564,  568,  576,  570,  570,  571,  558,
-      564,  570,  571,  572,  571,  570,  558,  564,  564,  562,
-      548,  560,  555,  559,  542,  556,  548,    0,  545,  556,
-
-      543,  544,  535,  536,  533,  547,  533,  530,  548,  543,
-      538,  541,  544,  143,    0,  525,  539,  538,  530,  529,
-      534,  142,  516,  531,  137,  521,  515,  525,  530,  512,
-      516,  526,  528,  523,  512,  517,  516,  137,    0,  521,
-      515,  518,  516,  500,  518,  500,  508,  495,  497,  512,
-      504,  511,  510,  509,  500,  490,  492,  485,  489,  499,
-      496,  490,  496,  150,  495,  483,  493,  496,  476,    0,
-        0,  475,  489,  488,  477,    0,  488,  485,  473,  479,
-      466,  467,  480,  465,  462,  462,  466,  475,  466,  472,
-      465,  460,  466,    0,  460,  453,    0,  460,  470,  452,
-
-        0,  460,  465,  448,  447,    0,  447,  459,  448,  453,
-      159,  443,  441,  458,  444,  437,  447,  449,  439,  450,
-      438,  439,  424,  437,    0,    0,    0,  433,  427,  441,
-      440,  435,  423,  433,  421,  438,  434,  437,  418,  424,
-      423,  409,  421,    0,  425,  411,  425,    0,  410,  421,
-      424,    0,  407,    0,  420,  421,  403,  407,  416,  414,
-      405,  395,  412,  390,    0,  393,  396,  405,    0,  158,
-      400,  386,  148,  386,  408,  399,  402,  386,  383,  384,
-      382,  393,  398,  385,  380,  383,  388,  387,    0,    0,
-      383,  391,  384,  391,  382,  376,  382,  379,  372,  380,
-
-      379,  364,  368,  367,  376,  375,  367,  372,  376,    0,
-      361,    0,  374,  362,  361,  367,  359,  350,    0,  363,
-      349,  362,  348,    0,  362,  356,  345,  342,    0,  343,
-      340,    0,  341,    0,  357,  338,  337,  337,  349,  344,
-      347,  336,  335,  348,  347,  342,  340,  339,  326,    0,
-      331,  330,  327,  331,  334,    0,  334,  336,  327,  314,
-      314,  321,  306,  305,  309,  320,  163,  312,  307,  306,
-        0,  310,  310,    0,  301,  307,    0,  155,    0,    0,
-      306,  311,  305,  304,  305,  311,  310,  310,  301,    0,
-      303,    0,    0,  310,  290,  308,  299,  298,  290,  304,
-
-        0,  301,  294,    0,  301,    0,  282,    0,  288,  281,
-      278,  279,  282,  286,  285,  287,  287,  284,  275,    0,
-      284,  269,  273,  272,  267,  269,  278,  277,  268,  275,
-      267,  273,    0,  272,    0,  262,    0,  266,  256,    0,
-      255,  159,  267,  264,    0,    0,  248,  247,  263,    0,
-      255,  250,  256,  260,  259,  247,  252,  246,  239,  232,
-      253,  247,  251,  241,  248,  247,  248,  228,  237,  239,
-        0,  227,  232,    0,  236,  237,  239,  233,  160,    0,
-        0,  236,  226,  235,    0,    0,    0,  233,    0,    0,
-      219,  224,  223,  229,  228,  216,  226,  222,  207,  219,
-
-        0,  213,  202,  222,  209,  218,  213,  206,    0,    0,
-        0,  206,  214,  213,  212,  204,  207,    0,  200,    0,
-        0,  211,    0,  194,    0,  191,    0,  187,  205,  203,
-      195,  194,  185,    0,  195,  198,  188,    0,  196,  195,
-      181,    0,  177,  183,  193,    0,  193,    0,  189,    0,
-      186,  171,  172,    0,    0,    0,    0,    0,  182,   47,
-        0,   62,   88,    0,  148,  160,    0,  157,  174,    0,
-        0,  164,    0,    0,    0,    0,    0,    0,    0,    0,
-      165,  177,    0,  172,  174,    0,  710,  208
-    } ;
-
-static yyconst short int yy_def[689] =
-    {   0,
-      687,    1,  687,  687,  687,  687,  687,  687,  687,  687,
-      687,  687,  687,  687,  687,  687,  687,  687,  687,  687,
-      687,  688,  687,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  687,  687,  687,  687,  687,  687,
-      687,  687,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  687,  687,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,  688,  688,  688,  688,
-      688,  688,  688,  688,  688,  688,    0,  687
-    } ;
-
-static yyconst short int yy_nxt[760] =
-    {   0,
-        4,    5,    6,    7,    8,    9,   10,   11,   12,   13,
-       14,   15,   16,   17,   18,   19,   20,   21,   22,   22,
-       23,   24,   25,   26,   27,   28,   29,   30,   31,   32,
-       22,   33,   34,   35,   36,   37,   38,   22,   39,   40,
-       41,   42,   43,   44,   22,   22,   22,   45,   46,   48,
-      134,   51,   49,   52,   54,   67,   55,   59,   49,  136,
-      135,   60,   63,   68,   56,   57,   58,   70,   61,   64,
-      675,  137,   65,   74,   62,   71,   66,   75,   77,   82,
-       85,   72,   78,   83,   73,   87,   86,   84,   91,  676,
-       76,   92,   93,   88,  122,  129,  122,   89,   95,  123,
-
-       90,   94,   96,   97,   98,  102,   99,  237,  130,  100,
-      103,  104,  101,   51,  238,   52,  117,  105,  118,  106,
-      677,  109,  107,  108,  110,  111,   48,  119,  120,   49,
-      127,  112,  131,   48,  113,   49,   49,  114,  140,  115,
-      159,  165,   49,  170,  128,  141,  142,  143,  132,  161,
-      174,  166,  160,  162,  187,  178,  181,  163,  122,  171,
-      122,  235,  247,  123,  175,  179,  182,  307,  215,  299,
-      300,  188,  216,  248,  249,  311,  180,  236,  312,  352,
-      308,  325,  326,  327,  443,  393,  448,  678,  531,  449,
-      444,  353,  394,  540,  445,  532,  541,  590,  623,  679,
-
-      591,  624,  680,  681,  682,  683,  684,  685,  686,   53,
-      674,  673,  672,  671,  670,  669,  668,  667,  666,  665,
-      664,  663,  662,  661,  660,  659,  658,  657,  656,  655,
-      654,  653,  623,  652,  651,  650,  649,  648,  647,  646,
-      645,  644,  643,  642,  641,  640,  639,  638,  637,  636,
-      635,  634,  633,  632,  631,  630,  629,  590,  628,  627,
-      626,  625,  622,  621,  620,  619,  618,  617,  616,  615,
-      614,  613,  612,  611,  610,  609,  608,  607,  606,  605,
-      604,  603,  602,  601,  600,  599,  598,  597,  596,  595,
-      594,  593,  592,  540,  589,  588,  587,  586,  585,  584,
-
-      583,  582,  581,  580,  579,  578,  577,  576,  575,  574,
-      573,  572,  571,  570,  569,  568,  567,  566,  565,  564,
-      563,  562,  561,  560,  559,  558,  557,  556,  555,  554,
-      553,  552,  551,  550,  549,  548,  547,  546,  545,  544,
-      543,  542,  539,  538,  537,  536,  535,  534,  533,  530,
-      529,  528,  527,  526,  525,  524,  523,  522,  521,  520,
-      519,  518,  517,  516,  448,  515,  514,  513,  512,  511,
-      510,  509,  508,  507,  506,  505,  504,  503,  502,  501,
-      500,  499,  498,  497,  496,  495,  494,  493,  492,  491,
-      490,  489,  488,  487,  486,  485,  484,  483,  482,  481,
-
-      480,  479,  478,  477,  476,  475,  474,  473,  472,  471,
-      470,  469,  468,  467,  466,  465,  464,  463,  462,  461,
-      460,  459,  458,  457,  456,  455,  454,  453,  452,  451,
-      450,  447,  446,  442,  441,  440,  439,  438,  437,  436,
-      435,  434,  433,  432,  431,  430,  429,  428,  427,  426,
-      425,  424,  423,  422,  421,  420,  419,  418,  417,  416,
-      415,  414,  413,  412,  411,  410,  409,  408,  407,  406,
-      405,  404,  403,  402,  401,  400,  399,  398,  397,  396,
-      395,  311,  392,  391,  390,  389,  388,  387,  386,  385,
-      384,  383,  382,  381,  380,  379,  378,  377,  376,  375,
-
-      374,  373,  372,  371,  370,  369,  368,  367,  366,  365,
-      364,  363,  362,  361,  360,  359,  358,  357,  356,  355,
-      354,  351,  350,  349,  348,  347,  346,  345,  344,  343,
-      342,  341,  340,  339,  338,  337,  336,  335,  334,  333,
-      332,  331,  330,  329,  328,  324,  323,  322,  321,  320,
-      319,  318,  317,  316,  315,  314,  313,  310,  309,  306,
-      305,  304,  303,  302,  301,  298,  297,  296,  295,  294,
-      293,  292,  291,  290,  289,  288,  287,  286,  285,  284,
-      283,  282,  281,  280,  279,  278,  277,  276,  275,  274,
-      273,  272,  271,  270,  269,  268,  267,  266,  265,  264,
-
-      263,  262,  261,  260,  259,  258,  257,  256,  255,  254,
-      253,  252,  251,  250,  246,  245,  244,  243,  242,  241,
-      240,  239,  234,  233,  232,  231,  230,  229,  228,  227,
-      226,  225,  224,  223,  222,  221,  220,  219,  218,  217,
-      214,  213,  212,  211,  210,  209,  208,  207,  123,  206,
-      205,  204,  203,  202,  201,  200,  199,  198,  197,  196,
-      195,  194,  193,  192,  191,  190,  189,  186,  185,  184,
-      183,  177,  176,  173,  172,  169,  168,  167,  164,  158,
-      157,  156,  155,  154,  153,  152,  151,  150,  149,  148,
-      147,  146,  145,  144,  139,  138,  133,  126,  125,  124,
-
-      121,  116,   81,   80,   79,   69,   50,   47,  687,    3,
-      687,  687,  687,  687,  687,  687,  687,  687,  687,  687,
-      687,  687,  687,  687,  687,  687,  687,  687,  687,  687,
-      687,  687,  687,  687,  687,  687,  687,  687,  687,  687,
-      687,  687,  687,  687,  687,  687,  687,  687,  687,  687,
-      687,  687,  687,  687,  687,  687,  687,  687,  687
-    } ;
-
-static yyconst short int yy_chk[760] =
-    {   0,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
-        1,    1,    1,    1,    1,    1,    1,    1,    1,   18,
-       61,   20,   18,   20,   24,   27,   24,   25,   18,   62,
-       61,   25,   26,   27,   24,   24,   24,   29,   25,   26,
-      660,   62,   26,   30,   25,   29,   26,   30,   31,   35,
-       36,   29,   31,   35,   29,   37,   36,   35,   38,  662,
-       30,   38,   38,   37,   49,   58,   49,   37,   39,   49,
-
-       37,   38,   39,   39,   39,   40,   39,  153,   58,   39,
-       40,   40,   39,   52,  153,   52,   43,   40,   43,   40,
-      663,   41,   40,   40,   41,   41,   48,   43,   43,   48,
-       57,   41,   59,   51,   41,   48,   51,   41,   65,   41,
-       81,   84,   51,   89,   57,   65,   65,   65,   59,   82,
-       92,   84,   81,   82,  102,   95,   96,   82,  122,   89,
-      122,  152,  163,  122,   92,   95,   96,  222,  132,  214,
-      214,  102,  132,  163,  163,  225,   95,  152,  225,  264,
-      222,  238,  238,  238,  370,  311,  373,  665,  467,  373,
-      370,  264,  311,  478,  370,  467,  478,  542,  579,  666,
-
-      542,  579,  668,  669,  672,  681,  682,  684,  685,  688,
-      659,  653,  652,  651,  649,  647,  645,  644,  643,  641,
-      640,  639,  637,  636,  635,  633,  632,  631,  630,  629,
-      628,  626,  624,  622,  619,  617,  616,  615,  614,  613,
-      612,  608,  607,  606,  605,  604,  603,  602,  600,  599,
-      598,  597,  596,  595,  594,  593,  592,  591,  588,  584,
-      583,  582,  578,  577,  576,  575,  573,  572,  570,  569,
-      568,  567,  566,  565,  564,  563,  562,  561,  560,  559,
-      558,  557,  556,  555,  554,  553,  552,  551,  549,  548,
-      547,  544,  543,  541,  539,  538,  536,  534,  532,  531,
-
-      530,  529,  528,  527,  526,  525,  524,  523,  522,  521,
-      519,  518,  517,  516,  515,  514,  513,  512,  511,  510,
-      509,  507,  505,  503,  502,  500,  499,  498,  497,  496,
-      495,  494,  491,  489,  488,  487,  486,  485,  484,  483,
-      482,  481,  476,  475,  473,  472,  470,  469,  468,  466,
-      465,  464,  463,  462,  461,  460,  459,  458,  457,  455,
-      454,  453,  452,  451,  449,  448,  447,  446,  445,  444,
-      443,  442,  441,  440,  439,  438,  437,  436,  435,  433,
-      431,  430,  428,  427,  426,  425,  423,  422,  421,  420,
-      418,  417,  416,  415,  414,  413,  411,  409,  408,  407,
-
-      406,  405,  404,  403,  402,  401,  400,  399,  398,  397,
-      396,  395,  394,  393,  392,  391,  388,  387,  386,  385,
-      384,  383,  382,  381,  380,  379,  378,  377,  376,  375,
-      374,  372,  371,  368,  367,  366,  364,  363,  362,  361,
-      360,  359,  358,  357,  356,  355,  353,  351,  350,  349,
-      347,  346,  345,  343,  342,  341,  340,  339,  338,  337,
-      336,  335,  334,  333,  332,  331,  330,  329,  328,  324,
-      323,  322,  321,  320,  319,  318,  317,  316,  315,  314,
-      313,  312,  310,  309,  308,  307,  305,  304,  303,  302,
-      300,  299,  298,  296,  295,  293,  292,  291,  290,  289,
-
-      288,  287,  286,  285,  284,  283,  282,  281,  280,  279,
-      278,  277,  275,  274,  273,  272,  269,  268,  267,  266,
-      265,  263,  262,  261,  260,  259,  258,  257,  256,  255,
-      254,  253,  252,  251,  250,  249,  248,  247,  246,  245,
-      244,  243,  242,  241,  240,  237,  236,  235,  234,  233,
-      232,  231,  230,  229,  228,  227,  226,  224,  223,  221,
-      220,  219,  218,  217,  216,  213,  212,  211,  210,  209,
-      208,  207,  206,  205,  204,  203,  202,  201,  200,  199,
-      197,  196,  195,  194,  193,  192,  191,  190,  189,  188,
-      187,  186,  185,  184,  183,  182,  181,  180,  179,  178,
-
-      177,  176,  175,  174,  173,  172,  171,  170,  169,  168,
-      167,  166,  165,  164,  162,  160,  159,  158,  157,  156,
-      155,  154,  151,  150,  149,  148,  147,  146,  145,  143,
-      142,  141,  140,  139,  138,  137,  136,  135,  134,  133,
-      131,  130,  129,  128,  127,  126,  125,  124,  123,  121,
-      120,  119,  118,  117,  115,  114,  113,  112,  111,  110,
-      109,  108,  107,  106,  105,  104,  103,  101,  100,   98,
-       97,   94,   93,   91,   90,   87,   86,   85,   83,   80,
-       79,   78,   77,   76,   75,   74,   73,   72,   71,   70,
-       69,   68,   67,   66,   64,   63,   60,   56,   55,   54,
-
-       44,   42,   34,   33,   32,   28,   19,    9,    3,  687,
-      687,  687,  687,  687,  687,  687,  687,  687,  687,  687,
-      687,  687,  687,  687,  687,  687,  687,  687,  687,  687,
-      687,  687,  687,  687,  687,  687,  687,  687,  687,  687,
-      687,  687,  687,  687,  687,  687,  687,  687,  687,  687,
-      687,  687,  687,  687,  687,  687,  687,  687,  687
-    } ;
-
-static yy_state_type yy_last_accepting_state;
-static char *yy_last_accepting_cpos;
-
-/* The intent behind this definition is that it'll catch
- * any uses of REJECT which flex missed.
- */
-#define REJECT reject_used_but_not_detected
-#define yymore() yymore_used_but_not_detected
-#define YY_MORE_ADJ 0
-#define YY_RESTORE_YY_MORE_OFFSET
-char *yytext;
-#line 1 "lex.l"
-#define INITIAL 0
-#line 2 "lex.l"
-#include <math.h>
-#include "art.h"
-#include "objs.h"
-#include "gram.h"
-
-extern int	linecount;
-
-extern char	currentfile[];
-
-extern symbol	*lookup();
-
-extern double	atof();
-
-
-/* Macros after this point can all be overridden by user definitions in
- * section 1.
- */
-
-#ifndef YY_SKIP_YYWRAP
-#ifdef __cplusplus
-extern "C" int yywrap YY_PROTO(( void ));
-#else
-extern int yywrap YY_PROTO(( void ));
-#endif
-#endif
-
-#ifndef YY_NO_UNPUT
-static void yyunput YY_PROTO(( int c, char *buf_ptr ));
-#endif
-
-#ifndef yytext_ptr
-static void yy_flex_strncpy YY_PROTO(( char *, yyconst char *, int ));
-#endif
-
-#ifdef YY_NEED_STRLEN
-static int yy_flex_strlen YY_PROTO(( yyconst char * ));
-#endif
-
-#ifndef YY_NO_INPUT
-#ifdef __cplusplus
-static int yyinput YY_PROTO(( void ));
-#else
-static int input YY_PROTO(( void ));
-#endif
-#endif
-
-#if YY_STACK_USED
-static int yy_start_stack_ptr = 0;
-static int yy_start_stack_depth = 0;
-static int *yy_start_stack = 0;
-#ifndef YY_NO_PUSH_STATE
-static void yy_push_state YY_PROTO(( int new_state ));
-#endif
-#ifndef YY_NO_POP_STATE
-static void yy_pop_state YY_PROTO(( void ));
-#endif
-#ifndef YY_NO_TOP_STATE
-static int yy_top_state YY_PROTO(( void ));
-#endif
-
-#else
-#define YY_NO_PUSH_STATE 1
-#define YY_NO_POP_STATE 1
-#define YY_NO_TOP_STATE 1
-#endif
-
-#ifdef YY_MALLOC_DECL
-YY_MALLOC_DECL
-#else
-#if __STDC__
-#ifndef __cplusplus
-#include <stdlib.h>
-#endif
-#else
-/* Just try to get by without declaring the routines.  This will fail
- * miserably on non-ANSI systems for which sizeof(size_t) != sizeof(int)
- * or sizeof(void*) != sizeof(int).
- */
-#endif
-#endif
-
-/* Amount of stuff to slurp up with each read. */
-#ifndef YY_READ_BUF_SIZE
-#define YY_READ_BUF_SIZE 8192
-#endif
-
-/* Copy whatever the last rule matched to the standard output. */
-
-#ifndef ECHO
-/* This used to be an fputs(), but since the string might contain NUL's,
- * we now use fwrite().
- */
-#define ECHO (void) fwrite( yytext, yyleng, 1, yyout )
-#endif
-
-/* Gets input and stuffs it into "buf".  number of characters read, or YY_NULL,
- * is returned in "result".
- */
-#ifndef YY_INPUT
-#define YY_INPUT(buf,result,max_size) \
-	if ( yy_current_buffer->yy_is_interactive ) \
-		{ \
-		int c = '*', n; \
-		for ( n = 0; n < max_size && \
-			     (c = getc( yyin )) != EOF && c != '\n'; ++n ) \
-			buf[n] = (char) c; \
-		if ( c == '\n' ) \
-			buf[n++] = (char) c; \
-		if ( c == EOF && ferror( yyin ) ) \
-			YY_FATAL_ERROR( "input in flex scanner failed" ); \
-		result = n; \
-		} \
-	else if ( ((result = fread( buf, 1, max_size, yyin )) == 0) \
-		  && ferror( yyin ) ) \
-		YY_FATAL_ERROR( "input in flex scanner failed" );
-#endif
-
-/* No semi-colon after return; correct usage is to write "yyterminate();" -
- * we don't want an extra ';' after the "return" because that will cause
- * some compilers to complain about unreachable statements.
- */
-#ifndef yyterminate
-#define yyterminate() return YY_NULL
-#endif
-
-/* Number of entries by which start-condition stack grows. */
-#ifndef YY_START_STACK_INCR
-#define YY_START_STACK_INCR 25
-#endif
-
-/* Report a fatal error. */
-#ifndef YY_FATAL_ERROR
-#define YY_FATAL_ERROR(msg) yy_fatal_error( msg )
-#endif
-
-/* Default declaration of generated scanner - a define so the user can
- * easily add parameters.
- */
-#ifndef YY_DECL
-#define YY_DECL int yylex YY_PROTO(( void ))
-#endif
-
-/* Code executed at the beginning of each rule, after yytext and yyleng
- * have been set up.
- */
-#ifndef YY_USER_ACTION
-#define YY_USER_ACTION
-#endif
-
-/* Code executed at the end of each rule. */
-#ifndef YY_BREAK
-#define YY_BREAK break;
-#endif
-
-#define YY_RULE_SETUP \
-	YY_USER_ACTION
-
-YY_DECL
-	{
-	register yy_state_type yy_current_state;
-	register char *yy_cp, *yy_bp;
-	register int yy_act;
-
-#line 22 "lex.l"
-
-
-
-	if ( yy_init )
-		{
-		yy_init = 0;
-
-#ifdef YY_USER_INIT
-		YY_USER_INIT;
-#endif
-
-		if ( ! yy_start )
-			yy_start = 1;	/* first start state */
-
-		if ( ! yyin )
-			yyin = stdin;
-
-		if ( ! yyout )
-			yyout = stdout;
-
-		if ( ! yy_current_buffer )
-			yy_current_buffer =
-				yy_create_buffer( yyin, YY_BUF_SIZE );
-
-		yy_load_buffer_state();
-		}
-
-	while ( 1 )		/* loops until end-of-file is reached */
-		{
-		yy_cp = yy_c_buf_p;
-
-		/* Support of yytext. */
-		*yy_cp = yy_hold_char;
-
-		/* yy_bp points to the position in yy_ch_buf of the start of
-		 * the current run.
-		 */
-		yy_bp = yy_cp;
-
-		yy_current_state = yy_start;
-yy_match:
-		do
-			{
-			register YY_CHAR yy_c = yy_ec[YY_SC_TO_UI(*yy_cp)];
-			if ( yy_accept[yy_current_state] )
-				{
-				yy_last_accepting_state = yy_current_state;
-				yy_last_accepting_cpos = yy_cp;
-				}
-			while ( yy_chk[yy_base[yy_current_state] + yy_c] != yy_current_state )
-				{
-				yy_current_state = (int) yy_def[yy_current_state];
-				if ( yy_current_state >= 688 )
-					yy_c = yy_meta[(unsigned int) yy_c];
-				}
-			yy_current_state = yy_nxt[yy_base[yy_current_state] + (unsigned int) yy_c];
-			++yy_cp;
-			}
-		while ( yy_base[yy_current_state] != 710 );
-
-yy_find_action:
-		yy_act = yy_accept[yy_current_state];
-		if ( yy_act == 0 )
-			{ /* have to back up */
-			yy_cp = yy_last_accepting_cpos;
-			yy_current_state = yy_last_accepting_state;
-			yy_act = yy_accept[yy_current_state];
-			}
-
-		YY_DO_BEFORE_ACTION;
-
-
-do_action:	/* This label is used only to access EOF actions. */
-
-
-		switch ( yy_act )
-	{ /* beginning of action switch */
-			case 0: /* must back up */
-			/* undo the effects of YY_DO_BEFORE_ACTION */
-			*yy_cp = yy_hold_char;
-			yy_cp = yy_last_accepting_cpos;
-			yy_current_state = yy_last_accepting_state;
-			goto yy_find_action;
-
-case 1:
-YY_RULE_SETUP
-#line 24 "lex.l"
-return(KDTREE);
-	YY_BREAK
-case 2:
-YY_RULE_SETUP
-#line 26 "lex.l"
-return(GRID);
-	YY_BREAK
-case 3:
-YY_RULE_SETUP
-#line 28 "lex.l"
-return(SUBDIVISION);
-	YY_BREAK
-case 4:
-YY_RULE_SETUP
-#line 30 "lex.l"
-return(MAXSUBLEVEL);
-	YY_BREAK
-case 5:
-YY_RULE_SETUP
-#line 32 "lex.l"
-return(BASIS);
-	YY_BREAK
-case 6:
-YY_RULE_SETUP
-#line 34 "lex.l"
-return(METABALL);
-	YY_BREAK
-case 7:
-YY_RULE_SETUP
-#line 36 "lex.l"
-return(THRESHOLD);
-	YY_BREAK
-case 8:
-YY_RULE_SETUP
-#line 38 "lex.l"
-return(GAPCOLOUR);
-	YY_BREAK
-case 9:
-YY_RULE_SETUP
-#line 40 "lex.l"
-return(GAPSIZE);
-	YY_BREAK
-case 10:
-YY_RULE_SETUP
-#line 42 "lex.l"
-return(MAXTREEDEPTH);
-	YY_BREAK
-case 11:
-YY_RULE_SETUP
-#line 44 "lex.l"
-return(SCREENSIZE);
-	YY_BREAK
-case 12:
-YY_RULE_SETUP
-#line 46 "lex.l"
-return(SOURCE);
-	YY_BREAK
-case 13:
-YY_RULE_SETUP
-#line 48 "lex.l"
-return(AMPLITUDE);
-	YY_BREAK
-case 14:
-YY_RULE_SETUP
-#line 50 "lex.l"
-return(WAVELENGTH);
-	YY_BREAK
-case 15:
-YY_RULE_SETUP
-#line 52 "lex.l"
-return(DAMPING);
-	YY_BREAK
-case 16:
-YY_RULE_SETUP
-#line 54 "lex.l"
-return(PHASE);
-	YY_BREAK
-case 17:
-YY_RULE_SETUP
-#line 56 "lex.l"
-return(ALPHA);
-	YY_BREAK
-case 18:
-YY_RULE_SETUP
-#line 58 "lex.l"
-return(SCALEFACTOR);
-	YY_BREAK
-case 19:
-YY_RULE_SETUP
-#line 60 "lex.l"
-return(SCALEFACTOR);
-	YY_BREAK
-case 20:
-YY_RULE_SETUP
-#line 62 "lex.l"
-return(SOURCERADIUS);
-	YY_BREAK
-case 21:
-YY_RULE_SETUP
-#line 64 "lex.l"
-return(TURBULENCE);
-	YY_BREAK
-case 22:
-YY_RULE_SETUP
-#line 66 "lex.l"
-return(SQUEEZE);
-	YY_BREAK
-case 23:
-YY_RULE_SETUP
-#line 68 "lex.l"
-return(OFFFILE);
-	YY_BREAK
-case 24:
-YY_RULE_SETUP
-#line 70 "lex.l"
-return(OFFFILE);
-	YY_BREAK
-case 25:
-YY_RULE_SETUP
-#line 72 "lex.l"
-return(COLOURFIELD);
-	YY_BREAK
-case 26:
-YY_RULE_SETUP
-#line 74 "lex.l"
-return(HEIGHTFIELD);
-	YY_BREAK
-case 27:
-YY_RULE_SETUP
-#line 76 "lex.l"
-return(PROJECTION);
-	YY_BREAK
-case 28:
-YY_RULE_SETUP
-#line 78 "lex.l"
-return(ORTHOGRAPHIC);
-	YY_BREAK
-case 29:
-YY_RULE_SETUP
-#line 80 "lex.l"
-return(PERSPECTIVE);
-	YY_BREAK
-case 30:
-YY_RULE_SETUP
-#line 82 "lex.l"
-return(COLOURFILE);
-	YY_BREAK
-case 31:
-YY_RULE_SETUP
-#line 84 "lex.l"
-return(NORMALFILE);
-	YY_BREAK
-case 32:
-YY_RULE_SETUP
-#line 86 "lex.l"
-return(VNORMALFILE);
-	YY_BREAK
-case 33:
-YY_RULE_SETUP
-#line 88 "lex.l"
-return(VCOLOURFILE);
-	YY_BREAK
-case 34:
-YY_RULE_SETUP
-#line 90 "lex.l"
-return(VORTFILE);
-	YY_BREAK
-case 35:
-YY_RULE_SETUP
-#line 92 "lex.l"
-return(ANTIALIASING);
-	YY_BREAK
-case 36:
-YY_RULE_SETUP
-#line 94 "lex.l"
-return(ADAPTIVE);
-	YY_BREAK
-case 37:
-YY_RULE_SETUP
-#line 96 "lex.l"
-return(BRUTE);
-	YY_BREAK
-case 38:
-YY_RULE_SETUP
-#line 98 "lex.l"
-return(TOP);
-	YY_BREAK
-case 39:
-YY_RULE_SETUP
-#line 100 "lex.l"
-return(BASE);
-	YY_BREAK
-case 40:
-YY_RULE_SETUP
-#line 102 "lex.l"
-return(CONST);
-	YY_BREAK
-case 41:
-YY_RULE_SETUP
-#line 104 "lex.l"
-return(CLIPVOLUME);
-	YY_BREAK
-case 42:
-YY_RULE_SETUP
-#line 106 "lex.l"
-return(COEFFS);
-	YY_BREAK
-case 43:
-YY_RULE_SETUP
-#line 108 "lex.l"
-return(ORDER);
-	YY_BREAK
-case 44:
-YY_RULE_SETUP
-#line 110 "lex.l"
-return(CSG);
-	YY_BREAK
-case 45:
-YY_RULE_SETUP
-#line 112 "lex.l"
-return(COMPOSITE);
-	YY_BREAK
-case 46:
-YY_RULE_SETUP
-#line 114 "lex.l"
-return(TRANSFORM);
-	YY_BREAK
-case 47:
-YY_RULE_SETUP
-#line 116 "lex.l"
-return(FRAMENO);
-	YY_BREAK
-case 48:
-YY_RULE_SETUP
-#line 118 "lex.l"
-{
-			yylval.y_int = PHONGSHADING;
-			return(OPTION);
-		}
-	YY_BREAK
-case 49:
-YY_RULE_SETUP
-#line 123 "lex.l"
-{
-			yylval.y_int = BACKFACING;
-			return(OPTION);
-		}
-	YY_BREAK
-case 50:
-YY_RULE_SETUP
-#line 128 "lex.l"
-return(ON);
-	YY_BREAK
-case 51:
-YY_RULE_SETUP
-#line 130 "lex.l"
-return(OFF);
-	YY_BREAK
-case 52:
-YY_RULE_SETUP
-#line 132 "lex.l"
-return(MATERIAL);
-	YY_BREAK
-case 53:
-YY_RULE_SETUP
-#line 134 "lex.l"
-return(CENTER);
-	YY_BREAK
-case 54:
-YY_RULE_SETUP
-#line 136 "lex.l"
-return(CENTER);
-	YY_BREAK
-case 55:
-YY_RULE_SETUP
-#line 138 "lex.l"
-return(COLOUR);
-	YY_BREAK
-case 56:
-YY_RULE_SETUP
-#line 140 "lex.l"
-return(AMBIENT);
-	YY_BREAK
-case 57:
-YY_RULE_SETUP
-#line 142 "lex.l"
-return(REFLECTANCE);
-	YY_BREAK
-case 58:
-YY_RULE_SETUP
-#line 144 "lex.l"
-return(ABSORPTION);
-	YY_BREAK
-case 59:
-YY_RULE_SETUP
-#line 146 "lex.l"
-return(TRANSPARENCY);
-	YY_BREAK
-case 60:
-YY_RULE_SETUP
-#line 148 "lex.l"
-return(HAZECOLOUR);
-	YY_BREAK
-case 61:
-YY_RULE_SETUP
-#line 150 "lex.l"
-return(FOGFACTOR);
-	YY_BREAK
-case 62:
-YY_RULE_SETUP
-#line 152 "lex.l"
-return(RFACTOR);
-	YY_BREAK
-case 63:
-YY_RULE_SETUP
-#line 154 "lex.l"
-return(FALLOFF);
-	YY_BREAK
-case 64:
-YY_RULE_SETUP
-#line 156 "lex.l"
-return(RI);
-	YY_BREAK
-case 65:
-YY_RULE_SETUP
-#line 158 "lex.l"
-return(REPEAT);
-	YY_BREAK
-case 66:
-YY_RULE_SETUP
-#line 160 "lex.l"
-return(RADIUS);
-	YY_BREAK
-case 67:
-YY_RULE_SETUP
-#line 162 "lex.l"
-return(RADII);
-	YY_BREAK
-case 68:
-YY_RULE_SETUP
-#line 164 "lex.l"
-return(STRIP);
-	YY_BREAK
-case 69:
-YY_RULE_SETUP
-#line 166 "lex.l"
-return(DIRECTION);
-	YY_BREAK
-case 70:
-YY_RULE_SETUP
-#line 168 "lex.l"
-return(ANGLE);
-	YY_BREAK
-case 71:
-YY_RULE_SETUP
-#line 170 "lex.l"
-return(INSIDEANGLE);
-	YY_BREAK
-case 72:
-YY_RULE_SETUP
-#line 172 "lex.l"
-return(BEAMDISTRIBUTION);
-	YY_BREAK
-case 73:
-YY_RULE_SETUP
-#line 174 "lex.l"
-return(MINDIST);
-	YY_BREAK
-case 74:
-YY_RULE_SETUP
-#line 176 "lex.l"
-return(NUMRAYS);
-	YY_BREAK
-case 75:
-YY_RULE_SETUP
-#line 178 "lex.l"
-return(GEOMX);
-	YY_BREAK
-case 76:
-YY_RULE_SETUP
-#line 180 "lex.l"
-return(GEOMY);
-	YY_BREAK
-case 77:
-YY_RULE_SETUP
-#line 182 "lex.l"
-return(GEOMZ);
-	YY_BREAK
-case 78:
-YY_RULE_SETUP
-#line 184 "lex.l"
-return(VERTEX);
-	YY_BREAK
-case 79:
-YY_RULE_SETUP
-#line 186 "lex.l"
-return(LOCATION);
-	YY_BREAK
-case 80:
-YY_RULE_SETUP
-#line 188 "lex.l"
-return(TEXTURE);
-	YY_BREAK
-case 81:
-YY_RULE_SETUP
-#line 190 "lex.l"
-return(MAP);
-	YY_BREAK
-case 82:
-YY_RULE_SETUP
-#line 192 "lex.l"
-return(COLOURMAP);
-	YY_BREAK
-case 83:
-YY_RULE_SETUP
-#line 194 "lex.l"
-return(RANGE);
-	YY_BREAK
-case 84:
-YY_RULE_SETUP
-#line 196 "lex.l"
-return(BLEND);
-	YY_BREAK
-case 85:
-YY_RULE_SETUP
-#line 198 "lex.l"
-return(BLENDCOLOR);
-	YY_BREAK
-case 86:
-YY_RULE_SETUP
-#line 200 "lex.l"
-return(SCALEFACTORS);
-	YY_BREAK
-case 87:
-YY_RULE_SETUP
-#line 202 "lex.l"
-return(BLOCKSIZE);
-	YY_BREAK
-case 88:
-YY_RULE_SETUP
-#line 204 "lex.l"
-return(BLOCKSIZE);
-	YY_BREAK
-case 89:
-YY_RULE_SETUP
-#line 206 "lex.l"
-return(SIZE);
-	YY_BREAK
-case 90:
-YY_RULE_SETUP
-#line 208 "lex.l"
-return(EQUATION);
-	YY_BREAK
-case 91:
-YY_RULE_SETUP
-#line 210 "lex.l"
-return(TRANSLATE);
-	YY_BREAK
-case 92:
-YY_RULE_SETUP
-#line 212 "lex.l"
-return(ROTATE);
-	YY_BREAK
-case 93:
-YY_RULE_SETUP
-#line 214 "lex.l"
-return(SCALE);
-	YY_BREAK
-case 94:
-YY_RULE_SETUP
-#line 216 "lex.l"
-return(LOOKAT);
-	YY_BREAK
-case 95:
-YY_RULE_SETUP
-#line 218 "lex.l"
-return(UP);
-	YY_BREAK
-case 96:
-YY_RULE_SETUP
-#line 220 "lex.l"
-return(FIELDOFVIEW);
-	YY_BREAK
-case 97:
-YY_RULE_SETUP
-#line 222 "lex.l"
-return(RAYSPERPIXEL);
-	YY_BREAK
-case 98:
-YY_RULE_SETUP
-#line 224 "lex.l"
-return(PIXELGRID);
-	YY_BREAK
-case 99:
-YY_RULE_SETUP
-#line 226 "lex.l"
-return(SHADOWS);
-	YY_BREAK
-case 100:
-YY_RULE_SETUP
-#line 228 "lex.l"
-return(TITLE);
-	YY_BREAK
-case 101:
-YY_RULE_SETUP
-#line 230 "lex.l"
-return(BACKGROUND);
-	YY_BREAK
-case 102:
-YY_RULE_SETUP
-#line 232 "lex.l"
-return(MAXHITLEVEL);
-	YY_BREAK
-case 103:
-YY_RULE_SETUP
-#line 234 "lex.l"
-return(OUTPUT);
-	YY_BREAK
-case 104:
-YY_RULE_SETUP
-#line 236 "lex.l"
-return(TWENTYFIVEBIT);
-	YY_BREAK
-case 105:
-YY_RULE_SETUP
-#line 238 "lex.l"
-{
-			yylval.y_int = PIX_RGB;
-			return(FILETYPE);
-		}
-	YY_BREAK
-case 106:
-YY_RULE_SETUP
-#line 243 "lex.l"
-{
-			yylval.y_int = PIX_RLE;
-			return(FILETYPE);
-		}
-	YY_BREAK
-case 107:
-YY_RULE_SETUP
-#line 248 "lex.l"
-{
-			yylval.y_int = PIX_RGBA;
-			return(FILETYPE);
-		}
-	YY_BREAK
-case 108:
-YY_RULE_SETUP
-#line 253 "lex.l"
-{
-			yylval.y_int = PIX_RLEA;
-			return(FILETYPE);
-		}
-	YY_BREAK
-case 109:
-YY_RULE_SETUP
-#line 258 "lex.l"
-{
-			if ((yylval.y_sym = lookup(yytext)) != (symbol *)NULL)
-				return(OBJECT_TYPE);
-			else {
-				yylval.y_str = (char *)smalloc(strlen(yytext) + 1);
-				strcpy(yylval.y_str, yytext);
-
-				return(NAME);
-			}
-		}
-	YY_BREAK
-case 110:
-YY_RULE_SETUP
-#line 269 "lex.l"
-{
-			yylval.y_int = atoi(yytext);
-			return(INTEGER);
-		}
-	YY_BREAK
-case 111:
-YY_RULE_SETUP
-#line 274 "lex.l"
-{
-			yylval.y_flt = atof(yytext);
-			return(FLOAT);
-		}
-	YY_BREAK
-case 112:
-YY_RULE_SETUP
-#line 279 "lex.l"
-{
-			yylval.y_flt = atof(yytext);
-			return(FLOAT);
-		}
-	YY_BREAK
-case 113:
-YY_RULE_SETUP
-#line 284 "lex.l"
-return(PLUS);
-	YY_BREAK
-case 114:
-YY_RULE_SETUP
-#line 286 "lex.l"
-return(MINUS);
-	YY_BREAK
-case 115:
-YY_RULE_SETUP
-#line 288 "lex.l"
-return(DIV);
-	YY_BREAK
-case 116:
-YY_RULE_SETUP
-#line 290 "lex.l"
-return(MULT);
-	YY_BREAK
-case 117:
-YY_RULE_SETUP
-#line 292 "lex.l"
-return(PCENT);
-	YY_BREAK
-case 118:
-YY_RULE_SETUP
-#line 294 "lex.l"
-return(POWER);
-	YY_BREAK
-case 119:
-YY_RULE_SETUP
-#line 296 "lex.l"
-return(COMMA);
-	YY_BREAK
-case 120:
-YY_RULE_SETUP
-#line 298 "lex.l"
-return(LP);
-	YY_BREAK
-case 121:
-YY_RULE_SETUP
-#line 300 "lex.l"
-return(RP);
-	YY_BREAK
-case 122:
-YY_RULE_SETUP
-#line 302 "lex.l"
-return(EQUALS);
-	YY_BREAK
-case 123:
-YY_RULE_SETUP
-#line 304 "lex.l"
-return(DOLS);
-	YY_BREAK
-case 124:
-YY_RULE_SETUP
-#line 306 "lex.l"
-{
-			char	buf[BUFSIZ], *p;
-			
-			for (p = buf; (*p = input()) != '"'; p++)
-				if (*p == '\n' || *p == EOF)
-					yyerror("syntax error");
-
-			*p = 0;
-
-			yylval.y_str = (char *)smalloc(strlen(buf) + 1);
-			strcpy(yylval.y_str, buf);
-
-			return(NAME);
-		}
-	YY_BREAK
-case 125:
-YY_RULE_SETUP
-#line 321 "lex.l"
-{
-			return(LBRACE);
-		}
-	YY_BREAK
-case 126:
-YY_RULE_SETUP
-#line 325 "lex.l"
-{
-			return(RBRACE);
-		}
-	YY_BREAK
-case 127:
-YY_RULE_SETUP
-#line 329 "lex.l"
-return(QUOTE);
-	YY_BREAK
-case 128:
-YY_RULE_SETUP
-#line 331 "lex.l"
-{
-			linecount++;
-		}
-	YY_BREAK
-case 129:
-YY_RULE_SETUP
-#line 335 "lex.l"
-{
-			;
-		}
-	YY_BREAK
-case 130:
-YY_RULE_SETUP
-#line 339 "lex.l"
-{
-			int	c, i, j;
-			char	buf[BUFSIZ], *p;
-
-			i = 0;
-			while ((c = input()) >= 0 && c != '\n')
-				buf[i++] = (char)c;
-			buf[i] = 0;
-
-			if (sscanf(buf, "%d", &linecount) != 1)
-				linecount++;
-			else {
-				for (p = buf; p != &buf[i]; p++)
-					if (*p == '"')
-						break;
-
-				if (p == &buf[i])
-					linecount++;
-				else {
-					j = 0;
-					p++;
-					while (*p != '"' && p != &buf[i])
-						currentfile[j++] = *p++;
-					currentfile[j] = 0;
-				}
-			}
-		}
-	YY_BREAK
-case 131:
-YY_RULE_SETUP
-#line 367 "lex.l"
-{
-			int	c1, c2;
-			int	comline, incomment = 1;
-			char	buf[BUFSIZ];
-
-			comline = linecount;
-
-			do {
-				while ((c1 = input()) != '*' && c1 != '/' && c1 != EOF)
-					if (c1 == '\n')
-						linecount++;
-
-				c2 = input();
-				if (c2 == '\n')
-					linecount++;
-
-				if (c1 == '*' && c2 == '/')
-					incomment--;
-
-				if (c1 == '/' && c2 == '*') {
-					incomment++;
-					comline = linecount;
-				}
-
-			} while (incomment && c2 != EOF);
-
-			if (c1 == EOF || c2 == EOF) {
-				sprintf(buf, "art: unterminated comment - started line %d.\n", comline);
-				fatal(buf);
-			}
-		}
-	YY_BREAK
-case 132:
-YY_RULE_SETUP
-#line 398 "lex.l"
-ECHO;
-	YY_BREAK
-case YY_STATE_EOF(INITIAL):
-	yyterminate();
-
-	case YY_END_OF_BUFFER:
-		{
-		/* Amount of text matched not including the EOB char. */
-		int yy_amount_of_matched_text = (int) (yy_cp - yytext_ptr) - 1;
-
-		/* Undo the effects of YY_DO_BEFORE_ACTION. */
-		*yy_cp = yy_hold_char;
-		YY_RESTORE_YY_MORE_OFFSET
-
-		if ( yy_current_buffer->yy_buffer_status == YY_BUFFER_NEW )
-			{
-			/* We're scanning a new file or input source.  It's
-			 * possible that this happened because the user
-			 * just pointed yyin at a new source and called
-			 * yylex().  If so, then we have to assure
-			 * consistency between yy_current_buffer and our
-			 * globals.  Here is the right place to do so, because
-			 * this is the first action (other than possibly a
-			 * back-up) that will match for the new input source.
-			 */
-			yy_n_chars = yy_current_buffer->yy_n_chars;
-			yy_current_buffer->yy_input_file = yyin;
-			yy_current_buffer->yy_buffer_status = YY_BUFFER_NORMAL;
-			}
-
-		/* Note that here we test for yy_c_buf_p "<=" to the position
-		 * of the first EOB in the buffer, since yy_c_buf_p will
-		 * already have been incremented past the NUL character
-		 * (since all states make transitions on EOB to the
-		 * end-of-buffer state).  Contrast this with the test
-		 * in input().
-		 */
-		if ( yy_c_buf_p <= &yy_current_buffer->yy_ch_buf[yy_n_chars] )
-			{ /* This was really a NUL. */
-			yy_state_type yy_next_state;
-
-			yy_c_buf_p = yytext_ptr + yy_amount_of_matched_text;
-
-			yy_current_state = yy_get_previous_state();
-
-			/* Okay, we're now positioned to make the NUL
-			 * transition.  We couldn't have
-			 * yy_get_previous_state() go ahead and do it
-			 * for us because it doesn't know how to deal
-			 * with the possibility of jamming (and we don't
-			 * want to build jamming into it because then it
-			 * will run more slowly).
-			 */
-
-			yy_next_state = yy_try_NUL_trans( yy_current_state );
-
-			yy_bp = yytext_ptr + YY_MORE_ADJ;
-
-			if ( yy_next_state )
-				{
-				/* Consume the NUL. */
-				yy_cp = ++yy_c_buf_p;
-				yy_current_state = yy_next_state;
-				goto yy_match;
-				}
-
-			else
-				{
-				yy_cp = yy_c_buf_p;
-				goto yy_find_action;
-				}
-			}
-
-		else switch ( yy_get_next_buffer() )
-			{
-			case EOB_ACT_END_OF_FILE:
-				{
-				yy_did_buffer_switch_on_eof = 0;
-
-				if ( yywrap() )
-					{
-					/* Note: because we've taken care in
-					 * yy_get_next_buffer() to have set up
-					 * yytext, we can now set up
-					 * yy_c_buf_p so that if some total
-					 * hoser (like flex itself) wants to
-					 * call the scanner after we return the
-					 * YY_NULL, it'll still work - another
-					 * YY_NULL will get returned.
-					 */
-					yy_c_buf_p = yytext_ptr + YY_MORE_ADJ;
-
-					yy_act = YY_STATE_EOF(YY_START);
-					goto do_action;
-					}
-
-				else
-					{
-					if ( ! yy_did_buffer_switch_on_eof )
-						YY_NEW_FILE;
-					}
-				break;
-				}
-
-			case EOB_ACT_CONTINUE_SCAN:
-				yy_c_buf_p =
-					yytext_ptr + yy_amount_of_matched_text;
-
-				yy_current_state = yy_get_previous_state();
-
-				yy_cp = yy_c_buf_p;
-				yy_bp = yytext_ptr + YY_MORE_ADJ;
-				goto yy_match;
-
-			case EOB_ACT_LAST_MATCH:
-				yy_c_buf_p =
-				&yy_current_buffer->yy_ch_buf[yy_n_chars];
-
-				yy_current_state = yy_get_previous_state();
-
-				yy_cp = yy_c_buf_p;
-				yy_bp = yytext_ptr + YY_MORE_ADJ;
-				goto yy_find_action;
-			}
-		break;
-		}
-
-	default:
-		YY_FATAL_ERROR(
-			"fatal flex scanner internal error--no action found" );
-	} /* end of action switch */
-		} /* end of scanning one token */
-	} /* end of yylex */
-
-
-/* yy_get_next_buffer - try to read in a new buffer
- *
- * Returns a code representing an action:
- *	EOB_ACT_LAST_MATCH -
- *	EOB_ACT_CONTINUE_SCAN - continue scanning from current position
- *	EOB_ACT_END_OF_FILE - end of file
- */
-
-static int yy_get_next_buffer()
-	{
-	register char *dest = yy_current_buffer->yy_ch_buf;
-	register char *source = yytext_ptr;
-	register int number_to_move, i;
-	int ret_val;
-
-	if ( yy_c_buf_p > &yy_current_buffer->yy_ch_buf[yy_n_chars + 1] )
-		YY_FATAL_ERROR(
-		"fatal flex scanner internal error--end of buffer missed" );
-
-	if ( yy_current_buffer->yy_fill_buffer == 0 )
-		{ /* Don't try to fill the buffer, so this is an EOF. */
-		if ( yy_c_buf_p - yytext_ptr - YY_MORE_ADJ == 1 )
-			{
-			/* We matched a single character, the EOB, so
-			 * treat this as a final EOF.
-			 */
-			return EOB_ACT_END_OF_FILE;
-			}
-
-		else
-			{
-			/* We matched some text prior to the EOB, first
-			 * process it.
-			 */
-			return EOB_ACT_LAST_MATCH;
-			}
-		}
-
-	/* Try to read more data. */
-
-	/* First move last chars to start of buffer. */
-	number_to_move = (int) (yy_c_buf_p - yytext_ptr) - 1;
-
-	for ( i = 0; i < number_to_move; ++i )
-		*(dest++) = *(source++);
-
-	if ( yy_current_buffer->yy_buffer_status == YY_BUFFER_EOF_PENDING )
-		/* don't do the read, it's not guaranteed to return an EOF,
-		 * just force an EOF
-		 */
-		yy_current_buffer->yy_n_chars = yy_n_chars = 0;
-
-	else
-		{
-		int num_to_read =
-			yy_current_buffer->yy_buf_size - number_to_move - 1;
-
-		while ( num_to_read <= 0 )
-			{ /* Not enough room in the buffer - grow it. */
-#ifdef YY_USES_REJECT
-			YY_FATAL_ERROR(
-"input buffer overflow, can't enlarge buffer because scanner uses REJECT" );
-#else
-
-			/* just a shorter name for the current buffer */
-			YY_BUFFER_STATE b = yy_current_buffer;
-
-			int yy_c_buf_p_offset =
-				(int) (yy_c_buf_p - b->yy_ch_buf);
-
-			if ( b->yy_is_our_buffer )
-				{
-				int new_size = b->yy_buf_size * 2;
-
-				if ( new_size <= 0 )
-					b->yy_buf_size += b->yy_buf_size / 8;
-				else
-					b->yy_buf_size *= 2;
-
-				b->yy_ch_buf = (char *)
-					/* Include room in for 2 EOB chars. */
-					yy_flex_realloc( (void *) b->yy_ch_buf,
-							 b->yy_buf_size + 2 );
-				}
-			else
-				/* Can't grow it, we don't own it. */
-				b->yy_ch_buf = 0;
-
-			if ( ! b->yy_ch_buf )
-				YY_FATAL_ERROR(
-				"fatal error - scanner input buffer overflow" );
-
-			yy_c_buf_p = &b->yy_ch_buf[yy_c_buf_p_offset];
-
-			num_to_read = yy_current_buffer->yy_buf_size -
-						number_to_move - 1;
-#endif
-			}
-
-		if ( num_to_read > YY_READ_BUF_SIZE )
-			num_to_read = YY_READ_BUF_SIZE;
-
-		/* Read in more data. */
-		YY_INPUT( (&yy_current_buffer->yy_ch_buf[number_to_move]),
-			yy_n_chars, num_to_read );
-
-		yy_current_buffer->yy_n_chars = yy_n_chars;
-		}
-
-	if ( yy_n_chars == 0 )
-		{
-		if ( number_to_move == YY_MORE_ADJ )
-			{
-			ret_val = EOB_ACT_END_OF_FILE;
-			yyrestart( yyin );
-			}
-
-		else
-			{
-			ret_val = EOB_ACT_LAST_MATCH;
-			yy_current_buffer->yy_buffer_status =
-				YY_BUFFER_EOF_PENDING;
-			}
-		}
-
-	else
-		ret_val = EOB_ACT_CONTINUE_SCAN;
-
-	yy_n_chars += number_to_move;
-	yy_current_buffer->yy_ch_buf[yy_n_chars] = YY_END_OF_BUFFER_CHAR;
-	yy_current_buffer->yy_ch_buf[yy_n_chars + 1] = YY_END_OF_BUFFER_CHAR;
-
-	yytext_ptr = &yy_current_buffer->yy_ch_buf[0];
-
-	return ret_val;
-	}
-
-
-/* yy_get_previous_state - get the state just before the EOB char was reached */
-
-static yy_state_type yy_get_previous_state()
-	{
-	register yy_state_type yy_current_state;
-	register char *yy_cp;
-
-	yy_current_state = yy_start;
-
-	for ( yy_cp = yytext_ptr + YY_MORE_ADJ; yy_cp < yy_c_buf_p; ++yy_cp )
-		{
-		register YY_CHAR yy_c = (*yy_cp ? yy_ec[YY_SC_TO_UI(*yy_cp)] : 1);
-		if ( yy_accept[yy_current_state] )
-			{
-			yy_last_accepting_state = yy_current_state;
-			yy_last_accepting_cpos = yy_cp;
-			}
-		while ( yy_chk[yy_base[yy_current_state] + yy_c] != yy_current_state )
-			{
-			yy_current_state = (int) yy_def[yy_current_state];
-			if ( yy_current_state >= 688 )
-				yy_c = yy_meta[(unsigned int) yy_c];
-			}
-		yy_current_state = yy_nxt[yy_base[yy_current_state] + (unsigned int) yy_c];
-		}
-
-	return yy_current_state;
-	}
-
-
-/* yy_try_NUL_trans - try to make a transition on the NUL character
- *
- * synopsis
- *	next_state = yy_try_NUL_trans( current_state );
- */
-
-#ifdef YY_USE_PROTOS
-static yy_state_type yy_try_NUL_trans( yy_state_type yy_current_state )
-#else
-static yy_state_type yy_try_NUL_trans( yy_current_state )
-yy_state_type yy_current_state;
-#endif
-	{
-	register int yy_is_jam;
-	register char *yy_cp = yy_c_buf_p;
-
-	register YY_CHAR yy_c = 1;
-	if ( yy_accept[yy_current_state] )
-		{
-		yy_last_accepting_state = yy_current_state;
-		yy_last_accepting_cpos = yy_cp;
-		}
-	while ( yy_chk[yy_base[yy_current_state] + yy_c] != yy_current_state )
-		{
-		yy_current_state = (int) yy_def[yy_current_state];
-		if ( yy_current_state >= 688 )
-			yy_c = yy_meta[(unsigned int) yy_c];
-		}
-	yy_current_state = yy_nxt[yy_base[yy_current_state] + (unsigned int) yy_c];
-	yy_is_jam = (yy_current_state == 687);
-
-	return yy_is_jam ? 0 : yy_current_state;
-	}
-
-
-#ifndef YY_NO_UNPUT
-#ifdef YY_USE_PROTOS
-static void yyunput( int c, register char *yy_bp )
-#else
-static void yyunput( c, yy_bp )
-int c;
-register char *yy_bp;
-#endif
-	{
-	register char *yy_cp = yy_c_buf_p;
-
-	/* undo effects of setting up yytext */
-	*yy_cp = yy_hold_char;
-
-	if ( yy_cp < yy_current_buffer->yy_ch_buf + 2 )
-		{ /* need to shift things up to make room */
-		/* +2 for EOB chars. */
-		register int number_to_move = yy_n_chars + 2;
-		register char *dest = &yy_current_buffer->yy_ch_buf[
-					yy_current_buffer->yy_buf_size + 2];
-		register char *source =
-				&yy_current_buffer->yy_ch_buf[number_to_move];
-
-		while ( source > yy_current_buffer->yy_ch_buf )
-			*--dest = *--source;
-
-		yy_cp += (int) (dest - source);
-		yy_bp += (int) (dest - source);
-		yy_current_buffer->yy_n_chars =
-			yy_n_chars = yy_current_buffer->yy_buf_size;
-
-		if ( yy_cp < yy_current_buffer->yy_ch_buf + 2 )
-			YY_FATAL_ERROR( "flex scanner push-back overflow" );
-		}
-
-	*--yy_cp = (char) c;
-
-
-	yytext_ptr = yy_bp;
-	yy_hold_char = *yy_cp;
-	yy_c_buf_p = yy_cp;
-	}
-#endif	/* ifndef YY_NO_UNPUT */
-
-
-#ifdef __cplusplus
-static int yyinput()
-#else
-static int input()
-#endif
-	{
-	int c;
-
-	*yy_c_buf_p = yy_hold_char;
-
-	if ( *yy_c_buf_p == YY_END_OF_BUFFER_CHAR )
-		{
-		/* yy_c_buf_p now points to the character we want to return.
-		 * If this occurs *before* the EOB characters, then it's a
-		 * valid NUL; if not, then we've hit the end of the buffer.
-		 */
-		if ( yy_c_buf_p < &yy_current_buffer->yy_ch_buf[yy_n_chars] )
-			/* This was really a NUL. */
-			*yy_c_buf_p = '\0';
-
-		else
-			{ /* need more input */
-			int offset = yy_c_buf_p - yytext_ptr;
-			++yy_c_buf_p;
-
-			switch ( yy_get_next_buffer() )
-				{
-				case EOB_ACT_LAST_MATCH:
-					/* This happens because yy_g_n_b()
-					 * sees that we've accumulated a
-					 * token and flags that we need to
-					 * try matching the token before
-					 * proceeding.  But for input(),
-					 * there's no matching to consider.
-					 * So convert the EOB_ACT_LAST_MATCH
-					 * to EOB_ACT_END_OF_FILE.
-					 */
-
-					/* Reset buffer status. */
-					yyrestart( yyin );
-
-					/* fall through */
-
-				case EOB_ACT_END_OF_FILE:
-					{
-					if ( yywrap() )
-						return EOF;
-
-					if ( ! yy_did_buffer_switch_on_eof )
-						YY_NEW_FILE;
-#ifdef __cplusplus
-					return yyinput();
-#else
-					return input();
-#endif
-					}
-
-				case EOB_ACT_CONTINUE_SCAN:
-					yy_c_buf_p = yytext_ptr + offset;
-					break;
-				}
-			}
-		}
-
-	c = *(unsigned char *) yy_c_buf_p;	/* cast for 8-bit char's */
-	*yy_c_buf_p = '\0';	/* preserve yytext */
-	yy_hold_char = *++yy_c_buf_p;
-
-
-	return c;
-	}
-
-
-#ifdef YY_USE_PROTOS
-void yyrestart( FILE *input_file )
-#else
-void yyrestart( input_file )
-FILE *input_file;
-#endif
-	{
-	if ( ! yy_current_buffer )
-		yy_current_buffer = yy_create_buffer( yyin, YY_BUF_SIZE );
-
-	yy_init_buffer( yy_current_buffer, input_file );
-	yy_load_buffer_state();
-	}
-
-
-#ifdef YY_USE_PROTOS
-void yy_switch_to_buffer( YY_BUFFER_STATE new_buffer )
-#else
-void yy_switch_to_buffer( new_buffer )
-YY_BUFFER_STATE new_buffer;
-#endif
-	{
-	if ( yy_current_buffer == new_buffer )
-		return;
-
-	if ( yy_current_buffer )
-		{
-		/* Flush out information for old buffer. */
-		*yy_c_buf_p = yy_hold_char;
-		yy_current_buffer->yy_buf_pos = yy_c_buf_p;
-		yy_current_buffer->yy_n_chars = yy_n_chars;
-		}
-
-	yy_current_buffer = new_buffer;
-	yy_load_buffer_state();
-
-	/* We don't actually know whether we did this switch during
-	 * EOF (yywrap()) processing, but the only time this flag
-	 * is looked at is after yywrap() is called, so it's safe
-	 * to go ahead and always set it.
-	 */
-	yy_did_buffer_switch_on_eof = 1;
-	}
-
-
-#ifdef YY_USE_PROTOS
-void yy_load_buffer_state( void )
-#else
-void yy_load_buffer_state()
-#endif
-	{
-	yy_n_chars = yy_current_buffer->yy_n_chars;
-	yytext_ptr = yy_c_buf_p = yy_current_buffer->yy_buf_pos;
-	yyin = yy_current_buffer->yy_input_file;
-	yy_hold_char = *yy_c_buf_p;
-	}
-
-
-#ifdef YY_USE_PROTOS
-YY_BUFFER_STATE yy_create_buffer( FILE *file, int size )
-#else
-YY_BUFFER_STATE yy_create_buffer( file, size )
-FILE *file;
-int size;
-#endif
-	{
-	YY_BUFFER_STATE b;
-
-	b = (YY_BUFFER_STATE) yy_flex_alloc( sizeof( struct yy_buffer_state ) );
-	if ( ! b )
-		YY_FATAL_ERROR( "out of dynamic memory in yy_create_buffer()" );
-
-	b->yy_buf_size = size;
-
-	/* yy_ch_buf has to be 2 characters longer than the size given because
-	 * we need to put in 2 end-of-buffer characters.
-	 */
-	b->yy_ch_buf = (char *) yy_flex_alloc( b->yy_buf_size + 2 );
-	if ( ! b->yy_ch_buf )
-		YY_FATAL_ERROR( "out of dynamic memory in yy_create_buffer()" );
-
-	b->yy_is_our_buffer = 1;
-
-	yy_init_buffer( b, file );
-
-	return b;
-	}
-
-
-#ifdef YY_USE_PROTOS
-void yy_delete_buffer( YY_BUFFER_STATE b )
-#else
-void yy_delete_buffer( b )
-YY_BUFFER_STATE b;
-#endif
-	{
-	if ( ! b )
-		return;
-
-	if ( b == yy_current_buffer )
-		yy_current_buffer = (YY_BUFFER_STATE) 0;
-
-	if ( b->yy_is_our_buffer )
-		yy_flex_free( (void *) b->yy_ch_buf );
-
-	yy_flex_free( (void *) b );
-	}
-
-
-#ifndef YY_ALWAYS_INTERACTIVE
-#ifndef YY_NEVER_INTERACTIVE
-extern int isatty YY_PROTO(( int ));
-#endif
-#endif
-
-#ifdef YY_USE_PROTOS
-void yy_init_buffer( YY_BUFFER_STATE b, FILE *file )
-#else
-void yy_init_buffer( b, file )
-YY_BUFFER_STATE b;
-FILE *file;
-#endif
-
-
-	{
-	yy_flush_buffer( b );
-
-	b->yy_input_file = file;
-	b->yy_fill_buffer = 1;
-
-#if YY_ALWAYS_INTERACTIVE
-	b->yy_is_interactive = 1;
-#else
-#if YY_NEVER_INTERACTIVE
-	b->yy_is_interactive = 0;
-#else
-	b->yy_is_interactive = file ? (isatty( fileno(file) ) > 0) : 0;
-#endif
-#endif
-	}
-
-
-#ifdef YY_USE_PROTOS
-void yy_flush_buffer( YY_BUFFER_STATE b )
-#else
-void yy_flush_buffer( b )
-YY_BUFFER_STATE b;
-#endif
-
-	{
-	if ( ! b )
-		return;
-
-	b->yy_n_chars = 0;
-
-	/* We always need two end-of-buffer characters.  The first causes
-	 * a transition to the end-of-buffer state.  The second causes
-	 * a jam in that state.
-	 */
-	b->yy_ch_buf[0] = YY_END_OF_BUFFER_CHAR;
-	b->yy_ch_buf[1] = YY_END_OF_BUFFER_CHAR;
-
-	b->yy_buf_pos = &b->yy_ch_buf[0];
-
-	b->yy_at_bol = 1;
-	b->yy_buffer_status = YY_BUFFER_NEW;
-
-	if ( b == yy_current_buffer )
-		yy_load_buffer_state();
-	}
-
-
-#ifndef YY_NO_SCAN_BUFFER
-#ifdef YY_USE_PROTOS
-YY_BUFFER_STATE yy_scan_buffer( char *base, yy_size_t size )
-#else
-YY_BUFFER_STATE yy_scan_buffer( base, size )
-char *base;
-yy_size_t size;
-#endif
-	{
-	YY_BUFFER_STATE b;
-
-	if ( size < 2 ||
-	     base[size-2] != YY_END_OF_BUFFER_CHAR ||
-	     base[size-1] != YY_END_OF_BUFFER_CHAR )
-		/* They forgot to leave room for the EOB's. */
-		return 0;
-
-	b = (YY_BUFFER_STATE) yy_flex_alloc( sizeof( struct yy_buffer_state ) );
-	if ( ! b )
-		YY_FATAL_ERROR( "out of dynamic memory in yy_scan_buffer()" );
-
-	b->yy_buf_size = size - 2;	/* "- 2" to take care of EOB's */
-	b->yy_buf_pos = b->yy_ch_buf = base;
-	b->yy_is_our_buffer = 0;
-	b->yy_input_file = 0;
-	b->yy_n_chars = b->yy_buf_size;
-	b->yy_is_interactive = 0;
-	b->yy_at_bol = 1;
-	b->yy_fill_buffer = 0;
-	b->yy_buffer_status = YY_BUFFER_NEW;
-
-	yy_switch_to_buffer( b );
-
-	return b;
-	}
-#endif
-
-
-#ifndef YY_NO_SCAN_STRING
-#ifdef YY_USE_PROTOS
-YY_BUFFER_STATE yy_scan_string( yyconst char *yy_str )
-#else
-YY_BUFFER_STATE yy_scan_string( yy_str )
-yyconst char *yy_str;
-#endif
-	{
-	int len;
-	for ( len = 0; yy_str[len]; ++len )
-		;
-
-	return yy_scan_bytes( yy_str, len );
-	}
-#endif
-
-
-#ifndef YY_NO_SCAN_BYTES
-#ifdef YY_USE_PROTOS
-YY_BUFFER_STATE yy_scan_bytes( yyconst char *bytes, int len )
-#else
-YY_BUFFER_STATE yy_scan_bytes( bytes, len )
-yyconst char *bytes;
-int len;
-#endif
-	{
-	YY_BUFFER_STATE b;
-	char *buf;
-	yy_size_t n;
-	int i;
-
-	/* Get memory for full buffer, including space for trailing EOB's. */
-	n = len + 2;
-	buf = (char *) yy_flex_alloc( n );
-	if ( ! buf )
-		YY_FATAL_ERROR( "out of dynamic memory in yy_scan_bytes()" );
-
-	for ( i = 0; i < len; ++i )
-		buf[i] = bytes[i];
-
-	buf[len] = buf[len+1] = YY_END_OF_BUFFER_CHAR;
-
-	b = yy_scan_buffer( buf, n );
-	if ( ! b )
-		YY_FATAL_ERROR( "bad buffer in yy_scan_bytes()" );
-
-	/* It's okay to grow etc. this buffer, and we should throw it
-	 * away when we're done.
-	 */
-	b->yy_is_our_buffer = 1;
-
-	return b;
-	}
-#endif
-
-
-#ifndef YY_NO_PUSH_STATE
-#ifdef YY_USE_PROTOS
-static void yy_push_state( int new_state )
-#else
-static void yy_push_state( new_state )
-int new_state;
-#endif
-	{
-	if ( yy_start_stack_ptr >= yy_start_stack_depth )
-		{
-		yy_size_t new_size;
-
-		yy_start_stack_depth += YY_START_STACK_INCR;
-		new_size = yy_start_stack_depth * sizeof( int );
-
-		if ( ! yy_start_stack )
-			yy_start_stack = (int *) yy_flex_alloc( new_size );
-
-		else
-			yy_start_stack = (int *) yy_flex_realloc(
-					(void *) yy_start_stack, new_size );
-
-		if ( ! yy_start_stack )
-			YY_FATAL_ERROR(
-			"out of memory expanding start-condition stack" );
-		}
-
-	yy_start_stack[yy_start_stack_ptr++] = YY_START;
-
-	BEGIN(new_state);
-	}
-#endif
-
-
-#ifndef YY_NO_POP_STATE
-static void yy_pop_state()
-	{
-	if ( --yy_start_stack_ptr < 0 )
-		YY_FATAL_ERROR( "start-condition stack underflow" );
-
-	BEGIN(yy_start_stack[yy_start_stack_ptr]);
-	}
-#endif
-
-
-#ifndef YY_NO_TOP_STATE
-static int yy_top_state()
-	{
-	return yy_start_stack[yy_start_stack_ptr - 1];
-	}
-#endif
-
-#ifndef YY_EXIT_FAILURE
-#define YY_EXIT_FAILURE 2
-#endif
-
-#ifdef YY_USE_PROTOS
-static void yy_fatal_error( yyconst char msg[] )
-#else
-static void yy_fatal_error( msg )
-char msg[];
-#endif
-	{
-	(void) fprintf( stderr, "%s\n", msg );
-	exit( YY_EXIT_FAILURE );
-	}
-
-
-
-/* Redefine yyless() so it works in section 3 code. */
-
-#undef yyless
-#define yyless(n) \
-	do \
-		{ \
-		/* Undo effects of setting up yytext. */ \
-		yytext[yyleng] = yy_hold_char; \
-		yy_c_buf_p = yytext + n; \
-		yy_hold_char = *yy_c_buf_p; \
-		*yy_c_buf_p = '\0'; \
-		yyleng = n; \
-		} \
-	while ( 0 )
-
-
-/* Internal utility routines. */
-
-#ifndef yytext_ptr
-#ifdef YY_USE_PROTOS
-static void yy_flex_strncpy( char *s1, yyconst char *s2, int n )
-#else
-static void yy_flex_strncpy( s1, s2, n )
-char *s1;
-yyconst char *s2;
-int n;
-#endif
-	{
-	register int i;
-	for ( i = 0; i < n; ++i )
-		s1[i] = s2[i];
-	}
-#endif
-
-#ifdef YY_NEED_STRLEN
-#ifdef YY_USE_PROTOS
-static int yy_flex_strlen( yyconst char *s )
-#else
-static int yy_flex_strlen( s )
-yyconst char *s;
-#endif
-	{
-	register int n;
-	for ( n = 0; s[n]; ++n )
-		;
-
-	return n;
-	}
-#endif
-
-
-#ifdef YY_USE_PROTOS
-static void *yy_flex_alloc( yy_size_t size )
-#else
-static void *yy_flex_alloc( size )
-yy_size_t size;
-#endif
-	{
-	return (void *) malloc( size );
-	}
-
-#ifdef YY_USE_PROTOS
-static void *yy_flex_realloc( void *ptr, yy_size_t size )
-#else
-static void *yy_flex_realloc( ptr, size )
-void *ptr;
-yy_size_t size;
-#endif
-	{
-	/* The cast to (char *) in the following accommodates both
-	 * implementations that use char* generic pointers, and those
-	 * that use void* generic pointers.  It works with the latter
-	 * because both ANSI C and C++ allow castless assignment from
-	 * any pointer type to void*, and deal with argument conversions
-	 * as though doing an assignment.
-	 */
-	return (void *) realloc( (char *) ptr, size );
-	}
-
-#ifdef YY_USE_PROTOS
-static void yy_flex_free( void *ptr )
-#else
-static void yy_flex_free( ptr )
-void *ptr;
-#endif
-	{
-	free( ptr );
-	}
-
-#if YY_MAIN
-int main()
-	{
-	yylex();
-	return 0;
-	}
-#endif
-#line 398 "lex.l"
diff -Nrua vort-old/art/src/lex.l vort-new/art/src/lex.l
--- vort-old/art/src/lex.l	1999-10-13 08:14:23.000000000 -0400
+++ vort-new/art/src/lex.l	2006-11-18 16:58:16.000000000 -0500
@@ -1,4 +1,6 @@
 %{
+#include <stdlib.h>
+#include <string.h>
 #include <math.h>
 #include "art.h"
 #include "objs.h"
@@ -10,8 +12,6 @@
 
 extern symbol	*lookup();
 
-extern double	atof();
-
 %}
 
 %p 5000
diff -Nrua vort-old/art/src/main.c vort-new/art/src/main.c
--- vort-old/art/src/main.c	1999-10-12 18:24:14.000000000 -0400
+++ vort-new/art/src/main.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,56 +1,20 @@
 #include <stdio.h>
+#include <stdlib.h>
 #include <math.h>
-#ifdef PC
 #include <signal.h>
 #include <fcntl.h>
 #include <string.h>
-#define rindex strrchr
-#else
-#ifdef SYSV
-#include <fcntl.h>
-#else
-#ifdef VMS
-#include <types.h>
-#include <file.h>
-#else
+#include <errno.h>
 #include <sys/types.h>
 #include <sys/file.h>
-#endif
-#endif
-#endif
-#ifdef VMS
-#include <string.h>
-#define rindex strrchr
-#endif
-#ifdef MIPS
-#include <string.h>
-#define rindex strrchr
-#endif
-#ifdef PC
-#ifdef TC
-#include <time.h>
-#ifdef _STKLEN
-unsigned _stklen = _STKLEN;
-#else
-unsigned _stklen = 8192 * 2 * 2;
-#endif
-#else
-#include <sys/timeb.h>
-#endif
-#else
+#include <unistd.h>
 #include <sys/times.h>
-#endif
-#ifdef CRAY
-#include <string.h>
-#define rindex strrchr
-#endif
 
 #include "art.h"
 #include "objs.h"
 #include "macro.h"
 #include "gram.h"
 
-extern char	*rindex();
 extern hlist	*trace();
 extern void	shade();
 extern time_t	time();
@@ -79,12 +43,6 @@
 static struct tms       buffer;
 #endif
 
-#ifdef PC
-int	EMS_available = FALSE;
-void	ctrl_C(void);	/* CTRL-C trap processor */
-
-#endif
-
 extern int	chatty;
 
 /*
@@ -137,7 +95,7 @@
 	int	ac;
 	char	*av[];
 {
-	int		indx, standardin, preprocess, nameset;
+	int		indx, standardin, preprocess, nameset, tempfd;
 	char		*p, name[100], fname[100], buf[100];
 	FILE		*infile;
 	int		i, fragment, xsize, ysize, xstart, xend, ystart, yend;
@@ -147,9 +105,7 @@
 	char		hostname[65], pathname[513];
 #endif
 
-#ifndef VMS
 	logfile = stdout;
-#endif
 
 	if (ac < 4)
 		usage((char *)NULL);
@@ -159,11 +115,6 @@
 	start_time = buffer.tms_utime + buffer.tms_stime;
 #endif
 
-#ifdef PC
-	if (EMS_rdy()) EMS_available = TRUE;
-	signal(SIGINT, ctrl_C); 			/* trap user aborts */
-#endif
-
 	if (strcmp(av[1], "-v") == 0) {
 		indx = 2;
 		chatty = TRUE;
@@ -220,8 +171,10 @@
 		} else if (strcmp(av[i], "-o") == 0) {
 			if (av[i + 1] == (char *)NULL)
 				usage("art: -o requires name.\n");
-			defname = av[i + 1];
-			nameset = TRUE;
+			else {
+				defname = av[i + 1];
+				nameset = TRUE;
+			}
 			i += 1;
 		} else if (strcmp(av[i], "-n") == 0) {
 			preprocess = FALSE;
@@ -236,19 +189,15 @@
 		
 	if (standardin || nameset) {
 		strcpy(name, defname);
-
-		if ((p = rindex(name, '.')) == (char *)NULL)
-			fatal("art: output file should end with \".pix\".\n");
 	} else {
 		strcpy(name, av[indx]);
-
-		if ((p = rindex(name, '.')) == (char *)NULL)
-			fatal("art: input file should end with \".scn\".\n");
-		standardin = FALSE;
 	}
-
-	strcpy(p, ".log");
-
+	p = rindex(name, '.');
+	if (p == (char *)NULL) {
+                p = name + strlen(name);
+		strcat(name, ".log");
+	} else
+		strcpy(p, ".log");
 	if ((logfile = fopen(name, "w")) == NULL) {
 		sprintf(buf, "art: unable to open %s for writing.\n", name);
 		fatal(buf);
@@ -256,7 +205,7 @@
 
 #ifdef LOSINGTRACK
 	gethostname(hostname, 64);
-	getwd(pathname, 512);
+	getcwd(pathname, 512);
 	fprintf(logfile, "Host: %s	Directory: %s\n", hostname, pathname);
 	fflush(logfile);
 #endif
@@ -265,12 +214,13 @@
 		if (preprocess) {
 			strcpy(fname, name);
 			strcpy(rindex(fname, '.'), "XXXXXX");
-			mktemp(fname);
-
-			if ((infile = fopen(fname, "w")) == NULL) {
-				sprintf(buf, "art: unable to open temporary file %s.\n", name);
+			if ((tempfd = mkstemp(fname)) < 0) {
+				sprintf(buf, "art: unable to open temporary file %s.\n", fname);
 				fatal(buf);
-			}
+			} else if ((infile = fdopen(tempfd, "w")) == NULL) {
+				perror("art");
+				fatal("");
+                        }
 
 			prepro(av[indx], infile);
 
@@ -281,20 +231,14 @@
 		infile = stdin;
 
 	if (!standardin) {
-#ifdef PC
-		if ((infile = freopen(fname, "rt", stdin)) == NULL) {
-#else
 		if ((infile = freopen(fname, "r", stdin)) == NULL) {
-#endif
 			sprintf(buf, "art: unable to open file %s.\n", av[indx]);
 			fatal(buf);
 		}
 	}
 
-#ifndef PC
 	if (preprocess)
 		unlink(fname);
-#endif
 
 	if (preprocess)
 		tmpname = fname;
@@ -326,14 +270,6 @@
 
 	render(infile, im, xsize, ysize, xstart, xend, ystart, yend);
 
-#ifdef PC
-	if (preprocess)
-		unlink(fname);
-
-	/* deallocate storage used by tile patterns, esp. EMS */
-	uninit_tiles();
-#endif
-
 #ifdef TIME_STATS
 	printtime("Total time taken             :");
 #endif
@@ -436,19 +372,4 @@
 
 #endif
 
-#ifdef PC
-/****
- * Handle user abort requests.
- **/
-
-void 	ctrl_C()
-{
-	signal(SIGINT, SIG_IGN);	/* ignore any abort requests in this routine */
-	uninit_tiles();
-	exit(1);
-}
-#endif
-
-
-
 
diff -Nrua vort-old/art/src/Makefile vort-new/art/src/Makefile
--- vort-old/art/src/Makefile	1999-10-13 08:11:09.000000000 -0400
+++ vort-new/art/src/Makefile	2006-11-18 16:58:16.000000000 -0500
@@ -1,4 +1,3 @@
-LFLAGS = -n
 YFLAGS = -d
 MFLAGS = -DSTATS -DTIME_STATS -I../../lib -O
 CFLAGS = $(MFLAGS) -I../../lib 
@@ -10,7 +9,7 @@
 	expr.c symbol.c object.c tile.c bbox.c csg.c comp.c sphere.c box.c \
 	geom.c interp.c alg.c torus.c hfield.c polygon.c ellipse.c cone.c \
 	cylinder.c ring.c super.c smalloc.c util.c map.c mask.c texture.c \
-	grid.c patch.c blob.c noise.c twentyf.c repeat.c
+	grid.c patch.c blob.c noise.c twentyf.c repeat.c readall.c
 
 OBJS = gram.o main.o lex.o prepro.o render.o gensamp.o trraw.o trgrid.o \
 	tradapt.o message.o matrix.o solve.o rt.o stree.o shade.o light.o \
@@ -23,15 +22,18 @@
 	stree.o shade.o light.o expr.o symbol.o object.o tile.o bbox.o \
 	csg.o comp.o sphere.o box.o geom.o interp.o alg.o torus.o hfield.o \
 	polygon.o ellipse.o cone.o cylinder.o ring.o super.o mask.o smalloc.o \
-	grid.o patch.o blob.o util.o map.o texture.o noise.o twentyf.o repeat.o
+	grid.o patch.o blob.o util.o map.o texture.o noise.o twentyf.o repeat.o\
+        readall.o
+
+OBJS3 = dart.o readall.o
 
 all: art in.netartd nart in.artd dart
 
 art: $(OBJS) ../../lib/libvort.a
 	$(CC) $(CFLAGS) -o art $(OBJS) ../../lib/libvort.a -lm $(LEXLIB)
 
-dart: dart.o ../../lib/libvort.a
-	$(CC) $(CFLAGS) -o dart dart.o ../../lib/libvort.a -lm
+dart: dart.o readall.o ../../lib/libvort.a
+	$(CC) $(CFLAGS) -o dart dart.o readall.o ../../lib/libvort.a -lm
 
 in.netartd: in.netartd.o
 	$(CC) $(CFLAGS) -o in.netartd in.netartd.o
@@ -52,19 +54,24 @@
 	rm -f *.o core
 
 clobber:
-	rm -f art nart dart nartc in.netartd in.artd *.o core
+	rm -f art nart dart nartc in.netartd in.artd *.o core gram.h gram.c lex.c
+
+$(OBJS) : art.h gram.h macro.h ../../lib/vort.h
 
-$(OBJS)\
-: art.h gram.h macro.h ../../lib/vort.h
+$(OBJS3) : art.h readall.h
 
 alg.o solve.o torus.o : poly.h
 
+lex.o: lex.c gram.h
+
 gram.o: gram.c
 	$(CC) -c -O -I../../lib gram.c
 
 gram.c gram.h: gram.y
+	$(YACC) $(YFLAGS) -b $* $*.y
+	mv $*.tab.c $*.c
+	mv $*.tab.h $*.h
+
+.l.c:
+	$(LEX) $(LFLAGS) -t $*.l > $*.c
 
-.y.c:
-	$(YACC) -d $*.y
-	mv *.tab.c gram.c
-	if cmp -s *.tab.h $*.h; then rm *.tab.h; else mv *.tab.h $*.h; fi
diff -Nrua vort-old/art/src/makefile.msc vort-new/art/src/makefile.msc
--- vort-old/art/src/makefile.msc	1999-10-12 18:34:24.000000000 -0400
+++ vort-new/art/src/makefile.msc	1969-12-31 19:00:00.000000000 -0500
@@ -1,68 +0,0 @@
-CC = cl
-F = -FPi87
-YFLAGS = -d
-#CFLAGS = -AL -Ot -Gs -DPC -DMSC -I..\..\lib -c
-CFLAGS = -AL -G2s -Otp $(F) -DPC -DMSC -I..\..\lib -c
-#CFLAGS = -AL -Od -Zi -FPa -DPC -DMSC -I..\..\lib -c
-LFLAGS = /ST:16384 /CO /NOE
-O = .obj
-R = .exe
-A = .lib
-
-SRCS = main.c gram.c lex.c prepro.c message.c matrix.c solve.c \
-	gensamp.c render.c shade.c light.c tile.c bbox.c csg.c \
-	rt.c sphere.c box.c geom.c interp.c alg.c \
-	hfield.ctorus.c ellipse.c super.c smalloc.c \
-	texture.c noise.c twentyf.c util.c map.c mask.c ring.c \
-	cylinder.c cone.c comp.c object.c stree.c expr.c \
-	trraw.c trgrid.c tradapt.c symbol.c polygon.c repeat.c \
-	patch.c blob.c grid.c
-
-HOBJS = main$(O) gram$(O) lex$(O) prepro$(O) message$(O) matrix$(O) solve$(O)\
-	gensamp$(O) render$(O) shade$(O) light$(O) tile$(O) bbox$(O) csg$(O) \
-	rt$(O) sphere$(O) box$(O) geom$(O) interp$(O) alg$(O) \
-	hfield$(O) torus$(O) ellipse$(O) super$(O) smalloc$(O) \
-	texture$(O) noise$(O) twentyf$(O) util$(O) map$(O) mask$(O) ring$(O) \
-	cylinder$(O) cone$(O) comp$(O) object$(O) stree$(O) expr$(O) \
-	trraw$(O) trgrid$(O) tradapt$(O) symbol$(O) polygon$(O) repeat$(O) \
-	patch$(O) blob$(O) grid$(O)
-
-
-OBJS = $(HOBJS)
-
-LNK = $[d,$(TMP)]\lnk
-
-art: $(OBJS)
-	del $(LNK)
-	%(HOBJS) echo $(HOBJS)+ >> $(LNK)
-	echo $(TOBJS)+ >> $(LNK)
-	echo c:\c5.1\lib\binmode.obj >> $(LNK)
-	echo $* >> $(LNK)
-	echo $* >> $(LNK)
-	echo ..\..\lib\libvort$(A) >> $(LNK)
-	link $(LFLAGS) @$(LNK)
-
-lint: $(SRCS)
-	lint $(SRCS) -lm > art.lint
-
-$(OBJS)\
-: art.h gram.h macro.h
-
-main$(O) tile$(O) lex$(O)\
-: ../../lib/vort.h
-
-alg$(O) solve$(O) torus$(O)\
-: poly.h
-
-gram$(O): gram.c
-	$(CC) -AL -Gs -Od $(F) -DMSC -DPC -I..\..\lib -c gram.c
-
-.c.obj:
-	$(CC) $(CFLAGS) $*.c
-
-.asm.obj:
-	masm /Mx $*;
-
-
-.SUFFIXES : .exe .obj .c .asm
-
diff -Nrua vort-old/art/src/Makefile.rs6000 vort-new/art/src/Makefile.rs6000
--- vort-old/art/src/Makefile.rs6000	1999-10-12 18:35:05.000000000 -0400
+++ vort-new/art/src/Makefile.rs6000	1969-12-31 19:00:00.000000000 -0500
@@ -1,72 +0,0 @@
-LFLAGS = -n
-YFLAGS = -d
-MFLAGS = -DSTATS -DTIME_STATS -I../../lib -O4 /usr/lib/libm.il
-CFLAGS = $(MFLAGS) -I../../lib 
-
-
-SRCS = gram.c main.c lex.c prepro.c render.c gensamp.c trraw.c trgrid.c \
-	tradapt.c message.c matrix.c solve.c rt.c stree.c shade.c light.c \
-	expr.c symbol.c object.c tile.c bbox.c csg.c comp.c sphere.c box.c \
-	geom.c interp.c alg.c torus.c hfield.c polygon.c ellipse.c cone.c \
-	cylinder.c ring.c super.c smalloc.c util.c map.c mask.c texture.c \
-	grid.c blob.c patch.c noise.c twentyf.c repeat.c
-
-OBJS = gram.o main.o lex.o prepro.o render.o gensamp.o trraw.o trgrid.o \
-	tradapt.o message.o matrix.o solve.o rt.o stree.o shade.o light.o \
-	expr.o symbol.o object.o tile.o bbox.o csg.o comp.o sphere.o box.o \
-	geom.o interp.o alg.o torus.o hfield.o polygon.o ellipse.o cone.o \
-	cylinder.o ring.o super.o smalloc.o util.o map.o mask.o texture.o \
-	grid.o blob.o patch.o noise.o twentyf.o repeat.o
-
-OBJS2 = gram.o lex.o prepro.o gensamp.o message.o matrix.o solve.o rt.o \
-	stree.o shade.o light.o expr.o symbol.o object.o tile.o bbox.o \
-	csg.o comp.o sphere.o box.o geom.o interp.o alg.o torus.o hfield.o \
-	polygon.o ellipse.o cone.o cylinder.o ring.o super.o mask.o smalloc.o \
-	grid.o blob.o patch.o util.o map.o texture.o noise.o twentyf.o repeat.o
-
-all: art
-
-art: $(OBJS) ../../lib/libvort.a
-	cc $(CFLAGS) -o art $(OBJS) ../../lib/libvort.a -ll -lm 
-
-#
-# None of these work on an RS6000
-#
-dart: dart.o ../../lib/libvort.a
-	cc $(CFLAGS) -o dart dart.o ../../lib/libvort.a -ll -lm
-
-in.netartd: in.netartd.o
-	cc $(CFLAGS) -o in.netartd in.netartd.o
-
-in.artd: $(OBJS2) in.artd.o ../../lib/libvort.a
-	cc $(CFLAGS) -o in.artd in.artd.o $(OBJS2) ../../lib/libvort.a -ll -lm
-
-nartc: nartc.o
-	cc $(CFLAGS) -o nartc nartc.o
-
-nart: nart.o
-	cc $(CFLAGS) -o nart nart.o
-
-lint: $(SRCS)
-	lint -DNOSILLYNESS $(SRCS) -I../../lib -lm > art.lint
-
-clean:
-	rm -f *.o core
-
-clobber:
-	rm -f art nart dart nartc in.netartd in.artd *.o core
-
-$(OBJS)\
-: art.h gram.h macro.h ../../lib/vort.h
-
-alg.o solve.o torus.o : poly.h
-
-gram.o: gram.c
-	cc -c -O -I../../lib gram.c
-
-gram.c gram.h: gram.y
-
-.y.c:
-	yacc -d $*.y
-	mv y.tab.c gram.c
-	if cmp -s y.tab.h $*.h; then rm y.tab.h; else mv y.tab.h $*.h; fi
diff -Nrua vort-old/art/src/makefile.tc vort-new/art/src/makefile.tc
--- vort-old/art/src/makefile.tc	1999-10-12 18:34:24.000000000 -0400
+++ vort-new/art/src/makefile.tc	1969-12-31 19:00:00.000000000 -0500
@@ -1,41 +0,0 @@
-CC = bcc
-CFLAGS = -Z -G -ml -DPC -DTC -D_STKLEN=32000 -DNOSILLYNESS -I..\..\lib -w-rvl -w-rch -w-par
-
-SRCS = main.c gram.c lex.c prepro.c message.c matrix.c solve.c \
-	gensamp.c render.c shade.c light.c tile.c bbox.c csg.c \
-	rt.c sphere.c box.c geom.c interp.c alg.c \
-	hfield.ctorus.c ellipse.c super.c smalloc.c \
-	texture.c noise.c twentyf.c util.c map.c mask.c ring.c \
-	cylinder.c cone.c comp.c object.c stree.c expr.c \
-        trraw.c trgrid.c tradapt.c symbol.obj polygon.obj repeat.obj \
-        patch.c blob.c grid.c
-
-HOBJS = main.obj gram.obj lex.obj prepro.obj message.obj matrix.obj solve.obj\
-	gensamp.obj render.obj shade.obj light.obj tile.obj bbox.obj csg.obj \
-	rt.obj sphere.obj box.obj geom.obj interp.obj alg.obj \
-	hfield.obj torus.obj ellipse.obj super.obj smalloc.obj \
-	texture.obj noise.obj twentyf.obj util.obj map.obj mask.obj ring.obj \
-	cylinder.obj cone.obj comp.obj object.obj stree.obj expr.obj \
-        trraw.obj trgrid.obj tradapt.obj symbol.obj polygon.obj repeat.obj \
-        patch.obj blob.obj grid.obj
-
-
-OBJS = $(HOBJS)
-
-all: art.exe
-
-#
-# We had to use bccx here...
-gram.obj:	gram.c
-	bccx -c $(CFLAGS) $*.c
-
-.c.obj:
-	$(CC) -c $(CFLAGS) $*.c
-
-.asm.obj:
-	tasm -mx $*;
-
-art.exe: $(OBJS)
-	$(CC) $(CFLAGS) -eart.exe -ml @tlink.in
-
-
diff -Nrua vort-old/art/src/make.msc vort-new/art/src/make.msc
--- vort-old/art/src/make.msc	1999-10-12 18:34:24.000000000 -0400
+++ vort-new/art/src/make.msc	1969-12-31 19:00:00.000000000 -0500
@@ -1,122 +0,0 @@
-CC = cl
-F = -FPi87
-YFLAGS = -d
-CFLAGS = -AL -Gs -Otp $(F) -DPC -DMSC -I..\..\lib -c
-LFLAGS = /ST:16384 /NOE
-
-.c.obj:
-	$(CC) $(CFLAGS) $*.c
-
-LIBS = ..\..\lib\vort.lib
-
-OBJS = main.obj gram.obj lex.obj prepro.obj message.obj matrix.obj solve.obj\
-	gensamp.obj render.obj shade.obj light.obj tile.obj bbox.obj csg.obj \
-	rt.obj sphere.obj box.obj geom.obj interp.obj alg.obj \
-	hfield.obj torus.obj ellipse.obj super.obj smalloc.obj \
-	texture.obj noise.obj twentyf.obj util.obj map.obj mask.obj ring.obj \
-	cylinder.obj cone.obj comp.obj object.obj stree.obj expr.obj \
-	trraw.obj trgrid.obj tradapt.obj symbol.obj polygon.obj repeat.obj \
-	patch.obj blob.obj grid.obj
-
-main.obj: main.c
-
-gram.obj: gram.c
-	cl -AL -Gs -Od $(F) -DMSC -DPC -I..\..\lib -c gram.c
-
-lex.obj: lex.c
-	cl -AL -Gs -Od $(F) -DMSC -DPC -I..\..\lib -c lex.c
-
-object.obj: object.c
-	cl -AL -Gs -Od $(F) -DMSC -DPC -I..\..\lib -c object.c
-
-blob.obj: blob.c
-	cl -AL -Gs -Ot $(F) -DMSC -DPC -I..\..\lib -c blob.c
-
-hfield.obj: hfield.c
-	cl -AL -Gs -Ot $(F) -DMSC -DPC -I..\..\lib -c hfield.c
-
-prepro.obj: prepro.c
-
-patch.obj: patch.c
-
-grid.obj: grid.c
-
-message.obj: message.c
-
-matrix.obj: matrix.c
-
-solve.obj: solve.c
-
-shade.obj: shade.c
-
-light.obj: light.c
-
-tile.obj: tile.c
-
-bbox.obj: bbox.c
-
-csg.obj: csg.c
-
-sphere.obj: sphere.c
-
-render.obj: render.c
-
-gensamp.obj: gensamp.c
-
-box.obj: box.c
-
-geom.obj: geom.c
-
-interp.obj: interp.c
-
-alg.obj: alg.c
-
-torus.obj: torus.c
-
-ellipse.obj: ellipse.c
-
-super.obj: super.c
-
-smalloc.obj: smalloc.c
-
-texture.obj: texture.c
-
-noise.obj: noise.c
-
-twentyf.obj: twentyf.c
-
-util.obj: util.c
-
-mask.obj: mask.c
-
-map.obj: map.c
-
-ring.obj: ring.c
-
-cylinder.obj: cylinder.c
-
-cone.obj: cone.c
-
-comp.obj: comp.c
-
-stree.obj: stree.c
-
-expr.obj: expr.c
-
-symbol.obj: symbol.c
-
-polygon.obj: polygon.c
-
-repeat.obj: repeat.c
-
-trraw.obj: trraw.c
-
-trgrid.obj: trgrid.c
-
-tradapt.obj: tradapt.c
-
-rt.obj: rt.c
-
-art.exe: $(OBJS) $(LIBS)
-	link $(LFLAGS) @link.in, art,, $(LIBS);
-
diff -Nrua vort-old/art/src/matrix.c vort-new/art/src/matrix.c
--- vort-old/art/src/matrix.c	1993-07-20 23:57:08.000000000 -0400
+++ vort-new/art/src/matrix.c	2006-11-18 17:03:06.000000000 -0500
@@ -97,9 +97,9 @@
 	int	i, j, k, ind;
 	matrix	tmp;
 
-	mident4(a);
+	mident4((float *) a);
 
-	mcpy4(tmp, b);
+	mcpy4(tmp, (float *) b);
 
 	for (i = 0; i != 4; i++) {
 
diff -Nrua vort-old/art/src/message.c vort-new/art/src/message.c
--- vort-old/art/src/message.c	1993-07-20 23:10:38.000000000 -0400
+++ vort-new/art/src/message.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,4 +1,5 @@
 #include <stdio.h>
+#include <stdlib.h>
 #include "status.h"
 
 extern int	linecount;
@@ -20,9 +21,6 @@
 	if (tmpname != (char *)NULL)
 		unlink(tmpname);
 
-#ifdef PC
-	uninit_tiles();
-#endif
 	exit(ERROR);
 }
 
@@ -76,9 +74,6 @@
 	if (logfile != stdout)
 		fprintf(logfile, s);
 
-#ifdef PC
-	uninit_tiles();
-#endif
 	exit(ERROR);
 }
 
diff -Nrua vort-old/art/src/nart vort-new/art/src/nart
--- vort-old/art/src/nart	2001-10-08 08:09:28.000000000 -0400
+++ vort-new/art/src/nart	1969-12-31 19:00:00.000000000 -0500
@@ -1,24 +0,0 @@
-ELF              `4         4    (      4   44                                       :  :           <  <<<  X                                            /lib/ld-linux.so.2           GNU                                                                                                                                      	       
-                                                             }   "   i   =        7      >   u      v   *          1     Z   I      E         L   0     0   @*      ~   P   "      x     o   `         p     !   /      7   ;              a                            &              (    :                  D         *      S   0:         @=                        P        __gmon_start__ libc.so.6 strcpy printf connect fscanf memcpy perror system malloc socket select strrchr write ulimit fprintf __deregister_frame_info read getcwd gethostbyname getservbyname sprintf fclose stderr exit fopen atoi _IO_stdin_used __libc_start_main __register_frame_info close GLIBC_2.1 GLIBC_2.0                                               ii   !     ii   +        x  h  l  p  t  x  |      	  
-                                    US    [   x    tsyv S  V  [   5`%d    %hh    %lh   %ph   %th   %xh    %|h(   %h0   %h8   p%h@   `%hH   P%hP   @%hX   0%h`    %hh   %hp    %hx   %h   %h   %h   %h   %h   %h   %h   %h   p%h   `%h   P%h   @1^PTRhhlQVhHU=D u>@P@ @8 uPthH}D   UUth|hHUUEUffUjURP}v U  WVS}'t"th`5xwjMh   PYG  hhHh  uh5xjuh5xj`    d    h    l    Cds0R:Cf`Bfbj js }h5xSj)j`PVG}h jjhGVu1MQuBuBujhG    jhLV HPV HPSVP Uz HPVMQ HPRV Urf*Mqf, *PV+,PV ,P*PEphNWj/PV jh`VrVy}  t&     uUBxZtxZu
-       uMAxntxnt
-   hbhdH$u.hdh5xV jhhuh5xj    d   `    d    h    l    V4uVh   Cs0WCf`Bfbj jsLp
-*@     <
- ~&j`P4
-|v p4Ph$P$R  u$h5xQj'&    hbMqM$urEph5x    9$t4p    49uj1    0    9t>p0< ~9u    9w  pt& < *  0
-  ,P*PQh$P uV9  pjh`    4;C4;H; F;u  t{Mqh5x2    9t8p< ~49ujt& jhGp4 tjhL4t& jhG4B HP4m HPS4  HP4 HPR4 *P4,P4 ,P*PQh t/@< t#4hSiS`  PP@RPKj.4.pix@ 91    0         9 tOp0&    < ~    9u  t<j j j 0Pj jP& }h3    9   p0&    <3 ~f3tNj/PQt3p< ~/Dt9s  $R[^_USL=Lt;u[UUS    [4  [[                                     nart: usage nart [file.scn xpixels ypixels] | [ infile ] [-Z]
- tcp netartd localhost nart: can't find service
- nart: can't find localhost
- nart: can't create socket
-                           nart: can't connect to netart daemon.
- N -n Y scene %s - %d %d
- Q r /usr/local/lib/vort/hosts   nart: can't open hosts file %s
- %s  nart: can't find host %s
-   nart: can't connect to any hosts
- nart: can't open file %s
- %s %hd %hd  scene file %s - %d %d
- compress -f %s .pix whoops       X                        &6FVfv&6FV             l      (      
-   !                  \                              oTo   o         GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)  GCC: (GNU) 2.95.2 20000220 (Debian GNU/Linux)           01.01             01.01             01.01             01.01             01.01             01.01    .symtab .strtab .shstrtab .interp .note.ABI-tag .hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.got .rel.bss .rel.plt .init .plt .text .fini .rodata .data .eh_frame .ctors .dtors .got .dynamic .sbss .bss .comment .note                                                                          #                              1         ((                  7                         ?           5                 G   o     >                T   o   TT  0                c   	                       l   	                       u   	                       ~         ll  1                                                      ``                                                         @@                             <<                             HH                             LL                             TT                             \\  |                                                     xx                              xx                                  x                                   x                                
-                                  x        7         	              %                                                           (                                        T                         	          
-     l                    `                    @          <          H          L          T          \                    x          x                                                                                                                      "   @      &   T      4   D      @         V   H      i         t   |     ~                     H         L                                        P                  H         X         H                                                   }   "      =      1  7      B            I  u      [  *      n   1       I                l        0       @*        P   "     x     
-  `         %       `      -  x     9  H    >  p     [  <       f  /      x        ~  ;                                     &        x       \                    "   :      5        F  D     U   *      h  <      u  0:        @=                      P        gcc2_compiled. Letext crtstuff.c p.3 __DTOR_LIST__ completed.4 __do_global_dtors_aux __EH_FRAME_BEGIN__ fini_dummy object.11 frame_dummy init_dummy force_to_data __CTOR_LIST__ __do_global_ctors_aux __CTOR_END__ __DTOR_END__ __FRAME_END__ nart.c _DYNAMIC __register_frame_info@@GLIBC_2.0 write@@GLIBC_2.0 close@@GLIBC_2.0 _fp_hw perror@@GLIBC_2.0 fprintf@@GLIBC_2.0 getservbyname@@GLIBC_2.0 select@@GLIBC_2.0 system@@GLIBC_2.0 _init malloc@@GLIBC_2.0 fscanf@@GLIBC_2.0 __deregister_frame_info@@GLIBC_2.0 stderr@@GLIBC_2.0 _start sendshort ulimit@@GLIBC_2.0 __bss_start main __libc_start_main@@GLIBC_2.0 data_start printf@@GLIBC_2.0 _fini memcpy@@GLIBC_2.0 fclose@@GLIBC_2.1 strrchr@@GLIBC_2.0 gethostbyname@@GLIBC_2.0 exit@@GLIBC_2.0 atoi@@GLIBC_2.0 _edata _GLOBAL_OFFSET_TABLE_ _end getcwd@@GLIBC_2.0 connect@@GLIBC_2.0 fopen@@GLIBC_2.1 _IO_stdin_used sprintf@@GLIBC_2.0 __data_start socket@@GLIBC_2.0 read@@GLIBC_2.0 __gmon_start__ strcpy@@GLIBC_2.0 
\ No newline at end of file
diff -Nrua vort-old/art/src/nart.c vort-new/art/src/nart.c
--- vort-old/art/src/nart.c	1999-10-13 08:03:49.000000000 -0400
+++ vort-new/art/src/nart.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,3 +1,5 @@
+#include <stdlib.h>
+#include <string.h>
 #include <sys/types.h>
 #include <sys/time.h>
 #include <sys/socket.h>
@@ -48,11 +50,7 @@
 		exit(1);
 	}
 
-#ifdef SYSV
 	getcwd(path, sizeof(path) - 1);
-#else
-	getwd(path);
-#endif
 
 	if (ac == 4 || ac == 5) {
 		sp = getservbyname("netartd", "tcp");
diff -Nrua vort-old/art/src/patch.c vort-new/art/src/patch.c
--- vort-old/art/src/patch.c	1999-10-12 18:24:14.000000000 -0400
+++ vort-new/art/src/patch.c	2006-11-18 16:58:16.000000000 -0500
@@ -453,29 +453,12 @@
 {
 	int	w, h, indx;
 	tiletxt	*tp;
-#ifdef PC
-	unsigned int	page;
-	unsigned long	cp;
-#endif
+
 	tp = txt->u.t;
 
 	w = o->obj.pch->u * tp->scalew;
 	h = o->obj.pch->v * tp->scaleh;
 
-#ifdef PC
-	if (tp->EMS_h != EMS_NULL_HDL) {
-		page = ((w % tp->pixw + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) / EMS_PAGE_SIZE;
-		cp = ((w % tp->pixw + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) % EMS_PAGE_SIZE;
-		EMS_map(tp->EMS_h, page);
-
-		pcol->r = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->g = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->b = (unsigned char)*(EMS_base()+cp) / 255.0;
-		return;
-	}
-#endif
 	indx = (w % tp->pixw + (h % tp->pixh) * tp->pixw) * 3;
 
 	pcol->r = (unsigned char)tp->map[indx] / 255.0;
diff -Nrua vort-old/art/src/polygon.c vort-new/art/src/polygon.c
--- vort-old/art/src/polygon.c	1992-09-10 01:45:44.000000000 -0400
+++ vort-new/art/src/polygon.c	2006-11-18 16:58:16.000000000 -0500
@@ -273,10 +273,6 @@
 	vector		loc;
 	transdata	*td;
 	tiletxt		*tp;
-#ifdef PC
-	unsigned int	page;
-	unsigned long	cp;
-#endif
 
 	totexture(txt, loc, *l);
 
@@ -300,20 +296,6 @@
 	else
 		h = tp->pixh - 1 - (h % tp->pixh);
 
-#ifdef PC
-	if (tp->EMS_h != EMS_NULL_HDL) {
-		page = ((w + (unsigned long)h * tp->pixw) * 3L) / EMS_PAGE_SIZE;
-		cp = ((w + (unsigned long)h * tp->pixw) * 3L) % EMS_PAGE_SIZE;
-		EMS_map(tp->EMS_h, page);
-
-		pcol->r = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->g = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->b = (unsigned char)*(EMS_base()+cp) / 255.0;
-		return;
-	}
-#endif
 	indx = (w + h * tp->pixw) * 3;
 
 	pcol->r = (unsigned char)tp->map[indx] / 255.0;
diff -Nrua vort-old/art/src/prepro.c vort-new/art/src/prepro.c
--- vort-old/art/src/prepro.c	1992-05-25 22:34:25.000000000 -0400
+++ vort-new/art/src/prepro.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,33 +1,9 @@
 #include <stdio.h>
+#include <stdlib.h>
 #include <math.h>
-#ifdef VMS
-#include <types.h>
-#else
-#include <sys/types.h>
-#endif
-#ifdef PC
-#include <fcntl.h>
-#include <string.h>
-#define rindex strrchr
-#else
-#ifdef SYSV
 #include <fcntl.h>
-#else
-#ifdef VMS
-#include <file.h>
-#else
-#include <sys/file.h>
-#endif
-#endif
-#endif
-#ifdef VMS
 #include <string.h>
-#define rindex strrchr
-#endif
-#ifdef MIPS
-#include <string.h>
-#define rindex strrchr
-#endif
+#include <sys/types.h>
 
 extern char	*frameid;
 
@@ -45,11 +21,7 @@
 	int	c, lastc, incomment, linecount, i;
 	char	buf[BUFSIZ];
 
-#ifdef PC
-	if ((f1 = fopen(file1, "rt")) == NULL) {
-#else
 	if ((f1 = fopen(file1, "r")) == NULL) {
-#endif
 		sprintf(buf, "art: unable to open file %s.\n", file1);
 		fatal(buf);
 	}
diff -Nrua vort-old/art/src/readall.c vort-new/art/src/readall.c
--- vort-old/art/src/readall.c	1969-12-31 19:00:00.000000000 -0500
+++ vort-new/art/src/readall.c	2006-11-18 16:58:16.000000000 -0500
@@ -0,0 +1,19 @@
+#include <unistd.h>
+#include "readall.h"
+
+/*
+ * readall
+ *
+ * read exactly count characters from file descriptor fd.  if the return value
+ * is different from the requested size then an error is indicated; the exact
+ * error may be determined by checking errno.
+ */
+ssize_t readall (int fd, char *buf, size_t count) {
+    size_t n2r, nr = 0;
+    for (n2r = count; n2r > 0; n2r -= nr) {
+        if ( (nr = read(fd, buf, n2r)) < 0 ) break;
+        else buf += nr;
+    }
+    return count - n2r;
+}
+
diff -Nrua vort-old/art/src/readall.h vort-new/art/src/readall.h
--- vort-old/art/src/readall.h	1969-12-31 19:00:00.000000000 -0500
+++ vort-new/art/src/readall.h	2006-11-18 16:58:16.000000000 -0500
@@ -0,0 +1,7 @@
+
+#ifndef _READALL_H
+#define _READALL_H
+
+ssize_t readall (int fd, char *buf, size_t count);
+
+#endif
diff -Nrua vort-old/art/src/render.c vort-new/art/src/render.c
--- vort-old/art/src/render.c	1994-11-17 19:12:08.000000000 -0500
+++ vort-new/art/src/render.c	2006-11-18 16:58:16.000000000 -0500
@@ -7,6 +7,7 @@
  */
 
 #include <stdio.h>
+#include <string.h>
 #include <math.h>
 
 #include "art.h"
diff -Nrua vort-old/art/src/ring.c vort-new/art/src/ring.c
--- vort-old/art/src/ring.c	1992-09-10 01:45:45.000000000 -0400
+++ vort-new/art/src/ring.c	2006-11-18 16:58:16.000000000 -0500
@@ -97,10 +97,6 @@
 	float	u, v;
 	vector	loc;
 	tiletxt	*tp;
-#ifdef PC
-	unsigned int	page;
-	unsigned long	cp;
-#endif
 
 	totexture(txt, loc, *l);
 
@@ -125,20 +121,6 @@
 	w = v * tp->scalew;
 	h = u * tp->scaleh;
 
-#ifdef PC
-	if (tp->EMS_h != EMS_NULL_HDL) {
-		page = ((w % tp->pixw + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) / EMS_PAGE_SIZE;
-		cp = ((w % tp->pixw + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) % EMS_PAGE_SIZE;
-		EMS_map(tp->EMS_h, page);
-
-		pcol->r = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->g = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->b = (unsigned char)*(EMS_base()+cp) / 255.0;
-		return;
-	}
-#endif
 	indx = (w % tp->pixw + (h % tp->pixh) * tp->pixw) * 3;
 
 	pcol->r = (unsigned char)tp->map[indx] / 255.0;
diff -Nrua vort-old/art/src/rt.c vort-new/art/src/rt.c
--- vort-old/art/src/rt.c	1993-07-26 01:50:37.000000000 -0400
+++ vort-new/art/src/rt.c	2006-11-18 16:58:16.000000000 -0500
@@ -12,8 +12,6 @@
 extern pixel	backcol;
 extern colour	ambient;
 
-extern double	power();
-
 extern hlist	*(*intersects[NUM_OBJS])();
 
 /*
@@ -33,7 +31,6 @@
 	prevhits = (hlist *)NULL;
 
 	for (o = oblist; o != (object *)NULL; o = o->nxt) {
-		breathe();
 		if ((hit = intersects[o->type](r, o, &end)) != (hlist *)NULL) {
 			if (prevhits == (hlist *)NULL)
 				prevhits = hit;
diff -Nrua vort-old/art/src/shade.c vort-new/art/src/shade.c
--- vort-old/art/src/shade.c	1999-10-18 06:16:32.000000000 -0400
+++ vort-new/art/src/shade.c	2006-11-18 16:58:16.000000000 -0500
@@ -59,8 +59,6 @@
 	float	fact, t, peturb, lastt;
 	colour	base;
 
-	breathe();
-
 	if (l->shadows) {
 		lr->raynumber = raynumber++;
 		lr->type = SHADOW_RAY;
@@ -324,8 +322,6 @@
 	colour		dif, spec;
 	register float	fact, ksfact, kdfact, ndoti, lensvsqu;
 
-	breathe();
-
 	ir.dir = i->dir;
 	smult(ir.dir, hit->t);
 	vadd(ir.org, i->org, ir.dir);
diff -Nrua vort-old/art/src/smalloc.c vort-new/art/src/smalloc.c
--- vort-old/art/src/smalloc.c	1992-05-25 22:34:25.000000000 -0400
+++ vort-new/art/src/smalloc.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,6 +1,5 @@
 #include <stdio.h>
-
-extern char	*malloc();
+#include <stdlib.h>
 
 /*
  * smalloc
@@ -59,12 +58,6 @@
 {
 	char	*p, *p2, buf[BUFSIZ];
 
-#ifdef PC
-	if ((long)size * (long)n > 65535L) {
-		sprintf(buf, "scalloc: request for %ld bytes from malloc is too big (> 64K).\n", (long)size * (long)n);
-		fatal(buf);
-		}
-#endif
 
 	if ((p = malloc((unsigned) size * n)) == (char *)NULL) {
 		sprintf(buf, "scalloc: request for %ld bytes from malloc returns NULL.\n", (long)size * (long)n);
diff -Nrua vort-old/art/src/sphere.c vort-new/art/src/sphere.c
--- vort-old/art/src/sphere.c	1999-10-12 18:24:14.000000000 -0400
+++ vort-new/art/src/sphere.c	2006-11-18 16:58:16.000000000 -0500
@@ -94,10 +94,6 @@
 	float	u, v;
 	int	w, h, indx;
 	tiletxt	*tp;
-#ifdef PC
-	unsigned int	page;
-	unsigned long	cp;
-#endif
 
 	totexture(txt, loc, *l);
 
@@ -112,20 +108,6 @@
 	w = u * tp->scalew;
 	h = v * tp->scaleh;
 
-#ifdef PC
-	if (tp->EMS_h != EMS_NULL_HDL) {
-		page = ((w % tp->pixw + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) / EMS_PAGE_SIZE;
-		cp = ((w % tp->pixw + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) % EMS_PAGE_SIZE;
-		EMS_map(tp->EMS_h, page);
-
-		pcol->r = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->g = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->b = (unsigned char)*(EMS_base()+cp) / 255.0;
-		return;
-	}
-#endif
 	indx = (w % tp->pixw + (h % tp->pixh) * tp->pixw) * 3;
 
 	pcol->r = (unsigned char)tp->map[indx] / 255.0;
diff -Nrua vort-old/art/src/super.c vort-new/art/src/super.c
--- vort-old/art/src/super.c	1999-10-12 18:24:14.000000000 -0400
+++ vort-new/art/src/super.c	2006-11-18 16:58:16.000000000 -0500
@@ -36,10 +36,6 @@
 	{ -1.0, -1.0, -1.0 }
 };
 
-#ifdef MSC
-#pragma optimise("", off)	/* Bloody optimiser is stuffed */
-#endif
-
 /*
  * superi
  *
@@ -183,10 +179,6 @@
 	return(hitlist);
 }
 
-#ifdef MSC
-#pragma optimise("", on)	/* Bloody optimiser is stuffed */
-#endif
-
 /*
  * supern
  *
@@ -226,10 +218,6 @@
 	int	w, h, indx;
 	vector	loc;
 	tiletxt *tp;
-#ifdef PC
-	unsigned int	page;
-	unsigned long	cp;
-#endif
 
 	totexture(txt, loc, *l);
 
@@ -246,20 +234,6 @@
 	w = u * tp->scalew;
 	h = v * tp->scaleh;
 
-#ifdef PC
-	if (tp->EMS_h != EMS_NULL_HDL) {
-		page = ((w % tp->pixw + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) / EMS_PAGE_SIZE;
-		cp = ((w % tp->pixw + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) % EMS_PAGE_SIZE;
-		EMS_map(tp->EMS_h, page);
-
-		pcol->r = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->g = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->b = (unsigned char)*(EMS_base()+cp) / 255.0;
-		return;
-	}
-#endif
 	indx = (w % tp->pixw + (h % tp->pixh) * tp->pixw) * 3;
 
 	pcol->r = (unsigned char)tp->map[indx] / 255.0;
diff -Nrua vort-old/art/src/texture.c vort-new/art/src/texture.c
--- vort-old/art/src/texture.c	1999-10-12 18:24:14.000000000 -0400
+++ vort-new/art/src/texture.c	2006-11-18 16:58:16.000000000 -0500
@@ -992,10 +992,6 @@
 	int		transformed;
 	float		scal, turb, squeez;
 	int		scalset, turbset, squeezset, have_block;
-#ifdef PC
-	unsigned int	EMS_h;
-	unsigned long	EMS_ofs;
-#endif
 
 	have_block = 0;
 
@@ -1029,9 +1025,6 @@
 		tilep->blend = 1.0;
 		tilep->scalew = 1.0;
 		tilep->scaleh = 1.0;
-#ifdef PC
-		tilep->EMS_h = EMS_NULL_HDL;
-#endif
 	} else if (tl->txtfun == blocks || tl->txtfun == bricks) {
 		tl->u.b = (blocktxt *)smalloc(sizeof(blocktxt));
 		tl->u.b->flags = 0;
@@ -1043,9 +1036,6 @@
 		procp->octaves = 6;
 		procp->var[0] = 1.0;
 		procp->var[1] = procp->var[2] = 0.0;
-#ifdef PC
-		procp->EMS_h = EMS_NULL_HDL;
-#endif
 	}
 
 	scal = 1.0;
@@ -1087,9 +1077,6 @@
 			procp->map = d->u.cm->m;
 			procp->pixw = d->u.cm->n;
 			procp->pixh = 1;
-#ifdef PC
-			procp->EMS_h = EMS_NULL_HDL;
-#endif
 			break;
 		case RANGE:
 			if (tl->txtfun == tile)
@@ -1161,11 +1148,7 @@
 			}
                         break;
 		case VORTFILE:
-#ifdef PC
-			tileinit(d->u.s, &map, &pixw, &pixh, &EMS_h, &EMS_ofs);
-#else
 			tileinit(d->u.s, &map, &pixw, &pixh);
-#endif
 
 			if (tl->txtfun == tile) {
 				tilep->map = map;
@@ -1173,18 +1156,10 @@
 				tilep->pixh = pixh;
 				tilep->scalew *= pixw;
 				tilep->scaleh *= pixh;
-#ifdef PC
-				tilep->EMS_h = EMS_h;
-				tilep->EMS_ofs = EMS_ofs;
-#endif
 			} else {
 				procp->map = map;
 				procp->pixw = pixw;
 				procp->pixh = pixh;
-#ifdef PC
-				procp->EMS_h = EMS_h;
-				procp->EMS_ofs = EMS_ofs;
-#endif
 			}
 
 			break;
diff -Nrua vort-old/art/src/tile.c vort-new/art/src/tile.c
--- vort-old/art/src/tile.c	1993-01-26 00:16:53.000000000 -0500
+++ vort-new/art/src/tile.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,20 +1,6 @@
 #include <stdio.h>
 #include <math.h>
-#ifdef PC
 #include <fcntl.h>
-#else
-#ifdef SYSV
-#include <fcntl.h>
-#else
-#ifdef VMS
-#include <file.h>
-#else
-#ifndef MACINTOSH
-#include <sys/file.h>
-#endif
-#endif
-#endif
-#endif
 #include "art.h"
 #include "gram.h"
 #include "macro.h"
@@ -25,48 +11,27 @@
 
 static symbol	*tiles = NULL;
 
-#ifdef PC
-extern int	EMS_available;
-#endif
-
 /*
  * tileinit
  *
  *	initialise the function pointers and fields for a tile pattern. 
  */
 void
-#ifdef PC
-tileinit(name, map, pixw, pixh, EMS_h, EMS_ofs)
-	char		*name;
-	char		**map;
-	unsigned short	*pixw, *pixh;
-	unsigned int	*EMS_h;
-	unsigned long	*EMS_ofs;
-#else
 tileinit(name, map, pixw, pixh)
 	char		*name;
 	char		**map;
 	unsigned short	*pixw, *pixh;
-#endif	
 {
 	register	int	i;
 	int		nlines;
 	image	*im;
 	symbol	*sym;
 	char	 *red, *green, *blue, buf[BUFSIZ], *cp;
-#ifdef PC
-	unsigned int	EMS_page, ep;
-	unsigned char far *EMS_addr;
-#endif
 
 	if ((sym = findsym(tiles, name)) != (symbol *)NULL) {
 		*pixw = sym->u.tile.width;
 		*pixh = sym->u.tile.height;
 		*map = sym->u.tile.pic;
-#ifdef PC
-		*EMS_h = sym->u.tile.EMS_h;
-		*EMS_ofs = sym->u.tile.EMS_ofs;
-#endif
 		return;
 	}
 
@@ -84,42 +49,6 @@
 	green = (char *)smalloc(imagewidth(im));
 	blue = (char *)smalloc(imagewidth(im));
 
-#ifdef PC
-	if (EMS_available) {
-		if ((*EMS_h = EMS_alloc(((*pixw * (unsigned long)*pixh * 3L) / EMS_PAGE_SIZE)+1)) != EMS_NULL_HDL) {
-			/* we have allocated enough EMS for this tile pattern, use it */
-			sym->u.tile.EMS_h = *EMS_h;
-			sym->u.tile.EMS_ofs = 0L;
-			*map = NULL;
-			sym->u.tile.pic = NULL;
-			ep = 0;
-			EMS_page = 0;
-			EMS_addr = EMS_base();
-			EMS_map(*EMS_h, EMS_page);
-
-			while (readrgbline(im, red, green, blue) && nlines-- != 0) {
-				for (i = 0; i < imagewidth(im); i++) {
-					EMS_addr[ep] = red[i];
-					if (++ep >= EMS_PAGE_SIZE) {EMS_map(*EMS_h, ++EMS_page); ep = 0;}
-					EMS_addr[ep] = green[i];
-					if (++ep >= EMS_PAGE_SIZE) {EMS_map(*EMS_h, ++EMS_page); ep = 0;}
-					EMS_addr[ep] = blue[i];
-					if (++ep >= EMS_PAGE_SIZE) {EMS_map(*EMS_h, ++EMS_page); ep = 0;}
-				}
-			}
-
-			closeimage(im);
-			free(red);
-			free(green);
-			free(blue);
-			return;
-		}
-	}
-	sym->u.tile.EMS_h = *EMS_h = EMS_NULL_HDL;
-
-	/* check if image size is to big for a PC (MSC or TC) */
-#endif
-
 	cp = *map = sym->u.tile.pic = (char *)scalloc(imagewidth(im), (unsigned long)imageheight(im) * 3);
 
 	while (readrgbline(im, red, green, blue) && nlines-- != 0)
@@ -135,25 +64,3 @@
 	free(blue);
 }
 
-
-#ifdef PC
-/*
- * Walk the tile symbol tree and deallocate any used EMS.
- */
-int   	uninit_tiles()
-{
-	uninit_a_tile(tiles);
-}
-
-
-int		uninit_a_tile(boffo)
-symbol	*boffo;
-{
-	if (boffo) {
-		if (boffo->left) uninit_a_tile(boffo->left);
-		else if (boffo->right) uninit_a_tile(boffo->right);
-		EMS_release(boffo->u.tile.EMS_h);
-	}
-}
-
-#endif
diff -Nrua vort-old/art/src/torus.c vort-new/art/src/torus.c
--- vort-old/art/src/torus.c	1999-10-12 18:24:14.000000000 -0400
+++ vort-new/art/src/torus.c	2006-11-18 16:58:16.000000000 -0500
@@ -190,10 +190,6 @@
 	float	u, v, fact;
 	vector	loc, tmp;
 	tiletxt	*tp;
-#ifdef PC
-	unsigned int	page;
-	unsigned long	cp;
-#endif
 
 	totexture(txt, loc, *l);
 
@@ -237,20 +233,6 @@
 	w = u * tp->scalew;
 	h = v * tp->scaleh;
 
-#ifdef PC
-	if (tp->EMS_h != EMS_NULL_HDL) {
-		page = ((w % tp->pixw + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) / EMS_PAGE_SIZE;
-		cp = ((w % tp->pixw + (unsigned long)(h % tp->pixh) * (unsigned long)tp->pixw) * 3L) % EMS_PAGE_SIZE;
-		EMS_map(tp->EMS_h, page);
-
-		pcol->r = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->g = (unsigned char)*(EMS_base()+cp) / 255.0;
-		if (++cp >= EMS_PAGE_SIZE) {EMS_map(tp->EMS_h, ++page); cp = 0;}
-		pcol->b = (unsigned char)*(EMS_base()+cp) / 255.0;
-		return;
-	}
-#endif
 	indx = (w % tp->pixw + (h % tp->pixh) * tp->pixw) * 3;
 
 	pcol->r = (unsigned char)tp->map[indx] / 255.0;
diff -Nrua vort-old/art/src/util.c vort-new/art/src/util.c
--- vort-old/art/src/util.c	1999-10-12 18:24:14.000000000 -0400
+++ vort-new/art/src/util.c	2006-11-18 16:58:16.000000000 -0500
@@ -648,10 +648,6 @@
 
 	txt->pixw = x;
 	txt->pixh = y;
-#ifdef PC
-	txt->EMS_h = EMS_NULL_HDL;
-#endif
-
 	txt->map = (char *)scalloc(x, y * 3);
 
 	if (noheader) {
diff -Nrua vort-old/buildk.bat vort-new/buildk.bat
--- vort-old/buildk.bat	1990-03-06 00:59:59.000000000 -0500
+++ vort-new/buildk.bat	1969-12-31 19:00:00.000000000 -0500
@@ -1,15 +0,0 @@
-echo off
-echo Building vort and art using kmake with Floating point option %1
-if "%1" == "" goto err
-cd lib
-kmake -f makefile.msc F=%1
-cd ..\tools
-kmake -f makefile.msc F=%1
-cd ..\pc
-kmake -f makefile.msc F=%1
-cd ..\art\src
-kmake -f makefile.msc F=%1
-goto end
-:err
-echo "Usage: buildm -FPi87 | -FPa | -FPc | -FPi"
-:end
diff -Nrua vort-old/buildm.bat vort-new/buildm.bat
--- vort-old/buildm.bat	1990-03-06 00:59:41.000000000 -0500
+++ vort-new/buildm.bat	1969-12-31 19:00:00.000000000 -0500
@@ -1,15 +0,0 @@
-echo off
-echo Building vort and art using microsoft make with Floating point option %1
-if "%1" == "" goto err
-cd lib
-make F=%1 make.msc
-cd ..\tools
-make F=%1 make.msc
-cd ..\pc
-make F=%1 make.msc
-cd ..\art\src
-make F=%1 make.msc
-goto end
-:err
-echo "Usage: buildm -FPi87 | -FPa | -FPc | -FPi"
-:end
diff -Nrua vort-old/buildtc.bat vort-new/buildtc.bat
--- vort-old/buildtc.bat	1992-05-25 21:05:53.000000000 -0400
+++ vort-new/buildtc.bat	1969-12-31 19:00:00.000000000 -0500
@@ -1,9 +0,0 @@
-echo Building vort and art using Turbo make 
-cd lib
-make -fmakefile.tc > g:\bernie\vort\lib.err
-cd ..\tools
-make -fmakefile.tc > g:\bernie\vort\tools.err
-cd ..\pc
-make -fmakefile.tc > g:\bernie\vort\pc.err
-cd ..\art\src
-make -fmakefile.tc > g:\bernie\vort\src.err
diff -Nrua vort-old/clean.bat vort-new/clean.bat
--- vort-old/clean.bat	1990-05-15 20:04:17.000000000 -0400
+++ vort-new/clean.bat	1969-12-31 19:00:00.000000000 -0500
@@ -1,13 +0,0 @@
-del art\src\*.obj
-del art\src\*.exe
-del art\src\*.map
-del art\scenes\*.pix
-del art\scenes\*.mix
-del lib\*.obj
-del lib\*.lib
-del pc\*.obj
-del pc\*.exe
-del pc\*.map
-del tools\*.obj
-del tools\*.exe
-del tools\*.map
diff -Nrua vort-old/cpfd.bat vort-new/cpfd.bat
--- vort-old/cpfd.bat	1990-03-06 00:59:19.000000000 -0500
+++ vort-new/cpfd.bat	1969-12-31 19:00:00.000000000 -0500
@@ -1,43 +0,0 @@
-echo Making directories
-md %1\vort
-md %1\vort\art
-md %1\vort\art\docs
-md %1\vort\art\src
-md %1\vort\art\scenes
-md %1\vort\lib
-md %1\vort\docs
-md %1\vort\tools
-md %1\vort\sun
-md %1\vort\pc
-md %1\vort\iris
-md %1\vort\apollo
-md %1\vort\old
-md %1\vort\x11
-md %1\vort\movies
-md %1\vort\movies\mech
-md %1\vort\movies\crank
-md %1\vort\movies\chess
-md %1\vort\movies\cylinder
-md %1\vort\movies\superq
-md %1\vort\tutes
-copy *.* %1\vort
-copy art\*.* %1\vort\art
-copy art\docs\*.* %1\vort\art\docs
-copy art\src\*.* %1\vort\art\src
-copy art\scenes\*.* %1\vort\art\scenes
-copy lib\*.* %1\vort\lib
-copy docs\*.* %1\vort\docs
-copy tools\*.* %1\vort\tools
-copy sun\*.* %1\vort\sun
-copy pc\*.* %1\vort\pc
-copy iris\*.* %1\vort\iris
-copy apollo\*.* %1\vort\apollo
-copy old\*.* %1\vort\old
-copy x11\*.* %1\vort\x11
-copy movies\*.* %1\vort\movies
-copy movies\mech\*.* %1\vort\movies\mech
-copy movies\crank\*.* %1\vort\movies\crank
-copy movies\chess\*.* %1\vort\movies\chess
-copy movies\cylinder\*.* %1\vort\movies\cylinder
-copy movies\superq\*.* %1\vort\movies\superq
-copy tutes\*.* %1\vort\tutes
diff -Nrua vort-old/docs/vortfile.5 vort-new/docs/vortfile.5
--- vort-old/docs/vortfile.5	1993-02-10 20:47:21.000000000 -0500
+++ vort-new/docs/vortfile.5	2006-11-18 16:58:16.000000000 -0500
@@ -1,4 +1,4 @@
-.TH VORTFILE 3  "5 December 1990" "VORT 2.2"
+.TH VORTFILE 5  "5 December 1990" "VORT 2.2"
 .UC 4
 .SH NAME
 VORTFILE \- A Very Ordinary raster file format library for the
@@ -68,7 +68,7 @@
 	T_LENGTH        1       /* length of text in characters */
 .fi
 .SS Colourmap Objects.
-The following types can be found in a text object:
+The following types can be found in a colourmap object:
 .nf
 	C_ADDR          0       /* size of map */
 	C_SIZE          1       /* size of each channel */
diff -Nrua vort-old/iris/disp.1 vort-new/iris/disp.1
--- vort-old/iris/disp.1	1990-03-02 00:06:19.000000000 -0500
+++ vort-new/iris/disp.1	1969-12-31 19:00:00.000000000 -0500
@@ -1,20 +0,0 @@
-.TH DISP 1 "May 23, 1989" "VORT 1.1"
-.SH NAME
-disp \- a programme for displaying a pix image file.
-.SH SYNOPSIS
-.PU
-.ll +8
-.B disp
-.I "file"
-.SH DESCRIPTION
-.I Disp
-displays a pix image file on an Iris workstation.
-.SH "SEE ALSO"
-.IR art (1),
-.IR pixinfo (1),
-.IR median (1),
-.IR targ2pix (1),
-.IR pix2ps (1),
-.IR gamma (1),
-.IR greyscale (1),
-.IR vort (3).
diff -Nrua vort-old/iris/disp.c vort-new/iris/disp.c
--- vort-old/iris/disp.c	1992-12-15 17:57:16.000000000 -0500
+++ vort-new/iris/disp.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,61 +0,0 @@
-#include <stdio.h>
-#include <math.h>
-#include "gl.h"
-#include "device.h"
-#include "vort.h"
- 
-/*
- * simple program to display rgb files
- */
-main(ac, av)
-        int     ac;
-        char    **av;
-{                     
-        image           *im;
-        char            title[BUFSIZ], name[BUFSIZ];
-        int             i, x, y;                
-	short		val;
-        unsigned short  h, w;
-        unsigned char   *red, *green, *blue;
-                                             
-        if ((im = openimage(av[1], "r")) == (image *)NULL) {
-                fprintf(stderr, "disp: can't open file %s.\n", av[1]);
-                 exit(1);
-        }    
-              
-        w = imagewidth(im);
-        h = imageheight(im);
-
-        red = (unsigned char *)malloc(w);
-        green = (unsigned char *)malloc(w);
-        blue = (unsigned char *)malloc(w);
-
-        strcpy(name, imagetitle(im));
-                                      
-        prefsize((Scoord)w, (Scoord)h);
-        winopen(name);
-        RGBmode();     
-        gconfig();
-        qdevice(QKEY);
-        qdevice(REDRAW);
-
-        y = h - 1;
-        while (readrgbline(im, red, green, blue)) {
-                cmov2i(0, y);
-                writeRGB(w, red, green, blue);
-                y--;
-        }
-          
-        while((i = qread(&val)) != QKEY)
-                if (i == REDRAW) {
-                        imagepos(im, 0, 0);
-			y = h - 1;
-                        while (readrgbline(im, red, green, blue)) {
-                                cmov2i(0, y);                       
-                                writeRGB(w, red, green, blue);
-                                y--;                           
-                        }
-                }         
-
-        exit(0);
-}
diff -Nrua vort-old/iris/disp.doc vort-new/iris/disp.doc
--- vort-old/iris/disp.doc	1990-03-02 00:06:50.000000000 -0500
+++ vort-new/iris/disp.doc	1969-12-31 19:00:00.000000000 -0500
@@ -1,66 +0,0 @@
-
-
-
-DISP(1)                  USER COMMANDS                    DISP(1)
-
-
-
-NAME
-     disp - a programme for displaying a pix image file.
-
-SYNOPSIS
-     disp file
-
-DESCRIPTION
-     Disp displays a pix image file on an Iris workstation.
-
-SEE ALSO
-     art(1),  pixinfo(1),  median(1),   targ2pix(1),   pix2ps(1),
-     gamma(1), greyscale(1), vort(3).
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-VORT 1.1            Last change: May 23, 1989                   1
-
-
-
diff -Nrua vort-old/iris/Makefile vort-new/iris/Makefile
--- vort-old/iris/Makefile	1995-04-03 20:39:31.000000000 -0400
+++ vort-new/iris/Makefile	1969-12-31 19:00:00.000000000 -0500
@@ -1,12 +0,0 @@
-CC=cc
-MFLAGS = 
-CFLAGS = $(MFLAGS)  -I../lib
-
-disp: ../lib/vort.h disp.o
-	$(CC) $(CFLAGS) -o disp disp.c ../lib/libvort.a -lgl_s
-
-#
-# best results can be had by compiling this with -DZBUFFER
-#
-movie: ../lib/vort.h movie.o
-	$(CC) $(CFLAGS) -o movie movie.c ../lib/libvort.a -lgl_s
diff -Nrua vort-old/iris/movie.c vort-new/iris/movie.c
--- vort-old/iris/movie.c	1992-12-17 17:50:51.000000000 -0500
+++ vort-new/iris/movie.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,255 +0,0 @@
-/* simple program to animate a series of frames on an Iris
-  by Pavel Rozalski
-  pavelr@sco.com
-
-  This should be compiled with -DZBUFFER in general
-*/
-
-#include <stdio.h>
-#include <gl.h>
-#include <device.h>
-#include "vort.h"
-
-typedef struct _screenPos {
-	Screencoord x1, y1;
-} screenPos;
-
-screenPos *srcImages;
-
-int nx, ny, w, h, magx=1, magy=1, maxframes, numframes;
-/*---change 12-17-92 Dave Scruton--------------------------------*/
-RGBvalue *r,*g,*b;             /* These used to be declared char */
-/*---------------------------------------------------------------*/
-
-#ifdef ZBUFFER
-int lastz;
-#endif /* ZBUFFER */
-
-extern char *malloc ();
-
-Usage ()
-{
-	fprintf (stderr, "movie [-x magx] [-y magy] [-m mag] pic1 pic2 ...\n");
-	exit ();
-}
-
-main (argc, argv)
-int argc;
-char **argv;
-{
-	int i;
-	extern char *optarg;
-	extern int optind;
-	int c;
-
-	while ((c = getopt (argc, argv, "x:y:m:")) != -1)
-		switch (c) {
-		case 'x':
-			magx = atoi (optarg);
-			break;
-	
-		case 'y':
-			magy = atoi (optarg);
-			break;
-	
-		case 'm':
-			magx = magy = atoi (optarg);
-			break;
-		case '?':
-			Usage ();
-			break;
-		}
-	
-	if ((magx<=0) || (magy<=0)) {
-		fprintf (stderr, "Magnification must be positive\n");
-		exit ();
-	}
-
-	InitTable ((char *) argv[optind]);
-	
-	InitGraphics ();
-
-	numframes = 0;
-
-	for (i=optind; i < argc && numframes<maxframes; i++)
-		LoadImage ((char *) argv[i]);
-
-	rectzoom ((float) magx, (float) magy);
-
-#ifdef	ZBUFFER
-	DisplayZ ();
-#else
-	Display ();
-#endif	/* ZBUFFER */
-}
-
-#ifdef	ZBUFFER
-DisplayZ ()
-{
-	int i;
-
-	qdevice (ESCKEY);
-
-	zdraw (FALSE);
-	frontbuffer (TRUE);
-
-	for (i=0; ;){
-		if (i==0) {
-			readsource (SRC_ZBUFFER);
-		} else if (i==lastz) {
-			readsource (SRC_FRONT);
-		}
-
-		gsync ();
-		rectcopy (srcImages[i].x1, srcImages[i].y1,
-			  srcImages[i].x1+w-1, srcImages[i].y1+h-1,
-			  0, 0);
-		gsync ();
-		i++;
-		if (i==numframes) i=0;
-		if (qtest())
-			exit ();
-	}
-}
-#else	/* !ZBUFFER */
-/*---change 12-17-92 Dave Scruton--------------------------------*/
-/* Added ESCKEY device que/checking - wasn't present before!     */
-/*---------------------------------------------------------------*/
-Display ()
-{
-	int i;
-	qdevice (ESCKEY);                /* This was not present */
-
-	for (i=0; ;){
-		gsync ();
-		rectcopy (srcImages[i].x1, srcImages[i].y1,
-			  srcImages[i].x1+w-1, srcImages[i].y1+h-1,
-			  0, 0);
-		gsync ();
-		i++;
-		if (i==numframes) i=0;
-		if (qtest())
-			exit ();
-	}
-}
-#endif	/* ZBUFFER */
-
-/* find the x and y size of the image. Compute some tables */
-InitTable (fname)
-char *fname;
-{
-	int x, y;
-	image *im;
-
-	if ((im = openimage (fname, "r")) == (image *) NULL) {
-		fprintf (stderr, "Unable to open image %s\n", fname);
-		exit ();
-	}
-
-        w = imagewidth(im);
-        h = imageheight(im);
-
-	nx = (XMAXSCREEN+1) / w;
-	ny = (YMAXSCREEN+1) / h;
-
-
-	if ((magx>nx) || (magy>ny)) {
-		fprintf (stderr, "Magnification too large\n");
-		exit ();
-	}
-
-	closeimage (im);
-
-/*---change 12-17-92 Dave Scruton--------------------------------*/
-	r = (RGBvalue *) malloc (w); /* prototype used to be char*/
-	g = (RGBvalue *) malloc (w); /*  for these three lines   */
-	b = (RGBvalue *) malloc (w);
-/*---------------------------------------------------------------*/
-
-#ifdef	ZBUFFER
-	maxframes = 2 * nx * ny - magx * magy;
-#else
-	maxframes =     nx * ny - magx * magy;
-#endif	/* ZBUFFER */
-
-	numframes = 0;
-
-	srcImages = (screenPos *) malloc (maxframes * sizeof (screenPos));
-
-#ifdef	ZBUFFER
-	/* calculate all frame positions in Zbuffer - all of it is available */
-	for (y=0; y <ny; y++)
-		for (x = 0; x<nx; x++) {
-			srcImages[numframes].x1 = x * w;
-			srcImages[numframes].y1 = y * h;
-			numframes ++;
-		}
-	lastz = numframes;
-#endif	/* ZBUFFER */
-
-	/* we have to skip over some regions where the target image will be */
-	for (y= 0; y<magy ; y++)
-		for (x= magx; x<nx; x++) {
-			srcImages[numframes].x1 = x * w;
-			srcImages[numframes].y1 = y * h;
-			numframes ++;
-		}
-
-	/* now do the rest of the frame buffer */
-	for (y=magy; y<ny; y++)
-		for (x = 0; x<nx; x++) {
-			srcImages[numframes].x1 = x * w;
-			srcImages[numframes].y1 = y * h;
-			numframes ++;
-		}
-}
-
-InitGraphics ()
-{
-	ginit ();
-	RGBmode ();
-	gconfig ();
-
-
-	RGBcolor (0, 0, 0);
-
-#ifdef	ZBUFFER
-	czclear (0,0);
-	zdraw (TRUE);
-#else	/* ZBUFFER */
-	clear ();
-#endif	/* ZBUFFER */
-}
-
-LoadImage (fname)
-char *fname;
-{
-	image *im;
-	int y;
-	if ((im = openimage (fname, "r")) == (image *) NULL) {
-		fprintf (stderr, "Unable to open image %s\n", fname);
-		return;
-	}
-
-	if ((imagewidth(im) != w) || (imageheight(im) != h)) {
-		fprintf (stderr, "Image wrong size: %s\n", fname);
-		closeimage (im);
-		return;
-	}
-
-	for (y=h; y>=0; y--) {
-		readrgbline (im, r, g, b);
-		cmov2i (srcImages[numframes].x1, srcImages[numframes].y1+y);
-		writeRGB ((short) w, r, g, b);
-	}
-	closeimage (im);
-	numframes ++;
-
-#ifdef	ZBUFFER
-	if (numframes == lastz) {
-		zdraw (FALSE);
-		frontbuffer (TRUE);
-	}
-#endif	/* ZBUFFER */
-}
-
diff -Nrua vort-old/lib/clib.opt vort-new/lib/clib.opt
--- vort-old/lib/clib.opt	1991-02-07 20:16:31.000000000 -0500
+++ vort-new/lib/clib.opt	1969-12-31 19:00:00.000000000 -0500
@@ -1,3 +0,0 @@
-! clib.opt file required for VAX systems
-
-sys$share:vaxcrtl.exe/share
diff -Nrua vort-old/lib/descrip.mms vort-new/lib/descrip.mms
--- vort-old/lib/descrip.mms	1991-02-07 20:16:31.000000000 -0500
+++ vort-new/lib/descrip.mms	1969-12-31 19:00:00.000000000 -0500
@@ -1,51 +0,0 @@
-! vort VAX make file [vort.lib]descrip.mms
-
-! should be the default - but sometimes does NOT work
-CFLAGS = /DEFINE="VMS=1"
-
-HEAD =		vort.h, -
-		features.h
-
-libvort :	libvort(hdr), -
-		libvort(imagepos), -
-		libvort(imageio), -
-		libvort(readmapl), -
-		libvort(readrgb), -
-		libvort(readrgba), - 
-		libvort(writmapl), -
-		libvort(writrgb), -
-		libvort(writrgba)
-	! libvort built
-
-! the above comment 'libvort built' is printed after
-! libvort has completed - leave it out and you get a warning from mms
-
-! it may be a bit overbearing to use HEAD for all the objects below
-! since not all use the 'features.h' - but better to be safe than sorry
-
-hdr.obj :	hdr.c $(HEAD)
-		cc $(CFLAGS) hdr
-
-imagepos.obj :	imagepos.c $(HEAD)
-		cc $(CFLAGS) imagepos
-
-imageio.obj :	imageio.c $(HEAD)
-		cc $(CFLAGS) imageio
-
-readmapl.obj :	readmapl.c $(HEAD)
-		cc $(CFLAGS) readmapl
-
-readrgb.obj :	readrgb.c $(HEAD)
-		cc $(CFLAGS) readrgb
-
-readrgba.obj :	readrgba.c $(HEAD)
-		cc $(CFLAGS) readrgba
-
-writmapl.obj :	writmapl.c $(HEAD)
-		cc $(CFLAGS) writmapl
-
-writrgb.obj :	writrgb.c $(HEAD)
-		cc $(CFLAGS) writrgb
-
-writrgba.obj :	writrgba.c $(HEAD)
-		cc $(CFLAGS) writrgba
diff -Nrua vort-old/lib/ems.asm vort-new/lib/ems.asm
--- vort-old/lib/ems.asm	1992-05-25 22:47:23.000000000 -0400
+++ vort-new/lib/ems.asm	1969-12-31 19:00:00.000000000 -0500
@@ -1,289 +0,0 @@
-		NAME	EMSRTN
-		TITLE	Routines for EMS handling.
-		PAGE	132,60
-  
-
-;=========================================
-;	EMS - Routines for EMS handling.
-;
-
-FALSE		=	0
-TRUE		=	1
-  
-		.MODEL	LARGE,C
-
-		.CODE
-
-		PUBLIC	EMS_rdy
-		PUBLIC	EMS_alloc
-		PUBLIC	EMS_map
-		PUBLIC	EMS_release
-		PUBLIC	EMS_count
-		PUBLIC	EMS_base
-  
-EMMXXXX0	db	"EMMXXXX0", 0
-  
-  
-
-		SUBTTL int EMS_rdy();
-		PAGE
-
-
-		COMMENT	$
-
-Name:		EMS_rdy
-
-Function:	Returns status of EMS.
-
-Caller:		Microsoft C
-
-		int EMS_rdy();
-
-Returns:
-		TRUE	- EMS is active
-		FALSE	- EMS is not active
-
-Assumes:	Filename EMMXXXX0 is ALWAYS the device name of the
-		EMS driver.
-
-		$
-
-
-EMS_rdy		proc	uses ds si
-		mov	ah,3Dh
-		push	cs
-		pop	ds
-		mov	dx,OFFSET EMMXXXX0	; File handle of EMS device driver
-		xor	al,al			; Zero register
-		int	21h			; DOS Services  ah=function 3Dh
-						;  open file, al=mode, name @ds:dx
-		jc	loc_2			; Jump if error
-		mov	bx,ax
-		mov	ah,3Eh			; '>'
-		int	21h			; DOS Services  ah=function 3Eh
-						;  close file, bx=file handle
-		mov	ax,TRUE			; Good return value
-		jmp	short loc_3
-loc_2:
-		mov	ax,FALSE		; Bad return value
-loc_3:
-		ret
-EMS_rdy		endp
-
-
-		SUBTTL void far *EMS_base();
-		PAGE
-
-
-		COMMENT	$
-
-Name:		EMS_base
-
-Function:	Returns base address of EMS page.
-
-Caller:		Microsoft C
-
-		void far *EMS_base();
-
-Returns:
-		32-bit EMS base address
-
-Assumes:	EMS is active.
-
-		$
-
-EMS_base	proc
-		mov	ah,41h
-		int	67h			; EMS Memory        ah=func 41h
-						;  get page frame segment in bx
-		mov	dx,bx			; Return value segment part
-		mov	ax,0			; Offset is always 0
-		ret
-EMS_base	endp
-
-
-		SUBTTL int EMS_count();
-		PAGE
-
-
-		COMMENT	$
-
-Name:		EMS_count
-
-Function:	Returns count of unused EMS pages.
-
-Caller:		Microsoft C
-
-		int EMS_count();
-
-Returns:
-		Number of unused EMS pages.
-
-Assumes:	EMS is active.
-
-		$
-
-EMS_count	proc	uses ds si
-		mov	ah,42h			; 'B'
-		int	67h			; EMS Memory        ah=func 42h
-						;  get pages, bx=unused, dx=total
-		mov	ax,bx			; Set number of unused pages
-		ret
-EMS_count	endp
-
-
-		SUBTTL int EMS_alloc(n);
-		PAGE
-
-
-		COMMENT	$
-
-Name:		EMS_alloc
-
-Function:	Allocates a number of EMS pages and returns an EMS handle.
-
-Caller:		Microsoft C
-
-		int	EMS_alloc(n)
-		int	n;		/* number of pages to allocate */
-
-Returns:	EMS handle or
-		FFFFH if can't allocate (this number may be dangerous).
-
-Assumes:	EMS is active.
-
-		$
-
-EMS_alloc	proc	uses ds si, n:WORD
-		mov	ah,43h			; 'C'
-		mov	bx,n			; Get # of pages
-		int	67h			; EMS Memory        ah=func 43h
-						;  get handle dx, allocate pgs bx
-		or	ah,ah
-		jz	loc_1
-		mov	dx,0FFFFH		; Error return
-loc_1:
-		mov	ax,dx			; Set handle
-		ret
-EMS_alloc	endp
-
-
-
-		SUBTTL int EMS_map();
-		PAGE
-
-
-		COMMENT	$
-
-Name:		EMS_map
-
-Function:	Maps an EMS page to the address returned by EMS_base().
-
-Caller:		Microsoft C
-
-		int	EMS_map(handle, page)
-		int	handle,		/* EMS handle */
-			page;		/* page number */
-
-Returns:	TRUE	- success
-		FALSE	- failure
-
-Assumes:	EMS is active.
-
-		$
-
-EMS_map		proc	uses dx bx, handle:WORD, p:WORD
-		mov	dx,handle
-		mov	bx,p
-		mov	al,0			; Always map to physical page 0
-		mov	ah,44h			; 'D'
-		int	67h			; EMS Memory        ah=func 44h
-						;  map memory, dx=handle
-		or	ah,ah
-		mov	ax,TRUE
-		jz	blonk			; Jump if zero
-		mov	ax,FALSE
-blonk:
-		ret
-EMS_map		endp
-
-
-		SUBTTL int EMS_release();
-		PAGE
-
-
-		COMMENT	$
-
-Name:		EMS_release
-
-Function:	Releases an EMS handle.
-
-Caller:		Microsoft C
-
-		int	EMS_release(handle)
-		int	handle;		/* EMS handle */
-
-Returns:	TRUE	- success
-		FALSE	- failure
-
-Assumes:	EMS is active.
-
-		$
-
-EMS_release	proc	uses ds si, handle:WORD
-		mov	ah,45h			; 'E'
-		mov	dx,handle		; Handle
-		int	67h			; EMS Memory        ah=func 45h
-						;  release handle dx, & memory
-		or	ah,ah
-		mov	ax,TRUE
-		jz	loc_4			; Jump if zero
-		mov	ax,FALSE
-loc_4:
-		ret
-EMS_release	endp
-
-
-
-		SUBTTL void lmemmove(to, from, n);
-		PAGE
-
-
-		COMMENT	$
-
-Name:		lmemmove
-
-Function:	Memory move for an explicitly far memory block.
-
-Caller:		Microsoft C
-
-		void lmemmove(to, from, n);
-
-		UCHAR far *to,		/* far ptr to move to */
-			  *from;	/* far ptr to move from */
-		int	n;		/* number of bytes to move */
-
-		$
-
-
-		.CODE
-
-
-public		lmemmove
-lmemmove	proc	uses	ds es di si, to:DWORD, from:DWORD, n:WORD
-		cld
-		lds	si,from
-		les	di,to
-		mov	cx,n
-		shr	cx,1
-		rep	movsw
-		jnc	bloot1
-		movsb
-bloot1:
-		ret
-lmemmove	endp
-
-
-
-		end
-
diff -Nrua vort-old/lib/hdr.c vort-new/lib/hdr.c
--- vort-old/lib/hdr.c	1995-04-03 22:24:22.000000000 -0400
+++ vort-new/lib/hdr.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,18 +1,16 @@
 #include <stdio.h>
-#ifdef PC
+#include <sys/types.h>
 #include <stdlib.h>
-#endif
+#include <string.h>
+#include <unistd.h>
 #include "vort.h"
 
-extern long	lseek();
-extern int	writelongval();
-
 /*
  * copyheader
  *
  *	copy all the header details for b into a, including the title, etc..
  */
-copyheader(a, b)
+void copyheader(a, b)
 	image	*a, *b;
 {
 	int	i;
@@ -69,7 +67,7 @@
  *
  *	set the colour map of the image
  */
-setcmap(im, numc, red, green, blue)
+void setcmap(im, numc, red, green, blue)
 	image		*im;
 	int		numc;
 	unsigned char	*red, *green, *blue;
@@ -103,14 +101,14 @@
  *	write out the header details for an image e.g. title, colormap, etc...
  * - should be done before anything else is written to the file.
  */
-writeheader(im)
+int writeheader(im)
 	image	*im;
 {
 	long	count, extra;
 	int	entries;
 	char	c;
 
-	lseek(im->fd, 0L, 0);
+	lseek(im->fd, 0L, SEEK_SET);
 
 	count = write(im->fd, VERSION_STR, VSTR_SIZE);
 
@@ -145,11 +143,11 @@
 		count += write(im->fd, &c, 1);
 		count += writelongval(im->fd, (unsigned long)(count + 5 + (entries - 1) * 6), 4);
 
-		lseek(im->fd, (unsigned long)(count + (entries - 1) * 6), 0);
+		lseek(im->fd, (unsigned long)(count + (entries - 1) * 6), SEEK_SET);
 
 		extra = writetextobj(im);
 
-		lseek(im->fd, count, 0);
+		lseek(im->fd, count, SEEK_SET);
 	}
 	
 	if (colormapped(im)) {
@@ -159,22 +157,24 @@
 
 		im->cmaddr = count + 6 + extra;
 
-		lseek(im->fd, (unsigned long)(count + 6 + extra), 0);
+		lseek(im->fd, (unsigned long)(count + 6 + extra), SEEK_SET);
 
 		extra += writecolormapobj(im);
 
-		lseek(im->fd, count, 0);
+		lseek(im->fd, count, SEEK_SET);
 	}
 
 	c = D_OBJECT;
 	count += write(im->fd, &c, 1);
 	count += writelongval(im->fd, (unsigned long)(count + extra + 5), 4);
 
-	lseek(im->fd, count + extra, 0);
+	lseek(im->fd, count + extra, SEEK_SET);
 
 	count += writeimageobj(im);
 
 	im->imaddr = count + extra;
 
-	lseek(im->fd, im->imaddr, 0);	/* shift to start of image */
+	lseek(im->fd, im->imaddr, SEEK_SET);	/* shift to start of image */
+
+	return count+extra;
 }
diff -Nrua vort-old/lib/imageio.c vort-new/lib/imageio.c
--- vort-old/lib/imageio.c	1995-04-03 20:48:30.000000000 -0400
+++ vort-new/lib/imageio.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,46 +1,23 @@
 #include <stdio.h>
-#ifdef VMS
-#include <types.h>
-#else
 #include <sys/types.h>
-#endif
-#ifdef PC
 #include <fcntl.h>
 #include <stdlib.h>
 #include <malloc.h>
-#else
-#ifdef VMS
-#include <file.h>
-#else
 #include <sys/file.h>
-#endif
-#endif
-
-#ifdef MIPS
-#include <fcntl.h>
-#endif
-
-#ifdef CRAY
-#include <foreign.h>
-#endif
-
-#ifdef SYSV
-#include <fcntl.h>
-#endif
+#include <unistd.h>
+#include <sys/stat.h>
 
 #include "vort.h"
 
-extern long	lseek();
-
 /*
  * getlongsize
  *
  *	return the size of a long value
  */
-getlongsize(val)
+int getlongsize(val)
 	unsigned long	val;
 {
-	unsigned char	size;
+	int	size;
 
 	if (val > 0xffffff)
 		size = 4;
@@ -51,7 +28,7 @@
 	else
 		size = 1;
 
-	return(size);
+	return size;
 }
 
 /*
@@ -59,12 +36,12 @@
  *
  *	reads a long value from the file fd.
  */
-int
-readlongval(fd, val)
+int readlongval(fd, val)
 	int	fd;
 	long	*val;
 {
-	unsigned char	size, byte, ret;
+	unsigned char	size, byte;
+	int ret;
 
 	read(fd, &size, 1);		/* get size byte */
 
@@ -72,14 +49,14 @@
 
 	ret = size;
 
-	while (size-- != 0) {
+	while (size-- > 0) {
 		*val <<= 8;
 		if (read(fd, &byte, 1) != 1)
 			vorterror("readlongval: unable to read value.\n");
 		*val |= byte;
 	}
 
-	return(ret);
+	return ret;
 }
 
 /*
@@ -87,8 +64,7 @@
  *
  *	writes a long value into the file fd.
  */
-int
-writelongval(fd, val, size)
+int writelongval(fd, val, size)
 	int		fd;
 	unsigned long	val;
 	unsigned char	size;
@@ -117,7 +93,7 @@
  *	extracts a long value from the byte stream pointed
  * to by ptr.
  */
-extractlongval(ptr, val)
+void extractlongval(ptr, val)
 	unsigned char	*ptr;
 	long		*val;
 {
@@ -138,7 +114,7 @@
  *
  *	read in a vort object
  */
-readvortobj(fd, obj)
+void readvortobj(fd, obj)
 	int	fd;
 	v_object	*obj;
 {
@@ -166,8 +142,7 @@
  *
  *	writes out a text object - returning it's size.
  */
-int
-writetextobj(im)
+int writetextobj(im)
 	image	*im;
 {
 	unsigned long	base, end;
@@ -200,8 +175,7 @@
  *
  *	writes out a colormap object - returning it's size.
  */
-int
-writecolormapobj(im)
+int writecolormapobj(im)
 	image		*im;
 {
 	unsigned char	c;
@@ -233,8 +207,7 @@
  *
  *	write out an image object - returning it's size.
  */
-int
-writeimageobj(im)
+int writeimageobj(im)
 	image	*im;
 {
 	unsigned char	size, c;
@@ -376,7 +349,7 @@
  *	set the size for the image buffer. Must be called before open
  * image to take effect.
  */
-imagebufsize(size)
+void imagebufsize(size)
 	int	size;
 {
 	ibufsize = size;
@@ -389,8 +362,7 @@
  * the file descriptor fd. Returns NULL if the image hasn't got a VORT
  * header.
  */
-image *
-readimage(fd)
+image *readimage(fd)
 	int	fd;
 {
 	image	*im;
@@ -451,8 +423,7 @@
  * as fopen(3), the only difference been if the file name "-" is used stdin
  * or stdout is assumed.
  */
-image *
-openimage(name, flag)
+image *openimage(name, flag)
 	char	*name;
 	char	*flag;
 {
@@ -478,32 +449,23 @@
 	titlelength(im) = 0;
 	imagefragment(im) = 0;
 
-#ifdef PC
-	if (strcmp(flag, "r") == 0) {
-		im->reading = 1;
-		flags = O_RDONLY | O_BINARY;
-	} else if (strcmp(flag, "w") == 0)
-		flags = O_WRONLY | O_CREAT | O_TRUNC | O_BINARY;
-	else {
-		vortwarning("openimage: bad open flag.\n");
-		return((image *)NULL);
-	}
-#else
 	if (strcmp(flag, "r") == 0) {
 		im->reading = 1;
 		flags = O_RDONLY;
 	} else if (strcmp(flag, "w") == 0)
+/*
 		flags = O_WRONLY | O_CREAT | O_TRUNC;
+*/
+		flags = O_RDWR | O_CREAT | O_TRUNC;
 	else {
 		vortwarning("openimage: bad open flag.\n");
 		return((image *)NULL);
 	}
-#endif
 
 	if (strcmp(name, "-") == 0)
 		im->fd = (im->reading) ? 0 : 1;
 	else
-		if ((im->fd = open(name, flags, 0664)) < 0)
+		if ((im->fd = open(name, flags, S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP | S_IROTH)) < 0)
 			return((image *)NULL);
 
 	im->ibufsize = ibufsize;
@@ -574,8 +536,7 @@
  *	returns an image structure for image file fd. fd must be set up
  * for writing.
  */
-image *
-makeimage(fd)
+image *makeimage(fd)
 	int	fd;
 {
 	image	*im;
@@ -616,7 +577,7 @@
  *
  *	set the details in im with the image data in obj
  */
-getimagedata(im, obj)
+void getimagedata(im, obj)
 	image		*im;
 	v_object	*obj;
 {
@@ -723,7 +684,7 @@
  *
  *	get the colourmap data out of obj for im
  */
-getcolormapdata(im, obj)
+void getcolormapdata(im, obj)
 	image	*im;
 	v_object	*obj;
 {
@@ -769,7 +730,7 @@
  *
  *	set the text data in im with the text data in obj
  */
-gettextdata(im, obj)
+void gettextdata(im, obj)
 	image	*im;
 	v_object	*obj;
 {
@@ -809,7 +770,7 @@
  *
  *	get the image details out of the object header
  */
-setupimage(im, obj)
+void setupimage(im, obj)
 	image		*im;
 	v_object	*obj;
 {
@@ -850,8 +811,7 @@
  *
  *	returns a byte from the image or EOF if the end is reached
  */
-int
-readbyte(im)
+int readbyte(im)
 	image		*im;
 {
 	int	count;
@@ -871,8 +831,7 @@
  *
  *	writes a byte to the image buffer, flushing it if it is full
  */
-int
-writebyte(im, byte)
+int writebyte(im, byte)
 	image		*im;
 	unsigned char	byte;
 {
@@ -894,8 +853,7 @@
  *
  *	close up an image file
  */
-int
-closeimage(im)
+int closeimage(im)
 	image		*im;
 {
 	int		fd;
@@ -940,8 +898,7 @@
  *
  *	finishes writing and frees up an image file
  */
-int
-finishimage(im)
+int finishimage(im)
 	image		*im;
 {
 	int		fd;
@@ -970,4 +927,6 @@
 	compressed = im->compressed;
 
 	free(im);
+
+	return 0;
 }
diff -Nrua vort-old/lib/imagepos.c vort-new/lib/imagepos.c
--- vort-old/lib/imagepos.c	1992-05-25 22:44:40.000000000 -0400
+++ vort-new/lib/imagepos.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,23 +1,8 @@
 #include <stdio.h>
-#ifdef VMS
-#include <types.h>
-#else
 #include <sys/types.h>
-#endif
-#ifdef PC
-#include <fcntl.h>
-#include <stdlib.h>
-#include <malloc.h>
-#else
-#ifdef VMS
-#include <file.h>
-#else
 #include <sys/file.h>
-#endif
-#endif
-#include "vort.h"
 
-extern long	lseek();
+#include "vort.h"
 
 /*
  * imagepos
@@ -32,5 +17,6 @@
 {
 	im->ebufp = im->ibufp = im->ibuf + im->ibufsize;
 
-	return(lseek(im->fd, (long)im->imaddr, 0));
+	return(lseek(im->fd, (long)im->imaddr, SEEK_SET));
 }
+
diff -Nrua vort-old/lib/Makefile vort-new/lib/Makefile
--- vort-old/lib/Makefile	2000-09-09 23:20:11.000000000 -0400
+++ vort-new/lib/Makefile	2006-11-18 16:58:16.000000000 -0500
@@ -1,6 +1,6 @@
 
 CC=cc
-MFLAGS = -O
+MFLAGS = -fsingle -O
 RANLIB = ranlib
 CFLAGS = $(MFLAGS)
 
diff -Nrua vort-old/lib/makefile.msc vort-new/lib/makefile.msc
--- vort-old/lib/makefile.msc	1993-02-10 22:11:04.000000000 -0500
+++ vort-new/lib/makefile.msc	1969-12-31 19:00:00.000000000 -0500
@@ -1,38 +0,0 @@
-CC = cl
-F = -FPi87
-CFLAGS = -AL -c -Ot $(F) -DPC
-ASMFLAGS = -Zi -Mx
-O = .obj
-A = .lib
-R = .exe
-
-HOBJS = hdr$(O) imageio$(O) readrgba$(O) readmapl$(O) \
-	writrgba$(O) writmapl$(O) ems$(O)
-TOBJS = imagepos$(O)
-OBJS = $(HOBJS) $(TOBJS)
-
-PLIB = libvort
-
-$(PLIB)$(A): $(OBJS)
-	del $(PLIB)$(A)
-	del lnk
-	echo $(PLIB) >> lnk
-	echo y >> lnk
-	%(HOBJS) echo $(HOBJS) & >> lnk
-	echo $(TOBJS) >> lnk
-	echo $(PLIB).LST >> lnk
-	lib @lnk
-
-$(OBJS):\
-vort.h
-
-
-.SUFFIXES:	.c .obj .exe .lib .asm
-
-.c.obj:
-	$(CC) $(CFLAGS) $*.c
-
-.asm.obj:
-	masm $(ASMFLAGS) $*;
-
-
diff -Nrua vort-old/lib/makefile.tc vort-new/lib/makefile.tc
--- vort-old/lib/makefile.tc	1993-02-10 22:10:46.000000000 -0500
+++ vort-new/lib/makefile.tc	1969-12-31 19:00:00.000000000 -0500
@@ -1,20 +0,0 @@
-CC = bcc
-CFLAGS = -ml -c -O -DPC -DTC -w-rvl
-ASM = tasm
-ASMFLAGS = -mx
-
-OBJS = hdr.obj imageio.obj readrgba.obj readmapl.obj \
-	vorterr.obj writrgba.obj writmapl.obj ems.obj imagepos.obj
-
-.c.obj:
-	$(CC) $(CFLAGS) $*.c
-
-.asm.obj:
-	$(ASM) $(ASMFLAGS) $*;
-
-LIB = vort.lib
-
-$(LIB)$(A): $(OBJS)
-	del $(LIB)
-	tlib $(LIB) +hdr+imageio+readrgba+readmapl+writrgba+writmapl+imagepos+vorterr+ems,,
-
diff -Nrua vort-old/lib/make.msc vort-new/lib/make.msc
--- vort-old/lib/make.msc	1993-02-10 22:10:56.000000000 -0500
+++ vort-new/lib/make.msc	1969-12-31 19:00:00.000000000 -0500
@@ -1,36 +0,0 @@
-CC = cl
-F = -FPa
-CFLAGS = -AL -c -Ot  $(F) -DPC
-
-OBJS = hdr.obj imageio.obj readrgba.obj readmapl.obj \
-	vorterr.obj writrgba.obj writmapl.obj imagepos.obj ems.obj
-
-LIB = vort.lib
-
-.c.obj:
-	$(CC) $(CFLAGS) $*.c
-
-.asm.obj:
-	masm $*.asm;
-
-hdr.obj: hdr.c vort.h
-
-imageio.obj : imageio.c vort.h
-
-readrgba.obj: readrgba.c vort.h
-
-readmapl.obj: readmapl.c vort.h
-
-writrgba.obj: writrgba.c vort.h
-
-writmapl.obj: writmapl.c vort.h
-
-imagepos.obj: imagepos.c vort.h
-
-vorterr.obj: vorterr.c vort.h
-
-ems.obj: ems.asm
-
-$(LIB): $(OBJS)
-	del $(LIB)
-	lib $(LIB)+hdr+imageio+readrgba+readmapl+writrgba+writmapl+imagepos+vorterr+ems;
diff -Nrua vort-old/lib/readmapl.c vort-new/lib/readmapl.c
--- vort-old/lib/readmapl.c	1995-04-03 22:22:40.000000000 -0400
+++ vort-new/lib/readmapl.c	2006-11-18 16:58:16.000000000 -0500
@@ -7,8 +7,7 @@
  *	reads in a scanline for a colour mapped image setting the alpha
  * channel as it goes (if required).
  */
-static int
-readmappeda(in, line, alpha)
+static int readmappeda(in, line, alpha)
 	image		*in;
 	unsigned char	*line;
 	unsigned char	*alpha;
@@ -112,8 +111,7 @@
  *
  *	reads in a scanline for a colour mapped image.
  */
-int
-readmappedline(in, line)
+int readmappedline(in, line)
 	image		*in;
 	unsigned char	*line;
 {
@@ -126,8 +124,7 @@
  *	reads in a scanline for a colour mapped image plus the alpha
  * information.
  */
-int
-readmappedaline(in, line, alpha)
+int readmappedaline(in, line, alpha)
 	image		*in;
 	unsigned char	*line;
 	unsigned char	*alpha;
diff -Nrua vort-old/lib/readrgba.c vort-new/lib/readrgba.c
--- vort-old/lib/readrgba.c	1995-04-03 22:19:29.000000000 -0400
+++ vort-new/lib/readrgba.c	2006-11-18 16:58:16.000000000 -0500
@@ -7,8 +7,7 @@
  *	reads in a scanline from file in and puts the scanline into red, green,
  * blue, and, if required, alpha.
  */
-static int
-readrgba(in, red, green, blue, alpha)
+static int readrgba(in, red, green, blue, alpha)
 	image		*in;
 	unsigned char	*red, *green, *blue, *alpha;
 {
@@ -230,7 +229,7 @@
  *	read in a scanline from file in setting red, green, blue, and
  * ignoring any alpha information that's present.
  */
-readrgbline(in, red, green, blue)
+int readrgbline(in, red, green, blue)
 	image	*in;
 	unsigned char	*red, *green, *blue;
 {
@@ -243,7 +242,7 @@
  *	read in a scanline from file in setting red, green, blue, and
  * alpha.
  */
-readrgbaline(in, red, green, blue, alpha)
+int readrgbaline(in, red, green, blue, alpha)
 	image	*in;
 	unsigned char	*red, *green, *blue, *alpha;
 {
diff -Nrua vort-old/lib/status.h vort-new/lib/status.h
--- vort-old/lib/status.h	1991-02-07 20:16:35.000000000 -0500
+++ vort-new/lib/status.h	2006-11-18 16:58:16.000000000 -0500
@@ -1,12 +1,4 @@
 
-/*
- * on VMS exit 0 is bad and 1 is good (sigh).
- */
-#ifdef VMS
-#define ALLOK		1
-#define ERROR		0
-#else 
 #define ALLOK		0
 #define ERROR		1
-#endif
 
diff -Nrua vort-old/lib/vorterr.c vort-new/lib/vorterr.c
--- vort-old/lib/vorterr.c	1992-09-10 01:56:18.000000000 -0400
+++ vort-new/lib/vorterr.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,4 +1,5 @@
 #include <stdio.h>
+#include <stdlib.h>
 #include "status.h"
 
 /*
@@ -7,7 +8,7 @@
  * prints out an error message and then exits.
  *
  */
-vorterror(s)
+void vorterror(s)
 	char	*s;
 {
 	fprintf(stderr, s);
@@ -20,7 +21,7 @@
  * prints out a non-fatal error message.
  *
  */
-vortwarning(s)
+void vortwarning(s)
 	char	*s;
 {
 	fprintf(stderr, s);
diff -Nrua vort-old/lib/vort.h vort-new/lib/vort.h
--- vort-old/lib/vort.h	1992-07-24 01:39:51.000000000 -0400
+++ vort-new/lib/vort.h	2006-11-18 16:58:16.000000000 -0500
@@ -4,13 +4,6 @@
 #define	VSTR_SIZE	6
 #define	VERSION_STR	"VORT01"
 
-/* 
- * Much IBM-PC magic for Borland Compilers...
- */
-#ifdef TC
-extern unsigned _stklen;
-#endif
-
 /*
  * compress magic numbers
  */
@@ -167,11 +160,63 @@
 #define rlecoded(a)		((a)->magic & _RLE_CODED)
 
 /*
- * image processing functions
+ * function prototypes
  */
-extern image	*openimage(), *readimage();
-extern int	readrgbline(), writergbline();
-extern int	readrgbaline(), writergbaline();
+
+/* hdr.c */
+void	copyheader (image *a, image *b);
+void	setcmap (image *im, int numc, unsigned char *red, unsigned char *green,
+		unsigned char *blue);
+int	writeheader (image *im);
+
+/* imageio.c */
+int	getlongsize (unsigned long val);
+int	readlongval (int fd, long *val);
+int	writelongval (int fd, unsigned long val, int size);
+void	extractlongval (unsigned char *ptr, long *val);
+void	readvortobj (int fd, v_object *obj);
+int	writetextobj (image *im);
+int	writecolormapobj (image *im);
+int	writeimageobj (image *im);
+void	imagebufsize (int size);
+image	*readimage (int fd);
+image	*openimage (char *name, char *flag);
+image	*makeimage (int fd);
+void	getimagedata (image *im, v_object *obj);
+void	getcolormapdata (image *im, v_object *obj);
+void	gettextdata (image *im, v_object *obj);
+void	setupimage (image *im, v_object *obj);
+int	readbyte (image *im);
+int	writebyte (image *im, int byte);
+int	closeimage (image *im);
+int	finishimage (image *im);
+
+/* imagepos.c */
+int	imagepos (image *im, int x, int y);
+
+/* readmapl.c */
+int	readmappedline (image *in, unsigned char *line);
+int	readmappedaline (image *in, unsigned char *line, unsigned char *alpha);
+
+/* readrgba.c */
+int	readrgbline (image *in, unsigned char *red, unsigned char *green,
+		unsigned char *blue);
+int	readrgbaline (image *in, unsigned char *red, unsigned char *green,
+		unsigned char *blue, unsigned char *alpha);
+
+/* vorterr.c */
+void	vorterror (char *s);
+void	vortwarning (char *s);
+
+/* writmapl.c */
+int	writemappedline (image *out, unsigned char *line);
+int	writemappedaline (image *out, unsigned char *line, unsigned char *alpha);
+
+/* writrgba.c */
+int	writergbline (image *out, unsigned char *red, unsigned char *green,
+		unsigned char *blue);
+int	writergbaline (image *out, unsigned char *red, unsigned char *green,
+		unsigned char *blue, unsigned char *alpha);
 
 /*
  * general macros for getting access to image details
diff -Nrua vort-old/lib/writmapl.c vort-new/lib/writmapl.c
--- vort-old/lib/writmapl.c	1995-04-03 22:23:22.000000000 -0400
+++ vort-new/lib/writmapl.c	2006-11-18 16:58:16.000000000 -0500
@@ -6,8 +6,7 @@
  *
  *	writes a scanline of colour map indexes from line to file out.
  */
-static int
-writemappeda(out, line, alpha)
+static int writemappeda(out, line, alpha)
 	image		*out;
 	unsigned char	*line, *alpha;
 {
@@ -162,8 +161,7 @@
  *
  *	writes a scanline of colour map indexes from line to file out.
  */
-int
-writemappedline(out, line)
+int writemappedline(out, line)
 	image		*out;
 	unsigned char	*line;
 {
@@ -176,8 +174,7 @@
  *	writes a scanline of colour map indexes and it associated alpha
  * information to file out.
  */
-int
-writemappedaline(out, line, alpha)
+int writemappedaline(out, line, alpha)
 	image		*out;
 	unsigned char	*line, *alpha;
 {
diff -Nrua vort-old/lib/writrgba.c vort-new/lib/writrgba.c
--- vort-old/lib/writrgba.c	1995-04-03 22:21:59.000000000 -0400
+++ vort-new/lib/writrgba.c	2006-11-18 16:58:16.000000000 -0500
@@ -6,8 +6,7 @@
  *
  *	writes out the rgba scanline described by red, green, and blue into out.
  */
-static int
-writergba(out, red, green, blue, alpha)
+static int writergba(out, red, green, blue, alpha)
 	image		*out;
 	unsigned char	*red, *green, *blue, *alpha;
 {
@@ -203,7 +202,7 @@
  *
  *	write out the red, green, and blue values to out.
  */
-writergbline(out, red, green, blue)
+int writergbline(out, red, green, blue)
 	image		*out;
 	unsigned char	*red, *green, *blue;
 {
@@ -215,7 +214,7 @@
  *
  *	write out the red, green, blue and alpha values to out.
  */
-writergbaline(out, red, green, blue, alpha)
+int writergbaline(out, red, green, blue, alpha)
 	image		*out;
 	unsigned char	*red, *green, *blue, *alpha;
 {
diff -Nrua vort-old/Makefile vort-new/Makefile
--- vort-old/Makefile	1999-10-13 08:08:33.000000000 -0400
+++ vort-new/Makefile	2006-11-18 16:58:16.000000000 -0500
@@ -10,127 +10,25 @@
 #
 .IGNORE:
 
-#
-# these are used by make unix
-#
-CFLAGS = -O -DSYSV
-CC=cc
-YACC=yacc
-LEX=lex
-LEXLIB=-ll
-
-#LIBS=-lsocket -lnsl
 RANLIB = ranlib
-# Or for SYSV types
-#RANLIB = echo
-
-SUN3FLAGS = -O4 -fsingle -f68881 /usr/lib/f68881/libm.il
-SUN3LIBS = -lsuntool -lsunwindow -lpixrect -lm
-SUN3XFLAGS = -O4 -fsingle -f68881 /usr/lib/f68881/libm.il
-SUN3XLIBS = -lX11
-SUN3CC = cc
-SUN3LEX = lex
-SUN3YACC = yacc
-SUN3LEXLIB = -ll
-
-SUN4FLAGS = -O4 -fsingle
-SUN4LIBS = -lsuntool -lsunwindow -lpixrect -lm
-SUN4XFLAGS = -O4 -fsingle
-SUN4XLIBS = -lX11
-SUN4CC = cc
-SUN4LEX = lex
-SUN4YACC = yacc
-SUN4LEXLIB = -ll
-
-X11FLAGS = -O4
-X11CC = cc
-X11LEX = lex
-X11YACC = yacc
-X11LEXLIB = -ll
-X11LIBS = -lX11
-
-IRISFLAGS = -O -DSYSV -float
-IRISCC = cc
-IRISLEX = lex
-IRISYACC = yacc
-IRISLEXLIB = -ll
-IRISLIBS = -ll
-
-APOLLOFLAGS = -O -M3000
-APOLLOCC = cc
-APOLLOLEX = lex
-APOLLOYACC = yacc
-APOLLOLEXLIB = -ll
-APOLLOX11LIBS = -lX11
-
-LINUXFLAGS = -O -DSYSV
-LINUXCC = gcc
-LINUXLEX = flex
-LINUXYACC = bison
-LINUXLEXLIB = -lfl
-LINUXX11LIBS = -L/usr/X11/lib -lX11
-
-all:	
-	@echo "Usage: 'make linux', 'make unix', 'make sun3', 'make sun4', 'make iris4D', 'make sun3X', make sun4X, 'make x11', 'make Apollo' or 'make clobber'"
+X11FLAGS = -O3
+LINUXFLAGS = -O2 -DSYSV
+CC = gcc
+LEX = flex
+YACC = bison
+LEXLIB = -lfl
+X11LIBS = -L/usr/X11R6/lib -lX11
 
-unix:
-	cd lib; make RANLIB="$(RANLIB)" MFLAGS="$(CFLAGS)" CC="$(CC)"
-	cd art/src; make MFLAGS="$(CFLAGS)" CC="$(CC)" YACC="$(YACC)" LEX="$(LEX)" LEXLIB="$(LEXLIB)"
-	cd tools; make MFLAGS="$(CFLAGS)" CC="$(CC)"
+all: linux
 
-sun3:
-	cd lib; make RANLIB="$(RANLIB)" MFLAGS="$(SUN3FLAGS)" CC="$(CC)"
-	cd art/src; make MFLAGS="$(SUN3FLAGS)" CC="$(CC)" YACC="$(SUN3YACC)" LEX="$(SUN3LEX)" LEXLIB="$(SUN3LEXLIB)"
-	cd tools; make MFLAGS="$(SUN3FLAGS)" CC="$(CC)"
-	cd sun; make MFLAGS="$(SUN3FLAGS)" MLIBS="$(SUN3LIBS)" CC="$(CC)"
-
-sun3X:
-	cd lib; make RANLIB="$(RANLIB)" MFLAGS="$(SUN3XFLAGS)" CC="$(SUN3CC)"
-	cd art/src; make MFLAGS="$(SUN3XFLAGS)" CC="$(SUN3CC)" YACC="$(SUN3YACC)" LEX="$(SUN3LEX)" LEXLIB="$(SUN3LEXLIB)"
-	cd tools; make MFLAGS="$(SUN3XFLAGS)" CC="$(SUN3CC)"
-	cd X11; make MFLAGS="$(SUN3XFLAGS)" MLIBS="$(SUN3XLIBS)" CC="$(SUN3CC)"
-
-sun4:
-	cd lib; make RANLIB="$(RANLIB)" MFLAGS="$(SUN4FLAGS)" CC="$(SUN4CC)"
-	cd art/src; make MFLAGS="$(SUN4FLAGS)" CC="$(SUN4CC)" YACC="$(SUN4YACC)" LEX="$(SUN4LEX)" LEXLIB="$(SUN4LEXLIB)"
-	cd tools; make MFLAGS="$(SUN4FLAGS)" CC="$(SUN4CC)"
-	cd sun; make MFLAGS="$(SUN4FLAGS)" MLIBS="$(SUN4LIBS)" CC="$(SUN4CC)"
-
-sun4X:
-	cd lib; make RANLIB="$(RANLIB)" MFLAGS="$(SUN4XFLAGS)" CC="$(SUN4CC)"
-	cd art/src; make MFLAGS="$(SUN4XFLAGS)" CC="$(SUN4CC)" YACC="$(SUN4YACC)" LEX="$(SUN4LEX)" LEXLIB="$(SUN4LEXLIB)"
-	cd tools; make MFLAGS="$(SUN4XFLAGS)" CC="$(SUN4CC)"
-	cd X11; make MFLAGS="$(SUN4XFLAGS)" MLIBS="$(SUN4XLIBS)" CC="$(SUN4CC)"
-
-x11:
-	cd lib; make RANLIB="$(RANLIB)" MFLAGS="$(X11FLAGS)" CC="$(CC)"
-	cd art/src; make MFLAGS="$(SUN4XFLAGS)" CC="$(CC)" YACC="$(YACC)" LEX="$(LEX)" LEXLIB="$(LEXLIB)"
+linux:
+	cd lib; make MFLAGS="$(LINUXFLAGS)" CC="$(CC)"
+	cd art/src; make MFLAGS="$(LINUXFLAGS)" CC="$(CC)" YACC="$(YACC)" LEX="$(LEX)" LEXLIB="$(LEXLIB)"
 	cd tools; make MFLAGS="$(X11FLAGS)" CC="$(CC)"
 	cd X11; make MFLAGS="$(X11FLAGS)" MLIBS="$(X11LIBS)" CC="$(CC)"
 
-linux:
-	cd lib; make RANLIB="$(RANLIB)" MFLAGS="$(LINUXFLAGS)" CC="$(LINUXCC)"
-	cd art/src; make MFLAGS="$(LINUXFLAGS)" CC="$(LINUXCC)" YACC="$(LINUXYACC)" LEX="$(LINUXLEX)" LEXLIB="$(LINUXLEXLIB)"
-	cd tools; make MFLAGS="$(X11FLAGS)" CC="$(LINUXCC)"
-	cd X11; make MFLAGS="$(X11FLAGS)" MLIBS="$(LINUXX11LIBS)" CC="$(LINUXCC)"
-
-
-iris4D:
-	cd lib; make MFLAGS="$(IRISFLAGS)" RANLIB="ar ts " CC="$(IRISCC)"
-	cd art/src; make MFLAGS="$(IRISFLAGS)" CC="$(IRISCC)" YACC="$(IRISYACC)" LEX="$(IRISLEX)" LEXLIB="$(IRISLEXLIB)"
-	cd tools; make MFLAGS="$(IRISFLAGS)" CC="$(IRISCC)"
-	cd iris; make MFLAGS="$(IRISFLAGS)" MLIBS="$(IRISLIBS)" CC="$(IRISCC)"
-
-Apollo:
-	cd lib; make MFLAGS="$(APOLLOFLAGS)" RANLIB="ar ts " CC="$(APOLLOCC)"
-	cd art/src; make MFLAGS="$(APOLLOFLAGS)" CC="$(APOLLOCC)" YACC="$(APOLLOYACC)" LEX="$(APOLLOLEX)" LEXLIB="$(APOLLOLEXLIB)"
-	cd tools; make MFLAGS="$(APOLLOFLAGS)" CC="$(APOLLOCC)"
-	cd apollo; make MFLAGS="$(APOLLOFLAGS)" MLIBS="$(APOLLOLIBS)" CC="$(APOLLOCC)"
-
 clobber:
 	cd lib; rm -f core *.o *.lint libvort.a
 	cd tools; rm -f median greyscale vortinfo gamma targ2vort vort2ps mulmcut imtools impaste imcreate nff2art vort2pcx pcx2vort ppm2vort vort2ppm background vort2simp *.o *.lint core
-	cd art/src; rm -f core *.o *.lint art artd dart
-	cd sun; rm -f core *.o *.lint ?disp disp
-	cd apollo; rm -f core *.o *.lint ?disp disp
-	cd X11; rm -f core *.o *.lint ?disp disp
+	cd art/src; rm -f core *.o *.lint art dart in.artd in.netartd nart gram.c gram.h lex.c
+	cd X11; rm -f core *.o *.lint ?disp disp movie
diff -Nrua vort-old/Makefile.irix5 vort-new/Makefile.irix5
--- vort-old/Makefile.irix5	1999-10-13 09:06:57.000000000 -0400
+++ vort-new/Makefile.irix5	1969-12-31 19:00:00.000000000 -0500
@@ -1,39 +0,0 @@
-#
-# Makefile for vort
-#
-#
-############################################################
-#
-# Notes:
-#	If you have an equivalent to SUNS -fsingle option, then it would
-# be a good idea to use it. If not, you should use -Dfloat=double
-#
-.IGNORE:
-
-CC=cc
-YACC=yacc
-LEX=lex
-LEXLIB=-ll
-#LIBS=-lsocket -lnsl
-RANLIB = ranlib
-# Or for SYSV types
-RANLIB = echo
-
-X11FLAGS = -O -DSYSV 
-X11LIBS = -lX11
-
-all:	x11
-
-x11:
-	cd lib; make RANLIB="$(RANLIB)" MFLAGS="$(X11FLAGS)" CC="$(CC)"
-	cd art/src; make MFLAGS="$(X11FLAGS)" CC="$(CC)" LIBS="$(LIBS)" LEX="$(LEX)" YACC="$(YACC)" LEXLIB="$(LEXLIB)"
-	cd tools; make MFLAGS="$(X11FLAGS)" CC="$(CC)"
-	cd X11; make MFLAGS="$(X11FLAGS)" MLIBS="$(X11LIBS)" CC="$(CC)"
-
-clobber:
-	cd lib; rm -f core *.o *.lint libvort.a
-	cd tools; rm -f median greyscale vortinfo gamma targ2vort vort2ps mulmcut imtools impaste imcreate nff2art vort2pcx pcx2vort ppm2vort vort2ppm background vort2simp *.o *.lint core
-	cd art/src; rm -f core *.o *.lint art artd dart
-	cd sun; rm -f core *.o *.lint ?disp disp
-	cd apollo; rm -f core *.o *.lint ?disp disp
-	cd X11; rm -f core *.o *.lint ?disp disp
diff -Nrua vort-old/Makefile.sol vort-new/Makefile.sol
--- vort-old/Makefile.sol	1999-10-13 09:08:09.000000000 -0400
+++ vort-new/Makefile.sol	1969-12-31 19:00:00.000000000 -0500
@@ -1,38 +0,0 @@
-#
-# Makefile for vort
-#
-#
-############################################################
-#
-# Notes:
-#	If you have an equivalent to SUNS -fsingle option, then it would
-# be a good idea to use it. If not, you should use -Dfloat=double
-#
-CC=cc
-YACC=yacc
-LEX=lex
-LEXLIB=-ll
-#CC=gcc
-LIBS=-lsocket -lnsl
-RANLIB = ranlib
-# Or for SYSV types
-RANLIB = echo
-
-X11FLAGS = -O -DSYSV -I/usr/openwin/include
-X11LIBS = -L/usr/openwin/lib -R/usr/openwin/lib -lX11
-
-all:	x11
-
-x11:
-	cd lib; make RANLIB="$(RANLIB)" MFLAGS="$(X11FLAGS)" CC="$(CC)"
-	cd art/src; make MFLAGS="$(X11FLAGS)" CC="$(CC)" LIBS="$(LIBS)" YACC="$(YACC)" LEX="$(LEX)" LEXLIB="$(LEXLIB)"
-	cd tools; make MFLAGS="$(X11FLAGS)" CC="$(CC)"
-	cd X11; make MFLAGS="$(X11FLAGS)" MLIBS="$(X11LIBS)" CC="$(CC)"
-
-clobber:
-	cd lib; rm -f core *.o *.lint libvort.a
-	cd tools; rm -f median greyscale vortinfo gamma targ2vort vort2ps mulmcut imtools impaste imcreate nff2art vort2pcx pcx2vort ppm2vort vort2ppm background vort2simp *.o *.lint core
-	cd art/src; rm -f core *.o *.lint art artd dart
-	cd sun; rm -f core *.o *.lint ?disp disp
-	cd apollo; rm -f core *.o *.lint ?disp disp
-	cd X11; rm -f core *.o *.lint ?disp disp
diff -Nrua vort-old/old/conv.c vort-new/old/conv.c
--- vort-old/old/conv.c	1990-02-19 19:16:53.000000000 -0500
+++ vort-new/old/conv.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,86 +0,0 @@
-#include <stdio.h>
-#include "oldvort.h"
-#include "vort.h"
-
-extern char	*malloc();
-
-/*
- * a program to convert old pix images into the new format
- */
-main(ac, av)
-	int	ac;
-	char	**av;
-{
-	oldimage	*in;
-	image		*out;
-	unsigned char	*red, *green, *blue, *alpha;
-	int		i, j;
-
-	if (ac != 3) {
-		fprintf(stderr, "Usage: conv in_image out_image\n");
-		exit(1);
-	}
-
-	in = oldopenimage(av[1], "r");
-
-	out = openimage(av[2], "w");
-
-	if (oldcolormapped(in)) {
-		if (oldalphachannel(in)) {
-			imagetype(out) = PIX_RGBA;
-			imagedepth(out) = 32;
-		} else {
-			imagetype(out) = PIX_RLECMAP;
-			imagedepth(out) = 8;
-		}
-	} else {
-		if (oldalphachannel(in)) {
-			imagetype(out) = PIX_RGBA;
-			imagedepth(out) = 32;
-		} else {
-			imagetype(out) = PIX_RLE;
-			imagedepth(out) = 24;
-		}
-	}
-
-	imagewidth(out) = oldimagewidth(in);
-	imageheight(out) = oldimageheight(in);
-	imagedate(out) = oldimagedate(in);
-	titlelength(out) = oldtitlelength(in);
-	imagetitle(out) = oldimagetitle(in);
-
-	cmapsize(out) = oldcmapsize(in);
-	redmap(out) = oldredmap(in);
-	greenmap(out) = oldgreenmap(in);
-	bluemap(out) = oldbluemap(in);
-
-	writeheader(out);
-
-	red = (unsigned char *)malloc(imagewidth(out));
-	green = (unsigned char *)malloc(imagewidth(out));
-	blue = (unsigned char *)malloc(imagewidth(out));
-	alpha = (unsigned char *)malloc(imagewidth(out));
-
-	for (i = 1; i <= oldimageheight(in); i++) {
-
-		oldimagepos(in, 0, 0);
-		for (j = oldimageheight(in); j != i; j--)
-			oldreadrgbline(in, red, green, blue);
-
-		if (oldalphachannel(in)) {
-			oldreadrgbaline(in, red, green, blue, alpha);
-			writergbaline(out, red, green, blue, alpha);
-		} else {
-			if (colormapped(out)) {
-				oldreadmappedline(in, red);
-				writemappedline(out, red);
-			} else {
-				oldreadrgbline(in, red, green, blue);
-				writergbline(out, red, green, blue);
-			}
-		}
-	}
-
-
-	closeimage(out);
-}
diff -Nrua vort-old/old/Makefile vort-new/old/Makefile
--- vort-old/old/Makefile	1990-02-19 04:28:57.000000000 -0500
+++ vort-new/old/Makefile	1969-12-31 19:00:00.000000000 -0500
@@ -1,17 +0,0 @@
-
-MFLAGS = -fsingle -g
-CFLAGS = $(MFLAGS) -I../lib
-
-OBJS = oldimio.o 
-
-conv: conv.o
-	cc -o conv conv.o oldimio.o ../lib/libvort.a
-
-$(OBJS):\
-oldvort.h
-
-clean:
-	rm -f *.o core
-
-clobber:
-	rm -f conv *.o core
diff -Nrua vort-old/old/makefile.msc vort-new/old/makefile.msc
--- vort-old/old/makefile.msc	1990-02-26 19:57:28.000000000 -0500
+++ vort-new/old/makefile.msc	1969-12-31 19:00:00.000000000 -0500
@@ -1,15 +0,0 @@
-
-CFLAGS = -AL -c  -I../lib -DMSC -DPC -FPa
-
-OBJS = oldimio.obj 
-
-conv: conv.obj $(OBJS)
-	link conv+oldimio,,,..\lib\libvort /ST:8192;
-
-$(OBJS):\
-oldvort.h
-
-.SUFFIXES : .c .obj .exe
-
-.c.obj:
-	cl $(CFLAGS) $*.c
diff -Nrua vort-old/old/oldimio.c vort-new/old/oldimio.c
--- vort-old/old/oldimio.c	1990-02-19 04:14:58.000000000 -0500
+++ vort-new/old/oldimio.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,567 +0,0 @@
-#include <stdio.h>
-#include <sys/types.h>
-#ifdef MSC
-#include <fcntl.h>
-#include <stdlib.h>
-#include <malloc.h>
-#else
-#include <sys/file.h>
-#endif
-#include "oldvort.h"
-
-/*
- * oldopenimage
- *
- *	returns an image structure for image file name. Takes same arguments
- * as fopen(3), the only difference been if the file name "-" is used stdin
- * or stdout is assumed.
- */
-oldimage *
-oldopenimage(name, flag)
-	char	*name;
-	char	*flag;
-{
-	oldimage	*im;
-	int		flags;
-
-	if (name == (char *)0)
-		return((oldimage *)NULL);
-
-	if ((im = (oldimage *)malloc(sizeof(oldimage))) == (oldimage *)NULL)
-		return((oldimage *)NULL);
-	
-	im->written = im->reading = 0;
-
-#ifdef PC
-	if (strcmp(flag, "r") == 0) {
-		im->reading = 1;
-		flags = O_RDONLY | O_BINARY;
-	} else if (strcmp(flag, "w") == 0)
-		flags = O_WRONLY | O_CREAT | O_TRUNC | O_BINARY;
-	else {
-		fprintf(stderr, "oldopenimage: bad open flag.\n");
-		return((oldimage *)NULL);
-	}
-#else
-	if (strcmp(flag, "r") == 0) {
-		im->reading = 1;
-		flags = O_RDONLY;
-	} else if (strcmp(flag, "w") == 0)
-		flags = O_WRONLY | O_CREAT | O_TRUNC;
-	else {
-		fprintf(stderr, "oldopenimage: bad open flag.\n");
-		return((oldimage *)NULL);
-	}
-#endif
-
-	if (strcmp(name, "-") == 0)
-		im->fd = (im->reading) ? 0 : 1;
-	else
-		if ((im->fd = open(name, flags, 0664)) < 0)
-			return((oldimage *)NULL);
-
-	if (!im->reading) {
-		im->ibufp = im->ibuf;		/* initialise bufp to start */
-		return(im);
-	}
-
-	if (read(im->fd, &im->hdr, sizeof(pixhdr)) != sizeof(pixhdr))
-		return((oldimage *)NULL);
-
-	switch (oldimagetype(im)) {
-	case OLDPIX_RGB:
-	case OLDPIX_RLE:
-	case OLDPIX_MIX:
-	case OLDPIX_RGBA:
-	case OLDPIX_RLEA:
-	case OLDPIX_MIXA:
-	case OLDPIX_CMAP:
-	case OLDPIX_RLECMAP:
-		break;
-	default:
-		fprintf(stderr, "oldopenimage: bad magic number in file.\n");
-		return((oldimage *)NULL);
-	}
-
-	if (oldtitlelength(im) != 0) {
-		oldimagetitle(im) = (char *)malloc(oldtitlelength(im));
-		read(im->fd, oldimagetitle(im), oldtitlelength(im));
-	} else
-		oldimagetitle(im) = "";
-
-	if (oldcolormapped(im)) {
-		read(im->fd, &im->mapsize, sizeof(unsigned short));
-		im->red = (unsigned char *)malloc(oldcmapsize(im));
-		read(im->fd, im->red, oldcmapsize(im));
-		im->green = (unsigned char *)malloc(oldcmapsize(im));
-		read(im->fd, im->green, oldcmapsize(im));
-		im->blue = (unsigned char *)malloc(oldcmapsize(im));
-		read(im->fd, im->blue, oldcmapsize(im));
-	}
-
-	im->ebufp = im->ibufp = im->ibuf + IBUF_SIZE;
-
-	return(im);
-}
-
-/*
- * oldimagepos
- *
- *	position the image file at pixel x, y. (at the moment this just gos to (0, 0))
- */
-int
-oldimagepos(im, x, y)
-	oldimage	*im;
-	int		x, y;
-{
-	int	offset;
-
-	im->ebufp = im->ibufp = im->ibuf + IBUF_SIZE;
-
-	if (oldimagetype(im) == OLDPIX_CMAP || oldimagetype(im) == OLDPIX_RLECMAP)
-		return(lseek(im->fd, (long)(sizeof(pixhdr) + sizeof(im->mapsize) + im->hdr.tlength + 3 * oldcmapsize(im)), 0));
-
-
-	return(lseek(im->fd, (long)(sizeof(pixhdr) + im->hdr.tlength), 0));
-}
-
-/*
- * oldreadbyte
- *
- *	returns a byte from the image or EOF if the end is reached
- */
-int
-oldreadbyte(im)
-	oldimage		*im;
-{
-	int	count;
-
-	if (im->ibufp == im->ebufp) {
-		im->ibufp = im->ibuf;
-		if ((count = read(im->fd, im->ibuf, IBUF_SIZE)) == 0)
-			return(EOF);
-		im->ebufp = im->ibuf + count;
-	}
-
-	return(*im->ibufp++);
-}
-
-/*
- * closeimage
- *
- *	close up an image file
- */
-int
-oldcloseimage(im)
-	oldimage		*im;
-{
-	close(im->fd);
-}
-
-/*
- * oldreadrgbline
- *
- *	reads in a scanline from file in and puts it into red, green, and blue.
- */
-int
-oldreadrgbline(in, red, green, blue)
-	oldimage		*in;
-	unsigned char	*red, *green, *blue;
-{
-	char		alpha;
-	register int	x, i;
-	unsigned char	r, g, b, run = 0;
-
-	switch (oldimagetype(in)) {
-	case OLDPIX_CMAP:
-		for (x = 0; x < oldimagewidth(in); x++) {
-			if ((i = oldreadbyte(in)) == EOF)
-				return(0);
-			red[x] = in->red[i];
-			green[x] = in->green[i];
-			blue[x] = in->blue[i];
-		}
-		break;
-	case OLDPIX_RLECMAP:
-		x = 0;
-		while (x < oldimagewidth(in)) {
-			if ((i = oldreadbyte(in)) == EOF)
-				return(0);
-			run = i;
-			if ((i = oldreadbyte(in)) == EOF)
-				return(0);
-			do {
-				red[x] = in->red[i];
-				green[x] = in->green[i];
-				blue[x++] = in->blue[i];
-			} while (--run != 255);
-		}
-		break;
-	case OLDPIX_RGB:
-		for (x = 0; x < oldimagewidth(in); x++) {
-			if ((i = oldreadbyte(in)) == EOF)
-				return(0);
-			red[x] = i;
-			green[x] = oldreadbyte(in);
-			blue[x] = oldreadbyte(in);
-		}
-		break;
-	case OLDPIX_RGBA:
-		for (x = 0; x < oldimagewidth(in); x++) {
-			if ((i = oldreadbyte(in)) == EOF)
-				return(0);
-			red[x] = i;
-			green[x] = oldreadbyte(in);
-			blue[x] = oldreadbyte(in);
-			oldreadbyte(in);
-		}
-		break;
-	case OLDPIX_RLE:
-		x = 0;
-		while (x < oldimagewidth(in)) {
-			if (run == 0) {
-				if ((i = oldreadbyte(in)) == EOF)
-					return(0);
-				run = i;
-
-				r = red[x] = oldreadbyte(in);
-				g = green[x] = oldreadbyte(in);
-				b = blue[x] = oldreadbyte(in);
-
-				x++;
-			} 
-			if (run > 0)
-				while (run && x < oldimagewidth(in)) {
-					red[x] = r;
-					green[x] = g;
-					blue[x] = b;
-					run--;
-					x++;
-				}
-		}
-		break;
-	case OLDPIX_RLEA:
-		x = 0;
-		while (x < oldimagewidth(in)) {
-			if (run == 0) {
-				if ((i = oldreadbyte(in)) == EOF)
-					return(0);
-				run = i;
-				r = red[x] = oldreadbyte(in);
-				g = green[x] = oldreadbyte(in);
-				b = blue[x] = oldreadbyte(in);
-				oldreadbyte(in);
-				x++;
-			} 
-			if (run > 0)
-				while (run && x < oldimagewidth(in)) {
-					red[x] = r;
-					green[x] = g;
-					blue[x] = b;
-					run--;
-					x++;
-				}
-		}
-		break;
-	case OLDPIX_MIX:
-		x = 0;
-		while (x < oldimagewidth(in)) {
-			if ((run & 0x7f) == 0) {
-				if ((i = oldreadbyte(in)) == EOF)
-					return(0);
-				run = i;
-			} 
-			if (run & 0x80) {
-				while ((run & 0x7f) && x < oldimagewidth(in)) {
-					red[x] = oldreadbyte(in);
-					green[x] = oldreadbyte(in);
-					blue[x] = oldreadbyte(in);
-					run--;
-					x++;
-				}
-			} else {
-				r = red[x] = oldreadbyte(in);
-				g = green[x] = oldreadbyte(in);
-				b = blue[x] = oldreadbyte(in);
-				x++;
-				while (run && x < oldimagewidth(in)) {
-					red[x] = r;
-					green[x] = g;
-					blue[x] = b;
-					run--;
-					x++;
-				}
-			}
-		}
-		break;
-	case OLDPIX_MIXA:
-		x = 0;
-		while (x < oldimagewidth(in)) {
-			if (run == 0) {
-				if ((i = oldreadbyte(in)) == EOF)
-					return(0);
-				run = i;
-			} 
-			if (run & 0x80) {
-				while ((run & 0x7f) && x < oldimagewidth(in)) {
-					red[x] = oldreadbyte(in);
-					green[x] = oldreadbyte(in);
-					blue[x] = oldreadbyte(in);
-					oldreadbyte(in);
-					run--;
-					x++;
-				}
-			} else {
-				r = red[x] = oldreadbyte(in);
-				g = green[x] = oldreadbyte(in);
-				b = blue[x] = oldreadbyte(in);
-				oldreadbyte(in);
-				x++;
-				while (run && x < oldimagewidth(in)) {
-					red[x] = r;
-					green[x] = g;
-					blue[x] = b;
-					run--;
-					x++;
-				}
-			}
-		}
-		break;
-	default:
-		fprintf(stderr, "oldreadrgbline: bad file format.\n");
-		return(0);
-	}
-
-	return(1);
-}
-
-/*
- * oldreadrgbaline
- *
- *	reads in a scanline from file in and puts the scanline into red, green,
- * blue, and alpha.
- */
-int
-oldreadrgbaline(in, red, green, blue, alpha)
-	oldimage		*in;
-	unsigned char	*red, *green, *blue, *alpha;
-{
-	register int	x, i;
-	unsigned char	r, g, b, a, run = 0;
-
-	switch (oldimagetype(in)) {
-	case OLDPIX_CMAP:
-		for (x = 0; x < oldimagewidth(in); x++) {
-			if ((i = oldreadbyte(in)) == EOF)
-				return(0);
-			red[x] = in->red[i];
-			green[x] = in->green[i];
-			blue[x] = in->blue[i];
-			alpha[x] = 255;
-		}
-		break;
-	case OLDPIX_RLECMAP:
-		x = 0;
-		while (x < oldimagewidth(in)) {
-			if ((i = oldreadbyte(in)) == EOF)
-				return(0);
-			run = i;
-			if ((i = oldreadbyte(in)) == EOF)
-				return(0);
-			do {
-				red[x] = in->red[i];
-				green[x] = in->green[i];
-				blue[x++] = in->blue[i];
-				alpha[x] = 255;
-			} while (--run != 255);
-		}
-		break;
-	case OLDPIX_RGB:
-		for (x = 0; x < oldimagewidth(in); x++) {
-			if ((i = oldreadbyte(in)) == EOF)
-				return(0);
-			red[x] = i;
-			green[x] = oldreadbyte(in);
-			blue[x] = oldreadbyte(in);
-			alpha[x] = 255;
-		}
-		break;
-	case OLDPIX_RGBA:
-		for (x = 0; x < oldimagewidth(in); x++) {
-			if ((i = oldreadbyte(in)) == EOF)
-				return(0);
-			red[x] = i;
-			green[x] = oldreadbyte(in);
-			blue[x] = oldreadbyte(in);
-			alpha[x] = oldreadbyte(in);
-		}
-		break;
-	case OLDPIX_RLE:
-		x = 0;
-		while (x < oldimagewidth(in)) {
-			if (run == 0) {
-				if ((i = oldreadbyte(in)) == EOF)
-					return(0);
-				run = i;
-
-				r = red[x] = oldreadbyte(in);
-				g = green[x] = oldreadbyte(in);
-				b = blue[x] = oldreadbyte(in);
-
-				x++;
-			} 
-			if (run > 0)
-				while (run && x < oldimagewidth(in)) {
-					red[x] = r;
-					green[x] = g;
-					blue[x] = b;
-					alpha[x] = 255;
-					run--;
-					x++;
-				}
-		}
-		break;
-	case OLDPIX_RLEA:
-		x = 0;
-		while (x < oldimagewidth(in)) {
-			if (run == 0) {
-				if ((i = oldreadbyte(in)) == EOF)
-					return(0);
-				run = i;
-				r = red[x] = oldreadbyte(in);
-				g = green[x] = oldreadbyte(in);
-				b = blue[x] = oldreadbyte(in);
-				a = alpha[x] = oldreadbyte(in);
-				x++;
-			} 
-			if (run > 0)
-				while (run && x < oldimagewidth(in)) {
-					red[x] = r;
-					green[x] = g;
-					blue[x] = b;
-					alpha[x] = a;
-					run--;
-					x++;
-				}
-		}
-		break;
-	case OLDPIX_MIX:
-		x = 0;
-		while (x < oldimagewidth(in)) {
-			if ((run & 0x7f) == 0) {
-				if ((i = oldreadbyte(in)) == EOF)
-					return(0);
-				run = i;
-			} 
-			if (run & 0x80) {
-				while ((run & 0x7f) && x < oldimagewidth(in)) {
-					red[x] = oldreadbyte(in);
-					green[x] = oldreadbyte(in);
-					blue[x] = oldreadbyte(in);
-					alpha[x] = 255;
-					run--;
-					x++;
-				}
-			} else {
-				r = red[x] = oldreadbyte(in);
-				g = green[x] = oldreadbyte(in);
-				b = blue[x] = oldreadbyte(in);
-				x++;
-				while (run && x < oldimagewidth(in)) {
-					red[x] = r;
-					green[x] = g;
-					blue[x] = b;
-					alpha[x] = 255;
-					run--;
-					x++;
-				}
-			}
-		}
-		break;
-	case OLDPIX_MIXA:
-		x = 0;
-		while (x < oldimagewidth(in)) {
-			if (run == 0) {
-				if ((i = oldreadbyte(in)) == EOF)
-					return(0);
-				run = i;
-			} 
-			if (run & 0x80) {
-				while ((run & 0x7f) && x < oldimagewidth(in)) {
-					red[x] = oldreadbyte(in);
-					green[x] = oldreadbyte(in);
-					blue[x] = oldreadbyte(in);
-					alpha[x] = oldreadbyte(in);
-					oldreadbyte(in);
-					run--;
-					x++;
-				}
-			} else {
-				r = red[x] = oldreadbyte(in);
-				g = green[x] = oldreadbyte(in);
-				b = blue[x] = oldreadbyte(in);
-				a = alpha[x] = oldreadbyte(in);
-				oldreadbyte(in);
-				x++;
-				while (run && x < oldimagewidth(in)) {
-					red[x] = r;
-					green[x] = g;
-					blue[x] = b;
-					alpha[x] = a;
-					run--;
-					x++;
-				}
-			}
-		}
-		break;
-	default:
-		fprintf(stderr, "oldreadrgbaline: bad file format.\n");
-		return(0);
-	}
-
-	return(1);
-}
-
-/*
- * oldreadmappedline
- *
- *	reads in a scanline for a colour mapped image as the
- * colourmap indexes.
- */
-int
-oldreadmappedline(in, line)
-	oldimage	*in;
-	unsigned char	*line;
-{
-	char		alpha;
-	register int	x, i;
-	unsigned char	run = 0;
-
-	switch (oldimagetype(in)) {
-	case OLDPIX_CMAP:
-		for (x = 0; x < oldimagewidth(in); x++) {
-			if ((i = oldreadbyte(in)) == EOF)
-				return(0);
-			line[x] = i;
-		}
-		break;
-	case OLDPIX_RLECMAP:
-		x = 0;
-		while (x < oldimagewidth(in)) {
-			if ((i = oldreadbyte(in)) == EOF)
-				return(0);
-			run = i;
-			if ((i = oldreadbyte(in)) == EOF)
-				return(0);
-			do
-				line[x++] = i;
-			while (--run != 255);
-		}
-		break;
-	default:
-		fprintf(stderr, "oldreadmappedline: bad file format.\n");
-		return(0);
-	}
-
-	return(1);
-}
diff -Nrua vort-old/old/oldvort.h vort-new/old/oldvort.h
--- vort-old/old/oldvort.h	1990-02-19 03:33:54.000000000 -0500
+++ vort-new/old/oldvort.h	1969-12-31 19:00:00.000000000 -0500
@@ -1,135 +0,0 @@
-/*
- * header details for pixel files
- */
-#define	_BASE		0xffff0000	/* base of magic number */
-
-/*
- * format types
- */
-#define	_FLAT		0x0000		/* straight rasters */
-#define	_RUN_LENGTH	0x1000		/* run-length encoded file */
-#define _COLOUR_MAP	0x2000		/* colour mapped image */
-#define	_MIXED		0x4000		/* mixture of runs and straights */
-
-/*
- * limits
- */
-#define	OLDPIX_MAXRUN	255		/* max run in run-length encoded */
-
-/*
- * channel types
- */
-#define	_R		0x0100		/* red channel */
-#define	_G		0x0200		/* green channel */
-#define	_B		0x0400		/* blue channel */
-#define	_A		0x0800		/* alpha channel */
-
-/*
- * magic numbers and their format structures
- *	- type order is the same as byte order
- */
-#define	OLDPIX_RGB	(_BASE | _R | _G | _B)
-#define	OLDPIX_RLE	(_BASE | _RUN_LENGTH | _R | _G | _B)
-#define	OLDPIX_MIX	(_BASE | _MIXED | _R | _G | _B)
-#define	OLDPIX_RGBA	(_BASE | _R | _G | _B | _A)
-#define	OLDPIX_RLEA	(_BASE | _RUN_LENGTH | _R | _G | _B | _A)
-#define	OLDPIX_MIXA	(_BASE | _MIXED | _R | _G | _B | _A)
-
-/*
- * colour map type - currently max size 256 so each pixel is a single byte index
- */
-#define	OLDPIX_CMAP	(_BASE | _COLOUR_MAP | _R | _G | _B)
-#define	OLDPIX_RLECMAP	(_BASE | _COLOUR_MAP | _RUN_LENGTH | _R | _G | _B)
-
-/*
- * file name suffix
- */
-#define	OLDPIX_SUFFIX	".pix"
-
-/*
- * header format
- *
- *	note: 1. if the title field is non zero the title follows the header.
- *	      2. if the type is colour-mapped the size of the colour map,
- *		 and the colourmap follows the title.
- */
-#ifdef PC
-typedef struct __h {
-	long		magic;		/* magic number */
-	float		rw, rh;		/* width and height in real values */
-	unsigned short	pw, ph;		/* width and height in pixels */
-	long		date;		/* date created (secs from 1/1/1970) */
-	long		tlength;	/* length of title */
-} pixhdr;
-#else
-typedef struct __h {
-	int		magic;		/* magic number */
-	float		rw, rh;		/* width and height in real values */
-	unsigned short	pw, ph;		/* width and height in pixels */
-	long		date;		/* date created (secs from 1/1/1970) */
-	int		tlength;	/* length of title */
-} pixhdr;
-#endif
-
-/*
- * image structure details
- */
-
-#define	IBUF_SIZE	4096			/* size of image buffer */
-
-typedef struct __oi {
-	int		fd;			/* file descriptor */
-	int		reading;		/* are we open for reading? */
-	int		written;		/* written to the file? */
-	pixhdr		hdr;			/* header details */
-	char		*title;			/* image title */
-	unsigned char	run,			/* current position in run */
-			r, g, b, a;		/* current pixel */
-	unsigned char	ibuf[IBUF_SIZE];	/* current scanline buffer */
-	unsigned char	*ibufp;			/* pointer to buffer position */
-	unsigned char	*ebufp;			/* pointer to end of buffer */
-	unsigned short	mapsize;
-	unsigned char	*red, *green, *blue;	/* colour map details */
-} oldimage;
-
-/*
- * macros for checking and setting the type from the magic number
- */
-#define	oldimagetype(a)		(a)->hdr.magic
-
-#define	oldalphachannel(a)		((a)->hdr.magic & _A)
-
-#define oldcolormapped(a)		((a)->hdr.magic & _COLOUR_MAP)
-
-#define oldrlecoded(a)		((a)->hdr.magic & _RUN_LENGTH)
-#define	oldmixcoded(a)		((a)->hdr.magic & _MIXED)
-
-/*
- * image processing functions
- */
-extern oldimage	*oldopenimage();
-extern int	oldreadrgbline(), oldwritergbline();
-extern int	oldreadrgbaline(), oldwritergbaline();
-
-/*
- * general macros for getting access to image details
- */
-#define	oldimagewidth(a)	(a)->hdr.pw
-#define	oldimageheight(a)	(a)->hdr.ph
-
-#define	oldimagexsize(a)	(a)->hdr.rw
-#define	oldimageysize(a)	(a)->hdr.rh
-
-#define	oldimagedate(a)	(a)->hdr.date
-
-#define	oldimagefile(a)	(a)->fd
-
-#define	oldimagetitle(a)	(a)->title
-#define	oldtitlelength(a)	(a)->hdr.tlength
-
-#define	oldcmapsize(a)	(a)->mapsize
-
-#define	oldredmap(a)	(a)->red
-#define	oldgreenmap(a)	(a)->green
-#define	oldbluemap(a)	(a)->blue
-
diff -Nrua vort-old/old/README vort-new/old/README
--- vort-old/old/README	1990-02-19 04:32:26.000000000 -0500
+++ vort-new/old/README	1969-12-31 19:00:00.000000000 -0500
@@ -1,13 +0,0 @@
-
-This directory contains a program for converting vort 1.0 images
-into vort 1.1 images. To compile it type make, and to run it
-type:
-	conv oldvortfilename newvortfilename
-
-It is a little slow as it has been designed to minimise on the
-memory it requires, and it is designed to be thrown away. As an
-added encouragement images in the new format are smaller (10%
-on average) than the old one and have the added advantage of
-being byteorder independant.
-
-You'd have thought I'd have known better...
diff -Nrua vort-old/pc/320x200.asm vort-new/pc/320x200.asm
--- vort-old/pc/320x200.asm	1992-05-25 21:10:27.000000000 -0400
+++ vort-new/pc/320x200.asm	1969-12-31 19:00:00.000000000 -0500
@@ -1,205 +0,0 @@
-		NAME	V320x200
-		TITLE	Standard VGA - 320 x 200 image display.
-		PAGE	132,60
-
-		.MODEL	LARGE,C
-
-		EXTRN	EMS_base:PROC
-		EXTRN	EMS_map:PROC
-
-
-VideoBufferSeg	=   	0A000H
-
-
-GetEMSByte	MACRO	hdl, pag	;; Get next byte from EMS (remapping afterwards if required)
-		local	blark
-		lodsb			;; Get byte from DS:SI
-		test	si,4000H	;; Check if we've got to the end of the page
-		jz	blark
-		inc	(pag)		;; Next page number
-		push	ax
-		mov	ax,(pag)
-		push	ax
-		mov	ax,(hdl)
-		push	ax
-		call	EMS_map
-		add	sp,4
-		pop	ax
-		mov	si,base_ofs
-blark:
-		ENDM
-
-
-		.CODE
-
-
-		SUBTTL	vga320x200_decodeEMS
-		PAGE
-
-		COMMENT	$
-
-Name:		vga320x200_decodeEMS
-
-Function:	Decodes a VORT run-length encoded colour mapped image
-		from EMS memory to PVGA front or back image buffer.
-
-Caller:		Microsoft C
-
-		void	vga320x200_decodeEMS(EMS_h, EMS_ofs, x, y, xlen, ylen)
-		UINT	EMS_h;			/* EMS handle */
-		ULONG	EMS_ofs;		/* linear offset with EMS pages */
-		int	x, y, xlen, ylen;	/* position and size */
-
-		$
-
-
-public vga320x200_EMSdecode
-vga320x200_EMSdecode	proc	uses di si ds es, EMS_h:WORD, EMS_ofs:DWORD, x:WORD, y:WORD, xlen:WORD, ylen:WORD
-		LOCAL	j:WORD
-		LOCAL	i:WORD
-		LOCAL	pg:WORD
-		LOCAL	base_ofs:WORD
-		LOCAL	len_l:WORD
-		LOCAL	len_h:WORD
-
-		call	EMS_base	; Get address of page frame into DX:AX
-		push	dx		; Save segment part of EMS base addr
-		mov	si,ax		; Setup DS:SI with source data pointer
-		mov	base_ofs,ax	; Save offset for later reference
-
-					; Calculate page # and page offset
-		mov	ax,WORD PTR (EMS_ofs)
-		mov	dx,WORD PTR (EMS_ofs+2)
-		mov	bx,ax
-		and	bx,03FFFH	; Lower 14 bits are offset into page
-		add	si,bx
-		rcl	ax,1		; Upper 18 bits is page 
-		rcl	dx,1
-		rcl	ax,1
-		rcl	dx,1
-		mov	pg,dx
-		push	dx
-		mov	ax,EMS_h	; Map in starting page
-		push	ax
-		call	EMS_map		; Map in EMS page (we presume no errors)
-		add	sp,4
-
-		mov	ax,ylen		; Width of image
-		mov	j,ax
-
-		mov	ax,320		; Calc starting buffer offset of destination
-		mul	y
-		add	ax,x
-		adc	dx,0		; dx:ax = y*320 + x;
-		mov	di,ax
-		mov	ax,VideoBufferSeg
-		mov	es,ax		; Video offset is ES:DI
-
-decode_it:
-		pop	ds		; Load EMS base address segment
-		mov	ch,0		; Zap high byte of repeat counter
-
-		GetEMSByte EMS_h, pg	; Load 4 byte image length value (one byte at a time)
-		mov	ah,al
-		GetEMSByte EMS_h, pg
-		xchg	ah,al
-		mov	len_l,ax	; Save LSB
-
-		GetEMSByte EMS_h, pg
-		mov	ah,al
-		GetEMSByte EMS_h, pg
-		xchg	ah,al
-		mov	len_h,ax	; Save MSB
-
-decode_1:
-		cmp	len_l,0
-		jnz	bloot2		; Continue if not zero
-		cmp	len_h,0
-		jnz	bloot2
-		jmp	decode_x	; Exit if no more bytes in image
-bloot2:
-		mov	bx,xlen		; X width
-		push	di		; Save destination offset
-
-decode_2:
-		cmp	bx,0
-		jnz	decode_2_1
-		jmp	decode_10	; JIF finished this row
-decode_2_1:
-		; Put in a test for LEN_L == 0 ???
-		sub	len_l,1		; One less byte in the image data
-		jnc	bloot3
-		dec	len_h
-bloot3:
-		GetEMSByte EMS_h, pg	; Get next byte (rnnnnnnn)
-		mov	cl,al		; Run length (?nnnnnnn)
-		test	al,80H		; Test top bit (r???????)
-		jnz	decode_3	; JIF top bit set
-
-		inc	cx		; Run of 0 bytes is actually a run of 1 byte
-					; Set next "run" bytes of image to *(DS:SI)
-		sub	bx,cx		; Calc bytes remaining on this row
-		sub	len_l,1		; One less byte in the image data
-		jnc	bloot4
-		dec	len_h
-bloot4:
-		GetEMSByte EMS_h, pg	; Get value to replicate
-		rep	stosb		; Replicate
-		jmp	short decode_2	; Go for next bit of encoded image
-
-decode_3:
-		and	cl,07FH		; Zap top bit - make run length
-		sub	bx,cx		; Calc bytes remaining on this row
-		sub	len_l,cx	; Bytes remaining in image
-		jnc	bloot5
-		dec	len_h
-bloot5:
-		push	dx		; CX is bytes to copy - ensure we don't run over end of EMS page
-		mov	dx,si
-		add	dx,cx
-		test	dx,04000H
-		jz	decode_4	; JIF run will fit into current EMS page
-					; We will run over into next page
-		sub	dx,4000H	; # bytes into next page
-		mov	cx,4000H	; # bytes to end of current page
-		sub	cx,si
-		jcxz	bloot6
-		rep	movsb		; Copy the bytes
-bloot6:
-		mov	cx,dx		; Remainder to copy
-		mov	si,base_ofs	; Start at beginning of new page
-		push	cx
-		push	es
-		push	di
-		inc	pg		; Map in next EMS page
-		mov	ax,pg
-		push	ax
-		mov	ax,EMS_h
-		push	ax
-		call	EMS_map
-		add	sp,4
-		pop	di
-		pop	es
-		pop	cx
-decode_4:
-		pop	dx
-		jcxz	bloot7		; Test for safety sake
-		rep	movsb		; Copy bytes in image to video buffer
-bloot7:
-		jmp	decode_2	; Go for next bit of encoded image
-
-decode_10:				; End of image line
-		dec	j		; One less row
-		; Test for j == 0 here ?
-		pop	di		; Restore start of destination line we've just done
-		add	di,320		; Next video buffer line
-		jmp	decode_1
-
-decode_x:
-		ret
-
-vga320x200_EMSdecode	endp
-
-
-		end
-
diff -Nrua vort-old/pc/320x400.asm vort-new/pc/320x400.asm
--- vort-old/pc/320x400.asm	1992-05-25 21:10:27.000000000 -0400
+++ vort-new/pc/320x400.asm	1969-12-31 19:00:00.000000000 -0500
@@ -1,285 +0,0 @@
-		name	V320x400
-		title	Standard VGA - 320 x 400 image display.
-		page	132,60
-
-
-		.model	LARGE,c
-
-;==============================================================
-;
-; These routines (with minor changes) are from the column:
-;
-;	"On Graphics", in the Programmer's Journal, by Micheal Abrash.
-;
-; The text:
-;
-;	"Power Graphics Programming" by Micheal Abrash,
-;	Que Corporation (Carmel, Indiana), 1989.
-;
-; is a collection of articles from the "On graphics" column in the
-; Programmer's Journal and contains lots of useful info on EGAs and VGAs.
-;
-
-VGA_SEGMENT	equ	0a000h
-SC_INDEX	equ	3c4h	;Sequence Controller Index register
-GC_INDEX	equ	3ceh	;Graphics Controller Index register
-CRTC_INDEX	equ	3d4h	;CRT Controller Index register
-MAP_MASK	equ	2	;Map Mask register index in SC
-MEMORY_MODE	equ	4	;Memory Mode register index in SC
-MAX_SCAN_LINE	equ	9	;Maximum Scan Line reg index in CRTC
-START_ADDRESS_HIGH equ	0ch	;Start Address High reg index in CRTC
-UNDERLINE	equ	14h	;Underline Location reg index in CRTC
-MODE_CONTROL	equ	17h	;Mode Control register index in CRTC
-GRAPHICS_MODE	equ	5	;Graphics Mode register index in GC
-MISCELLANEOUS	equ	6	;Miscellaneous register index in GC
-SCREEN_WIDTH	equ	320	;# of pixels across screen
-SCREEN_HEIGHT	equ	400	;# of scan lines on screen
-WORD_OUTS_OK	equ	1	;set to 0 to assemble for
-				; computers that can't handle
-				; word outs to indexed VGA registers
-
-
-;
-; Macro to output a word value to a port.
-;
-OUT_WORD	macro
-if WORD_OUTS_OK
-	out	dx,ax
-else
-	out	dx,al
-	inc	dx
-	xchg	ah,al
-	out	dx,al
-	dec	dx
-	xchg	ah,al
-endif
-	endm
-
-
-;
-; Macro to output a constant value to an indexed VGA register.
-;
-CONSTANT_TO_INDEXED_REGISTER	macro	ADDRESS, INDEX, VALUE
-	mov	dx,ADDRESS
-	mov	ax,(VALUE shl 8) + INDEX
-	OUT_WORD
-	endm
-
-
-		.code stuff
-
-
-
-;=================================================
-; Sets up 320x400 256-color modes.
-;
-; Input: none
-;
-; Output: none
-;
-;=================================================
-
-public Set320x400Mode
-Set320x400Mode	proc	uses di es
-
-;
-; First, go to normal 320x200 256-color mode, which is really a
-; 320x400 256-color mode with each line scanned twice.
-;
-	mov	ax,0013h  ;AH = 0 means mode set, AL = 13h selects
-			; 256-color graphics mode
-	int	10h	;BIOS video interrupt
-;
-; Change CPU addressing of video memory to linear (not odd/even,
-; chain, or chain 4), to allow us to access all 256K of display
-; memory. When this is done, VGA memory will look just like memory
-; in modes 10h and 12h, except that each byte of display memory will
-; control one 256-color pixel, with 4 adjacent pixels at any given
-; address, one pixel per plane.
-;
-	mov	dx,SC_INDEX
-	mov	al,MEMORY_MODE
-	out	dx,al
-	inc	dx
-	in	al,dx
-	and	al,not 08h	;turn off chain 4
-	or	al,04h		;turn off odd/even
-	out	dx,al
-	mov	dx,GC_INDEX
-	mov	al,GRAPHICS_MODE
-	out	dx,al
-	inc	dx
-	in	al,dx
-	and	al,not 10h	;turn off odd/even
-	out	dx,al
-	dec	dx
-	mov	al,MISCELLANEOUS
-	out	dx,al
-	inc	dx
-	in	al,dx
-	and	al,not 02h	;turn off chain
-	out	dx,al
-;
-; Now clear the whole screen, since the mode 13h mode set only
-; cleared 64K out of the 256K of display memory. Do this before
-; we switch the CRTC out of mode 13h, so we don't see garbage
-; on the screen when we make the switch.
-;
-	CONSTANT_TO_INDEXED_REGISTER SC_INDEX,MAP_MASK,0fh
-				;enable writes to all planes, so
-				; we can clear 4 pixels at a time
-	mov	ax,VGA_SEGMENT
-	mov	es,ax
-	sub	di,di
-	mov	ax,di
-	mov	cx,8000h	;# of words in 64K
-	cld
-	rep	stosw		;clear all of display memory
-;
-; Tweak the mode to 320x400 256-color mode by not scanning each
-; line twice.
-;
-	mov	dx,CRTC_INDEX
-	mov	al,MAX_SCAN_LINE
-	out	dx,al
-	inc	dx
-	in	al,dx
-	and	al,not 1fh	;set maximum scan line = 0
-	out	dx,al
-	dec	dx
-;
-; Change CRTC scanning from doubleword mode to byte mode, allowing
-; the CRTC to scan more than 64K of video data.
-;
-	mov	al,UNDERLINE
-	out	dx,al
-	inc	dx
-	in	al,dx
-	and	al,not 40h	;turn off doubleword
-	out	dx,al
-	dec	dx
-	mov	al,MODE_CONTROL
-	out	dx,al
-	inc	dx
-	in	al,dx
-	or	al,40h	;turn on the byte mode bit, so memory is
-			; scanned for video data in a purely
-			; linear way, just as in modes 10h and 12h
-	out	dx,al
-	xor	ax,ax
-	ret
-Set320x400Mode	endp
-
-
-
-;=================================================
-; Displays page 0 or 1 of the video buffer.
-;
-; Input:
-;	pg:	== 0 - page 0
-;		!= 0 - page 1
-;
-; Output: none
-;
-;=================================================
-
-public page320x400
-page320x400	proc	uses si di ds es, pg:word
-		cmp	pg,0
-		jz	Page320x400_1
-				; Set the Start Address High register
-				; to 80h, for a start address of 8000h
-		CONSTANT_TO_INDEXED_REGISTER CRTC_INDEX,START_ADDRESS_HIGH,80h
-		jmp	short Page320x400_2
-Page320x400_1:
-				; Set the Start Address High register
-				; to 00h, for a start address of 0000h
-		CONSTANT_TO_INDEXED_REGISTER CRTC_INDEX,START_ADDRESS_HIGH,00h
-Page320x400_2:
-		ret
-page320x400	endp
-
-
-
-;=================================================
-; Outputs a line to the video buffer.
-;
-; Input:
-;	line:	y co-ord
-;	l:	pointer to line
-;	len:	number of bytes to output
-;	pg:	== 0 - page 0
-;		!= 0 - page 1
-;
-; Output: none
-;
-;=================================================
-
-public Out320x400Line
-Out320x400Line	proc	uses si di ds es, line:word, l:ptr, len:word, pg:word
-
-		mov	ax,VGA_SEGMENT
-		mov	es,ax
-		mov	ax,line
-		mov	dx,80
-		mul	dx
-		mov	di,ax
-		cmp	pg,0
-		jz	UsePage0
-		add	di,8000H		; Use page 1 (starts at offset 8000H)
-UsePage0:
-		if	@datasize
-		 lds	si,l
-		else
-		 mov	si,l
-		endif
-
-		mov	dx,SC_INDEX
-		mov	al,MAP_MASK
-		out	dx,al
-		inc	dx
-
-		mov	cx,len
-		push	cx
-
-		shr	cx,1
-		shr	cx,1
-		mov	ah,1
-next_plane:
-		push	cx
-		push	di
-		xor	bx,bx
-
-		mov	al,ah		; Select plane
-		out	dx,al
-
-out_line:				; Output all bytes in line for this plane
-		mov	al,ds:[si+bx]
-		mov	es:[di],al
-		inc	di
-		add	bx,4
-		loop	out_line
-
-		pop	di
-		pop	cx
-
-		inc	si
-
-		shl	ah,1
-		cmp	ah,16
-		jne	next_plane
-
-		pop	cx
-		xor	ax,ax
-		ret
-Out320x400Line	endp
-
-
-
-
-Stuff		ends
-
-
-
-		end
-
diff -Nrua vort-old/pc/errs vort-new/pc/errs
--- vort-old/pc/errs	1992-05-25 21:10:27.000000000 -0400
+++ vort-new/pc/errs	1969-12-31 19:00:00.000000000 -0500
@@ -1,39 +0,0 @@
-MAKE  Version 3.5  Copyright (c) 1991 Borland International
-
-Available memory 423536 bytes
-
-	tasm -mx supavga
-Turbo Assembler  Version 2.51  Copyright (c) 1988, 1991 Borland International
-
-Assembling file:   supavga.ASM
-Error messages:    None
-Warning messages:  None
-Passes:            1
-Remaining memory:  255k
-
-	bcc -epcdisp.exe @tlink.in ..\lib\vort.lib
-Borland C++  Version 2.0 Copyright (c) 1991 Borland International
-Turbo Link  Version 4.0 Copyright (c) 1991 Borland International
-Error: Undefined symbol _lmemmove in module pcdisp.c
-Error: Undefined symbol _vga320x200_EMSdecode in module pcdspvg1.c
-Error: Undefined symbol _page320x400 in module pcdspvg2.c
-Error: Undefined symbol _Out320x400Line in module pcdspvg2.c
-Error: Undefined symbol _Set320x400Mode in module pcdspvg2.c
-Error: Undefined symbol _tseng_bank in module supavgac.c
-Error: Undefined symbol _ati_bank in module supavgac.c
-Error: Undefined symbol _aheadb_bank in module supavgac.c
-Error: Undefined symbol _aheada_bank in module supavgac.c
-Error: Undefined symbol _chips_bank in module supavgac.c
-Error: Undefined symbol _everex_bank in module supavgac.c
-Error: Undefined symbol _paradise_bank in module supavgac.c
-Error: Undefined symbol _trident_bank in module supavgac.c
-Error: Undefined symbol _svga_putline in module supavgac.c
-Error: Undefined symbol _tseng4_bank in module supavgac.c
-Error: Undefined symbol _oaktech_bank in module supavgac.c
-Error: Undefined symbol _video7_bank in module supavgac.c
-Error: Undefined symbol _svga_getline in module supavgac.c
-Error: Undefined symbol _svga_EMSdecode in module supavgac.c
-
-	Available memory 305184
-
-** error 1 ** deleting pcdisp.exe
diff -Nrua vort-old/pc/extra.asm vort-new/pc/extra.asm
--- vort-old/pc/extra.asm	1992-05-25 21:10:27.000000000 -0400
+++ vort-new/pc/extra.asm	1969-12-31 19:00:00.000000000 -0500
@@ -1,101 +0,0 @@
-;       Extra segment management
-;
-;       toextra()
-;       fromextra()
-;       cmpextra()
-;
-
-        .MODEL  medium,c
-
-        .8086
-
-.DATA
-
-; ************************ External variables *****************************
-
-; ************************ Public variables *****************************
-
-public          extraseg                ; extra 64K segment, if any
-
-;               arrays declared here, used elsewhere
-
-public          strlocn, entrynum, teststring   ; used by the Encoder
-
-; ************************* "Shared" array areas **************************
-
-strlocn         db      8192 dup(0)     ; 8K Encoder array
-
-entrynum        db      8192 dup(0)     ; 8K Encoder array
-
-teststring      db      100  dup(0)     ; 100 byte Encoder array
-
-; ************************ Internal variables *****************************
-
-extraseg        dw      0               ; extra 64K segment (allocated by init)
-
-
-.CODE
-
-; *************** Function toextra(tooffset,fromaddr, fromcount) *********
-
-public toextra
-toextra proc    uses es di si, tooffset:word, fromaddr:word, fromcount:word
-        cmp     extraseg,0              ; IS there extra memory?
-        je      tobad                   ;  nope.  too bad.
-        cld                             ; move forward
-        mov     ax,extraseg             ; load ES == extra segment
-        mov     es,ax                   ;  ..
-        mov     di,tooffset             ; load to here
-        mov     si,fromaddr             ; load from here
-        mov     cx,fromcount            ; this many bytes
-        rep     movsb                   ; do it.
-tobad:
-        ret                             ; we done.
-toextra endp
-
-
-; *************** Function fromextra(fromoffset, toaddr, tocount) *********
-
-public fromextra
-fromextra proc  uses es di si, fromoffset:word, toaddr:word, tocount:word
-        push    ds                      ; save DS for a tad
-        pop     es                      ; restore it to ES
-        cmp     extraseg,0              ; IS there extra memory?
-        je      frombad                 ;  nope.  too bad.
-        cld                             ; move forward
-        mov     ax,extraseg             ; load DS == extra segment
-        mov     ds,ax                   ;  ..
-        mov     si,fromoffset           ; load from here
-        mov     di,toaddr               ; load to here
-        mov     cx,tocount              ; this many bytes
-        rep     movsb                   ; do it.
-frombad:
-        push    es                      ; save ES again.
-        pop     ds                      ; restore DS
-        ret                             ; we done.
-fromextra endp
-
-
-; *************** Function cmpextra(cmpoffset,cmpaddr, cmpcount) *********
-
-public cmpextra
-cmpextra proc   uses es di si, cmpoffset:word, cmpaddr:word, cmpcount:word
-        cmp     extraseg,0              ; IS there extra memory?
-        je      cmpbad                  ;  nope.  too bad.
-        cld                             ; move forward
-        mov     ax,extraseg             ; load ES == extra segment
-        mov     es,ax                   ;  ..
-        mov     di,cmpoffset            ; load to here
-        mov     si,cmpaddr              ; load from here
-        mov     cx,cmpcount             ; this many bytes
-        rep     cmpsb                   ; do it.
-        jnz     cmpbad                  ; failed.
-        mov     ax,0                    ; 0 == true
-        jmp     cmpend
-cmpbad:
-        mov     ax,1                    ; 1 == false
-cmpend:
-        ret                             ; we done.
-cmpextra        endp
-
-        end
diff -Nrua vort-old/pc/extra.h vort-new/pc/extra.h
--- vort-old/pc/extra.h	1992-05-25 21:10:27.000000000 -0400
+++ vort-new/pc/extra.h	1969-12-31 19:00:00.000000000 -0500
@@ -1,6 +0,0 @@
-/* funcion prototypes for extra.obj */
-extern int extraseg;
-
-extern void toextra(int, unsigned char *, int);
-extern void fromextra(int, unsigned char *, int);
-extern int  cmpextra(int, unsigned char *, int);
diff -Nrua vort-old/pc/fgraph.h vort-new/pc/fgraph.h
--- vort-old/pc/fgraph.h	1992-05-25 21:10:28.000000000 -0400
+++ vort-new/pc/fgraph.h	1969-12-31 19:00:00.000000000 -0500
@@ -1,74 +0,0 @@
-/* include for fractint graphics routines */
-
-/* MEDIUM MEMORY MODEL, must be re-created for other modes */
-
-struct videoinfo {              /* All we need to know about a Video Adapter */
-        char    name[26];       /* Adapter name (IBM EGA, etc)          */
-        char    comment[26];    /* Comments (UNTESTED, etc)             */
-        int     videomodeax;    /* begin with INT 10H, AX=(this)        */
-        int     videomodebx;    /*              ...and BX=(this)        */
-        int     videomodecx;    /*              ...and CX=(this)        */
-        int     videomodedx;    /*              ...and DX=(this)        */
-                                /* NOTE:  IF AX==BX==CX==0, SEE BELOW   */
-        int     dotmode;        /* video access method used by asm code */
-                                /*      1 == BIOS 10H, AH=12,13 (SLOW)  */
-                                /*      2 == access like EGA/VGA        */
-                                /*      3 == access like MCGA           */
-                                /*      4 == Tseng-like  SuperVGA*256   */
-                                /*      5 == P'dise-like SuperVGA*256   */
-                                /*      6 == Vega-like   SuperVGA*256   */
-                                /*      7 == "Tweaked" IBM-VGA ...*256  */
-                                /*      8 == "Tweaked" SuperVGA ...*256 */
-                                /*      9 == Targa Format               */
-                                /*      10 = Hercules                   */
-                                /* NO!  11 = "disk video" (no screen)   */
-                                /*      12 = 8514/A                     */
-                                /*      13 = CGA 320x200x4, 640x200x2   */
-                                /*      14 = Tandy 1000                 */
-                                /*      15 = TRIDENT  SuperVGA*256      */
-                                /*      16 = Chips&Tech SuperVGA*256    */
-        int     xdots;          /* number of dots across the screen     */
-        int     ydots;          /* number of dots down the screen       */
-        int     colors;         /* number of colors available           */
-        };
-
-
-/* variables */
-
-extern  int     dotmode;                        /* video access method      */
-extern  int     oktoprint;                      /* 0 if printf() won't work */
-extern  int     xdots, ydots;                   /* # of dots on the screen  */
-extern  int     colors;                         /* maximum colors available */
-
-/* adapter names */
-#define settextmode() setvideomode(3, 0, 0, 0)
-#define IBMMCGA320200256 2
-#define TWKVGA360480256 10
-#define SUPVGA640400256 13
-#define SUPVGA640480256 14
-#define SUPVGA800600256 15
-#define SUPVGA1024768256 16
-#define SUPVGA12801024256 18
-#define IBM8514640480256 19
-#define IBM85141024768256 20
-
-/* functions */
-extern int  initvideotable(void);
-extern void fromvideotable(int);
-extern void tovideotable(int);
-extern void setvideomode(int, int, int, int);
-extern void storedac(void);
-extern void loaddac(void);
-extern int  getcolor(int, int);
-extern void putcolor(int, int, int);
-extern void out_line(unsigned char *, int);
-extern void get_line(int, int, int, unsigned char *);
-extern void put_line(int, int, int, unsigned char *);
-extern void putblock(int, int, int, int, int);
-
-extern unsigned char dacbox[256][3];    /* Video-DAC (filled in by SETVIDEO) */
-extern int rowcount;            /* row for out_line */
-
-extern struct videoinfo videoentry;
-
-extern int startgraphics(int);
diff -Nrua vort-old/pc/fgraph.lib vort-new/pc/fgraph.lib
--- vort-old/pc/fgraph.lib	1993-12-13 20:59:20.000000000 -0500
+++ vort-new/pc/fgraph.lib	1969-12-31 19:00:00.000000000 -0500
@@ -1,97 +0,0 @@
-  T           fr8514a.ASMN  fr8514a&  DGROUPDATACODE_DATAfr8514a_TEXT H- HM _ _xdots _ydots _dacbox T  _callafi   	_open8514N  	_w8514pal 	_do85open-  	_fr85rdotQ 	_fr85rbox 	_fr85wdot  	_fr85wbox 
-_close8514  _reopen8514  _getafi  /             R       > 	     L            
-                               
-                .< xO 
-Couldn't find the 8514/A interface
-(Maybe you forgot to load HDILOAD)
-$1  V  &5!tr	    P        DX    r[   =w
-  =w  D@\0   r5       ;  s  +      ;  s  +       	! L!  D1     "   V                       D  D    ^V      +6                       ^V                     D  D      ^V      +>                       ^          P;s  Q VWR6     Z       _^Y  X+u">
-%) 25	CJO  V^hu - z   -     ! '*-17;>DGMTZ` d hloux}    
-%k  t        
-hgcfra.ASM
-  hgcfraZ%  DGROUPDATACODE_DATAhgcfra_TEXT H H2 _V  _readhgc  _charhgc _linehgc  _inithgc   _termhgc  	_writehgcf  _setmd.  m    WV6     @  ^_WV 6     ^_UPSQ 2BJY 3XX]UWV~\}:~}3   v0FN~
- t&4& ^_]UWV   v0FN&t 3^_]UWV   F      3F
-+Fy
-  u  F+Fy    FN~ tG;F
-u;Nt9QP7YQ&0$XY }          +  ^_];F
-u;NtQP7YQ& $XY }          +  UWV   v
->  VF ?&CC^_]  .   ) . {      $ 2 8 o s w {            %   5-.[WW  aPR                ~~~~l|8 8||8 8|8|8|8||8|  <<   <fBBf< }x<fff<~?3?00pcccgZ<<Z >> <~~<fffff f { >c8ll8x    ~~~ <~~<<~ ~<     0``0       $ff$   <~   ~<          0xx00 0 lll     lllll 0|x0  0f 8l8vv ``     0```0 `00`  f<<f   0000       00`            00 0` || 0p0000 x8` x8x <l x 8`x 000 xxx x|p  00  00  00  00`0``0       `00` x0 0 |x 0x ff|ff <ff< lfffl bhxhb bhxh` <ff>  x00000x x flxlf ```bf   8ll8 ff|`` xx ff|lf xpx 0000x  x0  l88l x00x 2f x`````x `0 xx 8l           00       x|v ``|ff   xx |v   xx 8l```   v|`lvff 0 p000x  x`flxl p00000x         xx   ff|`  v|  vf`   |x 0|004   v   x0   l   l8l   |  0d 0000   0000 v       8l      @ `Z Z Z@Z`  @`!Aahh!hAha!Aa"Bbvv"vBvb"Bb**#*C*c#Cc#Cc88$8D8d$Dd$DdFF%FEFe%Ee%EeTT&TFTf&Ff'Ggbb'bGbg'Gg(Hhpp(pHph(Hh$	$)$I$i~	~)~I~i	)Ii2
-2*2J2j
-*Jj
-*Jj@@+@K@k+Kk+KkNN,NLNl,Ll-Mm\\-\M\m-Mm.Nnjj.jNjn.Nn/Ooxx/xOxo/Oo,,0,P,p0Pp0Pp::1:Q:q1Qq1QqHH2HRHr2Rr2RrVV3VSVs3Ss
-
-4
-T
-tdd4dTdt4Tt5Uurr5rUru5Uu&&6&V&v6Vv6Vv4474W4w7Ww7WwBB8BXBx8Xx8XxPP9PYPy9Yy:Zz^^:^Z^z:Zz;[{ll;l[l{;[{  < \ |zz<z\z|<\|..=.].}=]}=]}<<><^<~Y  t            	video.ASMF	  video$  DGROUPDATACODE
-video_TEXT_DATA H(W H/ _ _colors _readhgc _charhgc _linehgc 	_open8514 _inithgc 	_w8514pal _termhgc _dotmode 	_fr85rdot 	_fr85rbox 	_fr85wdot 	_fr85wbox 
-_close8514 	_writehgc _reopen8514 _videoentry _xdots _ydots    _setvideomode! _f85read\  _everex   _$video7$ J _cirrus   _$tseng4 _f85line! _$nobank _$ativga _tweak256write _cgaread _loaddaco( _hgcreadv _$everex _$pdrsub? _super256write _vgareadz _$cirrus _normalineread> u _oaktech >'  _vgaline _newbank _maybeor3'  _trident -Q  	_$oaktechT 	_mcgaread% 	_f85writeV 	_$trident 	_mcgaline[ 	_f85startJ  	_paradise   _fromvideotable% _initvideotable 	_whichvga 	_storedacM( _adapter_detect 	_cgawrite 	_nullread~ 	_hgcwriteb 	_getcolorN' 	_hgcstart 	_setvideo$ 	_putblock' 	_get_line' 	_vgawrite5 
-_$paradisew 	_putcolorj' 	_out_line' 	_put_line(  	_rowcount U&  
-_cgasegoff _tweak256readlineE!  
-_chipstech j  
-_tandyreado _asmvideocleanupy 
-_mcgawrite 
-_normaline) 
-_outax8bit _super256lineaddrk  _super256readline  _$chipstech _ati1024addr^ _ati1024read$ 
-_nullwrite} _normalread  _vesa ;  _f85readline! _tandywrite _tandysetup _$vesal  _video_type) 5  _vgareadline _ati1024write; _tweak256read  _vga512 _curbk   _tweak256line   _tseng w  _super256addr _super256read _$chkbk _f85endP _$gochk _asmdotwritet _super256line  _normalwrite   _aheada _aheadb 1*  _mcgareadlineq _$tseng _hgcend t$ _video7 _dacbox  _tseng4 d,  _$aheada _$aheadb8 _videocleanup!  _ativga   _tovideotableU                     K       4z                           
-That video mode is not available with your adapter.
-Please select another video mode.$       *X!hWXY> `    =, 8Z!jYZ^J `    I$- $D\"l[\_V `    U+'. 0P^#n]^bb `    a73/ <\`$p_`fn `    mC?0 Hhb$rabiz `    yOK1 Ttd%tcdh `    [W2 `-kYZ^> @     1- (_OPT @      ( P^OPT @      (                         UN ,G b"}                                    IBM 16-Color EGA          Slower but lots nicer             ^ IBM 256-Color MCGA        Quick and LOTS of colors          @  IBM 16-Color VGA          Nice high resolution               IBM 4-Color CGA           (Ugh - Yuck - Bleah)              @  IBM Hi-Rez B&W CGA        ('Hi-Rez' Ugh - Yuck)               IBM B&W EGA               (Monochrome EGA)                  ^ IBM B&W VGA               (Monochrome VGA)                   IBM Low-Rez EGA           Quick but chunky                  @  IBM VGA (non-std/no text) Register Compatibles ONLY       	  @ IBM VGA (non-std/no text) Register Compatibles ONLY         h SuperVGA/VESA Autodetect  Works with most SuperVGA            X SuperVGA/VESA Autodetect  Works with most SuperVGA              SuperVGA/VESA Autodetect  Works with most SuperVGA            SuperVGA/VESA Autodetect  Works with most SuperVGA            Super VGA/VESA Autodetect  Works with most SuperVGA            X SuperVGA/VESA Autodetect  Works with most SuperVGA              VESA Standard interface   OK: Andy Fu - Chips&Tech  O        VESA Standard interface   OK: Andy Fu - Chips&Tech  O        8514/A Low  Res           Requires IBM's HDILOAD            8514/A High Res           Requires IBM's HDILOAD              8514/A Low  W/Border      Requires IBM's HDILOAD           x 8514/A High W/Border      Requires IBM's HDILOAD            IBM Med-Rez EGA           (Silly but it's there!)             Video-7 Vram VGA          OK: Ira Emus              o`       Video-7 Vram VGA          OK: Ira Emus              oa       Video-7 Vram VGA          OK: Ira Emus              oc         Video-7 Vram VGA          OK: Ira Emus              od         Video-7  w/512K           OK: Greg Reznick          oh       GENOA/STB                 OK: Timothy Wegner        -        ^ GENOA                      OK: Timothy Wegner        '          GENOA                     OK: Timothy Wegner        /          GENOA                     OK: Timothy Wegner        |           GENOA                     OK: Timothy Wegner        }           STB                       UNTESTED: may not work    6         Everex EVGA               OK: Travis Harrison       p        Everex EVGA               OK: Travis Harrison       p        ^ Everex EVGA               OK: Travis Harrison       p        X Everex EVGA               UNTESTED: may not work    p       ^ Everex EVGA               UNTESTED: may not work    p         ATI EGA Wonder            OK: Garrett Wollman       Q         ATI EGA Wonder            OK: Garrett Wollman       R         0 Paradise EGA-480          UNTESTED: may not work    P         Pdise/AST/COMPAQ VGA      OK: Phil Wilson           Y         X GENOA Super EGA           UNTESTED: May not work    s         GENOAp  Super EGA           UNTESTED: May not work    y         X COMPAQ Portable 386       OK: Michael Kaufman       @         Tandy 1000 16 Clr LoRez   OK: Tom Price                        Tandy 1000 16 Color CGA   OK: Tom Price             	        @  Tandy 1000 4 Color hi-rez OK: Tom Price             
-          Tandy 1000 16 Colr hi-rez UNTESTED: May not work              AT&T 6300                 UNTESTED: may not work    A          AT&T 6300                 OK: Michael Kaufman       @         AT&T 6300                 OK: Colby Norton          B         Hercules Graphics         OK: Timothy Wegner               
- \ Genoa Super EGA Hirez+    OK: John Jurewicz         u         Genoa Super EGA Hirez+    OK: John Jurewicz         w         Genoa Super EGA Hirez+    OK: John Jurewicz         y         X Genoa Super EGA Hirez+    OK: John Jurewicz         {         NEC GB-1                  UNTESTED: May not work    &         IBM V GA (+tweaked+)       Register Compatibles ONLY          IBM VGA (+tweaked+)       Register Compatibles ONLY          IBM VGA (+tweaked+)       Register Compatibles ONLY         ( IBM VGA (+tweaked+)       Register Compatibles ONLY         4 IBM VGA (+tweaked+)       Register Compatibles ONLY          @ IBM VGA (+tweaked+)       Register Compatibles ONLY         L IBM VGA (+tweaked+)       Register Compatibles ONLY          X END                       Must be the END of list                   W    .}B t@D_UVWD F       EE3_^]UVWD F    _^]        U]  U]  K"P  &"X
-&  &"  s >  tQYQY&&   ;  t     &   ;  t      &<"}PBJX qPZ	q  ? F ? KVv ? {  !  Hip  	  F  $ >   u  }        & u%     & u
-"
-&V  QX$3&^W  QY&_  &t% %   &$t	
-&
-&P   ;  t    X  &  &P   ;  t    X$^ k9 ^P ^u    /                                            z   !   O  O X O X O   O   O   O   O   X j    X q      t    `    a    X b      X T      e   a    b    X c      X p      r    x    y    X {      p   X p   ^ p   X p  ^ p   p    p     p    p 0  X p 1    X Y    X X    ^    _      ]      X [      _    \    ]    X ^      X )      7   ^ -        .     /    X 0      o`  oa  X ob    oc    od    oe  of  og  oh  X oi    X R    S    X T      V        X )      7   ^ -    /    .    X 0      8       @           6  6  PR$
-@ZXPR
-ZXPR6&  ZXPRQ>  u% $
-BJ$
- $
-YZXPR6&  	ZXPRF  Z" 
-k: F 6&  ZXPR$
-ZXPRQ$r YZXPRQ $s  BJ$
- YZXPRQ 
-YZXPR$
-ZXPSQR&  O    ZY[XV>   t  ^    O  =O u2=Vu-}Eu'}Su!}Au                   &>@ 31u0               $ t      p3<puS               t   gt`#u                     <w%<r!                     o37Vu/               ov       >   t  	BJ
-u0     r!                     _3<_u&               r      3BJ3
-3B$J<
-u"33BJ$<u3<uOU<UuG                   t                      B<!t$< u@                  Y                  9$<`u,               Bt       ^B#K	 +  $*, l025 J+L :PVX \^qv +  +   + <  + %' $+-?D G KQ e ?k q+s w} w + n  + p"(* .04?E+G JKQS WY\ t+v z +  8+  Tq PR2JBB
-u$JB<u               ZJX 34  u
-!C  uV&&=&2&2=&=& ^R	Z                VW PRQ    YZX_^VWRQ    YZ_^VW    _^VW    _^                                                  <tt                  PQRV  ^ZYFAX;~  PQRW  _ZYGAX;~+@+@  QPR  ;  uN[[Y+PVW$ &G;v_^XF;wuG:u  ZXY  QPR  ;  uO[[X+ S  &<"}[G;wuF   ZXY    P;  Rt    C  -  [XPR  :ZXu+A  PR  :ZXu+A    U+C  ]S  QYfY tAQVW_^YK uIFuG:fu]U+C  ]S  QYfY tAPQWV  /5+7 ;= ACU ] &&&&
-
-&&&&)-
-/ $(,048<@DF JLP+R j)r)w |-/  T ![ )dp ! >  k  ) k $1 >E )P > !^_YXK uIG uF:fu]          =  u  UWV>  u     >  u     ~u    >   u               F^N
-V          >   u	  !            v  .                                                                                                                        v           a           L           7           "        >   t
->  t                                        |           g           R           =         j'&-&3 6 5R X P\ a g k v	|) -/!#%' $1 } % ) q $	 " " " # " # # # W$ [# $  $ f$ " # #
- $ !$ u$ " # # 1# F# [# |#  p#" "$ "& ") , o/ )2 >5 $8 ; > )A >D $G J %M [P qS $W]_ ceh #lrt xz $ w   l " H$ 5 z  >  $  H$#% w)+28: $>@GMO SU\bd hjqwy } $  (                           v        g        X           C>  u    s                                       H      ^_]=  u, u' u">  t>  t>  t
->  t    = t= t6  >  .9  wm  U]>  u= t= t= t= t  >  u> u<  O            r@   O       6  
-.=  t;  u.D;  u.D;  u.D.\ u   e     u      
-    =Ou	       6  >  .9  v      t%	t 
-tP.   c M   >   u +    $   T@  &J d&L &c ut  	t
-t  &c d    C     Otot
-  
-
-  
->  UWV NV   ^_]UWV NVF
-#      ^_]UWV NIAVJBQRF  ZY;Vu;N
-u  ^_]UWV3  ;  w FH     3^_]UWVN;  wV;  wF
-   3^_]  ! l%'- 0 3  6  < ? B  E E!K N Q )T >[` ;c $f )i >p'v&~	 "  b v ) >  V \ ! !     
-  o(				 $& %	) 3'%	? C	O]cgkos ''+	 %		 % %
-	) %"&> 3'V 3'c 3'#)/E d
- h k !  !  f| (UWVN;  wV;  w F
-;  w   3^_]>  u         >   u       U]%? ", 7 =&Q Y ` p   t            
- fgraph.ce
-  fgraphM   MS Cn	  MLIBC72  0mO  CV74  DGROUPFGRAPH_TEXTCODE_DATADATACONST_BSSBSS{ Hz  H   H  
- H  	 V  @E 
-__acrtused D: _dotmode b
-_oktoprint b_xdots b_ydots b_colors bU< _initvideotable _fromvideotable _setvideomode __chkstk  _videoentry bD _startgraphics w  _startgraphics   n  ~   U     ~ |
-    ;F}]FHP    4 F6 F8 F: F<   >   @   B   vvvv     ][A lV	]VZVWVTVQVNVKVHVBV<V6V0V(VVV
-  t                                                                                                                                                                       =c]  i{QWuI     8    C  1$o,_$nobank 	_$trident_$tseng_asmdotwrite _cirrus
-_close8514  _dacbox	_do85open _f85line _f85readline 	_f85write	_fr85rdot 	_fr85wdot 	_hgcwrite_linehgci  	_putcolor	_put_line_super256line
-_tandyread _trident _vgaline _vgareadline 	_vgawrite                                                                                                                                                                                         z ,g  1& U O7 mI[  t=C a _$ativga _$chipstech	_$oaktech_$tseng4 _ativga_charhgci  	_f85start	_fr85wbox 	_getcolor_hgcread 	_hgcstart_inithgci  _loaddac _maybeor 	_mcgaline
-_mcgawrite _newbank 
-_normaline _normalwrite 	_nullread_reopen8514 	_storedac_super256readline_tovideotable_vesa_video_type	_w8514pal                                                                                                                                     4oP   .   )v i   bE $=KY     |fgraph!_$aheada _$aheadb _$gochk_$vesa _$video7 _adapter_detect_ati1024write_callafi  _curbk _fromvideotable_normalineread _normalread_oaktech 
-_outax8bit 	_out_line	_paradise	_putblock_setmdi                                                                                                                                                                                                                                          az ;U  [A Ht3    %g nN    +hgcfra!i _$everex 
-_$paradise _$pdrsub _ati1024addr _ati1024read _cgaread 
-_cgasegoff 	_cgawrite
-_chipstech 	_fr85rbox 	_get_line	_mcgaread
-_nullwrite 	_open8514 	_rowcount	_setvideo_super256read_super256write _tseng4_vga512	_writehgci                                                                                                                                                                                                MW 3.`nGv#B )R=   hfr8514a!  video! _$chkbk_$cirrus _aheada_aheadb_asmvideocleanup _everex_f85end_f85read _getafi _hgcend_initvideotable_mcgareadline_readhgci  _setvideomode_startgraphics _super256addr_super256lineaddr_tandysetup_tandywrite_termhgci  _tseng _tweak256line_tweak256read_tweak256readline_tweak256write _vgaread _video7_videocleanup	_whichvga                                                    &    i                   
\ No newline at end of file
diff -Nrua vort-old/pc/link.in vort-new/pc/link.in
--- vort-old/pc/link.in	1992-05-25 21:10:28.000000000 -0400
+++ vort-new/pc/link.in	1969-12-31 19:00:00.000000000 -0500
@@ -1,8 +0,0 @@
-pcdisp.obj+
-pcdspvg1.obj+
-pcdspvg2.obj+
-pcdspveg.obj+
-320x400.obj+
-supavgac.obj+
-supavga.obj+
-320x200.obj+
diff -Nrua vort-old/pc/makefile.msc vort-new/pc/makefile.msc
--- vort-old/pc/makefile.msc	1992-05-25 21:10:28.000000000 -0400
+++ vort-new/pc/makefile.msc	1969-12-31 19:00:00.000000000 -0500
@@ -1,38 +0,0 @@
-CC = cl
-#CFLAGS = -AL -c -FPa -Zi -Od -I../lib -DPC
-CFLAGS = -AL -c -Gs -FPa -I../lib -DPC
-LFLAGS = /ST:8192 /CO /NOE
-ASMFLAGS = -Zi -Mx
-#ASMFLAGS = -Mx
-R = .exe
-O = .obj
-A = .lib
-
-LIBS = ..\lib\libvort$(A)
-
-OBJS =	pcdisp$(O) pcdspvg1$(O) pcdspvg2$(O) pcdspveg$(O) 320x400$(O) \
-	supavgac$(O) supavga$(O) 320x200$(O)
-
-LNK = $[d,$(TMP)]\lnk
-
-all: pcdisp$(R)
-
-pcdisp$(R): $(OBJS) $(LIBS)
-	del $(LNK)
-	%(OBJS) echo $(OBJS)+ >> $(LNK)
-	echo c:\c5.1\lib\setargv.obj >> $(LNK)
-	echo $* >> $(LNK)
-	echo $* >> $(LNK)
-	echo $(LIBS) >> $(LNK)
-	link $(LFLAGS) @$(LNK)
-
-
-.c.obj:
-	$(CC) $(CFLAGS) $*.c
-
-.asm.obj:
-	masm $(ASMFLAGS) $*;
-
-.obj.exe:
-	link $(LFLAGS) $*,,, $(LIBS)
-
diff -Nrua vort-old/pc/makefile.tc vort-new/pc/makefile.tc
--- vort-old/pc/makefile.tc	1992-05-25 21:10:28.000000000 -0400
+++ vort-new/pc/makefile.tc	1969-12-31 19:00:00.000000000 -0500
@@ -1,21 +0,0 @@
-CC = bcc
-ASM = tasm
-CFLAGS = -ml -w-rvl -I../lib -DPC -DTC -D_STKLEN=4096
-ASMFLAGS = -mx
-
-LIBS = ..\lib\vort.lib
-
-OBJS =	pcdisp.obj pcdspvg1.obj pcdspvg2.obj pcdspveg.obj 320x400.obj\
-	supavgac.obj supavga.obj 320x200.obj
-
-.c.obj:
-	$(CC) -c $(CFLAGS) $*.c
-
-.asm.obj:
-	$(ASM) $(ASMFLAGS) $*
-
-all: pcdisp.exe
-
-pcdisp.exe: $(OBJS) $(LIBS)
-	$(CC) $(CFLAGS) -epcdisp.exe @tlink.in $(LIBS)
-
diff -Nrua vort-old/pc/make.msc vort-new/pc/make.msc
--- vort-old/pc/make.msc	1992-05-25 21:10:28.000000000 -0400
+++ vort-new/pc/make.msc	1969-12-31 19:00:00.000000000 -0500
@@ -1,35 +0,0 @@
-CC = cl
-F = -FPa
-CFLAGS = -AL -c -Gs -I../lib -DPC $(F) -Ot
-LFLAGS = /ST:2048 /NOE
-ASMFLAGS = -Mx
-
-LIBS = ..\lib\vort.lib
-
-.c.obj:
-	$(CC) $(CFLAGS) $*.c
-
-.asm.obj:
-	masm $(ASMFLAGS) $*;
-
-OBJS = pcdisp.obj pcdspvg1.obj pcdspvg2.obj pcdspveg.obj 320x400.obj \
- 	supavgac.obj supavga.obj 320x200.obj
-
-pcdisp.obj: pcdisp.c
-
-pcdspvg1.obj: pcdspvg1.c
-
-pcdspvg2.obj: pcdspvg2.c
-
-pcdspveg.obj: pcdspveg.c
-
-320x400.obj: 320x400.asm
-
-320x200.obj: 320x200.asm
-
-supavgac.obj: supavgac.c
-
-supavga.obj: supavga.asm
-
-pcdisp.exe: $(OBJS) $(LIBS)
-	link $(LFLAGS) @link.in c:\lib\setargv.obj ,,,$(LIBS);
diff -Nrua vort-old/pc/pcdisp.c vort-new/pc/pcdisp.c
--- vort-old/pc/pcdisp.c	1992-05-25 21:10:28.000000000 -0400
+++ vort-new/pc/pcdisp.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,1550 +0,0 @@
-/*
- * Display a color-mapped image on a PC VGA. Images are produced by ART and
- * MEDIAN.
- */
-
-#include <stdio.h>
-#include <stdlib.h>
-#include <dos.h>
-#include <io.h>
-#include <bios.h>
-#include <string.h>
-#include <memory.h>
-#include <signal.h>
-#include "vort.h"
-#include "pcdisp.h"
-
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 4096;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
-
-
-#define	MAX_ADAPTERS	50
-#define	MAX_IMAGE_WIDTH	2048
-#define	PALETTE_SIZE	256
-#define SET_TEXT()	{union REGS regs; regs.x.ax = 3; int86(0x10, &regs, &regs);}
-
-/* image positioning flag values */
-#define	POSN_UL		0
-#define	POSN_UR		1
-#define	POSN_CT		2
-#define	POSN_LL		3
-#define	POSN_LR		4
-
-/* adapter id values */
-#define	ADAPTER_NONE		0
-#define	ADAPTER_ATI			1
-#define	ADAPTER_EVEREX		2
-#define	ADAPTER_TRIDENT		3
-#define	ADAPTER_VIDEO7		4
-#define	ADAPTER_PARADISE	5
-#define	ADAPTER_CHIPS		6
-#define	ADAPTER_TSENG		7
-#define	ADAPTER_TSENG4		8
-#define	ADAPTER_AHEADA		9
-#define	ADAPTER_AHEADB		10
-#define	ADAPTER_OTI			11
-#define	ADAPTER_VGA			99
-
-
-/* palette entry structure */
-#pragma pack(1)
-typedef struct {
-
-	UCHAR           r, g, b;
-
-}               PALETTE;
-
-#pragma pack()
-
-/* description of an image, where it lives, where to put it and how */
-typedef struct {
-
-	char           *fn;	/* image filename */
-
-	int             type;	/* image type */
-
-	int             x, y;	/* video co-ords to place image */
-
-	int             xlen, ylen;	/* dimensions of image */
-
-	char            posn_flag;	/* image positioning flag */
-
-	PALETTE        *pal;	/* palette; NULL = use current palette */
-
-	int             pal_size;	/* size of colour palette */
-
-	int             darkest_pal;	/* palette index of darkest colour */
-
-	union {
-
-		char far       *ptr;	/* position in regular memory */
-
-		ULONG           EMS_ofs;	/* position in EMS memory */
-
-	}               adr;
-
-	UINT           EMS_h;	/* handle of EMS memory; -1 if in regular
-				 * memory */
-
-}               IMAGE_DESCR;
-
-
-
-/* image info */
-IMAGE_DESCR    *images = NULL;
-
-int             max_images = 0;
-
-
-
-/* adapter info */
-int             max_adapters = 0;
-
-ADAPTER        *adapters;
-
-ADAPTER         v_adapter;
-
-
-/* these next 3 MUST!!! be in the near data segment */
-/* and DS == SS, since we rely on it! */
-UINT            adapter_x = 0;
-
-UINT            adapter_y = 0;
-
-PFI             adapter_bank = NULL;
-
-
-
-/* for reading images */
-UCHAR          *r, *g, *b, *s;
-
-
-/* EMS stuff */
-int             EMS_available = FALSE;
-
-char far       *EMS_addr = NULL;
-
-UINT            EMS_handle = 0xFFFF;
-
-UINT            EMS_max_pages = 0;
-
-UCHAR far      *EMS_base();
-
-UINT            init_EMS();
-
-void            lmemmove(UCHAR far *, UCHAR far *, int);
-
-
-/* CTRL-C trap processor */
-void             ctrl_C(void);
-
-
-
-int
-main(argc, argv)
-	int             argc;
-
-	char           *argv[];
-
-{
-
-	int             ac;
-
-	char          **av;
-
-	int             mode = 0, i, c, key, animate = FALSE, overscan = FALSE,
-	                posn_flag = POSN_CT, recognise_palette = FALSE,
-	                disable_EMS = FALSE, auto_detect = TRUE;
-
-	int             current_image = 0;
-
-	ULONG           EMS_offset = 0L;
-
-
-	ac = --argc;
-
-	av = ++argv;
-
-	/* load adapter info (for usage()) */
-	load_adapters(&adapters, &max_adapters, FALSE);
-
-
-	/* count image filenames */
-	while (ac-- > 0) {
-		if (**av == '-' || **av == '/') {
-			/* skip parameters */
-			switch (tolower((*av)[1])) {
-			case 'd':
-				auto_detect = FALSE;
-				break;
-			case 'a':
-			case 'm':
-			case 'p':
-				if (((*av)[2]) == 0) {
-					++av;
-					--ac;
-				}
-				break;
-
-			default:
-				break;
-
-			}
-		} else {
-			max_images++;
-		}
-
-		++av;
-	}
-
-	if (auto_detect) {
-
-		/* unload the adapter info */
-		unload_adapters(adapters);
-
-		max_adapters = 0;
-
-
-		/*
-		 * then load only the info relevent to the card we know we
-		 * have
-		 */
-		if (!load_adapters(&adapters, &max_adapters, TRUE)) {
-
-			/* failed auto detecting - load all info again! */
-			unload_adapters(adapters);
-
-			max_adapters = 0;
-
-			load_adapters(&adapters, &max_adapters, FALSE);
-
-		}
-	}
-	if (max_images < 1)
-		usage();
-
-	if (!(images = calloc(max_images, sizeof(IMAGE_DESCR)))) {
-
-		fail("no memory for image descriptions!");
-
-	}
-	ac = argc;
-
-	av = argv;
-
-
-	/* parse cmd line arguments, store image filenames */
-	while (ac-- > 0) {
-
-		if (**av == '-' || **av == '/') {
-
-			switch (tolower((*av)[1])) {
-
-
-			case '?':
-
-				usage();
-
-				break;
-
-
-			case 'a':
-
-				animate = TRUE;
-
-				if (((*av)[2]) == 0) {
-
-					/*
-					 * check for 'p' parameter to this
-					 * 'a' parameter
-					 */
-					if (ac - 1 >= 0) {
-
-						if (stricmp(*(av + 1), "p") == 0) {
-
-							av++;
-
-							ac--;
-
-							break;
-
-						}
-					}
-				} else
-					sscanf(&((*av)[2]), "%c", &c);
-
-				if (toupper(c) == 'P')
-					recognise_palette = TRUE;
-
-				break;
-
-
-			case 'd':
-				auto_detect = FALSE;
-				break;
-
-
-			case 'm':
-
-				if (((*av)[2]) == 0) {
-
-					if (--ac >= 0)
-						sscanf(*++av, "%d", &mode);
-
-					else
-						usage();
-
-				} else
-					sscanf(&((*av)[2]), "%d", &mode);
-
-				if (mode < 0 || mode >= max_adapters)
-					usage();
-
-				break;
-
-
-			case 'p':
-
-				if (((*av)[2]) == 0) {
-
-					if (--ac >= 0)
-						sscanf(*++av, "%d", &posn_flag);
-
-					else
-						usage();
-
-				} else
-					sscanf(&((*av)[2]), "%d", &posn_flag);
-
-				if (mode < 0 || mode >= max_adapters)
-					usage();
-
-				break;
-
-
-			case 'o':
-
-				overscan = TRUE;
-
-				break;
-
-
-			case 'e':
-
-				disable_EMS = TRUE;
-
-				break;
-
-
-			default:
-
-				usage();
-
-				break;
-
-			}
-		} else {
-
-			/*
-			 * t'was an image, store the filename and current
-			 * image position flag
-			 */
-			images[current_image].fn = *av;
-
-			images[current_image].posn_flag = posn_flag;
-
-			current_image++;
-
-		}
-		++av;
-
-	}
-
-	/* allocate buffers for maximum possible (likely) image width */
-	s = (UCHAR *) malloc(MAX_IMGWIDTH);
-
-	r = (UCHAR *) malloc(MAX_IMGWIDTH);
-
-	g = (UCHAR *) malloc(MAX_IMGWIDTH);
-
-	b = (UCHAR *) malloc(MAX_IMGWIDTH);
-
-
-	/* set the adapter */
-	v_adapter = adapters[mode];
-
-	adapter_x = v_adapter.width;
-
-	adapter_y = v_adapter.height;
-
-	adapter_bank = v_adapter.select_bank;
-
-	free(adapters);
-
-
-	signal(SIGINT, ctrl_C);	/* trap user aborts */
-
-
-	if (!disable_EMS) {
-
-		/*
-		 * test for EMS; set flag TRUE if available; allocate all of
-		 * EMS
-		 */
-		EMS_handle = init_EMS();
-
-	}
-	/* display the images */
-	if (!animate) {
-
-		/* display just one at a time please */
-		v_adapter.init();
-
-		single_display(max_images, overscan, EMS_handle);
-
-	} else {
-
-		/* load each image into memory */
-		for (current_image = 0; current_image < max_images; current_image++) {
-
-			if (EMS_available) {
-
-				/*
-				 * try to load image to EMS; if we fail try
-				 * regular memory
-				 */
-				if (!load_image2EMS(current_image, (current_image == 0) || recognise_palette, EMS_handle, &EMS_offset)) {
-
-					if (!load_image(current_image, (current_image == 0) || recognise_palette))
-						break;
-
-				}
-			} else if (!load_image(current_image, (current_image == 0) || recognise_palette))
-				break;
-
-			position_image(current_image);
-
-			if (recognise_palette)
-				check_duplicate_cmap(current_image);
-
-		}
-
-		if (current_image < 1) {
-
-			fail("couldn't load the first image!");
-
-		}
-		/* set number of images actually loaded */
-		max_images = current_image;
-
-
-		v_adapter.init();
-
-		v_adapter.palette(images[0].pal, images[0].pal_size);
-
-		if (overscan)
-			v_adapter.overscan(images[0].darkest_pal);
-
-
-		/* display one after the other real fast */
-		animated_display(max_images);
-
-
-		/* unload all the images */
-		for (current_image = 0; current_image < max_images; current_image++) {
-
-			unload_image(current_image);
-
-		}
-	}
-
-	uninit_EMS();
-
-
-	/* reset video mode */
-	SET_TEXT();
-
-
-	exit(0);
-
-}
-
-
-
-int
-single_display(n, overscan, EMS_h)
-	int             n;
-
-	int             overscan;
-
-	UINT            EMS_h;
-
-{
-
-	int             current_image;
-
-	int             key = 0;
-
-	int             request_abort = FALSE;
-
-	int             direction = 1;
-
-	int             image_loaded;
-
-	ULONG           EMS_ofs;
-
-	IMAGE_DESCR    *img;
-
-
-	current_image = 0;
-
-	do {
-
-
-		if (EMS_available) {
-
-			EMS_ofs = 0L;
-
-			image_loaded = load_image2EMS(current_image, TRUE, EMS_h, &EMS_ofs);
-
-		} else
-			image_loaded = load_image(current_image, TRUE);
-
-
-		if (image_loaded) {
-
-			img = &(images[current_image]);
-
-			position_image(current_image);
-
-
-			/* display image from memory */
-			if (img->pal) {
-
-				v_adapter.palette(img->pal, img->pal_size);
-
-				if (overscan)
-					v_adapter.overscan(img->darkest_pal);
-
-			}
-			display_image(current_image);
-
-			unload_image(current_image);
-
-		} else {
-
-			/*
-			 * can't load image into memory, display image
-			 * directly from file
-			 */
-			display_image_file(current_image, overscan);
-
-		}
-
-		/* wait for operator */
-		while (!get_key(&key));
-
-		switch (toupper(key)) {
-
-		case '+':
-			direction = 1;
-			break;
-
-		case '-':
-			direction = -1;
-			break;
-
-		case 0x1b:
-
-		case 'Q':
-			request_abort = TRUE;
-
-		default:
-			break;
-
-		}
-
-		/* clear video */
-		v_adapter.fill(0, 0, adapter_x, adapter_y, img->darkest_pal);
-
-
-		/* next image */
-		current_image = (current_image + direction) % n;
-
-		if (current_image < 0)
-			current_image = n - 1;
-
-
-	} while (!request_abort);
-
-}
-
-
-
-int
-animated_display(n)
-	int             n;
-
-{
-
-#define		SNAIL_FACTOR	1000L
-#define		MAX_DELAY		100
-	int             i = 0, request_abort = FALSE, hold = FALSE, single_step = FALSE,
-	                delay = 0;
-
-	ULONG           snail;
-
-	int             key;
-
-
-	do {
-
-		/* check for user intervention */
-		if (get_key(&key)) {
-
-			switch (toupper(key)) {
-
-			case 0x1b:
-
-			case 'Q':
-				request_abort = TRUE;
-				break;
-
-			case 'H':
-				hold = !hold;
-				break;
-
-			case 'S':
-				single_step = !single_step;
-				break;
-
-			case 'D':
-				if (delay == 0)
-					delay = MAX_DELAY;
-
-				else
-					delay = 0;
-
-				break;
-
-			case '+':
-				if (single_step)
-					i = (i + 1) % n;
-
-				else if (++delay > MAX_DELAY)
-					delay = MAX_DELAY;
-
-				break;
-
-			case '-':
-				if (single_step) {
-
-					i--;
-
-					if (i < 0)
-						i = n - 1;
-
-				} else if (--delay < 0)
-					delay = 0;
-
-				break;
-
-			default:
-				break;
-
-			}
-		}
-		if (!hold) {
-
-			if (delay) {
-
-				/* slow her up a bit */
-				for (snail = delay * SNAIL_FACTOR; snail; snail--);
-
-			}
-			/* set image palette */
-			if (images[i].pal) {
-
-				v_adapter.palette(images[i].pal, images[i].pal_size);
-
-				/*
-				 * if (overscan)
-				 * v_adapter.overscan(images[i].darkest_pal);
-				 */
-			}
-			display_image(i);
-
-			if (!single_step)
-				i = (i + 1) % n;
-
-		}
-	} while (!request_abort);
-
-}
-
-
-
-int
-display_image_file(current_image, overscan)
-	int             current_image;
-
-	int             overscan;
-
-{
-
-	image          *im;
-
-	int             w, h, x, y;
-
-	UCHAR          *sptr;
-
-	IMAGE_DESCR    *img;
-
-
-	img = &(images[current_image]);
-
-	if ((im = openimage(img->fn, "r")) == (image *) NULL) {
-
-		fprintf(stderr, "pcdisp: can't open file %s!\n", img->fn);
-
-		return 1;
-
-	}
-	img->xlen = w = imagewidth(im);
-
-	img->ylen = h = imageheight(im);
-
-
-	/* remap palette */
-	make_palette(im, img);
-
-	v_adapter.palette(img->pal, img->pal_size);
-
-	if (overscan)
-		v_adapter.overscan(img->darkest_pal);
-
-
-	/* display image line by line */
-	imagepos(im, 0, 0);
-
-	switch (imagetype(im)) {
-
-
-	case PIX_CMAP:
-
-	case PIX_RLECMAP:
-
-		for (y = 0; y < h; y++) {
-
-			readmappedline(im, s);
-
-			v_adapter.putline((char far *) s, (UINT) w, (UINT) img->x, (UINT) img->y + y);
-
-		}
-		break;
-
-
-	default:
-
-		for (y = 0; y < h; y++) {
-
-			readrgbline(im, r, g, b);
-
-			sptr = s;
-
-			for (x = 0; x < w; x++) {
-
-				*sptr++ = (UCHAR) ((90 * r[x] + 140 * g[x] + 25 * b[x]) >> 8);
-
-			}
-			v_adapter.putline((char far *) s, (UINT) w, (UINT) img->x, (UINT) img->y + y);
-
-		}
-		break;
-
-	}
-	closeimage(im);
-
-	return 0;
-
-}
-
-
-
-
-int
-display_image(current_image)
-	int             current_image;
-
-{
-
-	IMAGE_DESCR    *img;
-
-
-	img = &(images[current_image]);
-
-
-	if (img->EMS_h == 0xFFFF) {
-
-		v_adapter.block(img->adr.ptr, img->xlen, img->ylen, img->x, img->y);
-
-	} else {
-
-		v_adapter.EMSdecode(img->EMS_h, img->adr.EMS_ofs, img->x, img->y, img->xlen, img->ylen);
-
-	}
-}
-
-
-
-int
-load_image(current_image, set_palette)
-	int             current_image;
-
-	int             set_palette;
-
-{
-
-	image          *im;
-
-	int             x, y, w, h;
-
-	UCHAR          *fptr;
-
-	IMAGE_DESCR    *img;
-
-
-	img = &(images[current_image]);
-
-
-	if ((im = openimage(img->fn, "r")) == (image *) NULL) {
-
-		fprintf(stderr, "pcdisp: can't open file %s!\n", img->fn);
-
-		return FALSE;
-
-	}
-	img->xlen = w = imagewidth(im);
-
-	img->ylen = h = imageheight(im);
-
-
-	/* validate size of buffer required */
-	if (((long) w * (long) h) > 65500L) {
-
-		/*
-		 * can't load image into memory without heaps of stuffing
-		 * around,
-		 */
-		closeimage(im);
-
-		return FALSE;
-
-	}
-	if (!(img->adr.ptr = fptr = malloc(w * h))) {
-
-		fprintf(stderr, "pcdisp: can't alloc %u bytes for image!\n", (long) (w * h));
-
-		closeimage(im);
-
-		return FALSE;
-
-	}
-	img->EMS_h = 0xFFFF;
-
-
-	/* extract palette if required */
-	if (set_palette) {
-
-		make_palette(im, img);
-
-	} else
-		img->pal = NULL;
-
-
-	/* load image */
-	imagepos(im, 0, 0);
-
-	switch (imagetype(im)) {
-
-
-	case PIX_CMAP:
-
-	case PIX_RLECMAP:
-
-		for (y = 0; y < h; y++) {
-
-			readmappedline(im, fptr);
-
-			fptr += w;
-
-		}
-		break;
-
-
-	default:
-
-		for (y = 0; y < h; y++) {
-
-			readrgbline(im, r, g, b);
-
-			for (x = 0; x < w; x++) {
-
-				*fptr = (UCHAR) ((90 * r[x] + 140 * g[x] + 25 * b[x]) >> 8);
-
-				fptr++;
-
-			}
-		}
-		break;
-
-	}
-
-	closeimage(im);
-
-	return TRUE;
-
-}
-
-
-
-/****
- * Loads the menu image file defined by m into EMS
- * provided the adapter we are displaying image on can
- * handle it.
- *
- * We should be more careful of the EMS available and only
- * use what is actually there.
-  **/
-
-int
-load_image2EMS(current_image, set_palette, EMS_h, EMS_ofs)
-	int             current_image;
-
-	int             set_palette;
-
-	UINT            EMS_h;
-
-	ULONG          *EMS_ofs;
-
-{
-
-	image          *im = NULL;
-
-	int             fd;
-
-	int             i;
-
-	ULONG           len, img_len, abs_ofs;
-
-	UINT            page;
-
-	char            buffer[4096];
-
-	UINT            ofs, n;
-
-	IMAGE_DESCR    *img;
-
-
-	/* check that the adapter knows how to use EMS */
-	if (!v_adapter.EMSdecode)
-		return FALSE;
-
-
-	img = &(images[current_image]);
-
-
-	/* extract VORT header info, like colour map, dimensions */
-	if ((im = openimage(img->fn, "r")) == (image *) NULL) {
-
-		fprintf(stderr, "pcdisp: can't open file %s!\n", img->fn);
-
-		goto fail;
-
-	}
-	/* only load colour mapped images into EMS */
-	if (imagetype(im) != PIX_CMAP && imagetype(im) != PIX_RLECMAP)
-		goto fail;
-
-
-	img->xlen = imagewidth(im);
-
-	img->ylen = imageheight(im);
-
-
-	/* extract palette if required */
-	if (set_palette) {
-
-		make_palette(im, img);
-
-	} else
-		img->pal = NULL;
-
-
-	/* determine size of image part of VORT file */
-	fd = imagefile(im);
-
-	len = filelength(fd);
-
-	imagepos(im, 0, 0);
-
-	len -= tell(fd);
-
-
-	img->EMS_h = EMS_h;
-
-	img->adr.EMS_ofs = *EMS_ofs;
-
-	page = *EMS_ofs / 16384;
-
-	ofs = *EMS_ofs % 16384;
-
-	EMS_map(EMS_h, page);
-
-
-	/* store image length into EMS (possibly spanning a page boundary) */
-	n = min(16384 - ofs, sizeof(len));
-
-	lmemmove(EMS_addr + ofs, (char far *) &len, n);
-
-	ofs += n;
-
-	if (ofs >= 16384) {
-
-		if (++page >= EMS_max_pages)
-			goto fail;
-
-		EMS_map(EMS_h, page);
-
-		n = sizeof(len) - n;
-
-		lmemmove(EMS_addr, (char far *) &len, n);
-
-		ofs = n;
-
-	}
-	/* slap image directly to EMS without any decoding */
-	while (len) {
-
-		n = (sizeof(buffer) > len) ? len : sizeof(buffer);
-
-		if (read(fd, buffer, n) == n) {
-
-			len -= n;
-
-			if (n + ofs >= 16384) {
-
-				/* size will overflow page */
-				lmemmove(EMS_addr + ofs, (char far *) buffer, 16384 - ofs);
-
-				n -= 16384 - ofs;
-
-				if (++page >= EMS_max_pages)
-					goto fail;
-
-				EMS_map(EMS_h, page);
-
-				lmemmove(EMS_addr, (char far *) buffer + (16384 - ofs), n);
-
-				ofs = n;
-
-			} else {
-
-				lmemmove(EMS_addr + ofs, (char far *) buffer, n);
-
-				ofs += n;
-
-			}
-		} else
-			goto fail;
-
-	}
-
-	closeimage(im);
-
-
-	*EMS_ofs = page * 16384L + ofs;
-
-
-	return TRUE;
-
-
-fail:
-	if (im)
-		closeimage(im);
-
-	img->adr.EMS_ofs = 0L;
-
-	img->EMS_h = 0xFFFF;
-
-	return FALSE;
-
-}
-
-
-
-int
-unload_image(current_image)
-	int             current_image;
-
-{
-
-	IMAGE_DESCR    *img;
-
-
-	img = &(images[current_image]);
-
-	if (img->pal)
-		free(img->pal);
-
-
-	if (img->EMS_h != 0xFFFF) {
-
-		img->adr.EMS_ofs = 0L;
-
-	} else if (img->adr.ptr)
-		free(img->adr.ptr);
-
-}
-
-
-
-int
-make_palette(im, img)
-	image          *im;
-
-	IMAGE_DESCR    *img;
-
-{
-
-	int             i, r1, g1, b1, cmap_size;
-
-	long            darkest = 999999999, intensity;
-
-
-	/* generate palette */
-	if (imagetype(im) == PIX_CMAP || imagetype(im) == PIX_RLECMAP) {
-
-
-		img->pal_size = cmap_size = cmapsize(im);
-
-		if (!(img->pal = malloc(cmap_size * sizeof(PALETTE)))) {
-
-			fprintf(stderr, "pcdisp: can't allocate image palette %d bytes long!\n", cmap_size * sizeof(PALETTE));
-
-			return;
-
-		}
-		/* set up colour palette for colour map files */
-		for (i = 0; i < cmap_size; i++) {
-
-
-			/* 6-bits only per value please */
-			r1 = img->pal[i].r = im->red[i] >> 2;
-
-			g1 = img->pal[i].g = im->green[i] >> 2;
-
-			b1 = img->pal[i].b = im->blue[i] >> 2;
-
-
-			/*
-			 * check if this colour is darker than previous
-			 * darkest
-			 */
-			if ((intensity = r1 * r1 + g1 * g1 + b1 * b1) < darkest) {
-
-				darkest = intensity;
-
-				img->darkest_pal = i;
-
-			}
-		}
-
-		if (img->pal_size < PALETTE_SIZE && darkest != 0) {
-
-			/*
-			 * palette not yet full & darkest not black - add a
-			 * black entry to colour map
-			 */
-			img->pal[cmap_size - 1].r = 0;
-
-			img->pal[cmap_size - 1].g = 0;
-
-			img->pal[cmap_size - 1].b = 0;
-
-			img->darkest_pal = cmap_size - 1;
-
-			img->pal_size++;
-
-		}
-	} else {
-
-		img->pal_size = cmap_size = PALETTE_SIZE;
-
-		if (!(img->pal = malloc(cmap_size * sizeof(PALETTE)))) {
-
-			fprintf(stderr, "pcdisp: can't allocate image palette %d bytes long!\n", cmap_size * sizeof(PALETTE));
-
-			return;
-
-		}
-		/* create a B&W colour map */
-		for (i = 0; i < cmap_size; i++) {
-
-			/* gray scale: 6-bits only per value */
-			img->pal[i].r = i >> 2;
-
-			img->pal[i].g = i >> 2;
-
-			img->pal[i].b = i >> 2;
-
-		}
-		img->darkest_pal = 0;
-
-	}
-}
-
-
-
-/****
- * Set (x, y) co-ords of image on screen
- * depending on posn_flag in image description.
-  **/
-
-int
-position_image(current_image)
-	int             current_image;
-
-{
-
-	IMAGE_DESCR    *img;
-
-
-	img = &(images[current_image]);
-
-	switch (img->posn_flag) {
-
-	default:
-
-	case POSN_UL:
-		img->x = 0;
-		img->y = 0;
-		break;
-
-	case POSN_UR:
-		img->x = adapter_x - img->xlen;
-		img->y = 0;
-		break;
-
-	case POSN_LL:
-		img->x = 0;
-		img->y = adapter_y - img->ylen;
-		break;
-
-	case POSN_LR:
-		img->x = adapter_x - img->xlen;
-		img->y = adapter_y - img->ylen;
-		break;
-
-	case POSN_CT:
-		img->x = (adapter_x - img->xlen) / 2;
-		img->y = (adapter_y - img->ylen) / 2;
-		break;
-
-	}
-	if (img->x < 0)
-		img->x = 0;
-
-	if (img->y < 0)
-		img->y = 0;
-
-}
-
-
-
-/****
- * If previous image's palette is the same as
- * this image's, then throw this image's palette
- * away since there is no need to store it.
-  **/
-
-int
-check_duplicate_cmap(current_image)
-	int             current_image;
-
-{
-
-	int             i;
-
-	IMAGE_DESCR    *img, *prev_img;
-
-
-	if (current_image == 0)
-		return;
-
-
-	img = &(images[current_image]);
-
-
-	/* find a previous image with a colour map */
-	for (i = current_image - 1; i > 0 && images[i].pal == NULL; i--);
-
-	prev_img = &(images[i]);
-
-	if (prev_img->pal_size != img->pal_size)
-		return;
-
-
-	/* check colour maps are the same */
-	if (memcmp(img->pal, prev_img->pal, sizeof(PALETTE) * img->pal_size) != 0)
-		return;
-
-
-	/* image colour maps are the same, throw current one away */
-	free(img->pal);
-
-	img->pal = NULL;
-
-	img->pal_size = 0;
-
-}
-
-
-
-int
-usage()
-{
-
-	int             i;
-
-
-	fprintf(stderr, "usage: pcdisp fname [fname...] [-m mode] [-p n] [-a [p]] [-d] [-e] [-o] [-p n] [-?]\n\n");
-
-	fprintf(stderr, "where:\n");
-
-	fprintf(stderr, "       fname    - filenames of image to display (may be wildcard)\n");
-
-	fprintf(stderr, "       -m mode  - video mode to use\n");
-
-	for (i = 0; i < max_adapters; i++)
-		fprintf(stderr, "                   = %2d %s\n", i, adapters[i].descr);
-
-	fprintf(stderr, "       -a [p]   - animate the images specified\n");
-
-	fprintf(stderr, "                  specify 'p' to enable recognition of different palettes\n");
-
-	fprintf(stderr, "       -d       - disable auto adapter detect\n");
-
-	fprintf(stderr, "       -e       - do not use EMS if available\n");
-
-	fprintf(stderr, "       -o       - set overscan colour to darkest colour in colour map\n");
-
-	fprintf(stderr, "       -p n     - image position flag; values are:\n");
-
-	fprintf(stderr, "                  0 - Upper left; 1 - Upper right\n");
-
-	fprintf(stderr, "                  2 - Centre (default);\n");
-
-	fprintf(stderr, "                  3 - Lower left; 4 - Lower right\n");
-
-	fprintf(stderr, "       -?       - this message\n");
-
-	exit(1);
-
-}
-
-
-int
-fail(msg)
-	char           *msg;
-
-{
-
-	fprintf(stderr, "pcdisp: %s", msg);
-
-	exit(1);
-
-}
-
-
-int
-get_key(key)
-	int            *key;
-
-{
-
-/*
-	*key = _bios_keybrd(_KEYBRD_READY);
-
-	if (*key)
-		*key = _bios_keybrd(_KEYBRD_READ) & 0xff;
-*/
-
-	if (kbhit())
-		*key = getch();
-
-	return *key;
-
-}
-
-
-
-/*
- * Check if EMS is available, that there is enough and set the base page
- * address. Allocate ALL available EMS memory for us to use.
- */
-
-UINT
-init_EMS()
-{
-
-	UINT            EMS_handle = 0xFFFF;
-
-
-	EMS_available = FALSE;
-
-
-	if (EMS_rdy()) {
-
-		EMS_max_pages = EMS_count();
-
-
-		/* allocate ALL of EMS memory available */
-		EMS_handle = EMS_alloc(EMS_max_pages);
-
-		if (EMS_handle != 0xFFFF) {
-
-			EMS_addr = EMS_base();
-
-			EMS_available = TRUE;
-
-		}
-	}
-	return EMS_handle;
-
-}
-
-
-
-int
-uninit_EMS()
-{
-
-	EMS_release(EMS_handle);
-
-}
-
-
-
-/****
- * Handle user abort requests.
-  **/
-
-void
-ctrl_C()
-{
-
-	signal(SIGINT, SIG_IGN);/* ignore any abort requests in this routine */
-
-	uninit_EMS();
-
-	exit(1);
-
-}
-
-
-
-/*****
- * Setup adapter structures.
-  **/
-
-int
-load_adapters(a, n, auto_detect)
-	ADAPTER       **a;
-
-	int            *n;
-
-	int             auto_detect;
-
-{
-
-	ADAPTER        *adapters;
-
-	int             card = ADAPTER_NONE;
-
-
-	if (!(adapters = malloc(MAX_ADAPTERS * sizeof(ADAPTER)))) {
-
-		fail("no memory for adapter descriptions!");
-
-	}
-
-	fprintf(stderr, "in load_adatpters...\n");
-	/* determine what type of card we have */
-	if (auto_detect) {
-
-		if ((card = adapter_detect()) == ADAPTER_NONE)
-			return 0;
-
-	}
-	(*n) += setup_vga320x200(&adapters[(*n)]);
-
-	(*n) += setup_vga320x400(&adapters[(*n)]);
-
-	if (!auto_detect || card == ADAPTER_TSENG4)
-		(*n) += setup_tseng4000(&adapters[(*n)]);
-
-	if (!auto_detect || card == ADAPTER_TSENG)
-		(*n) += setup_tseng(&adapters[(*n)]);
-
-	if (!auto_detect || card == ADAPTER_VIDEO7)
-		(*n) += setup_video7(&adapters[(*n)]);
-
-	if (!auto_detect || card == ADAPTER_PARADISE)
-		(*n) += setup_paradise(&adapters[(*n)]);
-
-	if (!auto_detect || card == ADAPTER_CHIPS)
-		(*n) += setup_chips(&adapters[(*n)]);
-
-	if (!auto_detect || card == ADAPTER_TRIDENT)
-		(*n) += setup_trident(&adapters[(*n)]);
-
-	if (!auto_detect || card == ADAPTER_ATI)
-		(*n) += setup_ati(&adapters[(*n)]);
-
-	if (!auto_detect || card == ADAPTER_EVEREX)
-		(*n) += setup_everex(&adapters[(*n)]);
-
-	if (!auto_detect || card == ADAPTER_AHEADA)
-		(*n) += setup_aheada(&adapters[(*n)]);
-
-	if (!auto_detect || card == ADAPTER_AHEADB)
-		(*n) += setup_aheadb(&adapters[(*n)]);
-
-	if (!auto_detect || card == ADAPTER_OTI)
-		(*n) += setup_oaktech(&adapters[(*n)]);
-
-
-	*a = adapters;
-
-	fprintf(stderr, "returing from load_adapters..\n");
-	return 1;
-
-}
-
-
-int
-unload_adapters(a)
-	ADAPTER        *a;
-
-{
-
-	free(a);
-
-}
-
diff -Nrua vort-old/pc/pcdisp.doc vort-new/pc/pcdisp.doc
--- vort-old/pc/pcdisp.doc	1992-05-25 21:10:28.000000000 -0400
+++ vort-new/pc/pcdisp.doc	1969-12-31 19:00:00.000000000 -0500
@@ -1,122 +0,0 @@
-
-
-
-PCDISP(1)                USER COMMANDS                  PCDISP(1)
-
-
-
-NAME
-     pcdisp - a programme for displaying a pix image  file  on  a
-     VGA.
-
-USAGE
-     pcdisp [-a [p]] [-d] [-e] [-mn] [-o] [-p n] file1 file2 ...
-
-SYNOPSIS
-     pcdisp file
-
-DESCRIPTION
-     Disp displays a VORT image file on a VGA with extended graph-
-     ics. If the file has a colourmap (see median (1)), the image
-     is displayed using that  image  file's  colourmap.  Multiple
-     image  files  with  the  same  colourmap can be created with
-     mulmcut  (1).
-
- -a  is  for  displaying  multiple  files  in
-     sequence as quickly as possible.  It uses the colourmap of the first image
-     in the commandline. With the p parameter (i.e. -a p) an image's
-     palette is used only if it is different from the previous image
-     (previous means the image loaded from disk before the current one, not
-     the image displayed before the current one).
-     While the animation is running, the following keys can be used:
-            ESC, Q : quit
-            H : hold the animation at the current image, H again continues
-            S : single step mode, + and - advance and retreat the animation
-                one frame at a time. S again continues
-            D : toggles the delay between frames to full delay or no delay
-            - : when not in single step mode, decreases the delay between frames
-                down to a minumum of 0
-            + : when not in single step mode, increases the delay between frames
-                up to a some maximum
-     The image sequence is a continuous loop.
-
- -d  disables auto-detect of video hardware type. By default, pcdisp tries
-     to determine the type of video hardware within the host PC. It
-     happily detects standard VGA, TSENG4000, Paradise and Trident.
-     Others may work as well, but have not been tested.
-
- -e  disables use of EMS. By default, if there is EMS (3.2, 4.0)
-     available within the host, pcdisp will grab all of it. Video
-     mode 320x400 does not support the use of EMS.
-
-  -m followed  by  0, 1, ..., n  selects a 256 colour graphics device/mode
-     to use.
-     0 (the default) is 320 by 200
-     1 is 320 by 400 (does not suppoprt the use of EMS).
-     The value n depends on the presence of the -d flag. If it is set,
-     you will be able to select from the entire range of adapters supported. If
-     not, then you will be able to select from the modes pcdisp supports
-     for the detected video hardware.
-     The supported devices (chipsets) are:
-
-        ATI Wonder VGA
-        Everex
-        Trident
-        Video7
-        Paradise PVGA
-        Chips and Technology
-        Tseng
-        Tseng4000
-        Ahead Version A
-        Ahead Version B
-        Oakland Technologies
-        Standard VGA
-
-     Note, of the above, only VGA, Tseng4000 and Paradise have been tested.
-
--o   sets the overscan colour to the darkest  colour  in
-     the image. Useful for removing a sometimes ugly border from
-     the screen.
-
--p n sets the position of all following images up to the next -p parameter.
-        0  -  upper left     1  -  upper right 
-                   2  -   centered
-        3  -  lower left     4  -  lower right
-
-SEE ALSO
-     art(1),  pixinfo(1),  median(1),   targ2pix(1),   pix2ps(1),
-     gamma(1), mulmcut(1), greyscale(1), vort(3).
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-VORT 2.0            Last change: Feb 2, 1991                    1
-
-
-
diff -Nrua vort-old/pc/pcdisp.h vort-new/pc/pcdisp.h
--- vort-old/pc/pcdisp.h	1992-05-25 21:10:29.000000000 -0400
+++ vort-new/pc/pcdisp.h	1969-12-31 19:00:00.000000000 -0500
@@ -1,84 +0,0 @@
-/*
- * Header file for VORT pcdisp.
- *
- */
-
-#ifndef TRUE
-#define TRUE	1
-#define FALSE	0
-#endif
-
-#define	MAX_PALETTE	256			/* max size of a colour palette */
-#define	MAX_IMGWIDTH	2048	/* max width for an image */
-
-/* for brevity */
-typedef unsigned char UCHAR;
-typedef unsigned int UINT;
-typedef unsigned long ULONG;
-
-typedef UCHAR (far *VIDEO);		/* far pointer to video memory */
-typedef int (*PFI)();			/* pointer to function returning int */
-typedef void (far *(*PFP)());	/* pointer to function returning far pointer */
-
-/* video adapter info */
-typedef struct _ADAPTER {		/* description of adapter */
-			char	*descr;			/* text description of adapter (for usage info) */
-			int		width,			/* max width in pixels */
-					height,			/* max height in pixels */
-					depth;			/* max depth in bits */
-								/* register values for initializing mode with BIOS (used by init())*/
-			UINT	ax,				/* ax value */
-					bx;				/* bx value - 0 if not used */
-			UINT	cb;			/* current video bank */
-								/* functions */
-			PFI		init,			/* initialize the device */
-					putline,		/* copy a line of pixels to video */
-					EMSdecode,		/* decode a VORT RLE image in EMS to video */
-					getline,		/* copy a line of pixels from video - NOT IMPLEMENTED FULLY */
-					block,			/* copy a block of pixels to video */
-					fill,			/* fill block of pixels */
-					palette,		/* set colour palette */
-					overscan,		/* set overscan palette index */
-					front,			/* write to front video buffer */
-					back,			/* write to back video buffer */
-					swap,			/* swap front and back buffers */
-					text,			/* write text */
-					select_bank;	/* select video memory bank (used internally by "paddr" only) */
-			PFP		paddr;			/* return address of pixel */
-			} ADAPTER;
-
-/*
-
-	Adapter functions:
-
-		setup_xxxx()		- called explictly by main() to set ADAPTER stuff
-		init()				- puts adapter into required graphics mode
-		putline(p, w, x, y)	- writes pixel line "p" of pixel width "w" at co-ord (x,y)
-							  to selected video buffer (front or back). The line should
-							  be clipped.
-		EMSdecode(hdl, ofs, x, y, xlen, ylen)
-							- decodes the VORT RLE colour mapped image at EMS offset "ofs"
-							  (owned by EMS handle "hdl") to the selected video buffer
-							  at co-ords (x, y). The image has the dimensions (xlen, ylen).
-		getline(p, w, x, y)	- copies a line starting at co-ord (x, y) with a length "w"
-							  from selected video buffer to pixel buffer "p"
-		block(p, w, h, x, y)- writes a block of pixels "p" of pixel width "w"
-							  and height "h" starting at top left co-ord (x,y) to selected
-							  video buffer (front or back). The block should be clipped.
-		fill(x, y, w, h, c)	- sets specified area of video buffer to palette colour index "c"
-		palette(p, size)	- sets first "size" colour palette entries to values in "p".
-							  "p" palette entries are groups of 3 unsigned chars (r, g, b).
-		overscan(c)			- sets the overscan palette colour index to "c"
-		front()				- select the front video buffer. Does nothing if double buffering
-							  is not possible or practical.
-		back()				- select the back video buffer. Does nothing if double buffering
-							  is not possible or practical.
-		swap()				- swaps the front video buffer. Does nothing if double buffering
-							  is not possible or practical.
-		text(p, x, y)		- write text "p" to video buffer at top left co-ord (x,y)
-
-*/
-#ifdef TC
-extern unsigned _stklen;
-#endif
-
diff -Nrua vort-old/pc/pcdspveg.c vort-new/pc/pcdspveg.c
--- vort-old/pc/pcdspveg.c	1992-05-25 21:10:29.000000000 -0400
+++ vort-new/pc/pcdspveg.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,48 +0,0 @@
-/*
- * Helper routines for V/EGA routines of VORT PCDISP.
- */
-
-#include <stdio.h>
-#include <stdlib.h>
-#include <dos.h>
-
-#ifdef TC
-extern unsigned _stklen;
-#endif
-	
-static	union	REGS	regs;
-static	struct	SREGS	segregs;
-
-
-
-/*
- * Set the colour palette.
- */
-
-int			vega_palette(palette, size)
-char		*palette;
-int			size;
-{
-	regs.x.ax = 0x1012;
-	regs.x.bx = 0x0000;
-	regs.x.cx = size;
-	regs.x.dx = FP_OFF(palette);
-	segregs.es= FP_SEG(palette);
-	int86x(0x10, &regs, &regs, &segregs);
-}
-
-
-
-
-/*
- * Set the overscan palette index.
- */
-
-int			vega_overscan(index)
-int			index;
-{
-	regs.x.ax = 0x1001;
-	regs.h.bh = index;
-	int86(0x10, &regs, &regs);
-}
-
diff -Nrua vort-old/pc/pcdspvg1.c vort-new/pc/pcdspvg1.c
--- vort-old/pc/pcdspvg1.c	1992-05-25 21:10:29.000000000 -0400
+++ vort-new/pc/pcdspvg1.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,173 +0,0 @@
-/*
- * VGA 320 x 200 display routine for VORT PCDISP.
- */
-
-#include <stdio.h>
-#include <stdlib.h>
-#include <dos.h>
-#include <memory.h>
-#include "pcdisp.h"
-
-
-int		vega_palette();
-int		vega_overscan();
-
-static vga320x200_init();
-static vga320x200_line();
-static vga320x200_block();
-static vga320x200_fill();
-static vga320x200_front();
-static vga320x200_back();
-static vga320x200_swap();
-static vga320x200_text();
-extern vga320x200_EMSdecode();
-
-
-static	ADAPTER	vga320x200 = {
-			"VGA 320 x 200, 256 colour",
-			320,
-			200,
-			8,
-			0x13, 0,
-			0,
-			vga320x200_init,
-			vga320x200_line,
-			vga320x200_EMSdecode,
-			NULL,
-			vga320x200_block,
-			vga320x200_fill,
-			vega_palette,
-			vega_overscan,
-			vga320x200_front,
-			vga320x200_back,
-			vga320x200_swap,
-			vga320x200_text,
-			NULL,
-			NULL
-			};
-
-
-/* for doing system stuff */
-static	union	REGS	regs;
-static	struct	SREGS	segregs;
-
-
-/* vga video buffer pointers */
-static	char	*vfbuf,
-				*vbbuf,
-				*vp;
-
-/* video buffer flag: == 0 front buffer; != 0 back buffer */
-static	int		to_back_buffer = 0;
-static	int		double_buffer = FALSE;
-
-
-
-int			setup_vga320x200(a)
-ADAPTER		*a;
-{
-	memmove(a, &vga320x200, sizeof(vga320x200));
-	return 1;
-}
-
-
-static
-int			vga320x200_init()
-{
-	regs.x.ax = 0x13;
- 	int86(0x10, &regs, &regs);
-
-	vfbuf = vp = (char *)0xa0000000;
-	vbbuf = calloc(vga320x200.width*vga320x200.height, 1);
-	if (!vbbuf) {
-		fprintf(stderr, "setup_vga320x200: memory request for %u bytes failed\n", vga320x200.width*vga320x200.height);
-		double_buffer = FALSE;
-		}
-	else double_buffer = TRUE;
-	return 1;
-}
-
-
-static
-int			vga320x200_line(p, l, x, y)
-char		*p;
-int			l,
-			x,
-			y;
-{
-	if (y >= 200 || x >= 319) return;
-	memmove(vp + y*320 + x, p, min(l, 320-x));
-}
-
-
-static
-int			vga320x200_block(p, w, h, x, y)
-char		*p;
-int			w,
-			h,
-			x,
-			y;
-{
-	int		i, w1;
-	char	*v;
-
-	/* ensure everything is in range */
-	v = vp + y*320 + x;
-	if (w + x > 320) w1 = 320 - x;
-	else w1 = w;
-	if (h + y > 200) h = 200 - y;
-
-	/* output line by line */
-	for (i = 0; i < h; i++) {
-		memmove(v, p, w1);
-		v += 320;
-		p += w;
-		}
-}
-
-
-static
-int			vga320x200_fill(x, y, w, h, palette_index)
-{
-	int		j;
-
-	if (x == 0 && y == 0 && w == 320 && h == 200) {
-		memset(vp, palette_index, 320*200);
-		}
-	else {
-		for (j = 0; j < h; j++) {
-			memset(vp+j*320+x, palette_index, w);
-			}
-		}
-}
-
-
-static
-int			vga320x200_front()
-{
-	if (double_buffer) vp = vfbuf;
-}
-
-
-static
-int			vga320x200_back()
-{
-	if (double_buffer) vp = vbbuf;
-}
-
-
-static
-int			vga320x200_swap()
-{
-	if (double_buffer) memmove(vfbuf, vbbuf, 320*200);
-}
-
-
-static
-int			vga320x200_text(p, x, y)
-char		*p;
-int			x,
-			y;
-{
-}
-
diff -Nrua vort-old/pc/pcdspvg2.c vort-new/pc/pcdspvg2.c
--- vort-old/pc/pcdspvg2.c	1992-05-25 21:10:29.000000000 -0400
+++ vort-new/pc/pcdspvg2.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,158 +0,0 @@
-/*
- * VGA 320 x 400 display routine for VORT PCDISP.
- *
- * Only works fairly simply. No EMS handling or arbitrary
- * image positioning.
- *
- * Uses external routines defined in 320x400.asm:
- *		
- *		Set320x400Mode();
- *		Out320x400Line();
- *		Page320x400();
- */
-
-#include <stdio.h>
-#include <stdlib.h>
-#include <dos.h>
-#include <memory.h>
-#include "pcdisp.h"
-
-
-int		vega_palette();
-int		vega_overscan();
-
-static vga320x400_init();
-static vga320x400_line();
-static vga320x400_block();
-static vga320x400_erase();
-static vga320x400_front();
-static vga320x400_back();
-static vga320x400_swap();
-static vga320x400_text();
-	
-
-static	ADAPTER	vga320x400 = {
-			"VGA 320 x 400, 256 colour",
-			320,
-			400,
-			8,
-			0, 0,
-			0,
-			vga320x400_init,
-			vga320x400_line,
-			NULL,
-			NULL,
-			vga320x400_block,
-			vga320x400_erase,
-			vega_palette,
-			vega_overscan,
-			vga320x400_front,
-			vga320x400_back,
-			vga320x400_swap,
-			vga320x400_text,
-			NULL,
-			NULL,
-			};
-
-/* for doing system stuff */
-static	union	REGS	regs;
-static	struct	SREGS	segregs;
-
-
-/* video buffer flag: == 0 front buffer; != 0 back buffer */
-static	int		to_back_buffer = 0;
-
-/* static buffer for performing erases of a line */
-static	char	line[320];
-
-int			setup_vga320x400(a)
-ADAPTER		*a;
-{
-	memmove(a, &vga320x400, sizeof(vga320x400));
-	return 1;
-}
-
-
-static
-int			vga320x400_init()
-{
-	Set320x400Mode();
-}
-
-
-static
-int			vga320x400_line(p, l, x, y)
-char		*p;
-int			l,
-			x,
-			y;
-{
-	Out320x400Line(y, p, l, to_back_buffer);
-}
-
-
-static
-int			vga320x400_block(p, w, h, x, y)
-char		*p;
-int			w,
-			h,
-			x,
-			y;
-{
-	int		i, w1;
-
-	/* ensure everything is in range */
-	if (w + x > 320) w1 = 320 - x;
-	else w1 = w;
-	if (h + y > 400) h = 400 - y;
-
-	/* output line by line - doesn't handle x offset */
-	for (i = 0; i < h; i++) {
-		Out320x400Line(y+i, p, w1, to_back_buffer);
-		p += w;
-		}
-}
-
-
-static
-int			vga320x400_erase(x, y, w, h, palette_index)
-{
-	int		j;
-
-	/* ignore x and w parameters since our line output routine doesn't */
-	/* yet handle specification of start and end x-coords! */
-	memset(line, palette_index, 400);
-	for (j = 0; j < h; j++) Out320x400Line(j, line, 400, to_back_buffer);
-}
-
-
-static
-int			vga320x400_front()
-{
-	to_back_buffer = 0;
-}
-
-
-static
-int			vga320x400_back()
-{
-	to_back_buffer = 1;
-}
-
-
-static
-int			vga320x400_swap()
-{
-	page320x400(to_back_buffer);
-	to_back_buffer = !to_back_buffer;
-}
-
-
-static
-int			vga320x400_text(p, x, y)
-char		*p;
-int			x,
-			y;
-{
-}
-
diff -Nrua vort-old/pc/README vort-new/pc/README
--- vort-old/pc/README	1992-05-25 21:10:27.000000000 -0400
+++ vort-new/pc/README	1969-12-31 19:00:00.000000000 -0500
@@ -1,7 +0,0 @@
-
-The fgraph.lib file is apparently from a version of fractint by Bert Tyler
-and Timothy Wegner, fractint can be found on:
-
-wuarchive.wustl.edu	mirrors/graphics/
-
-and the files are frain14r.zip, frasrc14.zip. FRACTINT is also on simtel20.
diff -Nrua vort-old/pc/savegif.c vort-new/pc/savegif.c
--- vort-old/pc/savegif.c	1992-05-25 21:10:29.000000000 -0400
+++ vort-new/pc/savegif.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,279 +0,0 @@
-
-/*
-        encoder.c - GIF Encoder and associated routines
-
-*/
-
-#include "extra.h"
-#include "showpix.h"
-
-/*
-                        Save-To-Disk Routines (GIF)
-
-GIF and 'Graphics Interchange Format' are trademarks (tm) of Compuserve
-Incorporated, an H&R Block Company.
-
-
-The following routines perform the GIF encoding when the 's' key is pressed.
-The routines refer to several variables that are declared elsewhere
-[colors, xdots, ydots, and 'dacbox'], and rely on external routines to
-actually read and write screen pixels [getcolor(x,y) and putcolor(x,y,color)].
-(Writing pixels is just stuffed in here as a sort of visual status report,
-and has nothing to do with any GIF function.)   They also rely on the
-existence of an externally-defined 64K dataspace and they use the routines
-'toextra()' and 'cmpextra()' to deal with that dataspace (in the same manner
-as 'memcpy()' and 'memcmp()' would).   Otherwise, they perform a generic
-GIF-encoder function.
-
-Note that these routines use small string- and hash-tables, and "flush"
-the GIF entries whenever the hash-table gets two-thirds full or the string
-table gets full.   They also use the GIF encoding technique of limiting the
-encoded string length to a specific size, "adding" a string to the hash table
-at that point even if a matching string exists ("adding" is in quotes, because
-if a matching string exists we can increment the code counter but safely throw
-the duplicate string away, saving both string space and a hash table entry).
-
-   This results in relatively good speed and small data space, but at the
-expense of compression efficiency (filesize).   These trade-offs could be
-adjusted by modifying the #DEFINEd variables below.
-
-Note that the 'strlocn' and 'teststring' routines are declared
-to be external just so that they can be defined (and the space re-used)
-elsewhere.  The actual declarations are in the assembler code.
-
-*/
-
-#define MAXTEST   100           /* maximum single string length */
-#define MAXSTRING 64000         /* total space reserved for strings */
-                                /* maximum number of strings available */
-#define MAXENTRY  5003          /* (a prime number is best for hashing) */
-
-extern unsigned int strlocn[MAXENTRY];
-extern unsigned char teststring[MAXTEST];
-unsigned char block[266];   /* GIF-encoded blocks go here */
-
-static FILE *out;
-
-static int lentest, lastentry, numentries, numrealentries;
-static unsigned int nextentry;
-static int clearcode, endcode;
-static unsigned int hashcode;
-
-static unsigned char blockcount;
-static int startbits, codebits, bytecount, bitcount;
-
-
-int savegif(char *filename)                    /* save-to-disk routine */
-{
-char openfile[80], openfiletype[10];
-int i, j, ydot, xdot, color, outcolor1, outcolor2;
-unsigned int hashentry;
-unsigned char bitsperpixel, x;
-int entrynum;
-
-if (extraseg == 0)                      /* not enough memory for this */
-        return -1;
-
-if ((out=fopen(filename,"wb")) == NULL) {
-        return 0;
-        }
-
-bitsperpixel = 0;                       /* calculate bits / pixel */
-for (i = colors; i >= 2; i /= 2 )
-        bitsperpixel++;
-
-startbits = bitsperpixel+1;             /* start coding with this many bits */
-if (colors == 2)
-        startbits++;                    /* B&W Klooge */
-
-clearcode = 1 << (startbits - 1);       /* set clear and end codes */
-endcode = clearcode+1;
-
-outcolor1 = 2;                          /* use these colors to show progress */
-outcolor2 = 3;                          /* (this has nothing to do with GIF) */
-
-fwrite("GIF87a",1,6,out);               /* GIF Signature */
-
-fwrite(&xdots,2,1,out);                 /* screen descriptor */
-fwrite(&ydots,2,1,out);
-x = 128 + ((6-1)<<4) + (bitsperpixel-1); /* color resolution == 6 bits worth */
-fwrite(&x,1,1,out);
-i = 0;
-fwrite(&i,1,1,out);
-fwrite(&i,1,1,out);
-
-shftwrite(dacbox,colors);
-
-fwrite(",",1,1,out);                    /* Image Descriptor */
-i = 0;
-fwrite(&i,2,1,out);
-fwrite(&i,2,1,out);
-fwrite(&xdots,2,1,out);
-fwrite(&ydots,2,1,out);
-i = 0;
-fwrite(&i,1,1,out);
-
-bitsperpixel = startbits - 1;           /* raster data starts here */
-fwrite(&bitsperpixel,1,1,out);
-
-codebits = startbits;                   /* start encoding */
-
-raster(9999);                           /* initialize the raster routine */
-
-inittable();                            /* initialize the LZW tables */
-
-for (ydot = 0; ydot < ydots; ydot++) {  /* scan through the dots */
-        for (xdot = 0; xdot < xdots; xdot++) {
-                color = getcolor(xdot,ydot);    /* get the next dot */
-                teststring[0] = ++lentest;
-                teststring[lentest] = color;
-                if (lentest == 1) {             /* root entry? */
-                        lastentry = color;
-                        continue;
-                        }
-                if (lentest == 2)               /* init   the hash code */
-                        hashcode = 301 * (teststring[1]+1);
-                hashcode *= (color + lentest);  /* update the hash code */
-                hashentry = ++hashcode % MAXENTRY;
-                for( i = 0; i < MAXENTRY; i++) {
-                        if (++hashentry >= MAXENTRY) hashentry = 0;
-                        if (cmpextra(strlocn[hashentry]+2,
-                                teststring,lentest+1) == 0)
-                                        break;
-                        if (strlocn[hashentry] == 0) i = MAXENTRY;
-                        }
-                /* found an entry and string length isn't too bad */
-                if (strlocn[hashentry] != 0 && lentest < MAXTEST-3) {
-                        fromextra(strlocn[hashentry],&entrynum,2);
-                        lastentry = entrynum;
-                        continue;
-                        }
-                raster(lastentry);                      /* write entry */
-                numentries++;           /* act like you added one, anyway */
-                if (strlocn[hashentry] == 0) {  /* add new string, if any */
-                        entrynum = numentries+endcode;
-                        strlocn[hashentry] = nextentry;
-                        toextra(nextentry, &entrynum,2);
-                        toextra(nextentry+2,
-                                teststring,lentest+1);
-                        nextentry += lentest+3;
-                        numrealentries++;
-                        }
-                teststring[0] = 1;              /* reset current entry */
-                teststring[1] = color;
-                lentest = 1;
-                lastentry = color;
-
-                if ((numentries+endcode) == (1<<codebits))
-                        codebits++;              /* use longer encoding */
-
-                if ( numentries + endcode > 4093 ||     /* out of room? */
-                        numrealentries > (MAXENTRY*2)/3 ||
-                        nextentry > MAXSTRING-MAXTEST-5) {
-                        raster(lastentry);              /* flush & restart */
-                        inittable();
-                        }
-                }
-
-                if ((ydot & 4) == 0) {
-                        if (++outcolor1 >= colors) outcolor1 = 0;
-                        if (++outcolor2 >= colors) outcolor2 = 0;
-                        }
-                for (i = 0; 250*i < xdots; i++) {       /* display vert status bars */
-                        putcolor(      i,ydot,outcolor1);       /*   (this is NOT   */
-                        putcolor(xdots-1-i,ydot,outcolor2);     /*    GIF-related)  */
-                        }
-        if (kbhit())                            /* keyboard hit - bail out */
-                ydot = 9999;
-        }
-
-raster(lastentry);                      /* tidy up - dump the last code */
-
-raster(endcode);                        /* finish the map */
-
-i = 0;                                  /* raster data ends here */
-fwrite(&i,1,1,out);
-
-fwrite(";",1,1,out);                    /* GIF Terminator */
-
-fclose(out);
-if (ydot < 9999)                        /* signal normal or interrupted end */
-        return 1;
-else
-        return 0;
-}
-
-shftwrite(color,numcolors)              /* shift IBM colors to GIF format */
-unsigned char color[];
-int numcolors;
-{
-unsigned char thiscolor;
-int i,j;
-for (i = 0; i < numcolors; i++)
-        for (j = 0; j < 3; j++) {
-                thiscolor = color[3*i+j];
-                thiscolor = thiscolor << 2;
-                thiscolor += (thiscolor >> 6);
-                fwrite(&thiscolor,1,1,out);
-                }
-}
-
-inittable()                             /* routine to init tables */
-{
-int i;
-
-raster(clearcode);                      /* signal that table is initialized */
-
-numentries = 0;                         /* initialize the table */
-numrealentries = 0;
-nextentry = 1;
-lentest = 0;
-codebits = startbits;
-
-toextra(0,"\0",1);                      /* clear the hash entries */
-for (i = 0; i < MAXENTRY; i++)
-        strlocn[i] = 0;
-
-}
-
-raster(code)                            /* routine to block and output codes */
-unsigned int code;
-{
-unsigned int icode, i, j;
-
-if (code == 9999) {                     /* special start-up signal */
-        bytecount = 0;
-        bitcount = 0;
-        for (i = 0; i < 266; i++)
-                block[i] = 0;
-        return(0);
-        }
-
-icode = code << bitcount;               /* update the bit string */
-block[bytecount  ] |= (icode & 255);
-block[bytecount+1] |= ((icode>>8) & 255);
-icode = (code>>8) << bitcount;
-block[bytecount+2] |= ((icode>>8) & 255);
-bitcount += codebits;
-while (bitcount >= 8) {                 /* locate next starting point */
-        bitcount -= 8;
-        bytecount++;
-        }
-
-if (bytecount > 250 || code == endcode) {       /* time to write a block */
-        if (code == endcode)
-                while (bitcount > 0) {          /* if EOF, find the real end */
-                        bitcount -= 8;
-                        bytecount++;
-                        }
-        i = bytecount;
-        blockcount = i;
-        fwrite(&blockcount,1,1,out);            /* write the block */
-        fwrite(block,i,1,out);
-        bytecount = 0;                          /* now re-start the block */
-        for (j = 0; j < 5; j++)                 /* (may have leftover bits) */
-                block[j] = block[j+i];
-        for (j = 5; j < 266; j++)
-                block[j] = 0;
-        }
-}
diff -Nrua vort-old/pc/shcline.c vort-new/pc/shcline.c
--- vort-old/pc/shcline.c	1992-05-25 21:10:29.000000000 -0400
+++ vort-new/pc/shcline.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,223 +0,0 @@
-/* command line creator/analyzer for showpix */
-#include "showpix.h"
-
-
-int clp;
-char cline[1000];
-
-void buildcline(int argc, char **argv)
-{
-    int i, j;
-    char c, *e;
-    FILE *f;
-
-    cline[0]=0;
-
-    if ((e=getenv("SHOWPIX")) != NULL)
-         strcat(cline, e);
-
-    for (i=1; i<argc; i++) {
-         strcat(cline, " ");
-
-         if (argv[i][0] != '@')
-              strcat(cline, argv[i]);
-         else {
-              /* add the file in the line */
-              j=strlen(cline);
-
-              f=fopen(argv[i]+1, "r");
-
-              if (f==NULL) {
-                   printf("%s, unable to open the file.", argv[i]);
-                   exit(-1);
-                   }
-
-              while( (c=getc(f)) != EOF)
-                   cline[j++]=c;
-
-              fclose(f);
-
-              cline[j]=0;
-              }
-         }
-
-    clp=0;
-    while (isspace(cline[clp]))
-         clp++;
-}
-
-
-
-int nextchr(int *nc)
-{
-    int tc, cllp;
-
-    if (isspace(cline[clp]))
-         tc=' ';
-    else
-         tc=cline[clp];
-
-    if (cline[clp]==0)
-         *nc=0;
-    else {
-         cllp=clp+1;
-         while(isspace(cline[cllp]))
-              cllp++;
-         *nc=cline[cllp];
-         clp++;
-         }
-
-
-    return tc;
-}
-
-
-
-int nextarg(char *a)
-{
-    int i=0, nc, nnc, inp=0;
-
-remake:
-    while(isspace(cline[clp]))
-         clp++;
-
-    if ((nc=nextchr(&nnc)) == 0)
-         return -1;
-
-makearg:
-    if (nc==0 || (nc==' ' && inp==0 && nnc!='('))
-         goto endarg;
-
-    a[i++]=nc;
-    if (nc=='(')
-         inp=1;
-    if (nc==')')
-         inp=0;
-
-    if (nnc=='+')
-         goto endarg;
-
-    nc=nextchr(&nnc);
-    goto makearg;
-
-endarg:
-    a[i]=0;
-
-    if (0==strcmp(a, "+"))
-         goto remake;
-
-    return 1;
-}
-
-
-
-void setopt(int *whatopt, char c)
-{
-    if (c=='n')
-         *whatopt=NO;
-    else
-         *whatopt=YES;
-}
-
-
-
-void analoption(char *s)
-{
-    int i;
-    long l;
-
-    if (0==strncmp(s, "-a", 2))
-         setopt(&autosave, s[2]);
-    else if (0==strcmp(s, "-r"))
-         options=REDPLANE;
-    else if (0==strcmp(s, "-g"))
-         options=GREENPLANE;
-    else if (0==strcmp(s, "-b"))
-         options=BLUEPLANE;
-    else if (0==strcmp(s, "-f"))
-         options=FULLCOLORS;
-    else if (0==strcmp(s, "-m"))
-         options=MONOCHROME;
-    else if (0==strncmp(s, "-c", 2))
-         setopt(&centering, s[2]);
-    else if (0==strncmp(s, "-s", 2))
-         setopt(&showtitle, s[2]);
-    else if (0==strcmp(s, "-k")) {
-         imagewait=31536000L;
-         titlewait=imagewait;
-         }
-    else if (0==strncmp(s, "-w", 2))
-         if (1==sscanf(s+2, "%ld", &l))
-              imagewait=l;
-         else {
-              returntotext();
-              puts("The -w option expects a number.");
-              exit(-1);
-              }
-    else if (0==strncmp(s, "-W", 2))
-         if (1==sscanf(s+2, "%ld", &l))
-              titlewait=l;
-         else {
-              returntotext();
-              puts("The -W option expects number.");
-              exit(-1);
-              }
-
-    else if (0==strncmp(s, "-tl", 3)) {
-         options=TRICKYL;
-
-         strcpy(trickyd, s+3);
-         if (trickyd[0]==0) {
-              trickyd[0]='0';
-              trickyd[1]='2';
-              trickyd[2]=0;
-              }
-
-         tricklen=strlen(trickyd);
-         for (i=0; i<tricklen; i++) {
-              if (trickyd[i]<'0' || trickyd[i]>'5') {
-                   returntotext();
-                   puts("Illegal value in tricky mode pattern.");
-                   exit(-1);
-                   }
-
-              trickyd[i]-='0';
-              }
-         }
-
-    else if (0==strcmp(s, "-ts"))
-         options=TRICKYS;
-
-    else if (0==strcmp(s, "-tS"))
-         options=TRICKY2S;
-
-    else if (0==strncmp(s, "-v", 2))
-         if (1==sscanf(s+2, "%d", &i))
-              videomode=i;
-         else {
-              returntotext();
-              puts("The -v option expects a video adapter number.");
-              exit(-1);
-              }
-
-    else {
-         returntotext();
-         printf("Unknown option %s.\n", s);
-         exit(-1);
-         }
-}
-
-
-int getnextname(char *n)
-{
-begin:
-    if (nextarg(n)==-1)
-         return -1;
-
-    if (n[0]=='-') {
-         analoption(n);
-         goto begin;
-         }
-
-    return 1;
-}
diff -Nrua vort-old/pc/shdisp.c vort-new/pc/shdisp.c
--- vort-old/pc/shdisp.c	1992-05-25 21:10:29.000000000 -0400
+++ vort-new/pc/shdisp.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,475 +0,0 @@
-/* display routines for showpix */
-
-#include "showpix.h"
-
-#define pixred(xoff, lin) ( \
-        ((imagetype(im)==PIX_CMAP) || (imagetype(im)==PIX_RLECMAP)) ? \
-        (im->red[ r[lin][xoff] ]) : ( r[lin][xoff]) )
-#define pixgreen(xoff, lin) ( \
-        ((imagetype(im)==PIX_CMAP) || (imagetype(im)==PIX_RLECMAP)) ? \
-        (im->green[ r[lin][xoff] ]) : ( g[lin][xoff]) )
-#define pixblue(xoff, lin) ( \
-        ((imagetype(im)==PIX_CMAP) || (imagetype(im)==PIX_RLECMAP)) ? \
-        (im->blue[ r[lin][xoff] ]) : ( b[lin][xoff]) )
-
-
-
-/* colour map info */
-int cmap_size = PALETTE_SIZE;
-int paltype;
-int pattern[6][3]= { {0, 1, 2}, {1, 2, 0},
-                     {2, 0, 1}, {0, 2, 1},
-                     {2, 1, 0}, {1, 0, 2} };
-int trkyd[10];
-int trkysshift;
-int hgt, wdt;
-
-
-int setvideostats(int mode)
-{
-    if ((mode<1)||(mode>MAXVIDEO))
-         return -1;
-
-    mode--;
-
-    dismode=videos[mode][0];
-    disxw=videos[mode][1];
-    disyw=videos[mode][2];
-
-    return 1;
-}
-
-
-/* paltype==0 ->external    1 ->64-shades      2 ->square trick  */
-
-
-void make_palette(void)
-{
-        int i, r1, g1, b1, drk;
-        long int intensity, darkest=0x7FFFFFFF;
-
-        paltype=1;
-        if (imagetype(im)==PIX_CMAP || imagetype(im)==PIX_RLECMAP &&
-            options==FULLCOLORS)
-              paltype=0;
-
-        if (options==TRICKYS || options==TRICKY2S)
-              paltype=2;
-
-        switch(paltype) {
-
-        case 0:
-              /* set up colour palette for colour map files */
-              for (i = 0; i < cmapsize(im); i++) {
-                   /* 6-bits only per value please */
-                   r1 = dacbox[i][0]=im->red[i] >> 2;
-                   g1 = dacbox[i][1]=im->green[i] >> 2;
-                   b1 = dacbox[i][2]=im->blue[i] >> 2;
-                   /* check if this colour is darker than previous darkest */
-                   intensity=(r1*r1 + g1*g1 + b1*b1);
-                   if (intensity<darkest) {
-                        darkest=intensity;
-                        drk=i;
-                        }
-                   }
-              cmap_size = cmapsize(im);
-              break;
-
-        case 1:
-              /* set up a 64-shades palette */
-
-              for (i=0; i<64; i++) {
-                   dacbox[i][0]=i;
-                   dacbox[i][1]=i;
-                   dacbox[i][2]=i;
-
-                   dacbox[64+i][0]=i;
-                   dacbox[64+i][1]=0;
-                   dacbox[64+i][2]=0;
-
-                   dacbox[128+i][0]=0;
-                   dacbox[128+i][1]=i;
-                   dacbox[128+i][2]=0;
-
-                   dacbox[192+i][0]=0;
-                   dacbox[192+i][1]=0;
-                   dacbox[192+i][2]=i;
-                   }
-
-              cmap_size=256;
-              break;
-
-        case 2:
-              /* altered 64-shades palette */
-              for (i=0; i<64; i++) {
-                   dacbox[i][0]=i*50/63;
-                   dacbox[i][1]=i*50/63;
-                   dacbox[i][2]=i*38/63;
-
-                   dacbox[64+i][0]=i;
-                   dacbox[64+i][1]=0;
-                   dacbox[64+i][2]=0;
-
-                   dacbox[128+i][0]=0;
-                   dacbox[128+i][1]=i;
-                   dacbox[128+i][2]=0;
-
-                   dacbox[192+i][0]=0;
-                   dacbox[192+i][1]=0;
-                   dacbox[192+i][2]=i;
-                   }
-
-              cmap_size=256;
-              break;
-              }
-}
-
-
-
-void inittrick(int xc)
-{
-    int i, v;
-
-    if (options==TRICKYL) {
-         v=xc % 3;
-         for (i=0; i<tricklen; i++)
-              if (trickyd[i]<3)
-                   trkyd[i]= (trickyd[i] + v) % 3;
-              else
-                   trkyd[i]= 3 + (trickyd[i] + v) % 3;
-         }
-    else
-         trkysshift=xc&1;
-
-}
-
-
-
-
-void convertlines(int yc, int begr, int begw)
-{
-    int i, to1, to2, v1, v2, v3, c[4];
-    unsigned int vi1, vi2;
-
-    if (paltype==0) {   /* external, do nothing */
-         for (i=0; i<wdt; i++) {
-              s[0][begw]=r[0][begr];
-              s[1][begw++]=r[1][begr++];  /* just copy */
-              }
-
-         return;
-         }
-
-    if (options!=TRICKYL && options!=TRICKYS && options!=TRICKY2S) {
-         for (i=0; i<wdt; i++) {
-              switch(options) {
-              case REDPLANE:
-                   vi1=pixred(begr, 0);
-                   vi1=64+(vi1>>2);
-                   vi2=pixred(begr, 1);
-                   vi2=64+(vi2>>2);
-                   break;
-
-              case GREENPLANE:
-                   vi1=pixgreen(begr, 0);
-                   vi1=128+(vi1>>2);
-                   vi2=pixgreen(begr, 1);
-                   vi2=128+(vi2>>2);
-                   break;
-
-              case BLUEPLANE:
-                   vi1=pixblue(begr, 0);
-                   vi1=192+(vi1>>2);
-                   vi2=pixblue(begr, 1);
-                   vi2=192+(vi2>>2);
-                   break;
-
-              case FULLCOLORS:
-              case MONOCHROME:
-                   vi1=90*(unsigned int) pixred(begr, 0);
-                   vi1+=140*(unsigned int) pixgreen(begr, 0);
-                   vi1+=25*(unsigned int) pixblue(begr, 0);
-                   vi1=(int)(vi1>>10);
-                   vi2=90*(unsigned int) pixred(begr, 1);
-                   vi2+=140*(unsigned int) pixgreen(begr, 1);
-                   vi2+=25*(unsigned int) pixblue(begr, 1);
-                   vi2=(int)(vi2>>10);
-                   break;
-                   }
-
-              s[0][begw]=vi1;
-              s[1][begw++]=vi2;
-              begr++;
-              }
-
-         return;
-         }
-    else {
-         /* do the trick...... */
-         for (i=0; i<wdt;) {
-              v1=i;
-              v2=i+1;
-              v3=i+2;
-
-              if (v1>=wdt)
-                   v1=wdt;
-              if (v2>=wdt)
-                   v2=wdt;
-              if (v3>=wdt)
-                   v3=wdt;
-
-              v1+=begr;
-              v2+=begr;
-              v3+=begr;
-
-              switch(options) {
-              case TRICKYL:
-                   to1=trkyd[yc % tricklen];
-                   to2=trkyd[(yc+1) % tricklen];
-
-                   c[0]=pixred(v1, 0);
-                   c[0]+=pixred(v2, 0);
-                   c[0]+=pixred(v3, 0);
-                   c[1]=pixgreen(v1, 0);
-                   c[1]+=pixgreen(v2, 0);
-                   c[1]+=pixgreen(v3, 0);
-                   c[2]=pixblue(v1, 0);
-                   c[2]+=pixblue(v2, 0);
-                   c[2]+=pixblue(v3, 0);
-
-                   c[0]/=12;
-                   c[1]/=12;
-                   c[2]/=12;
-
-                   s[0][begw]=64*(1+pattern[to1][0])+c[pattern[to1][0]];
-                   s[0][begw+1]=64*(1+pattern[to1][1])+c[pattern[to1][1]];
-                   s[0][begw+2]=64*(1+pattern[to1][2])+c[pattern[to1][2]];
-
-                   c[0]=pixred(v1, 1);
-                   c[0]+=pixred(v2, 1);
-                   c[0]+=pixred(v3, 1);
-                   c[1]=pixgreen(v1, 1);
-                   c[1]+=pixgreen(v2, 1);
-                   c[1]+=pixgreen(v3, 1);
-                   c[2]=pixblue(v1, 1);
-                   c[2]+=pixblue(v2, 1);
-                   c[2]+=pixblue(v3, 1);
-
-                   c[0]/=12;
-                   c[1]/=12;
-                   c[2]/=12;
-
-                   s[1][begw++]=64*(1+pattern[to2][0])+c[pattern[to2][0]];
-                   s[1][begw++]=64*(1+pattern[to2][1])+c[pattern[to2][1]];
-                   s[1][begw++]=64*(1+pattern[to2][2])+c[pattern[to2][2]];
-
-                   i+=3;
-                   break;
-
-              case TRICKY2S:
-                   c[0]=pixred(v1, 0);
-                   c[0]/=4;
-                   c[1]=pixgreen(v1, 0);
-                   c[1]/=4;
-                   c[2]=pixblue(v1, 0);
-                   c[2]/=4;
-                   c[3]=(c[0]+c[1]+c[2])/3;
-
-                   if (trkysshift==0) {
-                        s[0][begw]=c[0]+64;
-                        s[1][begw++]=c[2]+192;
-                        s[0][begw]=c[1]+128;
-                        s[1][begw++]=c[3];
-                        }
-                   else {
-                        s[0][begw]=c[1]+128;
-                        s[1][begw++]=c[3];
-                        s[0][begw]=c[0]+64;
-                        s[1][begw++]=c[2]+192;
-                        }
-
-                   i++;
-                   break;
-
-              case TRICKYS:
-                   c[0]=pixred(v1, 0);
-                   c[0]+=pixred(v2, 0);
-                   c[0]+=pixred(v1, 1);
-                   c[0]+=pixred(v2, 1);
-                   c[0]/=16;
-                   c[1]=pixgreen(v1, 0);
-                   c[1]+=pixgreen(v2, 0);
-                   c[1]+=pixgreen(v1, 1);
-                   c[1]+=pixgreen(v2, 1);
-                   c[1]/=16;
-                   c[2]=pixblue(v1, 0);
-                   c[2]+=pixblue(v2, 0);
-                   c[2]+=pixblue(v1, 1);
-                   c[2]+=pixblue(v2, 1);
-                   c[2]/=16;
-                   c[3]=(c[0]+c[1]+c[2])/3;
-
-                   if (trkysshift==0) {
-                        s[0][begw]=c[0]+64;
-                        s[1][begw++]=c[2]+192;
-                        s[0][begw]=c[1]+128;
-                        s[1][begw++]=c[3];
-                        }
-                   else {
-                        s[0][begw]=c[1]+128;
-                        s[1][begw++]=c[3];
-                        s[0][begw]=c[0]+64;
-                        s[1][begw++]=c[2]+192;
-                        }
-
-                   i+=2;
-                   break;
-                   }
-              }
-         }
-}
-
-
-
-int readlines(int yp)
-{
-    int dy=1;
-
-    switch(imagetype(im)) {
-    case PIX_CMAP :
-    case PIX_RLECMAP :
-         readmappedline(im, r[0]);
-         if ((hgt&1) && yp==(hgt-1) || options==TRICKY2S)
-              memcpy(r[1], r[0], wdt);
-         else {
-              readmappedline(im, r[1]);
-              dy=2;
-              }
-         break;
-
-    default :
-         readrgbline(im, r[0], g[0], b[0]);
-         if ((hgt&1) && yp==(hgt-1) || options==TRICKY2S) {
-              memcpy(r[1], r[0], wdt);
-              memcpy(g[1], g[0], wdt);
-              memcpy(b[1], b[0], wdt);
-              }
-         else {
-              readrgbline(im, r[1], g[1], b[1]);
-              dy=2;
-              }
-         break;
-         }
-
-    return dy;
-}
-
-
-
-void display_image(int bx, int by, int shifted, int single)
-{
-        int x, y, px, py, dy=2;
-
-        wdt = imagewidth(im);
-        hgt = imageheight(im);
-
-        if (!shifted && centering) {
-              bx=(disxw-wdt)/2;
-              by=(disyw-hgt)/2;
-              }
-
-        if (imagefragment(im)) {
-              bx+=imagexaddr(im);
-              by+=imageyaddr(im);
-              }
-
-        if (single) {
-              for (x=0; x<MAX_IMGWIDTH*3; x++) {
-                   s[0][x]=0;
-                   s[1][x]=0;
-                   }
-
-              gotographics(dismode);
-              /* remap palette */
-              make_palette();
-              storedac();
-              }
-
-        if (options==TRICKYL || options==TRICKYS || options==TRICKY2S)
-              inittrick(bx);
-
-        /* display image line by line */
-        imagepos(im, 0, 0);
-        switch (imagetype(im)) {
-
-              case PIX_CMAP :
-              case PIX_RLECMAP :
-                   if (single) {
-                        rowcount=by;
-                        for (y = 0; (y<hgt && rowcount<disyw); y+=dy) {
-                                dy=readlines(y);
-
-                                if (rowcount>=0) {
-                                     convertlines(y, 0, bx+1280);
-                                     out_line(s[0]+1280, disxw);
-                                     out_line(s[1]+1280, disxw);
-                                     }
-                                else
-                                     rowcount++;
-                                }
-                        }
-                   else {
-                        for (y=0; y<hgt; y+=dy) {
-                             dy=readlines(y);
-
-                             py=y+by;
-                             if (py>=0 && py<disyw) {
-                                  convertlines(y, 0, 0);
-                                  for (x=0; x<wdt; x++) {
-                                       px=x+bx;
-                                       if (px>=0 && px<disxw) {
-                                            putcolor(px, py, s[0][x]);
-                                            putcolor(px, py+1, s[1][x]);
-                                            }
-                                       }
-                                  }
-                             }
-                        }
-                   break;
-
-              default :
-                   if (single) {
-                        rowcount=by;
-                        for (y = 0; (y<hgt && rowcount<disyw); y+=dy) {
-                                dy=readlines(y);
-
-                                if (rowcount>=0) {
-                                     convertlines(y, 0, 1280+bx);
-                                     out_line(s[0]+1280, disxw);
-                                     out_line(s[1]+1280, disxw);
-                                     }
-                                else
-                                     rowcount++;
-                                }
-                        }
-                   else {
-                        for (y=0; y<hgt; y+=dy) {
-                             dy=readlines(y);
-
-                             py=y+by;
-                             if (py>=0 && py<disyw) {
-                                  convertlines(y, 0, 0);
-                                  for (x=0; x<wdt; x++) {
-                                       px=x+bx;
-                                       if (px>=0 && px<disxw) {
-                                            putcolor(px, py, s[0][x]);
-                                            putcolor(px, py+1, s[1][x]);
-                                            }
-                                       }
-                                  }
-                             }
-                        }
-                   break;
-                }
-        closeimage(im);
-}
diff -Nrua vort-old/pc/showpix.c vort-new/pc/showpix.c
--- vort-old/pc/showpix.c	1992-05-25 21:10:31.000000000 -0400
+++ vort-new/pc/showpix.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,251 +0,0 @@
-/* Showpix 3.0, display VORT images on (nearly) any adapter  */
-
-#define DEF_VARS
-
-#include <dos.h>
-#include <time.h>
-#include <conio.h>
-#include <graph.h>
-#include <malloc.h>
-#include "showpix.h"
-#include "extra.h"
-
-
-int readkey(long wsecs)
-{
-    int k;
-    long t;
-
-    t=time((long *)NULL);
-    t+=wsecs;
-
-    k=32;
-    while (time((long *)NULL) < t)
-         if (kbhit()) {
-              k=getch();
-              break;
-              }
-
-    if (k=='q' || k=='Q' || k==27) {
-         returntotext();
-         exit(0);
-         }
-
-    return k;
-}
-
-
-
-void help(char *type)
-{
-    int i;
-
-    switch(type[0]) {
-    case 'h':
-         puts(prname);
-         puts("\nThe syntax is:");
-         puts("Showpix <options> <files> <more options> <more files> etc.");
-         puts("Where <options> are:");
-         puts("-a         enables autosave (default no save)");
-         puts("-k         wait for a key (default for image)");
-         puts("-w<secs>   wait for key or go on after <secs> seconds, image");
-         puts("-W<secs>   wait for key or go on after <secs> seconds, title (default 10)");
-         puts("-s         show image titles (default don't show)");
-         puts("-c         centers the image in the physical screen (default don't center)");
-         puts("-r -g -b   only display the red, green or blue plane");
-         puts("-f         display the image in full colors (default for colormapped)");
-         puts("-m         display the image in black & white (default for non-mapped)");
-         puts("-t<mode>[pattern] use the tricky dithering");
-         puts("           Read the docs for the values of <mode> and <pattern>");
-         puts("-v<num>    select the display adapter type");
-         puts("<files>    [path]filename.ext[(<xpos>, <ypos>)] [+] ..more files....");
-         puts("If no extension is specified Showpix will try '.pix' and '.mix'.");
-         puts("The translation overrides the -c centering option, '+' means add the images.");
-         puts("Use 's' to save the image onscreen in GIF format (same filename),");
-         puts("    'q' to quit to dos and any key to go on with the display.");
-         break;
-    case 'v':
-         puts(prname);
-         puts("List of supported video adapters (all are 256 colors):\n");
-         for (i=1; i<=MAXVIDEO; i++) {
-              fromvideotable(videos[i-1][0]-1);
-              printf("\t%d\t%dx%d %s\n", i, videoentry.xdots, videoentry.ydots,
-                     videoentry.name);
-              }
-         puts("\nThe video mode must be specified with the -v<number> option.");
-         break;
-    case 'd':
-         puts(prname);
-         puts("\nShowpix was created by A.Barsella, using the VORT.LIB to read in the .PIX");
-         puts("files and a hacked version of the FRACTINT graphics routines to draw onscreen.");
-         puts("Only a small part of the FRACTINT's graphics adapters are used by showpix, so");
-         puts("if you have an adapter which is not on the list hack the sources or call me");
-         puts("and it will be supported in the next version....");
-         break;
-    default:
-         puts(prname);
-         puts("Type 'Showpix h' for help, 'Showpix v' for adapters supported");
-         puts("or 'Showpix d' for product description.");
-         break;
-         }
-    exit(-1);
-}
-
-
-
-void main(int argc, char **argv)
-{
-    int xs, ys, lastone, single, shft, ct;
-    char x, gifname[40], *exten, param[60], *parm, *cor, pixname[40];
-    char huge *xyzzy;
-    unsigned int o;
-
-    if (argc == 1)
-         help("?");
-
-    if (argc==2 && argv[1][1]==0)
-         help(argv[1]);
-
-    buildcline(argc, argv);
-
-    /* allocate buffers for maximum possible (likely) image width */
-    s[0]= (unsigned char *) malloc(MAX_IMGWIDTH*3);
-    r[0]= (unsigned char *) malloc(MAX_IMGWIDTH);
-    g[0]= (unsigned char *) malloc(MAX_IMGWIDTH);
-    b[0]= (unsigned char *) malloc(MAX_IMGWIDTH);
-
-    s[1]= (unsigned char *) malloc(MAX_IMGWIDTH*3);
-    r[1]= (unsigned char *) malloc(MAX_IMGWIDTH);
-    g[1]= (unsigned char *) malloc(MAX_IMGWIDTH);
-    b[1]= (unsigned char *) malloc(MAX_IMGWIDTH);
-
-    /* allocate extra segment for 'extra.asm' routines */
-    xyzzy= halloc(66000l, 1);  /* allocate 66000 bytes */
-    extraseg=FP_SEG(xyzzy);
-    o=FP_OFF(xyzzy);
-
-    while (o>15) { o-=16; extraseg++; }
-
-    autosave=NO;
-    options=FULLCOLORS;
-    centering=NO;
-    videomode=-1;
-    showtitle=NO;
-    imagewait=31536000L; /* about 1 year of wait time */
-    titlewait=10L;
-
-    if (getnextname(param)==-1) {
-         /* eh?, no names? */
-         puts("No file specified.");
-         exit(-1);
-         }
-
-    single=YES;
-    parm=param;
-
-disimage:
-    cor=strchr(parm, '(');
-    shft=YES;
-    if (cor==NULL && single==YES) {
-         /* not shifted anywhere */
-         xs=0;
-         ys=0;
-         shft=0;
-         }
-    else
-         if (cor!=NULL)
-            if (2!=sscanf(cor, "(%d , %d)", &xs, &ys))
-               if (2!=sscanf(cor, "(%d %d)", &xs, &ys)) {
-                   returntotext();
-                   *cor=0;
-                   printf("Illegal coordinate specification for file %s.\n",
-                          parm);
-                   exit(-1);
-                   }
-
-    *cor=0;
-    if (single==YES)
-         strcpy(gifname, parm);
-
-    if (strchr(parm, '.')==NULL) {
-         sprintf(pixname, "%s.PIX", parm);
-         im = openimage(pixname, "r");
-         if (im==(image *)NULL) {
-              sprintf(pixname, "%s.MIX", parm);
-              im = openimage(pixname, "r");
-              if (im==(image *)NULL)
-                   sprintf(pixname,"%s (.PIX/.MIX)", parm);
-              }
-         }
-    else {
-         strcpy(pixname, parm);
-         im = openimage(parm, "r");
-         }
-
-    if (im==(image *)NULL) {
-         returntotext();
-         fprintf(stderr, "Can't open the file %s.\n", pixname);
-         exit(-1);
-         }
-
-    if (videomode==-1) {
-         puts("Video mode number missing.");
-         exit(-1);
-         }
-
-    if (setvideostats(videomode) != 1) {
-         printf("Illegal video mode %d.\n", videomode);
-         exit(-1);
-         }
-
-    if ( (ct=titlelength(im)) != 0 && single==YES && showtitle==YES) {
-         settextmode();
-         if (ct<80)
-              _settextposition(12, 40-ct/2);
-         else
-              _settextposition(12, 1);
-
-         puts(imagetitle(im));
-         readkey(titlewait);
-         }
-
-    display_image(xs, ys, shft, single);
-
-    if (getnextname(param)==-1) {
-         lastone=YES;
-         goto saveimage;
-         }
-
-    if (param[0]!='+') {
-         lastone=NO;
-         parm=param;
-         single=YES;
-         goto saveimage;
-         }
-
-    single=NO;
-    parm=param+1;
-    goto disimage;
-
-
-saveimage:
-    if (autosave==NO)
-         x=readkey(imagewait);
-    else
-         x='s';
-
-    if (x=='s') {
-         exten=strchr(gifname, '.');
-         if (exten==NULL)
-              exten=gifname+strlen(gifname);
-
-         strcpy(exten, ".gif");
-
-         savegif(gifname);
-         }
-
-    if (lastone!=YES)
-         goto disimage;
-
-    returntotext();
-}
diff -Nrua vort-old/pc/showpix.doc vort-new/pc/showpix.doc
--- vort-old/pc/showpix.doc	1992-05-25 21:10:31.000000000 -0400
+++ vort-new/pc/showpix.doc	1969-12-31 19:00:00.000000000 -0500
@@ -1,240 +0,0 @@
-                          SHOWPIX version 3.0
-
-The showpix program is an utility created to show VORT image files onto
-various display adapters, nearly all VGA adapters are supported as well
-as IBM 8514/A. Showpix only uses 256 color video modes.
-Showpix allows the image which is on the screen to be saved in GIF
-format. GIF files are limited to 256 color maps instead of 24 bits per
-pixel, and take much less storage.
-
-
-                                 Usage
-The usage of Showpix is this:
-
-        Showpix <options> <files> [<more options>] [<more files>] ......
-
-The options you specify only apply to the files which appear AFTER, that
-means that if you specify a filename before setting the video adapter
-you will get an error message.
-
-Since the MS-DOS command line is limited in length (you can type in up
-to 128 characters or so), it is possible to 'include' a file in the
-command line with the @filename.ext command. This causes the file
-specified to be placed exactly where the @ command is.
-
-
-A list of the valid options follows:
-
--v<num>    Select display adapter type
-        Selects which video mode to use. To get a list of the video
-        modes supported type 'showpix v'. This option must be placed
-        before any file specification. It may appear more than once in
-        the command line.
-
--a         Enable autosave
-        This option activates autosave for all the images which follow.
-        There's no way to disable it, once specified all the files which
-        appear after will be automatically saved. The image will be
-        saved with the same filename and with extension '.GIF'.
-        This option is useful if you have to convert 200 animation
-        frames to GIF format with a batch file.
-
--c         Center image in the physical screen
-        This option simply centers the image in the display screen (if
-        the image is smaller). If the image is exactly the screen size
-        nothing happens and if it's bigger you will only see the centre
-        of it. Once turned on there's no way to turn it off (anyway you
-        can always override it by translating the image to 0,0).
-
--s         Show the image title before displaying the image
-        *** The option's default is not to display the titles
-        This option causes the image title to be displayed in text mode
-        before going to graphics mode and displaying the image.
-        In case of image addition only the title of the first image is shown.
-
--w<num>    Set wait time for image
--W<num>    Set wait time for title
--k         Set wait time for image/title to infinite
-        *** Default values: 10 seconds for title and infinite for image
-        These three option set the amount of time the title or image will
-        stay onscreen if you don't hit any key. The <num> is the number of
-        seconds. 'Infinite' time means that you must hit a key to go on.
-
-The following option select how a selected image will be displayed, any
-specification of one of them overrides any previous setting.
-
--r         Display red plane only
--g         Display green plane only
--b         Display blue plane only
-        These three options select which plane you want to be displayed.
-        This option works both on non-mapped and mapped images.
-
--f         Display the image in full colors
-        *** This is the default for colormapped images.
-        Tells Showpix to display the image by using the colormap found
-        in the file. It has no effect on non-mapped images.
-
--m         Display the image in black & white
-        *** This is the default for non-colormapped images.
-        Tells Showpix to display the image in a gray scale. This is
-        assumed for non-mapped images. ('m' is for monochrome)
-
--t<mode>[<pattern>]
-           Try to display the image at 256K colors
-        This one is the most complex......
-        The options enables a 'tricky dithering' which allows Showpix to
-        display images using all the 256K colors available to the VGA
-        adapters. It will work both with colormapped and non-mapped
-        images (anyway for mapped ones -f is better).
-
-      <mode> = 'l', linear mode:
-        The trick consists in using 3 pixels to define a color instead
-        than one by placing a red pixel, a green pixel and a blue pixel
-        all close. Higher the horizontal resolution better the result,
-        since the horizontal resolution will be reduced by a factor of 3.
-        The way the three pixels are turned to one is controlled by mode:
-
-        The program averages the red, green and blue components of three pixels
-        to determine the three values to display.
-
-        <pattern>, which is meningful only for this mode, determines how the
-        rgb pixels will be placed. This is to avoid to have all the red
-        pixels on the first column, all the greens on the second, etc. because
-        this has an annoying effect of vertical lines.
-        <pattern> is a string of digits which tells Showpix how to
-        change the pixel positions with the vertical position.
-        The digits are:
-                0       R G B
-                1       G B R
-                2       B R G
-                3       R B G
-                4       B G R
-                5       G R B
-
-        For example if you say 135 you will get this in the first three
-        lines of your video:
-
-line 0:         G B R  G B R  G B R   etc.
-line 1:         R B G  R B G  R B G   etc.
-line 2:         G R B  G R B  G R B   etc.
-
-        Then the pattern is repeated. The max length of a pattern is 9
-        digits. I have no idea what happens if you go beyond this.
-        The default setting is 02, which is not bad.
-        012 is also good.
-
-      <mode> = 's' or 'S', square mode:
-        This mode uses 4 pixels to display a color. The pattern is fixed,
-        you must not give any number and is:
-
-                R G
-                B ?
-
-        where the ? is a pseudo-gray.
-        The R, G and B are the red, green and blue components averaged
-        on the three pixels if the 's' mode is specified. If 'S' mode is
-        selected then no average is made and the image is enlarged by
-        2x since 4 pixels are used to display a single point in the file.
-
-        pseudo-gray.red= 50/63*R + 50/63*G + 38/63*B
-
-        The effect is good, but the color are slightly altered.
-
-
-
-Note that the override allows some useful things:
-
-        showpix -v? -r pic.pix -g pic.pix -b pic.pix -m pic.pix
-
-can be used to see all the planes and the monochrome.
-
-
-                          Specifing filenames
-
-A file is specified by giving its path/filespec and an optional translation:
-
-        [path]filename.ext
-        [path]filename.ext(<xpos>, <ypos>)
-
-The filename is the name of the file you want to display, if you omit the
-extension Showpix will try to open a file whose name is the one you specified
-with a '.pix' extension, if this in not found a '.mix' is also tried.
-Using wildcards to specify names is accepted, but this creates conflicts with
-other possibilities such as addition and translation. Anyway if you just want
-to look at several .pix files:
-
-      showpix -v<n> *.pix
-
-works ok. The problem is that the filename extension is made by setargv
-before calling showpix.
-
-The <xpos>, <ypos> translation specifies where to put on the screen the
-top left corner of the image. The translation overrides any centering
-you may have set.
-In case you display image fragments they are automatically translated to
-their correct x,y position so that they get placed where they should be.
-This translation is added to the one you specify.
-
-When specifing more than one name you will get the image displayed one
-after the other unless you put a '+' before the filename. If a '+'
-appears before a filename that image is placed on the same display
-screen as the image before. It has no meaning to put a '+' in front of
-the first name you specify. This can be used to create multi-image
-screens or to add up several image fragments.
-Since the palette used is the one of the first image you must mulmcut
-the images or display them with the -m or -r,-g,-b options.
-This limitation doesn't exist if you use the -t option.
-The images which are added inherit the same translation of the first.
-An example of rebuilding a fragmented image:
-
-        showpix -v? frag1.pix+frag2.pix+frag3.pix+frag4.pix
-
-Rebuilding it at 100,100:
-
-        showpix -v? frag1.pix(100,100)+frag2.pix+frag3.pix+frag4.pix
-
-If the images you add don't have the same palette of the first you will
-get strange results.
-
-
-                           Keyboard commands
-
-When the image is displayed there are three command you can give by
-hitting the associated key:
-
-'s'     Save the image in .GIF format (with the same filename) and
-        proceed with the next image.
-
-'q'     Quit even if other images where specified.
-        (this also works when the title is onscreen)
-
-Any other key proceeds with the next image specified.
-
-Note that added images count as only one and are all displayed before
-you can hit key, so you can't quit during an image addition.
-
-
-                             Advanced topic
-
-It is possible to alter the options within an image addition, but it's
-dangerous. In order to do this you must know that Showpix works with 3
-palette statuses: external, internal1 and internal2.
-The external palette is the one defined from a colormapped file, it can
-be anything, if you want to make assumptions about its content you must
-create it to meet your needs.
-The internal1 palette is the one used in monochrome, red
-green or blue planes and -tl mode. The palette contains 64 shades of
-gray, 64 of red, 64 of green and 64 of blue. This allows things like
-this to be done: consider a 320x200 image,
-
-        showpix -v4 -r pic.pix -g +pic.pix(320,0) -b +pic.pix(0,280)
-                -m +pic.pix(320,280) -tl +pic.pix(160,120)
-
-shows the image pic.pix drawing the red plane in the top left corner,
-the green plane in the top right corner, the blue plane in the bottom
-left corner, the image in black & white in the bottom right corner and
-the image with colors in the center of the screen.
-
-The -ts mode uses the internal2 palette, which is equal to internal1,
-with some changes to the BW scale. The preceding example will give an
-incorrect black & white image (the other are still displayed correctly).
diff -Nrua vort-old/pc/showpix.h vort-new/pc/showpix.h
--- vort-old/pc/showpix.h	1992-05-25 21:10:31.000000000 -0400
+++ vort-new/pc/showpix.h	1969-12-31 19:00:00.000000000 -0500
@@ -1,66 +0,0 @@
-#include <string.h>
-#include <stdio.h>
-#include <stdlib.h>
-#include <ctype.h>
-#include <vort.h>
-#include "fgraph.h"
-
-#define MAXVIDEO 9
-#define MAX_IMGWIDTH 1280
-#define PALETTE_SIZE 256
-
-#define YES 1
-#define NO 0
-
-#define REDPLANE 1
-#define GREENPLANE 2
-#define BLUEPLANE 3
-#define FULLCOLORS 100
-#define MONOCHROME 101
-#define TRICKYL 200
-#define TRICKYS 300
-#define TRICKY2S 301
-
-#define gotographics(zz)  { startgraphics(zz); gort=1; }
-#define returntotext() { if (gort) settextmode(); gort=0; }
-
-#ifndef DEF_VARS
-extern image *im;
-extern int autosave, options, videomode, centering, showtitle;
-extern long imagewait, titlewait;
-extern int dismode, disxw, disyw, gort;
-extern unsigned char *r[2], *g[2], *b[2], *s[2];
-extern char prname[], trickyd[10];
-extern int videos[10][3];
-extern int tricklen;
-#else
-image *im;
-int autosave, options, centering, videomode, showtitle;
-long imagewait, titlewait;
-int dismode, disxw, disyw, gort=0;
-unsigned char *r[2], *g[2], *b[2], *s[2];
-char prname[]="Showpix 3.0, display Vort files on (nearly) any adapter.";
-int videos[10][3]= { { IBMMCGA320200256, 320, 200 },
-                     { TWKVGA360480256, 360, 480 },
-                     { SUPVGA640400256, 640, 400 },
-                     { SUPVGA640480256, 640, 480 },
-                     { SUPVGA800600256, 800, 600 },
-                     { SUPVGA1024768256, 1024, 768 },
-                     { SUPVGA12801024256, 1280, 1024 },
-                     { IBM8514640480256, 640, 480 },
-                     { IBM85141024768256, 1024, 768 } };
-char trickyd[10];
-int tricklen;
-#endif
-
-extern int savegif(char *);
-
-extern void buildcline(int, char **);
-extern void getoptions(int *, int *, int *);
-extern int getnextname(char *);
-
-int setvideostats(int);
-void display_image(int, int, int, int);
-
-void help(char *);
-int readkey(long);
diff -Nrua vort-old/pc/showpix.mak vort-new/pc/showpix.mak
--- vort-old/pc/showpix.mak	1992-05-25 21:10:31.000000000 -0400
+++ vort-new/pc/showpix.mak	1969-12-31 19:00:00.000000000 -0500
@@ -1,25 +0,0 @@
-.c.obj:
-        cl -AM -Gs -c -Ot -W1 $*.c
-
-# note that the use of -AM requires you to have libraries created for this model
-# (the included fgraph.lib is in fact in medium model)
-
-LIB = c:\lib
-# where to find setargv.obj
-
-.asm.obj:
-        masm -ML $*;
-
-showpix.obj : showpix.c showpix.h
-
-savegif.obj : savegif.c showpix.h
-
-shcline.obj : shcline.c showpix.h
-
-shdisp.obj : shdisp.c showpix.h
-
-extra.obj : extra.asm
-
-showpix.exe : showpix.obj savegif.obj extra.obj shcline.obj shdisp.obj
-        LINK /NOE /NOI /STACK:12000 showpix+savegif+shcline+extra+shdisp\
-+$(LIB)\setargv,,,fgraph vort;
diff -Nrua vort-old/pc/supavga.asm vort-new/pc/supavga.asm
--- vort-old/pc/supavga.asm	1992-05-25 21:10:32.000000000 -0400
+++ vort-new/pc/supavga.asm	1969-12-31 19:00:00.000000000 -0500
@@ -1,1021 +0,0 @@
-		name	SUPAVGA
-		title	Various Super VGA 256-Colour image routines.
-		page	132,60
-
-;============================================================================
-;
-; The bulk of the code to handle different Super VGA boards is
-; snarfed from FRACTINT (Version 10).
-;
-; The procedure for handling these different boards is reasonably
-; straightforward.
-;
-; It appears that all the super VGA modes have the same video
-; memory organisation (for 256 colour modes at least), i.e. bank
-; switched flat memory pages (usually 64K page size) . The only
-; apparent difference between each manufacturer's board is the
-; way paging is performed and the INT 10H BIOS initialization values.
-; Thus, the only code specific to each board is the paging routine.
-;
-; To determine the page number of some arbitrary pixel (x, y), use
-; the following expression (given a page size of 64K):
-;
-;		(y * x-width + x) >> 16
-;
-; After mapping in the video page, the CPU address of the pixel
-; will be:
-;
-;		0xA000: ((y * x-width) & 0xFFFF) + x
-;
-;
-;
-; Some boards can handle double buffering for some of their higher
-; modes. This is taken advantage of where possible.
-;
-;============================================================================
-
-		.model	LARGE,c
-
-
-		extrn	svga_cur_bank:BYTE
-		extrn	adapter_x:WORD
-		extrn	adapter_y:WORD
-		extrn	adapter_bank:DWORD
-		extrn	EMS_base:PROC
-		extrn	EMS_map:PROC
-
-
-
-;--------------------------------------
-; Adapter types we think we know about.
-
-ADAPTER_NONE		=	0
-ADAPTER_ATI		=	1
-ADAPTER_EVEREX		=	2
-ADAPTER_TRIDENT		=	3
-ADAPTER_VIDEO7		=	4
-ADAPTER_PARADISE	=	5
-ADAPTER_CHIPS		=	6
-ADAPTER_TSENG		=	7
-ADAPTER_TSENG4		=	8
-ADAPTER_AHEADA		=	9
-ADAPTER_AHEADB		=	10
-ADAPTER_OTI		=	11
-ADAPTER_VGA		=	99
-
-
-GetEMSByte	MACRO	hdl, pag	;; Get next byte from EMS (remapping afterwards if required)
-		local	blark
-		lodsb			;; Get byte from DS:SI
-		test	si,4000H	;; Check if we've got to the end of the page
-		jz	blark
-		inc	(pag)		;; Next page number
-		push	ax
-		mov	ax,(pag)
-		push	ax
-		mov	ax,(hdl)
-		push	ax
-		call	EMS_map
-		add	sp,4
-		pop	ax
-		mov	si,base_ofs
-blark:
-		ENDM
-
-nojmp		macro
-		local	lbl
-		jmp	lbl
-lbl:
-		endm
-
-
-		.code
-
-
-public	aheada_bank
-aheada_bank	proc	
-		cli
-		mov	SS:svga_cur_bank,al
-		push	ax
-		push	dx
-		push	cx
-		mov	ch,al
-        	mov     dx,3ceh		;Enable extended registers
-        	mov     ax,200fh
-        	out     dx,ax
-		mov	dl,0cch		;bit 0
-		in	al,dx
-		mov	dl,0c2h
-		and	al,11011111b
-		shr	ch,1
-		jnc	temp_1
-		or	al,00100000b
-temp_1:		out	dx,al
-		mov	dl,0cfh		;bits 1,2,3
-		mov	al,0
-		out	dx,al
-		inc	dx
-		in	al,dx
-		dec	dx
-		and	al,11111000b
-		or	al,ch
-		mov	ah,al
-		mov	al,0
-		out	dx,ax
-		sti
-		pop	cx
-		pop	dx
-		pop	ax
-		ret
-aheada_bank	endp
-
-public	aheadb_bank
-aheadb_bank	proc	
-		cli
-		mov	SS:svga_cur_bank,al
-		push	ax
-		push	dx
-		push	cx
-		mov	ch,al
-        	mov     dx,3ceh		;Enable extended registers
-        	mov     ax,200fh
-        	out     dx,ax
-		mov	ah,ch
-		mov	cl,4
-		shl	ah,cl
-		or	ah,ch
-		mov	al,0dh
-		out	dx,ax
-		sti
-		pop	cx
-		pop	dx
-		pop	ax
-		ret
-aheadb_bank	endp
-
-public	ati_bank
-ati_bank	proc			;ATI VGA Wonder
-		cli
-		mov	SS:svga_cur_bank,al
-		push	ax
-		push	dx
-		mov	ah,al
-		mov	dx,1ceh
-		mov	al,0b2h
-		out	dx,al
-		inc	dl
-		in	al,dx
-		shl	ah,1
-		and	al,0e1h
-		or	ah,al
-		mov	al,0b2h
-		dec	dl
-		out	dx,ax
-		sti
-		pop	dx
-		pop	ax
-		ret
-ati_bank	endp
-
-public	chips_bank
-chips_bank	proc			;Chips & Tech
-		cli
-		mov	SS:svga_cur_bank,al
-		push	ax
-		push	dx
-		mov     dx,46e8h	;place chip in setup mode
-		mov     ax,1eh
-		out     dx,ax
-		mov     dx,103h		;enable extended registers
-		mov     ax,0080h	; (patched per JB's msg - Bert)
-		out     dx,ax
-		mov     dx,46e8h	;bring chip out of setup mode
-		mov     ax,0eh
-		out     dx,ax
-		mov	ah,SS:svga_cur_bank
-		shl	ah,1		;change 64k bank number into 16k bank number
-		shl	ah,1
-		mov	al,10h
-		mov	dx,3d6h
-		out	dx,ax
-		sti
-		pop	dx
-		pop	ax
-		ret
-chips_bank	endp
-
-public everex_bank
-everex_bank	proc			;Everex
-		cli
-		mov	SS:svga_cur_bank,al
-		push	ax
-		push	dx
-		push	cx
-		mov	cl,al
-		mov	dx,3c4h
-		mov	al,8
-		out	dx,al
-		inc	dl
-		in	al,dx
-		dec	dl
-		shl	al,1
-		shr	cl,1
-		rcr	al,1
-		mov	ah,al
-		mov	al,8
-		out	dx,ax
-		mov	dl,0cch
-		in	al,dx
-		mov	dl,0c2h
-		and	al,0dfh
-		shr	cl,1
-		jc	nob2
-		or	al,20h
-nob2:		out	dx,al
-		sti
-		pop	cx
-		pop	dx
-		pop	ax
-		ret
-everex_bank	endp
-
-public paradise_bank
-paradise_bank	proc			;Paradise
-		cli
-		mov	SS:svga_cur_bank,al
-		push	ax
-		push	dx
-		mov	dx,3ceh
-		mov	ax,50fh		;turn off write protect on VGA registers
-		out	dx,ax
-		mov	ah,SS:svga_cur_bank
-		shl	ah,1
-		shl	ah,1
-		shl	ah,1
-		shl	ah,1
-		mov	al,9
-		out	dx,ax
-		sti
-		pop	dx
-		pop	ax
-		ret
-paradise_bank	endp
-
-public trident_bank
-trident_bank	proc			;Trident
-		cli
-		mov	SS:svga_cur_bank,al
-		push	ax
-		push	dx
-		mov	dx,3ceh		;set page size to 64k
-		mov	al,6
-		out	dx,al
-		inc	dl
-		in	al,dx
-		dec	dl
-		or	al,4
-		mov	ah,al
-		mov	al,6
-		out	dx,ax
-		
-		mov	dl,0c4h		;switch to BPS mode
-		mov	al,0bh
-		out	dx,al
-		inc	dl
-		in	al,dx
-		dec	dl
-
-		mov	ah,SS:svga_cur_bank
-		xor	ah,2
-		mov	dx,3c4h
-		mov	al,0eh
-		out	dx,ax
-		sti
-		pop	dx
-		pop	ax
-		ret
-trident_bank	endp
-
-public tseng_bank
-tseng_bank	proc			;Tseng
-		cli
-		mov	SS:svga_cur_bank,al
-		push	ax
-		push	dx
-		and	al,7
-		mov	ah,al
-		shl	ah,1
-		shl	ah,1
-		shl	ah,1
-		or	al,ah
-		or	al,01000000b
-		mov	dx,3cdh
-		out	dx,al
-		sti
-		pop	dx
-		pop	ax
-		ret
-tseng_bank	endp
-
-public video7_bank
-video7_bank	proc			;Video 7
-		cli
-		mov	SS:svga_cur_bank,al
-		push	ax
-		push	dx
-		push	cx
-video7xx:
-		and	ax,15
-		mov	ch,al
-		mov	dx,3c4h
-		mov	ax,0ea06h
-		out	dx,ax
-		mov	ah,ch
-		and	ah,1
-		mov	al,0f9h
-		out	dx,ax
-		mov	al,ch
-		and	al,1100b
-		mov	ah,al
-		shr	ah,1
-		shr	ah,1
-		or	ah,al
-		mov	al,0f6h
-		out	dx,al
-		inc	dx
-		in	al,dx
-		dec	dx
-		and	al,not 1111b
-		or	ah,al
-		mov	al,0f6h
-		out	dx,ax
-		mov	ah,ch
-		mov	cl,4
-		shl	ah,cl
-		and	ah,100000b
-		mov	dl,0cch
-		in	al,dx
-		mov	dl,0c2h
-		and	al,not 100000b
-		or	al,ah
-		out	dx,al
-		sti
-		pop	cx
-		pop	dx
-		pop	ax
-		ret
-video7_bank	endp
-	
-public oaktech_bank
-oaktech_bank	proc			;Oak Technology Inc OTI-067
-		cli
-		mov	SS:svga_cur_bank,al
-		push	ax
-		push	dx
-		and	al,15
-		mov	ah,al
-		shl	al,1
-		shl	al,1
-		shl	al,1
-		shl	al,1
-		or	al,ah
-		mov	dx,3dfh
-		out	dx,al
-		sti
-		pop	dx
-		pop	ax
-		ret
-oaktech_bank	endp
-
-public tseng4_bank
-tseng4_bank	proc			;Tseng 4000 series
-		cli
-		mov	SS:svga_cur_bank,al
-		push	ax
-		push	dx
-		mov	ah,al
-		mov	dx,3bfh			;Enable access to extended registers
-		mov	al,3
-		out	dx,al
-		mov	dl,0d8h
-		mov	al,0a0h
-		out	dx,al
-		and	ah,15
-		mov	al,ah
-		shl	al,1
-		shl	al,1
-		shl	al,1
-		shl	al,1
-		or	al,ah
-		mov	dl,0cdh
-		out	dx,al
-		sti
-		pop	dx
-		pop	ax
-		ret
-tseng4_bank	endp
-
-
-
-;===============================================
-; Calc pixel address of pixel (x, y).
-; Called internally only.
-;
-; Called with:
-;	 		BX	- X
-;			AX	- Y
-; Returns:
-;			ES:DI	- Video buffer address
-;			DX	- Number of bytes remaining in video bank
-;
-
-svga_paddr	proc	near
-		clc
-		mul	SS:adapter_x         	; start line * number of pixels per line
-		add	ax,bx			; add X offset
-		adc	dx,0			; add carry
-		mov	di,ax
-		push    ax               	; save pixel address for later
-		cmp     dl,SS:svga_cur_bank	; bank same as previous ?
-		je      svga_paddr1		; jump if bank same as previous
-		mov     al,dl            	; put bank in al
-		call	SS:[adapter_bank]	; map in new bank
-svga_paddr1:
-		pop	ax
-		mov	dx,0FFFFH		; Size of a bank - 1
-		sub	dx,ax			; Find bytes remaining in bank
-		inc	dx			; i.e. number of bytes left to go until we have to use next bank
-		ret
-svga_paddr	endp
-
-
-
-public svga_putline
-svga_putline	proc    uses di si ds es, p:FAR PTR, n:WORD, x:WORD, y:WORD ; super VGA 256 colors
-		cld
-		mov	bx,x
-		mov	ax,y
-		call	svga_paddr		; Calc start addr of pixel
-		mov	ax,0A000H		; Video buffer segment
-		mov	es,ax
-		lds	si,p			; Load ptr to scan line
-		mov	cx,n			; Number of bytes to move
-		or	dx,dx
-		jz	svga_putline2		; JIF 64K bytes remain in bank 
-		cmp	cx,dx			; Test # bytes to move with # available in current bank
-		jbe	svga_putline2		; JIF this line will fit in current bank
-		sub	cx,dx			; Calc # bytes to put into next bank
-		xchg	cx,dx			; Save it in DX and set up CX for this bank
-		shr	cx,1			; Convert # bytes to # words
-		jnc	svga_putline1
-		movsb				; Copy the first byte
-svga_putline1:
-		rep	movsw			; Copy the remainder of the line (best if ptr is word aligned too!)
-		mov	al,SS:svga_cur_bank	; Get current bank
-		inc	al
-		call	SS:[adapter_bank]	; Swap to next bank
-		mov	cx,dx			; Set # of bytes to copy to new bank
-svga_putline2:
-		shr	cx,1			; Convert # bytes to # words
-		jnc	svga_putline3
-		movsb				; Copy the first byte
-svga_putline3:
-		rep	movsw			; Copy the remainder of the line (best if ptr is word aligned too!)
-
-		ret
-svga_putline	endp
-
-
-public svga_getline
-svga_getline	proc    uses di si ds es, p:FAR PTR, n:WORD, x:WORD, y:WORD ; super VGA 256 colors
-		cld
-		mov	bx,x
-		mov	ax,y
-		call	svga_paddr		; Calc start addr of pixel
-		mov	ax,0A000H		; Video buffer segment
-		mov	es,ax
-		lds	si,p			; Load ptr to scan line
-		mov	cx,n			; Number of bytes to move
-		cmp	cx,dx			; Test # bytes to move with # available in current bank
-		jbe	svga_getline2		; JIF this line will fit in current bank
-		sub	cx,dx			; Calc # bytes to put into next bank
-		xchg	cx,dx			; Save it in DX and set up CX for this bank
-		shr	cx,1			; Convert # bytes to # words
-		jnc	svga_getline1
-		movsb				; Copy the first byte
-svga_getline1:
-		rep	movsw			; Copy the remainder of the line (best if ptr is word aligned too!)
-		mov	al,SS:svga_cur_bank	; Get current bank
-		inc	al
-		call	SS:[adapter_bank]	; Swap to next bank
-		mov	cx,dx			; Set # of bytes to copy to new bank
-svga_getline2:
-		shr	cx,1			; Convert # bytes to # words
-		jnc	svga_getline3
-		movsb				; Copy the first byte
-svga_getline3:
-		rep	movsw			; Copy the remainder of the line (best if ptr is word aligned too!)
-		ret
-svga_getline	endp
-
-
-		SUBTTL	svga_EMSdecode
-		PAGE
-
-		COMMENT	$
-
-Name:		svga_EMSdecode
-
-Function:	Decodes a VORT run-length encoded colour mapped image
-		from EMS memory to PVGA front or back image buffer.
-
-Caller:		Microsoft C
-
-		void	svga_EMSdecode(EMS_h, EMS_ofs, x, y, xlen, ylen)
-		UINT	EMS_h;			/* EMS handle */
-		ULONG	EMS_ofs;		/* linear offset with EMS pages */
-		int	x, y, xlen, ylen;	/* position and size */
-
-		$
-
-
-public svga_EMSdecode
-svga_EMSdecode	proc	uses di si ds es, EMS_h:WORD, EMS_ofs:DWORD, x:WORD, y:WORD, xlen:WORD, ylen:WORD
-		LOCAL	j:WORD
-		LOCAL	i:WORD
-		LOCAL	pg:WORD
-		LOCAL	base_ofs:WORD
-		LOCAL	len_l:WORD
-		LOCAL	len_h:WORD
-		LOCAL	start_bank:BYTE
-
-		call	EMS_base	; Get address of page frame into DX:AX
-		push	dx		; Save segment part of EMS base addr
-		mov	si,ax		; Setup DS:SI with source data pointer
-		mov	base_ofs,ax	; Save offset for later reference
-
-					; Calculate page # and page offset
-		mov	ax,WORD PTR (EMS_ofs)
-		mov	dx,WORD PTR (EMS_ofs+2)
-		mov	bx,ax
-		and	bx,03FFFH	; Lower 14 bits are offset into page
-		add	si,bx
-		rcl	ax,1		; Upper 18 bits is page 
-		rcl	dx,1
-		rcl	ax,1
-		rcl	dx,1
-		mov	pg,dx
-		push	dx
-		mov	ax,EMS_h	; Map in starting page
-		push	ax
-		call	EMS_map	; Map in EMS page (we presume no errors)
-		add	sp,4
-
-		mov	ax,ylen		; Width of image
-		mov	j,ax
-
-					; calculate 1st pixel address and map in bank
-		mov	bx,x
-		mov	ax,y
-		call	svga_paddr	; Video bank ptr is ES:DI, DX bytes remaining in the bank
-		mov	ax,0A000H		; Video buffer segment
-		mov	es,ax
-
-decode_it:
-		pop	ds		; Load EMS base address segment
-		mov	ch,0		; Zap high byte of repeat counter
-
-		GetEMSByte EMS_h, pg	; Load 4 byte image length value (one byte at a time)
-		mov	ah,al
-		GetEMSByte EMS_h, pg
-		xchg	ah,al
-		mov	len_l,ax	; Save LSB
-
-		GetEMSByte EMS_h, pg
-		mov	ah,al
-		GetEMSByte EMS_h, pg
-		xchg	ah,al
-		mov	len_h,ax	; Save MSB
-
-decode_1:
-		cmp	len_l,0
-		jnz	bloot1		; Continue if not zero
-		cmp	len_h,0
-		jnz	bloot1
-		jmp	decode_x	; Exit if no more bytes in image
-bloot1:
-		mov	bx,xlen		; X width
-					; Save state at start of this line
-		push	dx		; Save number of bytes remaining in bank
-		push	di		; Save destination offset
-		mov	al,SS:svga_cur_bank	; Save video bank we are starting within
-		mov	start_bank,al
-
-decode_2:
-		cmp	bx,0
-		jnz	decode_2_1
-		jmp	decode_10	; JIF finished this row
-decode_2_1:
-		; Put in a test for LEN_L == 0 ???
-		sub	len_l,1		; One less byte in the image data
-		jnc	bloot2
-		dec	len_h
-bloot2:
-		GetEMSByte EMS_h, pg	; Get next byte (rnnnnnnn)
-		mov	cl,al		; Run length (?nnnnnnn)
-		test	al,80H		; Test top bit (r???????)
-		jnz	decode_3	; JIF top bit set
-
-				; Replicate next byte n+1 times
-		inc	cx		; Run of 0 bytes is actually a run of 1 byte
-					; Set next "run" bytes of image to *(DS:SI)
-		sub	bx,cx		; Calc bytes remaining on this row
-		sub	len_l,1		; One less byte in the image data
-		jnc	bloot3
-		dec	len_h
-bloot3:
-		GetEMSByte EMS_h, pg	; Get value to replicate
-
-		or	dx,dx		; Test if we are the start of bank
-		jz	decode_2_2	; JIF there is plenty of room
-		cmp	cx,dx		; Ensure that there is enough room in the current video bank
-		jb	decode_2_2	; JIF there is room
-		sub	cx,dx		; Calc # bytes to shove into next bank
-		push	cx
-		mov	cx,dx
-		rep	stosb		; Fill the last of the current bank
-		push	ax
-		mov	al,SS:svga_cur_bank
-		inc	al
-		call	SS:[adapter_bank]; Map in next bank
-		pop	ax		; Restore value to replicate
-		pop	cx		; Restore remainder to fill
-		mov	di,0		; Start of bank
-		mov	dx,0000H	; Number of bytes in new bank (64K)
-		jcxz	bloot4		; Don't replicate if none
-decode_2_2:
-		sub	dx,cx		; Calc bytes remaining in new bank
-		rep	stosb		; Replicate
-bloot4:
-		jmp	decode_2	; Go for next bit of encoded image
-
-
-decode_3:			; Copy next n bytes from EMS to video
-		and	cl,07FH		; Zap top bit - make run length
-		sub	bx,cx		; Calc bytes remaining on this row
-		sub	len_l,cx	; Bytes remaining in image
-		jnc	bloot5
-		dec	len_h
-bloot5:
-		push	dx		; CX is bytes to copy - ensure we don't run over end of EMS page
-		mov	dx,si
-		add	dx,cx		; Calc end byte of run
-		test	dx,04000H	; Over the end of the EMS page?
-		jnz	bloot6
-		pop	dx		; Restore # bytes in video bank
-		jmp	short decode_4	; JIF run will fit into current EMS page
-bloot6:					; We will run over into next page
-		sub	dx,4000H	; # bytes into next page
-		mov	cx,4000H	; # bytes to end of current page
-		sub	cx,si
-		jcxz	decode_3_3
-
-		pop	ax		; Restore # bytes in video bank
-		xchg	dx,ax
-		push	ax		; Save # bytes into next EMS page
-
-		or	dx,dx		; Test if we are the start of bank
-		jz	decode_3_1	; JIF there is plenty of room
-		cmp	cx,dx		; Ensure that there is enough room in the current video bank
-		jb	decode_3_1	; JIF there is room
-		je	decode_3_2	; JIF there is room (but we end at the end of the bank)
-		sub	cx,dx		; Calc # bytes to shove into next bank
-		push	cx
-		mov	cx,dx
-		rep	movsb		; Move the last of the current bank
-		mov	al,SS:svga_cur_bank
-		inc	al
-		call	SS:[adapter_bank]; Map in next bank
-		pop	cx		; Restore remainder to move
-		mov	di,0		; Start of bank
-		mov	dx,0000H	; Number of bytes in new bank (64K)
-decode_3_1:
-		sub	dx,cx		; Calc bytes remaining in new bank
-		rep	movsb		; Move
-		jmp	short decode_3_3; Go and map in next EMS page
-
-decode_3_2:
-		rep	movsb		; Move
-		mov	al,SS:svga_cur_bank
-		inc	al
-		call	SS:[adapter_bank]; Map in next bank
-		mov	di,0		; Start of bank
-		mov	dx,0000H	; Number of bytes in new bank (64K)
-
-decode_3_3:
-;;;;;		pop	cx		; Remainder to copy from new page
-		mov	si,base_ofs	; Start at beginning of new page
-;;;;;		push	cx
-		push	es
-		push	di
-		inc	pg		; Map in next EMS page
-		mov	ax,pg
-		push	ax
-		mov	ax,EMS_h
-		push	ax
-		call	EMS_map
-		add	sp,4
-		pop	di
-		pop	es
-		pop	cx
-decode_4:
-		jcxz	decode_4_3	; Test for safety sake
-
-		or	dx,dx		; Test for start of bank
-		jz	decode_4_1	; JIF there is plenty of room
-		cmp	cx,dx		; Ensure that there is enough room in the current video bank
-		jb	decode_4_1	; JIF there is room
-		sub	cx,dx		; Calc # bytes to shove into next bank
-		push	cx
-		mov	cx,dx
-		rep	movsb		; Move the last of the current bank
-		mov	al,SS:svga_cur_bank
-		inc	al
-		call	SS:[adapter_bank]; Map in next bank
-		pop	cx		; Restore remainder to move
-		mov	di,0		; Start of bank
-		mov	dx,0000H	; Number of bytes in new bank (64K)
-		jcxz	decode_4_3	; Don't move bytes if there is none
-decode_4_1:
-		sub	dx,cx		; Calc bytes remaining in new bank
-		rep	movsb		; Move
-
-decode_4_3:
-		jmp	decode_2	; Go for next bit of encoded image
-
-
-decode_10:				; End of image line
-		dec	j		; One less row
-		; Test for j == 0 here ?
-
-					; Restore state at start of the line just output
-		pop	di		; Restore buffer address of start of destination line
-		pop	dx		; And restore # bytes remaining in the bank then too
-		sub	dx,SS:adapter_x	; Bytes now remaining in bank
-		add	di,SS:adapter_x	; Next video buffer line
-		jc	decode_11	; JIF starts in next bank
-		jmp	decode_1	; Go for next line
-decode_11:
-		mov	al,start_bank	; Swap in next bank
-		inc	al
-		call	SS:[adapter_bank]
-		jmp	decode_1	; Go for next line
-
-decode_x:
-		ret
-
-svga_EMSdecode	endp
-
-
-; **************** Video adapter detection routine ***********************
-;
-;	This routine performs a few quick checks on the type of
-;	video adapter installed.  It returns AX with a value indicating
-;	the adapter found.
-;
-
-
-public	adapter_detect
-adapter_detect	proc	uses si es ds
-		mov	ax,1a00h		; look for a VGA/MCGA
-		int	10h			;  by using a VGA-specific call
-		cmp	al,1ah			; was AL modified?
-		je	adapter_detect_1	;  Yup.  A VGA or an MCGA
-		mov	ax,ADAPTER_NONE		; Not a video card we care to know about
-		ret
-
-adapter_detect_1:			; Determine type of VGA
-		mov	ax,0c000h		; Test for ATI
-		mov	es,ax
-		cmp	word ptr es:[40h],'13'
-		jnz	noati
-		mov	ax,ADAPTER_ATI
-		jmp	fini
-
-noati:		mov	ax,7000h		;Test for Everex
-		xor	bx,bx
-		cld
-		int	10h
-		cmp	al,70h
-		jnz	noev
-		mov	ax, ADAPTER_EVEREX
-						; Test for Trident
-		cmp	dx,6780h
-		jz	yeste
-		cmp	dx,2360h
-		jnz	note
-yeste:
-		mov	ax,ADAPTER_TRIDENT
-note:		jmp	fini
-
-noev:		mov	dx,3c4h			;Test for Trident
-		mov	al,0bh
-		out	dx,al
-		inc	dl
-		in	al,dx
-		cmp	al,0fh
-		ja	notri
-		cmp	al,2
-		jb	notri
-		mov	ax,ADAPTER_TRIDENT
-		jmp	fini
-
-notri:		mov	ax,6f00h		;Test for Video 7
-		xor	bx,bx
-		cld
-		int	10h
-		cmp	bx,'V7'
-		jnz	nov7
-		mov	ax,ADAPTER_VIDEO7
-		jmp	fini
-
-nov7:		mov	dx,3ceh			;Test for Paradise
-		mov	al,9			;check Bank switch register
-		out	dx,al
-		inc	dx
-		in	al,dx
-		dec	dx
-		or	al,al
-		jnz	nopd
-
-		mov	ax,50fh			;turn off write protect on VGA registers
-		out	dx,ax
-						; Check Paradise banks
-						;if bank 0 and 1 same not paradise
-		mov	cx,1
-		mov	di,0b800h
-		mov	es,di
-		xor	di,di
-		mov	bx,1234h
-		call	$gochk
-		jnz	nopd
-		mov	bx,4321h
-		call	$gochk
-		jnz	nopd
-		mov	ax,ADAPTER_PARADISE
-		jmp	fini
-
-nopd:		mov	ax,5f00h		;Test for Chips & Tech
-		xor	bx,bx
-		cld
-		int	10h
-		cmp	al,5fh
-		jnz	noct
-		mov	ax,ADAPTER_CHIPS
-		jmp	fini
-
-noct:		mov	ch,0
-		mov	dx,3d4h			;check for Tseng 4000 series
-		mov	al,33h
-		out	dx,al
-		inc	dx
-		in	al,dx
-		dec	dx
-		mov	cl,al
-		mov	ax,00a33h
-		out	dx,ax
-		mov	al,33h
-		out	dx,al
-		inc	dx
-		in	al,dx
-		and 	al,0fh
-		dec	dx
-		cmp	al,00ah
-		jnz	noct2
-		mov	ax,00533h
-		out	dx,ax
-		mov	al,33h
-		out	dx,al
-		inc	dx
-		in	al,dx
-		dec	dx
-		and 	al,0fh
-		cmp	al,005h
-		jnz	noct2
-		mov	al,33h
-		mov	ah,cl
-		out	dx,ax
-		mov	ch,1
-
-		mov	dx,3bfh			;Enable access to extended registers
-		mov	al,3
-		out	dx,al
-		mov	dl,0d8h
-		mov	al,0a0h
-		out	dx,al
-
-noct2:		mov	dx,3cdh			;Test for Tseng
-		in	al,dx			;save bank switch register
-		mov	cl,al
-		mov	al,0aah			;test register with 0aah
-		out	dx,al
-		in	al,dx
-		cmp	al,0aah
-		jnz	nots
-		mov	al,055h			;test register with 055h
-		out	dx,al
-		in	al,dx
-		cmp	al,055h
-		jnz	nots
-		mov	al,cl
-		out	dx,al
-		mov	ax,ADAPTER_TSENG
-
-		cmp	ch,0
-		jz	oldts
-		mov	ax,ADAPTER_TSENG4
-oldts:		jmp	fini
-
-nots:	
-        	mov     dx,3ceh		;Test for Above A or B chipsets
-        	mov     ax,200fh
-        	out     dx,ax
-        	inc	dx
-		nojmp
-        	in      al,dx
-		cmp	al,21h
-		jz	verb
-		cmp	al,20h
-		jnz	noab
-		mov	ax,ADAPTER_AHEADA
-		jmp	short fini
-
-verb:		mov	ax,ADAPTER_AHEADB
-		jmp	short fini
-
-noab:		mov	dx,3deh
-		in	al,dx
-		and	al,11100000b
-		cmp	al,01100000b
-		jnz	nooak
-		mov	ax,ADAPTER_OTI
-		jmp	short fini
-nooak:
-		mov	ax,ADAPTER_VGA		; Plain vanilla VGA
-fini:
-		ret
-adapter_detect	endp
-
-
-
-;----------------------------------------
-; Paradise bank checking helper routines.
-;
-$gochk		proc	near
-		push	si
-		mov	si,bx
-
-		mov	al,cl
-		call	$pdrsub
-		xchg	bl,es:[di]
-		mov	al,ch
-		call	$pdrsub
-		xchg	bh,es:[di]
-
-		xchg	si,bx
-
-		mov	al,cl
-		call	$pdrsub
-		xor	bl,es:[di]
-		mov	al,ch
-		call	$pdrsub
-		xor	bh,es:[di]
-
-		xchg	si,bx
-
-		mov	al,ch
-		call	$pdrsub
-		mov	es:[di],bh
-		mov	al,cl
-		call	$pdrsub
-		mov	es:[di],bl
-
-		mov	al,0
-		call	$pdrsub
-		or	si,si
-		pop	si
-		ret
-$gochk		endp
-
-
-$pdrsub		proc	near		;Paradise
-		mov	ah,al
-		mov	dx,3ceh
-		mov	al,9
-		out	dx,ax
-		ret
-$pdrsub		endp
-
-
- 		end
-
diff -Nrua vort-old/pc/supavgac.c vort-new/pc/supavgac.c
--- vort-old/pc/supavgac.c	1992-05-25 21:10:32.000000000 -0400
+++ vort-new/pc/supavgac.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,393 +0,0 @@
-/*
- * VORT - PCDISP.
- *
- * SuperVGA 256-Colour display routines.
- *
- * Adapted from the video routines contained in FRACTINT.
- *
- * Super VGA chipsets supported:
- *		
- * 		video7
- * 		tseng
- * 		tseng4000
- * 		paradise
- * 		chipstech
- * 		trident
- * 		ativga
- * 		everex
- * 		ahead (Ver. A & B)
- *		oaktech
- */
-
-#include <stdio.h>
-#include <stdlib.h>
-#include <dos.h>
-#include <memory.h>
-#include "pcdisp.h"
-
-
-extern int	vega_palette();
-extern int	vega_overscan();
-
-static int svga_init();
-static int svga_block();
-static int svga_fill();
-static int svga_front();
-static int svga_back();
-static int svga_swap();
-static int svga_text();
-
-extern int aheada_bank();
-extern int aheadb_bank();
-extern int video7_bank();
-extern int tseng_bank();
-extern int tseng4_bank();
-extern int paradise_bank();
-extern int chips_bank();
-extern int trident_bank();
-extern int ati_bank();
-extern int everex_bank();
-extern int oaktech_bank();
-extern int svga_putline(void far *, int, int, int);
-extern int svga_EMSdecode(int, ULONG, int, int, int, int);
-extern int svga_getline(void far *, int, int, int);
-
-
-/* structure for SuperVGA boards */
-/* some values are set for specific manufacturer's boards */
-static	ADAPTER	supervga = {
-			NULL,
-			0, 0,			/* width, height */
-			8,				/* depth */
-			0, 0,			/* register values for mode initialization (ax, bx) */
-			0,				/* current video bank */
-			svga_init,
-			svga_putline,
-			svga_EMSdecode,
-			svga_getline,
-			svga_block,
-			svga_fill,
-			vega_palette,
-			vega_overscan,
-			svga_front,
-			svga_back,
-			svga_swap,
-			svga_text,
-			NULL,			/* bank select function (specific to manufacturer) */
-			NULL,
-			};
-
-
-/* currently defined adapter */
-extern	ADAPTER	v_adapter;
-extern	int		adapter_x,
-				adapter_y;
-extern	int		adapter_dbuf;
-extern	UINT	adapter_bank;
-UCHAR			svga_cur_bank = 0;
-
-/* for doing system stuff */
-static	union	REGS	regs;
-static	struct	SREGS	segregs;
-
-
-/* svga video buffer pointers */
-static UCHAR far	*vfbuf,
-					*vbbuf,
-					*vp;
-
-/* video buffer flag: == 0 front buffer; != 0 back buffer */
-static	int		to_back_buffer = 0;
-
-
-
-/*
- * Routines to set up a list of each mode supported for each
- * brand of SuperVGA board.
- */
-
-int			setup_aheada(a)
-ADAPTER		*a;
-{
-	a[0] = supervga;
-	a[1] = supervga;
-	a[2] = supervga;
-
-	a[0].descr = "AHEAD (Ver. A) 640 x 400, 256 colour";
-	a[0].width = 640; a[0].height = 400; a[0].ax = 0x0060; a[0].bx = 0x0000; a[0].select_bank = aheada_bank;
-	a[1].descr = "AHEAD (Ver. A) 640 x 480, 256 colour";
-	a[1].width = 640; a[1].height = 480; a[1].ax = 0x0061; a[1].bx = 0x0000; a[1].select_bank = aheada_bank;
-	a[2].descr = "AHEAD (Ver. A) 800 x 600, 256 colour";
-	a[2].width = 800; a[2].height = 600; a[2].ax = 0x0062; a[2].bx = 0x0000; a[2].select_bank = aheada_bank;
-	return 3;
-}
-
-
-int			setup_aheadb(a)
-ADAPTER		*a;
-{
-	a[0] = supervga;
-	a[1] = supervga;
-	a[2] = supervga;
-
-	a[0].descr = "AHEAD (Ver. B) 640 x 400, 256 colour";
-	a[0].width = 640; a[0].height = 400; a[0].ax = 0x0060; a[0].bx = 0x0000; a[0].select_bank = aheadb_bank;
-	a[1].descr = "AHEAD (Ver. B) 640 x 480, 256 colour";
-	a[1].width = 640; a[1].height = 480; a[1].ax = 0x0061; a[1].bx = 0x0000; a[1].select_bank = aheadb_bank;
-	a[2].descr = "AHEAD (Ver. B) 800 x 600, 256 colour";
-	a[2].width = 800; a[2].height = 600; a[2].ax = 0x0062; a[2].bx = 0x0000; a[2].select_bank = aheadb_bank;
-	return 3;
-}
-
-
-int			setup_ati(a)
-ADAPTER		*a;
-{
-	a[0] = supervga;
-	a[1] = supervga;
-	a[2] = supervga;
-
-	a[0].descr = "ATI 640 x 400, 256 colour";
-	a[0].width = 640; a[0].height = 400; a[0].ax = 0x0061; a[0].bx = 0x0000; a[0].select_bank = ati_bank;
-	a[1].descr = "ATI 640 x 480, 256 colour";
-	a[1].width = 640; a[1].height = 400; a[1].ax = 0x0062; a[1].bx = 0x0000; a[1].select_bank = ati_bank;
-	a[2].descr = "ATI 800 x 600, 256 colour";
-	a[2].width = 800; a[2].height = 600; a[2].ax = 0x0063; a[2].bx = 0x0000; a[2].select_bank = ati_bank;
-	return 3;
-}
-
-
-int			setup_tseng(a)
-ADAPTER		*a;
-{
-	a[0] = supervga;
-	a[1] = supervga;
-	a[2] = supervga;
-	a[3] = supervga;
-	a[4] = supervga;
-
-	a[0].descr = "TSENG 640 x 350, 256 colour";
-	a[0].width = 640; a[0].height = 350; a[0].ax = 0x002d; a[0].bx = 0x0000; a[0].select_bank = tseng_bank;
-	a[1].descr = "TSENG 640 x 400, 256 colour";
-	a[1].width = 640; a[1].height = 400; a[1].ax = 0x0000; a[1].bx = 0x00fe; a[1].select_bank = tseng_bank;
-	a[2].descr = "TSENG 640 x 480, 256 colour";
-	a[2].width = 640; a[2].height = 480; a[2].ax = 0x002e; a[2].bx = 0x0000; a[2].select_bank = tseng_bank;
-	a[3].descr = "TSENG 720 x 512, 256 colour";
-	a[3].width = 720; a[3].height = 512; a[3].ax = 0x002f; a[3].bx = 0x0000; a[3].select_bank = tseng_bank;
-	a[4].descr = "TSENG 800 x 600, 256 colour";
-	a[4].width = 800; a[4].height = 600; a[4].ax = 0x0030; a[4].bx = 0x0000; a[4].select_bank = tseng_bank;
-	return 5;
-}
-
-
-int			setup_trident(a)
-ADAPTER		*a;
-{
-	a[0] = supervga;
-	a[1] = supervga;
-	a[2] = supervga;
-
-	a[0].descr = "TRIDENT 640 x 400, 256 colour";
-	a[0].width = 640; a[0].height = 400; a[0].ax = 0x005c; a[0].bx = 0x0000; a[0].select_bank = trident_bank;
-	a[1].descr = "TRIDENT 640 x 480, 256 colour";
-	a[1].width = 640; a[1].height = 400; a[1].ax = 0x005d; a[1].bx = 0x0000; a[1].select_bank = trident_bank;
-	a[2].descr = "TRIDENT 800 x 600, 256 colour";
-	a[2].width = 640; a[2].height = 400; a[2].ax = 0x005e; a[2].bx = 0x0000; a[2].select_bank = trident_bank;
-	return 3;
-}
-
-
-int			setup_paradise(a)
-ADAPTER		*a;
-{
-	a[0] = supervga;
-	a[1] = supervga;
-
-	a[0].descr = "PARADISE 640 x 400, 256 colour";
-	a[0].width = 640; a[0].height = 400; a[0].ax = 0x005e; a[0].bx = 0x0000; a[0].select_bank = paradise_bank;
-	a[1].descr = "PARADISE 640 x 480, 256 colour";
-	a[1].width = 640; a[1].height = 480; a[1].ax = 0x005f; a[1].bx = 0x0000; a[1].select_bank = paradise_bank;
-	return 2;
-}
-
-
-int			setup_everex(a)
-ADAPTER		*a;
-{
-	a[0] = supervga;
-	a[1] = supervga;
-	a[2] = supervga;
-	a[3] = supervga;
-	a[4] = supervga;
-
-	a[0].descr = "EVEREX 640 x 350, 256 colour";
-	a[0].width = 640; a[0].height = 350; a[0].ax = 0x0070; a[0].bx = 0x0013; a[0].select_bank = everex_bank;
-	a[1].descr = "EVEREX 640 x 400, 256 colour";
-	a[1].width = 640; a[1].height = 400; a[1].ax = 0x0070; a[1].bx = 0x0014; a[1].select_bank = everex_bank;
-	a[2].descr = "EVEREX 512 x 480, 256 colour";
-	a[2].width = 512; a[2].height = 480; a[2].ax = 0x0070; a[2].bx = 0x0015; a[2].select_bank = everex_bank;
-	a[3].descr = "EVEREX 640 x 480, 256 colour";
-	a[3].width = 640; a[3].height = 480; a[3].ax = 0x0070; a[3].bx = 0x0030; a[3].select_bank = everex_bank;
-	a[4].descr = "EVEREX 800 x 600, 256 colour";
-	a[4].width = 800; a[4].height = 600; a[4].ax = 0x0070; a[4].bx = 0x0031; a[4].select_bank = everex_bank;
-	return 5;
-}
-
-
-int			setup_chips(a)
-ADAPTER		*a;
-{
-	a[0] = supervga;
-	a[1] = supervga;
-	a[2] = supervga;
-
-	a[0].descr = "CHIPS & TECH. 640 x 400, 256 colour";
-	a[0].width = 640; a[0].height = 400; a[0].ax = 0x0078; a[0].bx = 0x0000; a[0].select_bank = chips_bank;
-	a[1].descr = "CHIPS & TECH. 640 x 480, 256 colour";
-	a[1].width = 640; a[1].height = 400; a[1].ax = 0x0079; a[1].bx = 0x0000; a[1].select_bank = chips_bank;
-	a[2].descr = "CHIPS & TECH. 800 x 600, 256 colour";
-	a[2].width = 640; a[2].height = 400; a[2].ax = 0x007b; a[2].bx = 0x0000; a[2].select_bank = chips_bank;
-	return 3;
-}
-
-
-int			setup_video7(a)
-ADAPTER		*a;
-{
-	a[0] = supervga;
-	a[1] = supervga;
-	a[2] = supervga;
-	a[3] = supervga;
-
-	a[0].descr = "VIDEO7 640 x 400, 256 colour";
-	a[0].width = 640; a[0].height = 400; a[0].ax = 0x6f05; a[0].bx = 0x0066; a[0].select_bank = video7_bank;
-	a[1].descr = "VIDEO7 640 x 480, 256 colour";
-	a[1].width = 640; a[1].height = 400; a[1].ax = 0x6f05; a[1].bx = 0x0067; a[1].select_bank = video7_bank;
-	a[2].descr = "VIDEO7 720 x 540, 256 colour";
-	a[2].width = 720; a[2].height = 540; a[2].ax = 0x6f05; a[2].bx = 0x0068; a[2].select_bank = video7_bank;
-	a[3].descr = "VIDEO7 800 x 600, 256 colour";
-	a[3].width = 640; a[2].height = 400; a[2].ax = 0x6f05; a[2].bx = 0x0069; a[2].select_bank = video7_bank;
-	return 4;
-}
-
-
-int			setup_oaktech(a)
-ADAPTER		*a;
-{
-	a[0] = supervga;
-	a[1] = supervga;
-
-	a[0].descr = "OAKTECH (OTI-067) 640 x 480, 256 colour";
-	a[0].width = 640; a[0].height = 480; a[0].ax = 0x0053; a[0].bx = 0x0000; a[0].select_bank = oaktech_bank;
-	a[1].descr = "OAKTECH (OTI-067) 800 x 600, 256 colour";
-	a[1].width = 800; a[1].height = 600; a[1].ax = 0x0054; a[1].bx = 0x0000; a[1].select_bank = oaktech_bank;
-	return 2;
-}
-
-
-int			setup_tseng4000(a)
-ADAPTER		*a;
-{
-	a[0] = supervga;
-	a[1] = supervga;
-	a[2] = supervga;
-	a[3] = supervga;
-	a[4] = supervga;
-
-	a[0].descr = "TSENG4000 640 x 350, 256 colour";
-	a[0].width = 640; a[0].height = 350; a[0].ax = 0x002d; a[0].bx = 0x0000; a[0].select_bank = tseng4_bank;
-	a[1].descr = "TSENG4000 640 x 400, 256 colour";
-	a[1].width = 640; a[1].height = 400; a[1].ax = 0x002f; a[1].bx = 0x0000; a[1].select_bank = tseng4_bank;
-	a[2].descr = "TSENG4000 640 x 480, 256 colour";
-	a[2].width = 640; a[2].height = 480; a[2].ax = 0x002e; a[2].bx = 0x0000; a[2].select_bank = tseng4_bank;
-	a[3].descr = "TSENG4000 800 x 600, 256 colour";
-	a[3].width = 800; a[3].height = 600; a[3].ax = 0x0030; a[3].bx = 0x0000; a[3].select_bank = tseng4_bank;
-	a[4].descr = "TSENG4000 1024 x 768, 256 colour";
-	a[4].width = 1024; a[4].height = 768; a[4].ax = 0x0038; a[4].bx = 0x0000; a[4].select_bank = tseng4_bank;
-	return 5;
-}
-
-
-
-static
-int			svga_init()
-{
-	regs.x.ax = v_adapter.ax;
-	regs.x.bx = v_adapter.bx;
- 	int86(0x10, &regs, &regs);
-	svga_cur_bank = 0;
-}
-
-
-
-static
-int			svga_block(p, w, h, x, y)
-char		*p;
-int			w,
-			h,
-			x,
-			y;
-{
-	int		i;
-
-	for (i = 0; i < h; i++) {
-		svga_putline(p + i*w, w, x, y+i);
-		}
-}
-
-
-
-static
-int			svga_fill(x, y, w, h, palette_index)
-int			x, y;
-int			w, h;
-int			palette_index;
-{
-	char	*s;
-	int		i,j;
-
-	if (!(s = malloc(w))) {
-		/* fill the slow way */
-		for (j = 0; j < h; j++) {
-			for (i = 0; i < w; i++) {
-				svga_putline((char *)(&palette_index), 1, x+i, j+y);
-				}
-			}
-		}
-	else {
-		/* the fast way */
-		memset(s, palette_index, w);
-		for (j = 0; j < h; j++) {
-			svga_putline(s, w, x, j+y);
-			}
-		free(s);
-		}
-}
-
-
-static
-int			svga_front()
-{
-}
-
-
-static
-int			svga_back()
-{
-}
-
-
-static
-int			svga_swap()
-{
-}
-
-
-static
-int			svga_text(p, x, y)
-char		*p;
-int			x,
-			y;
-{
-}
-
diff -Nrua vort-old/pc/tlink.in vort-new/pc/tlink.in
--- vort-old/pc/tlink.in	1992-05-25 21:10:32.000000000 -0400
+++ vort-new/pc/tlink.in	1969-12-31 19:00:00.000000000 -0500
@@ -1,9 +0,0 @@
-pcdisp.obj
-pcdspvg1.obj
-pcdspvg2.obj
-pcdspveg.obj
-supavgac.obj
-supavga.obj
-320x200.obj
-320x400.obj
-
diff -Nrua vort-old/README.VMS vort-new/README.VMS
--- vort-old/README.VMS	1991-03-06 20:05:31.000000000 -0500
+++ vort-new/README.VMS	1969-12-31 19:00:00.000000000 -0500
@@ -1,29 +0,0 @@
-
-A few extra things have to be done to get art to
-compile under VMS.
-
-1. in art/src/lex.c the 
-	
-		#include "stdio.h"
-
-	should be replaced by
-
-		#include <stdio.h>
-
-2. in art/src/lex.c the lines
-
-		#define yyin	stdin
-		#define yyout	stdout
-
-	should be added to the top of the file, and
-	the line
-
-		FILE	*yyin={stdin},*yyout={stdout};
-
-	should be changed to
-
-		FILE	*yyin, *yyout;
-
-3. in X11 movie.c and disp.c should be compiled with
-
-	-DMYBCOPY
diff -Nrua vort-old/sun/disp.1 vort-new/sun/disp.1
--- vort-old/sun/disp.1	1991-02-08 01:29:05.000000000 -0500
+++ vort-new/sun/disp.1	1969-12-31 19:00:00.000000000 -0500
@@ -1,42 +0,0 @@
-.TH DISP 1 "Feb 8, 1991" "VORT 2.0"
-.SH NAME
-disp, rdisp, gdisp, bdisp, adisp \- program for displaying a pix
-image file.
-.SH SYNOPSIS
-.PU
-.ll +8
-.B disp [-mmagnification] [-u]
-.I "file"
-.SH DESCRIPTION
-.I Disp
-displays a pix image file on a suitable Sun workstation in greyscale. If
-the file has a colourmap (see median (1)), the image is displayed using that
-image file's colourmap. If 
-.B -m
-is specified the magnification (an integer value from one to five) is
-applied to the image before display. If
-.B -u
-is specified the image is displayed upside down.
-.LP
-.I Rdisp
-displays the red channel of a pix image file.
-.LP
-.I Gdisp
-displays the green channel of a pix image file.
-.LP
-.I Bdisp
-displays the blue channel of a pix image file.
-.LP
-.I Adisp
-displays the alpha channel of a pix image file.
-.SH "SEE ALSO"
-.IR art (1),
-.IR vortinfo (1),
-.IR median (1),
-.IR movie (1),
-.IR mulmcut (1),
-.IR targ2vort (1),
-.IR vort2ps (1),
-.IR gamma (1),
-.IR greyscale (1),
-.IR vort (3).
diff -Nrua vort-old/sun/disp24.1 vort-new/sun/disp24.1
--- vort-old/sun/disp24.1	1991-02-08 01:29:05.000000000 -0500
+++ vort-new/sun/disp24.1	1969-12-31 19:00:00.000000000 -0500
@@ -1,27 +0,0 @@
-.TH DISP 1 "Feb 8, 1991" "VORT 2.0"
-.SH NAME
-disp24 \- program for displaying a 24 bit VORT
-image file.
-.SH SYNOPSIS
-.PU
-.ll +8
-.B disp24 [-u]
-.I "file"
-.SH DESCRIPTION
-.I Disp24
-displays a VORT image file on a suitable Sun workstation in 24 bit colour. If
-the file has a colourmap (see median (1)), the image is displayed using that
-image file's colourmap. If 
-.B -u
-is specified the image is displayed upsidedown.
-.SH "SEE ALSO"
-.IR art (1),
-.IR vortinfo (1),
-.IR median (1),
-.IR movie (1),
-.IR mulmcut (1),
-.IR targ2vort (1),
-.IR vort2ps (1),
-.IR gamma (1),
-.IR greyscale (1),
-.IR vort (3).
diff -Nrua vort-old/sun/disp24.c vort-new/sun/disp24.c
--- vort-old/sun/disp24.c	1991-02-08 01:29:05.000000000 -0500
+++ vort-new/sun/disp24.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,150 +0,0 @@
-#include <stdio.h>
-#include <math.h>
-#include <suntool/sunview.h>
-#include <suntool/canvas.h>
-#include "vort.h"
-
-extern	char	*rindex();
-
-
-/*
- * program to read in a 24 bit VORT file and display it on a 24 bit
- * RasterOps card.
- */
-main(ac, av)
-	int	ac;
-	char	**av;
-{
-	Frame			frame;
-	Canvas			canvas;
-	char			*myname, name[BUFSIZ];
-	register int		x;
-	unsigned short		h, w, wreal, w2;
-	int			line_bytes;
-	u_char			*red, *green, *blue;
-	u_char			*p, *pp;
-	register Pixwin		*pw;
-	register Pixrect	*pr;
-	image			*im;
-	int			upsidedown;
-
-        if ((myname = rindex(av[0],'/')) == NULL)
-                myname = av[0];
-        else
-                *myname++;
-        /*
-         * Check that we are in sunview....
-         */
-        if (getenv("WINDOW_ME") == NULL) {
-                fprintf(stderr, "%s can only be run under sunview (suntools)\n", myname);
-                fprintf(stderr, "on the same machine that is running sunview.\n");
-                exit(1);
-        }
-
-	if (ac < 2 || ac > 4) {
-		fprintf(stderr, "%s: usage %s [-u] file.\n", myname, myname);
-		exit(1);
-	}
-
-	upsidedown = 0;
-	for (x = 1; x < ac && *av[x] == '-'; x++) {
-		if (strncmp(av[x], "-u", 2) == 0) { /* show image upside down */
-			upsidedown = 1;
-		}
-	} 
-
-	if ((im = openimage(av[x], "r")) == (image *)NULL) {
-		fprintf(stderr, "%s: can't open file %s.\n", myname, av[x]);
-		exit(1);
-	}
-
-	strcpy(name, myname);
-	strcat(name, ": ");
-
-        if ((myname = rindex(av[x],'/')) == NULL)
-                myname = av[x];
-        else
-                *myname++;
-
-	if (titlelength(im) == 0)
-		strcat(name, myname);
-	else
-		strcat(name, imagetitle(im));
-
-	w = imagewidth(im);
-	h = imageheight(im);
-
-	if (imagedepth(im) < 24)
-		imagedepth(im) = 24;
-
-        w2 = w;
-	if ((x = w % 4) != 0)
-                w2 = (w / 4 + x) * 4;
-
-	/*
-	 * Need a 32 bit deep pixrect for this stuff...
-	 */
-	if ((pr = mem_create(w2, h, (8 + imagedepth(im)))) == (Pixrect *)NULL) {
-		fprintf(stderr, "Couldn't allocate Pixrect\n");
-		exit(1);
-	}
-
-	line_bytes = mpr_linebytes(w2, 8 + imagedepth(im));
-	p = (unsigned char *)mpr_d(pr)->md_image; /* Start of Pixrect */
-
-	if (upsidedown)
-		p += line_bytes * (h - 1);	/* Last line in Pixrect */
-
-	frame = window_create(0, FRAME,
-			WIN_HEIGHT, h,
-			WIN_WIDTH, w,
-			FRAME_LABEL, name,
-		0);
-
-	canvas = window_create(frame, CANVAS,
-			WIN_HEIGHT, h,
-			WIN_WIDTH, w,
-			CANVAS_COLOR24, TRUE,
-		0);
-
-	window_fit(frame);
-
-	pw = (Pixwin *)canvas_pixwin(canvas);
-
-	if ((red = (u_char *)malloc(w2)) == NULL) {
-		fprintf(stderr, "No mem!\n");
-		exit(1);
-	}
-	if ((green = (u_char *)malloc(w2)) == NULL) {
-		fprintf(stderr, "No mem!\n");
-		exit(1);
-	}
-	if ((blue = (u_char *)malloc(w2)) == NULL) {
-		fprintf(stderr, "No mem!\n");
-		exit(1);
-	}
-
-	while (readrgbline(im, red, green, blue)) {
-		pp = p;
-		for (x = 0; x < w; x++) {
-			*pp++ = 0;
-			*pp++ = blue[x];
-			*pp++ = green[x];
-			*pp++ = red[x];
-		}
-
-		if (upsidedown)
-			p -= line_bytes;
-		else
-			p += line_bytes;
-
-	}
-
-	pw_batch_on(pw);
-	pw_rop(pw, 0, 0, w, h, PIX_SRC, pr, 0, 0);
-	pw_batch_off(pw);
-
-	window_main_loop(frame);
-
-	exit(0);
-}
diff -Nrua vort-old/sun/disp24.doc vort-new/sun/disp24.doc
--- vort-old/sun/disp24.doc	1991-02-08 01:29:05.000000000 -0500
+++ vort-new/sun/disp24.doc	1969-12-31 19:00:00.000000000 -0500
@@ -1,66 +0,0 @@
-
-
-
-DISP(1)                  USER COMMANDS                    DISP(1)
-
-
-
-NAME
-     disp24 - program for displaying a 24 bit VORT image file.
-
-SYNOPSIS
-     disp24 [-u] file
-
-DESCRIPTION
-     Disp24 displays a VORT image file on a suitable Sun worksta-
-     tion  in  24  bit  colour.  If the file has a colourmap (see
-     median (1)), the image is displayed using that image  file's
-     colourmap. If -u is specified the image is displayed upside-
-     down.
-
-SEE ALSO
-     art(1),  vortinfo(1),   median(1),   movie(1),   mulmcut(1),
-     targ2vort(1), vort2ps(1), gamma(1), greyscale(1), vort(3).
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-VORT 2.0            Last change: Feb 8, 1991                    1
-
-
-
diff -Nrua vort-old/sun/disp.c vort-new/sun/disp.c
--- vort-old/sun/disp.c	1991-02-08 01:29:05.000000000 -0500
+++ vort-new/sun/disp.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,211 +0,0 @@
-#include <stdio.h>
-#include <math.h>
-#include <suntool/sunview.h>
-#include <suntool/canvas.h>
-#include "vort.h"
-
-#define	CMAPSIZE	256
-#define	DEPTH		8
-
-extern	char	*rindex();
-
-
-/*
- * program to read in a color-mapped image and display it on the sun
- */
-main(ac, av)
-	int	ac;
-	char	**av;
-{
-	Frame			frame;
-	Canvas			canvas;
-	char			*myname, name[BUFSIZ], buf[BUFSIZ];
-	register int		i, j, x, y;
-	unsigned short		h, w, wreal, w2;
-	int			val, line_bytes, mag = 1;
-	u_char			*line, *red, *green, *blue;
-	u_char			*l, *p, *pp;
-	register Pixwin		*pw;
-	register Pixrect	*pr;
-	image			*im;
-	int			upsidedown;
-
-        if ((myname = rindex(av[0],'/')) == NULL)
-                myname = av[0];
-        else
-                *myname++;
-        /*
-         * Chech that we are in sunview....
-         */
-        if (getenv("WINDOW_ME") == NULL) {
-                fprintf(stderr, "%s can only be run under sunview (suntools)\n", myname);
-                fprintf(stderr, "on the same machine that is running sunview.\n");
-                exit(1);
-        }
-
-	if (ac < 2 || ac > 4) {
-		fprintf(stderr, "%s: usage %s [-m<n>] [-u] file.\n", myname, myname);
-		exit(1);
-	}
-
-	upsidedown = 0;
-	for (i = 1; i < ac && *av[i] == '-'; i++) {
-		if (strncmp(av[i], "-m", 2) == 0) {		/* magnify */
-			if (sscanf(av[i] , "-m%d", &mag) != 1) {
-				fprintf(stderr, "%s: bad mag factor\n", myname);
-				exit(1);
-			}
-
-			if (mag < 1 || mag > 5) {
-				fprintf(stderr, "%s: bad mag factor\n", myname);
-				exit(1);
-			}
-		} else if (strncmp(av[i], "-u", 2) == 0) {		/* show image upside down */
-			upsidedown = 1;
-		}
-	} 
-
-	if ((im = openimage(av[i], "r")) == (image *)NULL) {
-		fprintf(stderr, "%s: can't open file %s.\n", myname, av[i]);
-		exit(1);
-	}
-
-	strcpy(name, myname);
-	strcat(name, ": ");
-
-        if ((myname = rindex(av[i],'/')) == NULL)
-                myname = av[i];
-        else
-                *myname++;
-
-	if (titlelength(im) == 0)
-		strcat(name, myname);
-	else
-		strcat(name, imagetitle(im));
-
-	wreal = imagewidth(im);
-	w = wreal * mag;
-	h = mag * imageheight(im);
-
-        w2 = w;
-        if ((i = w % 4) != 0)
-                w2 = (w / 4 + i) * 4;
-
-	if ((pr = mem_create(w2, h, DEPTH)) == (Pixrect *)NULL) {
-		fprintf(stderr, "Couldn't allocate Pixrect\n");
-		exit(1);
-	}
-
-	line_bytes = mpr_linebytes(w2, DEPTH);
-	p = (unsigned char *)mpr_d(pr)->md_image; /* Start of Pixrect */
-
-	if (upsidedown)
-		p += line_bytes * (h - 1);	/* Last line in Pixrect */
-
-	frame = window_create(0, FRAME,
-			WIN_HEIGHT, h,
-			WIN_WIDTH, w,
-			FRAME_LABEL, name,
-		0);
-
-	canvas = window_create(frame, CANVAS,
-			CANVAS_RETAINED, TRUE,
-			WIN_HEIGHT, h,
-			WIN_WIDTH, w,
-		0);
-
-	window_fit(frame);
-
-	pw = (Pixwin *)canvas_pixwin(canvas);
-
-	sprintf(buf, "disp%d\n", getpid());
-
-	y = h - 1;
-	x = 0;
-	val = -1;
-
-	line = (u_char *)malloc(w2);
-	l = line;
-
-	if (colormapped(im)) {
-		pw_setcmsname(pw, buf);
-		pw_putcolormap(pw, 0, cmapsize(im), redmap(im), greenmap(im), bluemap(im));
-
-		while (y >= 0) {
-			readmappedline(im, line);
-			if (mag == 1) {
-				bcopy(l, p, line_bytes);
-				if (upsidedown)
-					p -= line_bytes;
-				else
-					p += line_bytes;
-				y--;
-			} else {
-				for (j = 0; j < mag; j++) {
-					pp = p;
-					for (x = 0; x < wreal; x++) 
-						for (i = 0; i < mag; i++)
-							*pp++ = l[x];
-
-					if (upsidedown)
-						p -= line_bytes;
-					else
-						p += line_bytes;
-				}
-				y -= mag;
-			}
-		}
-	} else {
-		if (w2 < CMAPSIZE) {
-			red = (u_char *)malloc(CMAPSIZE);
-			green = (u_char *)malloc(CMAPSIZE);
-			blue = (u_char *)malloc(CMAPSIZE);
-		} else {
-			red = (u_char *)malloc(w2);
-			green = (u_char *)malloc(w2);
-			blue = (u_char *)malloc(w2);
-		}
-
-		for (i = 0; i < CMAPSIZE; i++)
-			red[i] = green[i] = blue[i] = i;
-
-		pw_setcmsname(pw, buf);
-		pw_putcolormap(pw, 0, CMAPSIZE, red, green, blue);
-
-		while (y >= 0) {
-			readrgbline(im, red, green, blue);
-			for (x = 0; x < w; x++) 
-				line[x] = red[x] * 0.3 + green[x] * 0.59 + blue[x] * 0.11;
-
-			if (mag == 1) {
-				bcopy(l, p, line_bytes);
-				if (upsidedown)
-					p -= line_bytes;
-				else
-					p += line_bytes;
-				y--;
-			} else {
-				for (j = 0; j < mag; j++) {
-					pp = p;
-					for (x = 0; x < wreal; x++) 
-						for (i = 0; i < mag; i++)
-							*pp++ = l[x];
-
-					if (upsidedown)
-						p -= line_bytes;
-					else
-						p += line_bytes;
-				}
-				y -= mag;
-			}
-		}
-	}
-
-	pw_batch_on(pw);
-	pw_rop(pw, 0, 0, w, h, PIX_SRC | PIX_DONTCLIP, pr, 0, 0);
-	pw_batch_off(pw);
-
-	window_main_loop(frame);
-
-	exit(0);
-}
diff -Nrua vort-old/sun/disp.doc vort-new/sun/disp.doc
--- vort-old/sun/disp.doc	1991-02-08 01:29:05.000000000 -0500
+++ vort-new/sun/disp.doc	1969-12-31 19:00:00.000000000 -0500
@@ -1,66 +0,0 @@
-
-
-
-DISP(1)                  USER COMMANDS                    DISP(1)
-
-
-
-NAME
-     disp, rdisp, gdisp, bdisp, adisp - program for displaying  a
-     pix image file.
-
-SYNOPSIS
-     disp [-mmagnification] [-u] file
-
-DESCRIPTION
-     Disp displays a pix image file on a suitable Sun workstation
-     in  greyscale. If the file has a colourmap (see median (1)),
-     the image is displayed using that image file's colourmap. If
-     -m is specified the magnification (an integer value from one
-     to five) is applied to the image before display.  If  -u  is
-     specified the image is displayed upside down.
-
-     Rdisp displays the red channel of a pix image file.
-
-     Gdisp displays the green channel of a pix image file.
-
-     Bdisp displays the blue channel of a pix image file.
-
-     Adisp displays the alpha channel of a pix image file.
-
-SEE ALSO
-     art(1),  vortinfo(1),   median(1),   movie(1),   mulmcut(1),
-     targ2vort(1), vort2ps(1), gamma(1), greyscale(1), vort(3).
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-VORT 2.0            Last change: Feb 8, 1991                    1
-
-
-
diff -Nrua vort-old/sun/Makefile vort-new/sun/Makefile
--- vort-old/sun/Makefile	1995-04-03 20:38:58.000000000 -0400
+++ vort-new/sun/Makefile	1969-12-31 19:00:00.000000000 -0500
@@ -1,40 +0,0 @@
-CC=cc
-MLIBS =  -lsuntool -lsunwindow -lpixrect
-MFLAGS = /usr/lib/libm.il -fsingle -O4
-CFLAGS = $(MFLAGS) -I../lib
-LIBS = ../lib/libvort.a $(MLIBS) -lm
-OBJS = disp.o movie.o disp24.o movie24.o
-
-all: disp24 disp movie24 movie pdisp rdisp
-
-disp: disp.o ../lib/libvort.a
-	$(CC) $(CFLAGS) -o disp disp.o $(LIBS)
-
-disp24: disp24.o ../lib/libvort.a
-	$(CC) $(CFLAGS) -o disp24 disp24.o $(LIBS)
-
-rdisp: rdisp.o ../lib/libvort.a
-	$(CC) $(CFLAGS) -o rdisp rdisp.o $(LIBS)
-	rm -f gdisp bdisp adisp
-	ln -s rdisp gdisp
-	ln -s rdisp bdisp
-	ln -s rdisp adisp
-
-pdisp: pdisp.o 
-	$(CC) $(CFLAGS) -o pdisp pdisp.o $(LIBS)
-
-movie: movie.o ../lib/libvort.a
-	$(CC) $(CFLAGS) -o movie movie.o $(LIBS)
-
-movie24: movie24.o ../lib/libvort.a
-	$(CC) $(CFLAGS) -o movie24 movie24.o $(LIBS)
-
-
-clean:
-	rm -f *.o core
-
-clobber:
-	rm -f *.o disp movie ?disp disp24 movie24 core
-
-$(OBJS):\
-../lib/vort.h 
diff -Nrua vort-old/sun/movie.1 vort-new/sun/movie.1
--- vort-old/sun/movie.1	1991-02-08 01:29:05.000000000 -0500
+++ vort-new/sun/movie.1	1969-12-31 19:00:00.000000000 -0500
@@ -1,30 +0,0 @@
-.TH MOVIE 1 "Feb 8, 1991" "VORT 2.0"
-.SH NAME
-movie - a program for displaying several image files in sequence.
-.SH SYNOPSIS
-.PU
-.ll +8
-.B movie [-t] [-u]
-.I file1 file2 file3 ...
-.SH DESCRIPTION
-.I Movie
-displays each pix image file on a suitable Sun workstation in the sequence
-given on the command line. If the images are full colour they are displayed
-in greyscale. If all the files have a colourmap (see mulmcut (1)), the
-images are displayed using the colourmap.
-If 
-.B -t
-is specified the title of each file is printed in the panel as well.
-.B -u
-is specified each frame is displayed upside down.
-.SH "SEE ALSO"
-.IR art (1),
-.IR vortinfo (1),
-.IR disp (1),
-.IR median (1),
-.IR mulmcut (1),
-.IR targ2vort (1),
-.IR vort2ps (1),
-.IR gamma (1),
-.IR greyscale (1),
-.IR vort (3).
diff -Nrua vort-old/sun/movie24.1 vort-new/sun/movie24.1
--- vort-old/sun/movie24.1	1991-02-08 01:29:06.000000000 -0500
+++ vort-new/sun/movie24.1	1969-12-31 19:00:00.000000000 -0500
@@ -1,31 +0,0 @@
-.TH MOVIE24 1 "Feb 8, 1991" "VORT 2.0"
-.SH NAME
-movie24 - a program for displaying several image files in sequence.
-.SH SYNOPSIS
-.PU
-.ll +8
-.B movie24 [-t] [-u]
-.I file1 file2 file3 ...
-.SH DESCRIPTION
-.I Movie24
-displays each pix image file on a suitable Sun workstation in the sequence
-given on the command line. If the images are full colour they are displayed
-in 24 bit colour. If all the files have a colourmap (see mulmcut (1)), the
-images are displayed using the colourmap.
-If 
-.B -t
-is specified the title of each file is printed in the panel as well.
-If
-.B -u
-is specified each frame will be displayed upside down.
-.SH "SEE ALSO"
-.IR art (1),
-.IR vortinfo (1),
-.IR disp (1),
-.IR median (1),
-.IR mulmcut (1),
-.IR targ2vort (1),
-.IR vort2ps (1),
-.IR gamma (1),
-.IR greyscale (1),
-.IR vort (3).
diff -Nrua vort-old/sun/movie24.c vort-new/sun/movie24.c
--- vort-old/sun/movie24.c	1991-02-08 01:29:06.000000000 -0500
+++ vort-new/sun/movie24.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,386 +0,0 @@
-#include <stdio.h>
-#include <strings.h>
-#include <suntool/sunview.h>
-#include <suntool/canvas.h>
-#include <suntool/panel.h>
-#include "vort.h"
-
-#define	DEPTH		32
-#define	MAX(a, b)	((a) > (b) ? (a) : (b))
-
-extern	Notify_error	notify_dispatch();
-
-Canvas		canvas;
-Frame		frame;
-
-Pixwin		*pw, *fpw, *tpw, *ppw;
-Pixrect		*pr, **ppr;
-
-Pixfont		*medium;
-
-Panel		panel, tpanel;
-Panel_item	fnum_item, tpanel_item;
-
-int		dir,
-		color = 1,
-		cur_frame = -1,
-		one = 1,
-		fnum,
-		stopped = 1,
-		keep_going = 1,
-		tlen = 0,
-		do_titles = 0;
-
-short		w, w2, h, oldw, oldh;
-
-u_char		*pp, *red, *green, *blue;
-
-char		*myname;
-char		**title;
-
-image		*im;
-
-/*
- * program to read in a 24bit VORT image and display it on a RasterOps
- * 24 bit card on a SUN.
- */
-main(ac, av)
-	int	ac;
-	char	**av;
-{
-	register int	ox, x, y;
-	int		len, v, f;
-	u_char		*line;
-        caddr_t         l;
-        caddr_t         p;
-        int             line_bytes;
-	int		upsidedown;
-
-	if ((myname = rindex(av[0],'/')) == NULL)
-		myname = av[0];
-	else
-		*myname++;
-	/*
-	 * Chech that we are in sunview....
-	 */
-	if (getenv("WINDOW_ME") == NULL) {
-		fprintf(stderr, "%s can only be run under sunview (suntools).\n", myname);
-		exit(1);
-	}
-
-	if (ac < 2) {
-		fprintf(stderr, "usage: %s [-t] [-u] files\n", myname);
-		exit(1);
-	}
-
-	do_titles = 0;
-	upsidedown = 0;
-
-	for (f = 1; f < ac && *av[f] == '-'; f++) {
-		if (strcmp(av[f], "-t") == 0) {
-			do_titles = 1;
-		} else if (strcmp(av[f], "-u") == 0) {
-			upsidedown = 1;
-		}
-	}
-
-        medium = pf_open("/usr/lib/fonts/fixedwidthfonts/cour.b.16");
-
-
-	/*
-	 * Read in a bunch of images into pixrects
-	 *
-	 * First allocate a bunch of pixrect pointers
-	 */
-
-	ppr = (Pixrect **)malloc(sizeof(Pixrect *) * (ac - f));
-
-	if (do_titles) 
-		title = (char **)malloc(sizeof(char *) * (ac - f));
-		
-	for (fnum = f; fnum < ac; fnum++) {
-		if ((im = openimage(av[fnum], "r")) == (image *)NULL) {
-			fprintf(stderr, "%s: can't open file %s.\n", myname, av[fnum]);
-			exit(1);
-		}
-
-		fprintf(stderr, "Reading file %s\n", av[fnum]);
-
-		len = titlelength(im);
-		tlen = MAX(tlen, len);
-
-		w = imagewidth(im);
-		h = imageheight(im);
-
-		w2 = w;
-		if ((x = w % 4) != 0)
-			w2 = (w / 4 + x) * 4;
-
-		if (one) {
-			one = 0;
-			oldw = w;
-			oldh = h;
-			red = (u_char *)malloc(w);
-			green = (u_char *)malloc(w);
-			blue = (u_char *)malloc(w);
-		} else if (oldw != w || oldh != h) {
-			fprintf(stderr, "All images must be the same size\n");
-			exit(1);
-		}
-
-
-		if (do_titles) {
-			if (len != 0) {
-				title[fnum - f] = (char *)malloc((unsigned)len);
-				strcpy(title[fnum - f], imagetitle(im));
-			} else {
-				title[fnum - f] = (char *)malloc(1);
-				title[fnum - f][0] = '\0';
-			}
-		}
-
-		/*
-		 * Allocate the pixrect for this frame 
-		 */
-		if ((pr = ppr[fnum - f] = mem_create(w2, h, DEPTH)) == (Pixrect *)NULL) {
-			fprintf(stderr, "Failed to allocate Pixrect for frame %d\n", fnum);
-			break;
-		}
-
-		line_bytes = mpr_linebytes(w2, DEPTH);
-		p = (caddr_t)mpr_d(pr)->md_image; /* Start of Pixrect */
-
-		if (upsidedown)
-			p += line_bytes * (h - 1);      /* Last line in Pixrect */
-
-		while (readrgbline(im, red, green, blue)) {
-			pp = (u_char *)p;
-			for (x = 0; x < w; x++) {
-				*pp++ = 0;
-				*pp++ = blue[x];
-				*pp++ = green[x];
-				*pp++ = red[x];
-			}
-
-			if (upsidedown)
-				p -= line_bytes;
-			else
-				p += line_bytes;
-		}
-
-		if (fnum < ac - 1)
-			closeimage(im);
-	}
-	fprintf(stderr, "Finished reading %d files.\n", fnum - f);
-
-	fnum -= f;
-
-	if (tlen <= 0)
-		do_titles = 0;
-
-	init(w, h);
-	closeimage(im);
-
-	window_set(frame, WIN_SHOW, TRUE, 0);
-	
-	dir = 1;
-	show_frame();
-
-	/*
-	 * Uses explicit sunview dispatching
-	 */
-	while (keep_going) {
-		(void)notify_dispatch();
-		while (!stopped) {
-			show_frame();
-			(void)notify_dispatch();
-		}
-	}
-
-}
-
-show_frame()
-{
-	char	buf[20];
-
-	cur_frame += dir;
-	if (cur_frame >= fnum)
-		cur_frame = 0;
-	else if (cur_frame < 0)
-		cur_frame = fnum - 1;
-
-	sprintf(buf, "Frame: %d\n", cur_frame);
-	pw_batch_on(pw);
-	pw_rop(pw, 0, 0, w, h, PIX_SRC | PIX_DONTCLIP, ppr[cur_frame], 0, 0);
-	pw_batch_off(pw);
-	panel_set(fnum_item, PANEL_LABEL_STRING, buf, 0);
-
-	if (do_titles) {
-		panel_set(tpanel_item, PANEL_LABEL_STRING, title[cur_frame], 0);
-	}
-}
-
-stop()
-{
-	stopped = 1;
-}
-
-start()
-{
-	stopped = 0;
-}
-
-Notify_value
-exterminate(frame, status)
-	Frame		frame;
-	Destroy_status	status;
-{
-	if (status != DESTROY_CHECKING) {
-		keep_going = 0;
-		stopped = 1;
-		(void)notify_stop();
-	}
-
-	return (notify_next_destroy_func(frame, status));
-}
-
-quit()
-{
-/*
-        DESTROY_PROCESS_DEATH=0,
-        DESTROY_CHECKING=1,
-        DESTROY_CLEANUP=2,
-*/
-
-	notify_post_destroy(frame, DESTROY_CHECKING, NOTIFY_SAFE);
-	notify_post_destroy(frame, DESTROY_CLEANUP, NOTIFY_SAFE);
-	exit(0);
-}
-
-reverse()
-{	
-	dir = -1;
-	if (stopped)
-		show_frame();
-}
-
-forward()
-{	
-	dir = 1;
-	if (stopped)
-		show_frame();
-}
-
-init(w, h)
-	int	w, h;
-{
-	int	i;
-	char	buf[30];
-
-	strcpy(buf, myname);
-	strcat(buf, ".vo");
-
-	frame = window_create(NULL, FRAME,
-		FRAME_LABEL, buf,
-		WIN_FIT_HEIGHT, 3,
-	0);
-
-	(void)notify_interpose_destroy_func(frame, exterminate);
-
-	fpw = (Pixwin *)window_get(frame, WIN_PIXWIN);
-
-	panel = window_create(frame, PANEL, 
-			WIN_FONT, medium,
-			WIN_HEIGHT, 30,
-/*
-			WIN_X, 1, 
-			WIN_Y, 3,
-*/
-	0);
-
-	ppw = (Pixwin *)window_get(panel, WIN_PIXWIN);
-
-
-	panel_create_item(
-		panel, PANEL_BUTTON,
-		PANEL_LABEL_IMAGE,
-		panel_button_image(panel, "<<", 0, 0),
-		PANEL_NOTIFY_PROC, reverse,
-	0);
-
-	panel_create_item(
-		panel, PANEL_BUTTON,
-		PANEL_LABEL_IMAGE,
-		panel_button_image(panel, "Play", 0, 0),
-		PANEL_NOTIFY_PROC, start,
-	0);
-
-	panel_create_item(
-		panel, PANEL_BUTTON,
-		PANEL_LABEL_IMAGE,
-		panel_button_image(panel, ">>", 0, 0),
-		PANEL_NOTIFY_PROC, forward,
-	0);
-
-	panel_create_item(
-		panel, PANEL_BUTTON,
-		PANEL_LABEL_IMAGE,
-		panel_button_image(panel, "Stop", 0, 0),
-		PANEL_NOTIFY_PROC, stop,
-	0);
-
-	fnum_item = panel_create_item(
-			panel, PANEL_MESSAGE,
-			PANEL_LABEL_STRING, "Frame: 0  ",
-		    0);
-
-	panel_create_item(
-		panel, PANEL_BUTTON,
-		PANEL_LABEL_IMAGE,
-		panel_button_image(panel, " QUIT ", 0, 0),
-		PANEL_NOTIFY_PROC, quit,
-	0);
-
-
-	canvas = window_create(frame, CANVAS,
-			/*CANVAS_RETAINED, TRUE,*/
-			WIN_HEIGHT, h,
-			WIN_WIDTH, w,
-			WIN_X, 1, 
-			WIN_Y, 39,
-			CANVAS_COLOR24, TRUE,
-		0);
-
-	pw = (Pixwin *)canvas_pixwin(canvas);
-
-	if (do_titles) {
-		tpanel = window_create(frame, PANEL, 
-				WIN_FONT, medium,
-				WIN_HEIGHT, 30,
-				WIN_X, 1, 
-				WIN_Y, 45 + h,
-		0);
-
-		tpw = (Pixwin *)window_get(tpanel, WIN_PIXWIN);
-
-		tlen--;
-		for (i = 0; i < tlen; i++)
-			buf[i] = ' ';
-
-		buf[tlen] = '\0';
-
-		tpanel_item = panel_create_item(
-				tpanel, PANEL_MESSAGE,
-				PANEL_LABEL_STRING, buf,
-			    0);
-	}
-
-	window_fit(panel);
-	window_fit(canvas);
-
-	if (do_titles)
-		window_fit(tpanel);
-
-	window_fit(frame);
-
-}
diff -Nrua vort-old/sun/movie24.doc vort-new/sun/movie24.doc
--- vort-old/sun/movie24.doc	1991-02-08 01:29:06.000000000 -0500
+++ vort-new/sun/movie24.doc	1969-12-31 19:00:00.000000000 -0500
@@ -1,66 +0,0 @@
-
-
-
-MOVIE24(1)               USER COMMANDS                 MOVIE24(1)
-
-
-
-NAME
-     movie24 - a program for displaying several image files  in
-     sequence.
-
-SYNOPSIS
-     movie24 [-t] [-u] file1 file2 file3 ...
-
-DESCRIPTION
-     Movie24 displays each pix  image  file  on  a  suitable  Sun
-     workstation  in  the  sequence given on the command line. If
-     the images are full colour they  are  displayed  in  24  bit
-     colour. If all the files have a colourmap (see mulmcut (1)),
-     the images are displayed using  the  colourmap.   If  -t  is
-     specified  the title of each file is printed in the panel as
-     well.  If -u is  specified  each  frame  will  be  displayed
-     upside down.
-
-SEE ALSO
-     art(1),   vortinfo(1),   disp(1),   median(1),   mulmcut(1),
-     targ2vort(1), vort2ps(1), gamma(1), greyscale(1), vort(3).
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-VORT 2.0            Last change: Feb 8, 1991                    1
-
-
-
diff -Nrua vort-old/sun/movie.c vort-new/sun/movie.c
--- vort-old/sun/movie.c	1991-02-08 01:29:06.000000000 -0500
+++ vort-new/sun/movie.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,440 +0,0 @@
-#include <stdio.h>
-#include <strings.h>
-#include <suntool/sunview.h>
-#include <suntool/canvas.h>
-#include <suntool/panel.h>
-#include "vort.h"
-
-#define	CMAPSIZE	256
-#define	DEPTH		8
-#define	MAX(a, b)	((a) > (b) ? (a) : (b))
-
-extern	Notify_error	notify_dispatch();
-
-Canvas		canvas;
-Frame		frame;
-
-Pixwin		*pw, *fpw, *tpw, *ppw;
-Pixrect		*pr, **ppr;
-
-Pixfont		*medium;
-
-Panel		panel, tpanel;
-Panel_item	fnum_item, tpanel_item;
-
-int		dir,
-		color = 1,
-		cur_frame = -1,
-		one = 1,
-		fnum,
-		stopped = 1,
-		keep_going = 1,
-		tlen = 0,
-		do_titles = 0;
-
-short		w, w2, h, oldw, oldh;
-
-u_char		*red, *green, *blue;
-
-char		*myname;
-char		**title;
-
-image		*im;
-
-/*
- * program to read in a color-mapped image and display it on the sun
- */
-main(ac, av)
-	int	ac;
-	char	**av;
-{
-	register int	ox, x, y;
-	int		len, v, f;
-	u_char		*line;
-        caddr_t         l;
-        caddr_t         p;
-        int             line_bytes;
-	int		upsidedown;
-
-	if ((myname = rindex(av[0],'/')) == NULL)
-		myname = av[0];
-	else
-		*myname++;
-	/*
-	 * Chech that we are in sunview....
-	 */
-	if (getenv("WINDOW_ME") == NULL) {
-		fprintf(stderr, "%s can only be run under sunview (suntools).\n", myname);
-		exit(1);
-	}
-
-	if (ac < 2) {
-		fprintf(stderr, "usage: %s [-t] [-u] files\n", myname);
-		exit(1);
-	}
-
-	do_titles = 0;
-	upsidedown = 0;
-
-	for (f = 1; f < ac && *av[f] == '-'; f++) {
-		if (strcmp(av[f], "-t") == 0) {
-			do_titles = 1;
-		} else if (strcmp(av[f], "-u") == 0) {
-			upsidedown = 1;
-		}
-	}
-
-        medium = pf_open("/usr/lib/fonts/fixedwidthfonts/cour.b.16");
-
-
-	/*
-	 * Read in a bunch of images into pixrects
-	 *
-	 * First allocate a bunch of pixrect pointers
-	 */
-
-	ppr = (Pixrect **)malloc(sizeof(Pixrect *) * (ac - f));
-
-	if (do_titles) 
-		title = (char **)malloc(sizeof(char *) * (ac - f));
-		
-	for (fnum = f; fnum < ac; fnum++) {
-		if ((im = openimage(av[fnum], "r")) == (image *)NULL) {
-			fprintf(stderr, "%s: can't open file %s.\n", myname, av[fnum]);
-			exit(1);
-		}
-
-		fprintf(stderr, "Reading file %s\n", av[fnum]);
-
-		len = titlelength(im);
-		tlen = MAX(tlen, len);
-
-		w = imagewidth(im);
-		h = imageheight(im);
-
-		w2 = w;
-		if ((x = w % 4) != 0)
-			w2 = (w / 4 + x) * 4;
-
-		if (one) {
-			one = 0;
-			oldw = w;
-			oldh = h;
-			line = (u_char *)malloc(w);
-			l = (caddr_t)line;
-			if (!colormapped(im)) {
-				color = 0;
-				if (w < CMAPSIZE) {
-					red = (u_char *)malloc(CMAPSIZE);
-					green = (u_char *)malloc(CMAPSIZE);
-					blue = (u_char *)malloc(CMAPSIZE);
-				} else {
-					red = (u_char *)malloc(w);
-					green = (u_char *)malloc(w);
-					blue = (u_char *)malloc(w);
-				}
-			}
-		} else if (oldw != w || oldh != h) {
-			fprintf(stderr, "All images must be the same size\n");
-			exit(1);
-		}
-
-
-		if (do_titles) {
-			if (len != 0) {
-				title[fnum - f] = (char *)malloc((unsigned)len);
-				strcpy(title[fnum - f], imagetitle(im));
-			} else {
-				title[fnum - f] = (char *)malloc(1);
-				title[fnum - f][0] = '\0';
-			}
-		}
-
-		/*
-		 * Allocate the pixrect for this frame 
-		 */
-		if ((pr = ppr[fnum - f] = mem_create(w2, h, DEPTH)) == (Pixrect *)NULL) {
-			fprintf(stderr, "Failed to allocate Pixrect for frame %d\n", fnum);
-			break;
-		}
-
-		line_bytes = mpr_linebytes(w2, DEPTH);
-		p = (caddr_t)mpr_d(pr)->md_image; /* Start of Pixrect */
-
-		if (upsidedown)
-			p += line_bytes * (h - 1);      /* Last line in Pixrect */
-
-		y = h - 1;
-		x = 0;
-
-		if (color) {
-			while (y >= 0) {
-				readmappedline(im, line);
-				bcopy(l, p, line_bytes);	/* Quite fast */
-				if (upsidedown)
-					p -= line_bytes;		/* Backwards */
-				else
-					p += line_bytes;
-				y--;
-			}
-		} else {
-			while (y >= 0) {
-				readrgbline(im, red, green, blue);
-				for (x = 0; x < w; x++) 
-					line[x] = red[x] * 0.3 + green[x] * 0.59 + blue[x] * 0.11;
-
-				bcopy(l, p, line_bytes);	/* Quite fast */
-				if (upsidedown)
-					p -= line_bytes;		/* Backwards */
-				else
-					p += line_bytes;
-				y--;
-			}
-		}
-
-		if (fnum < ac - 1)
-			closeimage(im);
-	}
-	fprintf(stderr, "Finished reading %d files.\n", fnum - f);
-
-	fnum -= f;
-
-	if (tlen <= 0)
-		do_titles = 0;
-
-	init(w, h);
-	closeimage(im);
-
-	window_set(frame, WIN_SHOW, TRUE, 0);
-	
-	dir = 1;
-	show_frame();
-
-	/*
-	 * Uses explicit sunview dispatching
-	 */
-	while (keep_going) {
-		(void)notify_dispatch();
-		while (!stopped) {
-			show_frame();
-			(void)notify_dispatch();
-		}
-	}
-
-}
-
-show_frame()
-{
-	char	buf[20];
-
-	cur_frame += dir;
-	if (cur_frame >= fnum)
-		cur_frame = 0;
-	else if (cur_frame < 0)
-		cur_frame = fnum - 1;
-
-	sprintf(buf, "Frame: %d\n", cur_frame);
-	pw_batch_on(pw);
-	pw_rop(pw, 0, 0, w, h, PIX_SRC | PIX_DONTCLIP, ppr[cur_frame], 0, 0);
-	pw_batch_off(pw);
-	panel_set(fnum_item, PANEL_LABEL_STRING, buf, 0);
-
-	if (do_titles) {
-		panel_set(tpanel_item, PANEL_LABEL_STRING, title[cur_frame], 0);
-	}
-}
-
-stop()
-{
-	stopped = 1;
-}
-
-start()
-{
-	stopped = 0;
-}
-
-Notify_value
-exterminate(frame, status)
-	Frame		frame;
-	Destroy_status	status;
-{
-	if (status != DESTROY_CHECKING) {
-		keep_going = 0;
-		stopped = 1;
-		(void)notify_stop();
-	}
-
-	return (notify_next_destroy_func(frame, status));
-}
-
-quit()
-{
-/*
-        DESTROY_PROCESS_DEATH=0,
-        DESTROY_CHECKING=1,
-        DESTROY_CLEANUP=2,
-*/
-
-	notify_post_destroy(frame, DESTROY_CHECKING, NOTIFY_SAFE);
-	notify_post_destroy(frame, DESTROY_CLEANUP, NOTIFY_SAFE);
-	exit(0);
-}
-
-reverse()
-{	
-	dir = -1;
-	if (stopped)
-		show_frame();
-}
-
-forward()
-{	
-	dir = 1;
-	if (stopped)
-		show_frame();
-}
-
-init(w, h)
-	int	w, h;
-{
-	int	i;
-	char	buf[30];
-
-	strcpy(buf, myname);
-	strcat(buf, ".vo");
-
-	frame = window_create(NULL, FRAME,
-		FRAME_LABEL, buf,
-		WIN_FIT_HEIGHT, 3,
-	0);
-
-	(void)notify_interpose_destroy_func(frame, exterminate);
-
-	fpw = (Pixwin *)window_get(frame, WIN_PIXWIN);
-
-	panel = window_create(frame, PANEL, 
-			WIN_FONT, medium,
-			WIN_HEIGHT, 30,
-/*
-			WIN_X, 1, 
-			WIN_Y, 3,
-*/
-	0);
-
-	ppw = (Pixwin *)window_get(panel, WIN_PIXWIN);
-
-
-	panel_create_item(
-		panel, PANEL_BUTTON,
-		PANEL_LABEL_IMAGE,
-		panel_button_image(panel, "<<", 0, 0),
-		PANEL_NOTIFY_PROC, reverse,
-	0);
-
-	panel_create_item(
-		panel, PANEL_BUTTON,
-		PANEL_LABEL_IMAGE,
-		panel_button_image(panel, "Play", 0, 0),
-		PANEL_NOTIFY_PROC, start,
-	0);
-
-	panel_create_item(
-		panel, PANEL_BUTTON,
-		PANEL_LABEL_IMAGE,
-		panel_button_image(panel, ">>", 0, 0),
-		PANEL_NOTIFY_PROC, forward,
-	0);
-
-	panel_create_item(
-		panel, PANEL_BUTTON,
-		PANEL_LABEL_IMAGE,
-		panel_button_image(panel, "Stop", 0, 0),
-		PANEL_NOTIFY_PROC, stop,
-	0);
-
-	fnum_item = panel_create_item(
-			panel, PANEL_MESSAGE,
-			PANEL_LABEL_STRING, "Frame: 0  ",
-		    0);
-
-	panel_create_item(
-		panel, PANEL_BUTTON,
-		PANEL_LABEL_IMAGE,
-		panel_button_image(panel, " QUIT ", 0, 0),
-		PANEL_NOTIFY_PROC, quit,
-	0);
-
-
-	canvas = window_create(frame, CANVAS,
-			/*CANVAS_RETAINED, TRUE,*/
-			WIN_HEIGHT, h,
-			WIN_WIDTH, w,
-			WIN_X, 1, 
-			WIN_Y, 39,
-		0);
-
-	pw = (Pixwin *)canvas_pixwin(canvas);
-
-	if (do_titles) {
-		tpanel = window_create(frame, PANEL, 
-				WIN_FONT, medium,
-				WIN_HEIGHT, 30,
-				WIN_X, 1, 
-				WIN_Y, 45 + h,
-		0);
-
-		tpw = (Pixwin *)window_get(tpanel, WIN_PIXWIN);
-
-		tlen--;
-		for (i = 0; i < tlen; i++)
-			buf[i] = ' ';
-
-		buf[tlen] = '\0';
-
-		tpanel_item = panel_create_item(
-				tpanel, PANEL_MESSAGE,
-				PANEL_LABEL_STRING, buf,
-			    0);
-	}
-
-	window_fit(panel);
-	window_fit(canvas);
-
-	if (do_titles)
-		window_fit(tpanel);
-
-	window_fit(frame);
-
-	if (color) {
-		setcolors(cmapsize(im), redmap(im), greenmap(im), bluemap(im));
-	} else {
-
-		for (i = 0; i < CMAPSIZE; i++)
-			red[i] = green[i] = blue[i] = i;
-
-		setcolors(CMAPSIZE, red, green, blue);
-	}
-}
-
-setcolors(n, red, green, blue)
-	int	n;
-	u_char	*red, *green, *blue;
-{
-	char	buf[40];
-	sprintf(buf, "movie%d", getpid());
-
-	pw_setcmsname(fpw, buf);
-        pw_putcolormap(fpw, 0, n, red, green, blue);
-
-	if (do_titles) {
-		pw_setcmsname(tpw, buf);
-		pw_putcolormap(tpw, 0, n, red, green, blue);
-	}
-
-	pw_setcmsname(ppw, buf);
-        pw_putcolormap(ppw, 0, n, red, green, blue);
-
-	pw_setcmsname(pw, buf);
-        pw_putcolormap(pw, 0, n, red, green, blue);
-}
diff -Nrua vort-old/sun/movie.doc vort-new/sun/movie.doc
--- vort-old/sun/movie.doc	1991-02-08 01:29:06.000000000 -0500
+++ vort-new/sun/movie.doc	1969-12-31 19:00:00.000000000 -0500
@@ -1,66 +0,0 @@
-
-
-
-MOVIE(1)                 USER COMMANDS                   MOVIE(1)
-
-
-
-NAME
-     movie - a program for displaying several  image  files  in
-     sequence.
-
-SYNOPSIS
-     movie [-t] [-u] file1 file2 file3 ...
-
-DESCRIPTION
-     Movie displays each pix image file on a suitable Sun  works-
-     tation  in  the  sequence  given on the command line. If the
-     images are full colour they are displayed in  greyscale.  If
-     all the files have a colourmap (see mulmcut (1)), the images
-     are displayed using the colourmap.  If -t is  specified  the
-     title  of  each file is printed in the panel as well.  -u is
-     specified each frame is displayed upside down.
-
-SEE ALSO
-     art(1),   vortinfo(1),   disp(1),   median(1),   mulmcut(1),
-     targ2vort(1), vort2ps(1), gamma(1), greyscale(1), vort(3).
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-VORT 2.0            Last change: Feb 8, 1991                    1
-
-
-
diff -Nrua vort-old/sun/pdisp.1 vort-new/sun/pdisp.1
--- vort-old/sun/pdisp.1	1991-02-08 01:29:07.000000000 -0500
+++ vort-new/sun/pdisp.1	1969-12-31 19:00:00.000000000 -0500
@@ -1,29 +0,0 @@
-.TH PDISP 1 "Feb 8, 1991" "VORT 2.0"
-.SH NAME
-pdisp \- programme for displaying a pix
-image file on a raw sun framebuffer.
-.SH SYNOPSIS
-.PU
-.ll +8
-.B pdisp [-u]
-.I "file"
-.SH DESCRIPTION
-.I Pdisp
-displays a pix image file on a suitable Sun workstation in 24 bit colour if the
-workstation supports this or 8 bit grayscale on an 8 bit device. If
-the file has a colourmap (see median (1)), the image is displayed using that
-image file's colourmap. If 
-.B -u
-is specified the image is displayed upside down.
-.LP
-.SH "SEE ALSO"
-.IR art (1),
-.IR vortinfo (1),
-.IR median (1),
-.IR movie (1),
-.IR mulmcut (1),
-.IR targ2vort (1),
-.IR vort2ps (1),
-.IR gamma (1),
-.IR greyscale (1),
-.IR vort (3).
diff -Nrua vort-old/sun/pdisp.c vort-new/sun/pdisp.c
--- vort-old/sun/pdisp.c	1992-08-03 01:18:29.000000000 -0400
+++ vort-new/sun/pdisp.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,168 +0,0 @@
-#include <stdio.h>
-#include <pixrect/pixrect_hs.h>
-#include "vort.h"
-
-#define	CMAPSIZE	256
-
-extern	char	*rindex();
-
-
-/*
- * program to read in a image and display it on the sun
- */
-main(ac, av)
-	int	ac;
-	char	**av;
-{
-	char		*myname, buf[BUFSIZ], groups[PIXPG_24BIT_COLOR + 1];
-	int		i, j, x, y;
-	unsigned short	h, w, wreal, w2;
-	int		d, line_bytes, upsidedown;
-	u_char		*line, *red, *green, *blue;
-	u_char		*p, *pp;
-	Pixrect		*pr, *screen;
-	image		*im;
-
-        if ((myname = rindex(av[0],'/')) == NULL)
-                myname = av[0];
-        else
-                *myname++;
-
-	if (ac < 2 || ac > 4) {
-		fprintf(stderr, "%s: usage %s [-u] file.\n", myname, myname);
-		exit(1);
-	}
-
-	upsidedown = 0;
-
-	strcpy(buf, "/dev/fb");
-
-	for (i = 1; i < ac && *av[i] == '-'; i++) {
-		if (strncmp(av[i], "-d", 2) == 0) {	/* frame buffer */
-			strcpy(buf, av[++i]);
-		} else if (strncmp(av[i], "-u", 2) == 0) {	/* show image upside down */
-			upsidedown = 1;
-		}
-	} 
-
-	if ((im = openimage(av[i], "r")) == (image *)NULL) {
-		fprintf(stderr, "%s: can't open file %s.\n", myname, av[i]);
-		exit(1);
-	}
-
-        if ((myname = rindex(av[i],'/')) == NULL)
-                myname = av[i];
-        else
-                *myname++;
-
-	w = imagewidth(im);
-	h = imageheight(im);
-
-        w2 = w;
-	if ((i = w % 4) != 0)
-		w2 = (w / 4 + i) * 4;
-
-
-	if ((screen = pr_open(buf)) == (Pixrect *)NULL) {
-		fprintf(stderr, "Couldn't open %s\n", buf);
-		exit(1);
-	}
-
-	pr_available_plane_groups(screen, PIXPG_24BIT_COLOR + 1, groups);
-
-	if (groups[PIXPG_24BIT_COLOR] != 0) {
-		fprintf(stderr, "Board supports 24 bit colour.\n");
-		d = 32;
-	} else {
-		fprintf(stderr, "Board supports 8 bit colour.\n");
-		d = 8;
-	}
-	
-	if ((pr = mem_create(w2, h, d)) == (Pixrect *)NULL) {
-		fprintf(stderr, "Couldn't allocate Pixrect\n");
-		exit(1);
-	}
-
-
-	line_bytes = mpr_linebytes(w2, d);
-	p = (unsigned char *)mpr_d(pr)->md_image; /* Start of Pixrect */
-
-	x = screen->pr_size.x / 2 - w / 2;
-	y = screen->pr_size.y / 2 - h / 2;
-
-	if (d == 32) {
-		red = (u_char *)malloc(w);
-		green = (u_char *)malloc(w);
-		blue = (u_char *)malloc(w);
-		while (readrgbline(im, red, green, blue)) {
-			pp = p;
-			for (i = 0; i < w; i++) {
-				*pp++ = 0;
-				*pp++ = blue[i];
-				*pp++ = green[i];
-				*pp++ = red[i];
-			}
-			if (upsidedown)
-				p -= line_bytes;
-			else
-				p += line_bytes;
-		}
-
-		pr_set_plane_group(screen, PIXPG_OVERLAY);
-		pr_rop(screen, 0, 0, screen->pr_size.x, screen->pr_size.y, PIX_SRC | PIX_COLOR(0), 0, 0, 0);
-	
-		pr_set_plane_group(screen, PIXPG_24BIT_COLOR);
-		pr_rop(screen, 0, 0, screen->pr_size.x, screen->pr_size.y, PIX_SRC | PIX_COLOR(0), 0, 0, 0);
-
-		pr_set_plane_group(screen, PIXPG_OVERLAY_ENABLE);
-		pr_rop(screen, 0, 0, screen->pr_size.x, screen->pr_size.y, PIX_SRC | PIX_COLOR(0), 0, 0, 0);
-		pr_set_plane_group(screen, PIXPG_24BIT_COLOR);
-
-	} else {
-		if (colormapped(im)) {
-			pr_putcolormap(screen, 0, cmapsize(im), redmap(im), greenmap(im), bluemap(im));
-			line = (u_char *)malloc(w);
-
-			while(readmappedline(im, line)) {
-				pp = p;
-				for (i = 0; i < w; i++)
-					*pp++ = line[i];
-
-				if (upsidedown)
-					p -= line_bytes;
-				else
-					p += line_bytes;
-			}
-		} else {
-			if (w < CMAPSIZE) {
-				red = (u_char *)malloc(CMAPSIZE);
-				green = (u_char *)malloc(CMAPSIZE);
-				blue = (u_char *)malloc(CMAPSIZE);
-			} else {
-				red = (u_char *)malloc(w);
-				green = (u_char *)malloc(w);
-				blue = (u_char *)malloc(w);
-			}
-
-			for (i = 0; i < CMAPSIZE; i++) 
-				red[i] = green[i] = blue[i] = i;
-
-			pr_putcolormap(screen, 0, cmapsize(im), redmap(im), greenmap(im), bluemap(im));
-			while(readrgbline(im, red, green, blue)) {
-				pp = p;
-				for (i = 0; i < w; i++)
-					 *pp++ = (u_char)(red[i] * 0.3 + green[i] * 0.59 + blue[i] * 0.11);
-				if (upsidedown)
-					p -= line_bytes;
-				else
-					p += line_bytes;
-			}
-		}
-	}
-
-	pr_rop(screen, x, y, w, h, PIX_SRC, pr, 0, 0);
-
-	getchar();
-
-	exit(0);
-}
diff -Nrua vort-old/sun/pdisp.doc vort-new/sun/pdisp.doc
--- vort-old/sun/pdisp.doc	1991-02-08 01:29:07.000000000 -0500
+++ vort-new/sun/pdisp.doc	1969-12-31 19:00:00.000000000 -0500
@@ -1,66 +0,0 @@
-
-
-
-PDISP(1)                 USER COMMANDS                   PDISP(1)
-
-
-
-NAME
-     pdisp - programme for displaying a pix image file on  a  raw
-     sun framebuffer.
-
-SYNOPSIS
-     pdisp [-u] file
-
-DESCRIPTION
-     Pdisp displays a pix image file on a suitable  Sun  worksta-
-     tion  in 24 bit colour if the workstation supports this or 8
-     bit grayscale on an 8 bit device. If the file has a  colour-
-     map  (see  median  (1)),  the  image is displayed using that
-     image file's colourmap. If -u  is  specified  the  image  is
-     displayed upside down.
-
-SEE ALSO
-     art(1),  vortinfo(1),   median(1),   movie(1),   mulmcut(1),
-     targ2vort(1), vort2ps(1), gamma(1), greyscale(1), vort(3).
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-VORT 2.0            Last change: Feb 8, 1991                    1
-
-
-
diff -Nrua vort-old/sun/rdisp.c vort-new/sun/rdisp.c
--- vort-old/sun/rdisp.c	1991-02-08 01:29:07.000000000 -0500
+++ vort-new/sun/rdisp.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,106 +0,0 @@
-#include <stdio.h>
-#include <math.h>
-#include <suntool/sunview.h>
-#include <suntool/canvas.h>
-#include "vort.h"
-
-#define	CMAPSIZE	256
-
-extern char	*rindex();
-
-
-/*
- * simple program to display a single channel of an pixel file. Channel
- * displayed depends on the name of the program at run time.
- */
-main(ac, av)
-	int	ac;
-	char	**av;
-{
-	Frame		frame;
-	Canvas		canvas;
-	char		name[BUFSIZ], title[BUFSIZ], *pt;
-	register int	x, y;
-	image		*im;
-	short		i, h, w;
-	u_char		r[CMAPSIZE], b[CMAPSIZE], g[CMAPSIZE], *red, *green, *blue, *alpha, *channel;
-	register Pixwin	*pw;
-
-	
-	if ((pt = rindex(av[0], '/')) != (char *)NULL)
-		strcpy(name, pt + 1);
-	else
-		strcpy(name, av[0]);
-
-	if (ac != 2) {
-		fprintf(stderr, "%s: usage %s filename.\n", av[0], av[0]);
-		exit(1);
-	}
-
-	if ((im = openimage(av[1], "r")) == (image *)NULL) {
-		fprintf(stderr, "%s: can't open file %s.\n", av[0], av[1]);
-		exit(1);
-	}
-
-	w = imagewidth(im);
-	h = imageheight(im);
-
-	red = (u_char *)malloc(w);
-	green = (u_char *)malloc(w);
-	blue = (u_char *)malloc(w);
-	alpha = (u_char *)malloc(w);
-
-	strcpy(title, name);
-	strcat(title, ": ");
-	strcat(title, imagetitle(im));
-
-	frame = window_create(0, FRAME, WIN_HEIGHT, h, WIN_WIDTH, w, FRAME_LABEL, name, 0);
-	canvas = window_create(frame, CANVAS, CANVAS_RETAINED, FALSE, WIN_HEIGHT, h, WIN_WIDTH, w, 0);
-	window_fit(frame);
-	pw =(Pixwin *)canvas_pixwin(canvas);
-
-	if (name[0] == 'r') {
-		channel = red;
-		for (i = 0; i < CMAPSIZE; i++) {
-			g[i] = b[i] = 0;
-			r[i] = i;
-		}
-	} else if (name[0] == 'g') {
-		channel = green;
-		for (i = 0; i < CMAPSIZE; i++) {
-			r[i] = b[i] = 0;
-			g[i] = i;
-		}
-	} else if (name[0] == 'b') {
-		channel = blue;
-		for (i = 0; i < CMAPSIZE; i++) {
-			r[i] = g[i] = 0;
-			b[i] = i;
-		}
-	} else if (name[0] == 'a') {
-		channel = alpha;
-		for (i = 0; i < CMAPSIZE; i++)
-			r[i] = g[i] = b[i] = i;
-	}
-
-	pw_setcmsname(pw, name);
-	pw_putcolormap(pw, 0, CMAPSIZE, r, g, b);
-
-	window_set(canvas, CANVAS_RETAINED, TRUE, 0);
-
-	pw_batch_on(pw);
-
-	y = 0;
-	x = 0;
-
-	while (readrgbaline(im, red, green, blue, alpha)) {
-		for (x = 0; x != w; x++)
-			pw_put(pw, x, y, channel[x]);
-		y++;
-	}
-
-	pw_batch_off(pw);
-	window_main_loop(frame);
-
-	exit(0);
-}
diff -Nrua vort-old/text3d/gram.c vort-new/text3d/gram.c
--- vort-old/text3d/gram.c	1992-08-05 01:18:52.000000000 -0400
+++ vort-new/text3d/gram.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,975 +0,0 @@
-extern char *malloc(), *realloc();
-
-# line 3 "gram.y"
-#include <stdio.h>
-#include <math.h>
-#include "text3d.h"
-
-extern	void	bdraw();
-extern	void	sdraw();
-
-extern	attribs	attr;
-
-extern	int	verbose;
-
-
-# line 16 "gram.y"
-typedef union {
-	float		y_flt;
-	int		y_int;
-	char		*y_str;
-} YYSTYPE;
-# define FLOAT 257
-# define INTEGER 258
-# define OPTION 259
-# define STRING 260
-# define DRAWSTR 261
-# define TEXTSIZE 262
-# define COLOUR 263
-# define AMBIENT 264
-# define REFLECTANCE 265
-# define TRANSPARENCY 266
-# define MATERIAL 267
-# define TEXTRADIUS 268
-# define FIXEDWIDTH 269
-# define CENTERTEXT 270
-# define TEXTANG 271
-# define FONT 272
-# define CHAR 273
-# define DRAWCHAR 274
-# define BOXFIT 275
-# define BOXTEXT 276
-# define MOVE 277
-# define RMOVE 278
-# define SCALE 279
-# define TRANSLATE 280
-# define ROTATE 281
-# define OUTPUT 282
-# define BOX_CYL 283
-# define CYL_SPH 284
-# define LP 285
-# define RP 286
-# define LBRACE 287
-# define RBRACE 288
-# define COMMA 289
-# define ON 290
-# define OFF 291
-# define TRUE 292
-# define FALSE 293
-# define PCENT 294
-# define PLUS 295
-# define MINUS 296
-# define MULT 297
-# define DIV 298
-# define POWER 299
-# define UMINUS 300
-# define EQUALS 301
-#define yyclearin yychar = -1
-#define yyerrok yyerrflag = 0
-extern int yychar;
-extern int yyerrflag;
-#ifndef YYMAXDEPTH
-#define YYMAXDEPTH 150
-#endif
-YYSTYPE yylval, yyval;
-# define YYERRCODE 256
-int yyexca[] ={
--1, 1,
-	0, -1,
-	-2, 0,
-	};
-# define YYNPROD 35
-# define YYLAST 427
-int yyact[]={
-
-   151,   150,    79,    80,   153,   147,    77,    78,    79,    80,
-    77,    78,    79,    80,    77,    78,    79,    80,   146,    61,
-    62,    94,   145,    59,    60,    92,   144,    77,    78,    79,
-    80,    77,    78,    79,    80,    77,    78,    79,    80,   143,
-   142,    91,    90,    89,    75,    77,    78,    79,    80,    77,
-    78,    79,    80,   141,   140,    74,    73,   152,   139,    77,
-    78,    79,    80,    77,    78,    79,    80,    77,    78,    79,
-    80,   129,    44,    46,    47,    64,    43,    42,   128,    41,
-    77,    78,    79,    80,    77,    78,    79,    80,   127,    40,
-    39,    38,   126,    37,    77,    78,    79,    80,    77,    78,
-    79,    80,   125,    36,    35,    34,   124,    33,    77,    78,
-    79,    80,    77,    78,    79,    80,   123,    32,    31,    30,
-   122,    29,    77,    78,    79,    80,    77,    78,    79,    80,
-   121,    28,    27,    26,   120,   119,    77,    78,    79,    80,
-    77,    78,    79,    80,    77,    78,    79,    80,   108,    25,
-    24,    45,     2,     1,     0,   102,     0,    77,    78,    79,
-    80,    77,    78,    79,    80,   101,     0,     0,     0,   100,
-     0,    77,    78,    79,    80,    77,    78,    79,    80,    99,
-     0,     0,     0,    98,     0,    77,    78,    79,    80,    77,
-    78,    79,    80,    97,     0,     0,     0,    96,    95,    77,
-    78,    79,    80,    77,    78,    79,    80,    77,    78,    79,
-    80,    93,     0,     0,     0,    88,     0,     0,     0,     0,
-    77,    78,    79,    80,    77,    78,    79,    80,    87,    86,
-     0,     0,     0,    85,    77,    78,    79,    80,    77,    78,
-    79,    80,    77,    78,    79,    80,    84,     0,     0,     0,
-    83,     0,    77,    78,    79,    80,    77,    78,    79,    80,
-    76,     0,     0,     0,    49,    50,    77,    78,    79,    80,
-     3,     5,     6,     7,     8,     9,    10,    11,    13,    12,
-    14,    15,    48,    16,    17,    18,    19,    20,    21,    22,
-    23,     4,    52,     0,     0,     0,     0,     0,     0,     0,
-     0,     0,     0,    51,     0,     0,     0,     0,     0,     0,
-    53,    54,    55,    56,    57,    58,     0,     0,    63,     0,
-    65,    66,    67,    68,    69,    70,    71,    72,     0,     0,
-     0,     0,     0,     0,    81,    82,     0,     0,     0,     0,
-     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
-     0,     0,     0,     0,     0,     0,     0,     0,     0,   103,
-   104,   105,   106,   107,     0,     0,   109,   110,     0,     0,
-   111,     0,     0,     0,     0,     0,     0,     0,     0,   112,
-   113,   114,   115,   116,   117,   118,     0,     0,     0,     0,
-     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
-     0,     0,     0,   130,   131,   132,   133,   134,   135,   136,
-   137,   138,     0,     0,     0,     0,     0,     0,     0,     0,
-     0,     0,     0,     0,   148,     0,   149 };
-int yypact[]={
-
- -1000,     9, -1000,  -135,  -136,  -152,  -153,  -154,  -164,  -166,
-  -167,  -168,  -178,  -180,  -181,  -182,  -192,  -194,  -195,  -196,
-  -206,  -208,  -209,  -213,  -109,  -210,     7,     7,     7,     7,
-     7,     7,     7,  -269,  -273,     7,  -185,     7,     7,     7,
-     7,     7,     7,     7,     7,  -230,  -231,  -242,   -29, -1000,
- -1000,     7,     7,   -39,   -43,   -53,   -57,   -61,   -71,  -243,
-  -244,  -245,  -261,   -75,  -265,   -88,   -92,   -96,  -106,  -110,
-  -120,  -124,  -134, -1000, -1000, -1000,     7,     7,     7,     7,
-     7, -1000,  -138,     7,     7, -1000, -1000,     7, -1000, -1000,
- -1000, -1000, -1000, -1000, -1000, -1000,     7,     7,     7,     7,
-     7,     7,     7,  -151,  -295,  -295, -1000, -1000, -1000,  -155,
-  -159,  -169,  -173,  -183,  -187,  -197,  -201,  -211,  -215, -1000,
-     7,     7,     7,     7,     7,     7,     7,     7,     7, -1000,
-  -228,  -232,  -236,  -246,  -250,  -260,  -264,  -268,  -281, -1000,
- -1000,     7, -1000,     7, -1000, -1000, -1000, -1000,  -285,  -289,
- -1000,  -203,  -282, -1000 };
-int yypgo[]={
-
-     0,   282,   153,   152 };
-int yyr1[]={
-
-     0,     2,     2,     3,     3,     3,     3,     3,     3,     3,
-     3,     3,     3,     3,     3,     3,     3,     3,     3,     3,
-     3,     3,     3,     3,     3,     3,     3,     1,     1,     1,
-     1,     1,     1,     1,     1 };
-int yyr2[]={
-
-     0,     0,     4,     9,     9,     9,    13,    17,    17,     9,
-     9,    21,     9,     9,     9,     9,     9,     9,     9,     9,
-    17,    25,    17,    17,    17,    17,    13,     3,     3,     7,
-     7,     7,     7,     5,     7 };
-int yychk[]={
-
- -1000,    -2,    -3,   261,   282,   262,   263,   264,   265,   266,
-   267,   268,   270,   269,   271,   272,   274,   275,   276,   277,
-   278,   279,   280,   281,   285,   285,   285,   285,   285,   285,
-   285,   285,   285,   285,   285,   285,   285,   285,   285,   285,
-   285,   285,   285,   285,   285,   260,   283,   284,    -1,   257,
-   258,   296,   285,    -1,    -1,    -1,    -1,    -1,    -1,   292,
-   293,   292,   293,    -1,   260,    -1,    -1,    -1,    -1,    -1,
-    -1,    -1,    -1,   286,   286,   286,   289,   295,   296,   297,
-   298,    -1,    -1,   289,   289,   286,   286,   289,   286,   286,
-   286,   286,   286,   286,   286,   286,   289,   289,   289,   289,
-   289,   289,   289,    -1,    -1,    -1,    -1,    -1,   286,    -1,
-    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,   286,
-   289,   289,   289,   289,   289,   289,   289,   289,   289,   286,
-    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,   286,
-   286,   289,   286,   289,   286,   286,   286,   286,    -1,    -1,
-   286,   289,   260,   286 };
-int yydef[]={
-
-     1,    -2,     2,     0,     0,     0,     0,     0,     0,     0,
-     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
-     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
-     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
-     0,     0,     0,     0,     0,     0,     0,     0,     0,    27,
-    28,     0,     0,     0,     0,     0,     0,     0,     0,     0,
-     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
-     0,     0,     0,     3,     4,     5,     0,     0,     0,     0,
-     0,    33,     0,     0,     0,     9,    10,     0,    12,    13,
-    14,    15,    16,    17,    18,    19,     0,     0,     0,     0,
-     0,     0,     0,     0,    29,    30,    31,    32,    34,     0,
-     0,     0,     0,     0,     0,     0,     0,     0,     0,     6,
-     0,     0,     0,     0,     0,     0,     0,     0,     0,    26,
-     0,     0,     0,     0,     0,     0,     0,     0,     0,     7,
-     8,     0,    20,     0,    22,    23,    24,    25,     0,     0,
-    11,     0,     0,    21 };
-typedef struct { char *t_name; int t_val; } yytoktype;
-#ifndef YYDEBUG
-#	define YYDEBUG	0	/* don't allow debugging */
-#endif
-
-#if YYDEBUG
-
-yytoktype yytoks[] =
-{
-	"FLOAT",	257,
-	"INTEGER",	258,
-	"OPTION",	259,
-	"STRING",	260,
-	"DRAWSTR",	261,
-	"TEXTSIZE",	262,
-	"COLOUR",	263,
-	"AMBIENT",	264,
-	"REFLECTANCE",	265,
-	"TRANSPARENCY",	266,
-	"MATERIAL",	267,
-	"TEXTRADIUS",	268,
-	"FIXEDWIDTH",	269,
-	"CENTERTEXT",	270,
-	"TEXTANG",	271,
-	"FONT",	272,
-	"CHAR",	273,
-	"DRAWCHAR",	274,
-	"BOXFIT",	275,
-	"BOXTEXT",	276,
-	"MOVE",	277,
-	"RMOVE",	278,
-	"SCALE",	279,
-	"TRANSLATE",	280,
-	"ROTATE",	281,
-	"OUTPUT",	282,
-	"BOX_CYL",	283,
-	"CYL_SPH",	284,
-	"LP",	285,
-	"RP",	286,
-	"LBRACE",	287,
-	"RBRACE",	288,
-	"COMMA",	289,
-	"ON",	290,
-	"OFF",	291,
-	"TRUE",	292,
-	"FALSE",	293,
-	"PCENT",	294,
-	"PLUS",	295,
-	"MINUS",	296,
-	"MULT",	297,
-	"DIV",	298,
-	"POWER",	299,
-	"UMINUS",	300,
-	"EQUALS",	301,
-	"-unknown-",	-1	/* ends search */
-};
-
-char * yyreds[] =
-{
-	"-no such reduction-",
-	"input : /* empty */",
-	"input : input item",
-	"item : DRAWSTR LP STRING RP",
-	"item : OUTPUT LP BOX_CYL RP",
-	"item : OUTPUT LP CYL_SPH RP",
-	"item : TEXTSIZE LP expr COMMA expr RP",
-	"item : COLOUR LP expr COMMA expr COMMA expr RP",
-	"item : AMBIENT LP expr COMMA expr COMMA expr RP",
-	"item : REFLECTANCE LP expr RP",
-	"item : TRANSPARENCY LP expr RP",
-	"item : MATERIAL LP expr COMMA expr COMMA expr COMMA expr RP",
-	"item : TEXTRADIUS LP expr RP",
-	"item : CENTERTEXT LP TRUE RP",
-	"item : CENTERTEXT LP FALSE RP",
-	"item : FIXEDWIDTH LP TRUE RP",
-	"item : FIXEDWIDTH LP FALSE RP",
-	"item : TEXTANG LP expr RP",
-	"item : FONT LP STRING RP",
-	"item : DRAWCHAR LP expr RP",
-	"item : BOXFIT LP expr COMMA expr COMMA expr RP",
-	"item : BOXTEXT LP expr COMMA expr COMMA expr COMMA expr COMMA STRING RP",
-	"item : MOVE LP expr COMMA expr COMMA expr RP",
-	"item : RMOVE LP expr COMMA expr COMMA expr RP",
-	"item : SCALE LP expr COMMA expr COMMA expr RP",
-	"item : TRANSLATE LP expr COMMA expr COMMA expr RP",
-	"item : ROTATE LP expr COMMA expr RP",
-	"expr : FLOAT",
-	"expr : INTEGER",
-	"expr : expr PLUS expr",
-	"expr : expr MINUS expr",
-	"expr : expr MULT expr",
-	"expr : expr DIV expr",
-	"expr : MINUS expr",
-	"expr : LP expr RP",
-};
-#endif /* YYDEBUG */
-#line 1 "/usr/lib/yaccpar"
-/*	@(#)yaccpar 1.10 89/04/04 SMI; from S5R3 1.10	*/
-
-/*
-** Skeleton parser driver for yacc output
-*/
-
-/*
-** yacc user known macros and defines
-*/
-#define YYERROR		goto yyerrlab
-#define YYACCEPT	{ free(yys); free(yyv); return(0); }
-#define YYABORT		{ free(yys); free(yyv); return(1); }
-#define YYBACKUP( newtoken, newvalue )\
-{\
-	if ( yychar >= 0 || ( yyr2[ yytmp ] >> 1 ) != 1 )\
-	{\
-		yyerror( "syntax error - cannot backup" );\
-		goto yyerrlab;\
-	}\
-	yychar = newtoken;\
-	yystate = *yyps;\
-	yylval = newvalue;\
-	goto yynewstate;\
-}
-#define YYRECOVERING()	(!!yyerrflag)
-#ifndef YYDEBUG
-#	define YYDEBUG	1	/* make debugging available */
-#endif
-
-/*
-** user known globals
-*/
-int yydebug;			/* set to 1 to get debugging */
-
-/*
-** driver internal defines
-*/
-#define YYFLAG		(-1000)
-
-/*
-** static variables used by the parser
-*/
-static YYSTYPE *yyv;			/* value stack */
-static int *yys;			/* state stack */
-
-static YYSTYPE *yypv;			/* top of value stack */
-static int *yyps;			/* top of state stack */
-
-static int yystate;			/* current state */
-static int yytmp;			/* extra var (lasts between blocks) */
-
-int yynerrs;			/* number of errors */
-
-int yyerrflag;			/* error recovery flag */
-int yychar;			/* current input token number */
-
-
-/*
-** yyparse - return 0 if worked, 1 if syntax error not recovered from
-*/
-int
-yyparse()
-{
-	register YYSTYPE *yypvt;	/* top of value stack for $vars */
-	unsigned yymaxdepth = YYMAXDEPTH;
-
-	/*
-	** Initialize externals - yyparse may be called more than once
-	*/
-	yyv = (YYSTYPE*)malloc(yymaxdepth*sizeof(YYSTYPE));
-	yys = (int*)malloc(yymaxdepth*sizeof(int));
-	if (!yyv || !yys)
-	{
-		yyerror( "out of memory" );
-		return(1);
-	}
-	yypv = &yyv[-1];
-	yyps = &yys[-1];
-	yystate = 0;
-	yytmp = 0;
-	yynerrs = 0;
-	yyerrflag = 0;
-	yychar = -1;
-
-	goto yystack;
-	{
-		register YYSTYPE *yy_pv;	/* top of value stack */
-		register int *yy_ps;		/* top of state stack */
-		register int yy_state;		/* current state */
-		register int  yy_n;		/* internal state number info */
-
-		/*
-		** get globals into registers.
-		** branch to here only if YYBACKUP was called.
-		*/
-	yynewstate:
-		yy_pv = yypv;
-		yy_ps = yyps;
-		yy_state = yystate;
-		goto yy_newstate;
-
-		/*
-		** get globals into registers.
-		** either we just started, or we just finished a reduction
-		*/
-	yystack:
-		yy_pv = yypv;
-		yy_ps = yyps;
-		yy_state = yystate;
-
-		/*
-		** top of for (;;) loop while no reductions done
-		*/
-	yy_stack:
-		/*
-		** put a state and value onto the stacks
-		*/
-#if YYDEBUG
-		/*
-		** if debugging, look up token value in list of value vs.
-		** name pairs.  0 and negative (-1) are special values.
-		** Note: linear search is used since time is not a real
-		** consideration while debugging.
-		*/
-		if ( yydebug )
-		{
-			register int yy_i;
-
-			(void)printf( "State %d, token ", yy_state );
-			if ( yychar == 0 )
-				(void)printf( "end-of-file\n" );
-			else if ( yychar < 0 )
-				(void)printf( "-none-\n" );
-			else
-			{
-				for ( yy_i = 0; yytoks[yy_i].t_val >= 0;
-					yy_i++ )
-				{
-					if ( yytoks[yy_i].t_val == yychar )
-						break;
-				}
-				(void)printf( "%s\n", yytoks[yy_i].t_name );
-			}
-		}
-#endif /* YYDEBUG */
-		if ( ++yy_ps >= &yys[ yymaxdepth ] )	/* room on stack? */
-		{
-			/*
-			** reallocate and recover.  Note that pointers
-			** have to be reset, or bad things will happen
-			*/
-			int yyps_index = (yy_ps - yys);
-			int yypv_index = (yy_pv - yyv);
-			int yypvt_index = (yypvt - yyv);
-			yymaxdepth += YYMAXDEPTH;
-			yyv = (YYSTYPE*)realloc((char*)yyv,
-				yymaxdepth * sizeof(YYSTYPE));
-			yys = (int*)realloc((char*)yys,
-				yymaxdepth * sizeof(int));
-			if (!yyv || !yys)
-			{
-				yyerror( "yacc stack overflow" );
-				return(1);
-			}
-			yy_ps = yys + yyps_index;
-			yy_pv = yyv + yypv_index;
-			yypvt = yyv + yypvt_index;
-		}
-		*yy_ps = yy_state;
-		*++yy_pv = yyval;
-
-		/*
-		** we have a new state - find out what to do
-		*/
-	yy_newstate:
-		if ( ( yy_n = yypact[ yy_state ] ) <= YYFLAG )
-			goto yydefault;		/* simple state */
-#if YYDEBUG
-		/*
-		** if debugging, need to mark whether new token grabbed
-		*/
-		yytmp = yychar < 0;
-#endif
-		if ( ( yychar < 0 ) && ( ( yychar = yylex() ) < 0 ) )
-			yychar = 0;		/* reached EOF */
-#if YYDEBUG
-		if ( yydebug && yytmp )
-		{
-			register int yy_i;
-
-			(void)printf( "Received token " );
-			if ( yychar == 0 )
-				(void)printf( "end-of-file\n" );
-			else if ( yychar < 0 )
-				(void)printf( "-none-\n" );
-			else
-			{
-				for ( yy_i = 0; yytoks[yy_i].t_val >= 0;
-					yy_i++ )
-				{
-					if ( yytoks[yy_i].t_val == yychar )
-						break;
-				}
-				(void)printf( "%s\n", yytoks[yy_i].t_name );
-			}
-		}
-#endif /* YYDEBUG */
-		if ( ( ( yy_n += yychar ) < 0 ) || ( yy_n >= YYLAST ) )
-			goto yydefault;
-		if ( yychk[ yy_n = yyact[ yy_n ] ] == yychar )	/*valid shift*/
-		{
-			yychar = -1;
-			yyval = yylval;
-			yy_state = yy_n;
-			if ( yyerrflag > 0 )
-				yyerrflag--;
-			goto yy_stack;
-		}
-
-	yydefault:
-		if ( ( yy_n = yydef[ yy_state ] ) == -2 )
-		{
-#if YYDEBUG
-			yytmp = yychar < 0;
-#endif
-			if ( ( yychar < 0 ) && ( ( yychar = yylex() ) < 0 ) )
-				yychar = 0;		/* reached EOF */
-#if YYDEBUG
-			if ( yydebug && yytmp )
-			{
-				register int yy_i;
-
-				(void)printf( "Received token " );
-				if ( yychar == 0 )
-					(void)printf( "end-of-file\n" );
-				else if ( yychar < 0 )
-					(void)printf( "-none-\n" );
-				else
-				{
-					for ( yy_i = 0;
-						yytoks[yy_i].t_val >= 0;
-						yy_i++ )
-					{
-						if ( yytoks[yy_i].t_val
-							== yychar )
-						{
-							break;
-						}
-					}
-					(void)printf( "%s\n", yytoks[yy_i].t_name );
-				}
-			}
-#endif /* YYDEBUG */
-			/*
-			** look through exception table
-			*/
-			{
-				register int *yyxi = yyexca;
-
-				while ( ( *yyxi != -1 ) ||
-					( yyxi[1] != yy_state ) )
-				{
-					yyxi += 2;
-				}
-				while ( ( *(yyxi += 2) >= 0 ) &&
-					( *yyxi != yychar ) )
-					;
-				if ( ( yy_n = yyxi[1] ) < 0 )
-					YYACCEPT;
-			}
-		}
-
-		/*
-		** check for syntax error
-		*/
-		if ( yy_n == 0 )	/* have an error */
-		{
-			/* no worry about speed here! */
-			switch ( yyerrflag )
-			{
-			case 0:		/* new error */
-				yyerror( "syntax error" );
-				goto skip_init;
-			yyerrlab:
-				/*
-				** get globals into registers.
-				** we have a user generated syntax type error
-				*/
-				yy_pv = yypv;
-				yy_ps = yyps;
-				yy_state = yystate;
-				yynerrs++;
-			skip_init:
-			case 1:
-			case 2:		/* incompletely recovered error */
-					/* try again... */
-				yyerrflag = 3;
-				/*
-				** find state where "error" is a legal
-				** shift action
-				*/
-				while ( yy_ps >= yys )
-				{
-					yy_n = yypact[ *yy_ps ] + YYERRCODE;
-					if ( yy_n >= 0 && yy_n < YYLAST &&
-						yychk[yyact[yy_n]] == YYERRCODE)					{
-						/*
-						** simulate shift of "error"
-						*/
-						yy_state = yyact[ yy_n ];
-						goto yy_stack;
-					}
-					/*
-					** current state has no shift on
-					** "error", pop stack
-					*/
-#if YYDEBUG
-#	define _POP_ "Error recovery pops state %d, uncovers state %d\n"
-					if ( yydebug )
-						(void)printf( _POP_, *yy_ps,
-							yy_ps[-1] );
-#	undef _POP_
-#endif
-					yy_ps--;
-					yy_pv--;
-				}
-				/*
-				** there is no state on stack with "error" as
-				** a valid shift.  give up.
-				*/
-				YYABORT;
-			case 3:		/* no shift yet; eat a token */
-#if YYDEBUG
-				/*
-				** if debugging, look up token in list of
-				** pairs.  0 and negative shouldn't occur,
-				** but since timing doesn't matter when
-				** debugging, it doesn't hurt to leave the
-				** tests here.
-				*/
-				if ( yydebug )
-				{
-					register int yy_i;
-
-					(void)printf( "Error recovery discards " );
-					if ( yychar == 0 )
-						(void)printf( "token end-of-file\n" );
-					else if ( yychar < 0 )
-						(void)printf( "token -none-\n" );
-					else
-					{
-						for ( yy_i = 0;
-							yytoks[yy_i].t_val >= 0;
-							yy_i++ )
-						{
-							if ( yytoks[yy_i].t_val
-								== yychar )
-							{
-								break;
-							}
-						}
-						(void)printf( "token %s\n",
-							yytoks[yy_i].t_name );
-					}
-				}
-#endif /* YYDEBUG */
-				if ( yychar == 0 )	/* reached EOF. quit */
-					YYABORT;
-				yychar = -1;
-				goto yy_newstate;
-			}
-		}/* end if ( yy_n == 0 ) */
-		/*
-		** reduction by production yy_n
-		** put stack tops, etc. so things right after switch
-		*/
-#if YYDEBUG
-		/*
-		** if debugging, print the string that is the user's
-		** specification of the reduction which is just about
-		** to be done.
-		*/
-		if ( yydebug )
-			(void)printf( "Reduce by (%d) \"%s\"\n",
-				yy_n, yyreds[ yy_n ] );
-#endif
-		yytmp = yy_n;			/* value to switch over */
-		yypvt = yy_pv;			/* $vars top of value stack */
-		/*
-		** Look in goto table for next state
-		** Sorry about using yy_state here as temporary
-		** register variable, but why not, if it works...
-		** If yyr2[ yy_n ] doesn't have the low order bit
-		** set, then there is no action to be done for
-		** this reduction.  So, no saving & unsaving of
-		** registers done.  The only difference between the
-		** code just after the if and the body of the if is
-		** the goto yy_stack in the body.  This way the test
-		** can be made before the choice of what to do is needed.
-		*/
-		{
-			/* length of production doubled with extra bit */
-			register int yy_len = yyr2[ yy_n ];
-
-			if ( !( yy_len & 01 ) )
-			{
-				yy_len >>= 1;
-				yyval = ( yy_pv -= yy_len )[1];	/* $$ = $1 */
-				yy_state = yypgo[ yy_n = yyr1[ yy_n ] ] +
-					*( yy_ps -= yy_len ) + 1;
-				if ( yy_state >= YYLAST ||
-					yychk[ yy_state =
-					yyact[ yy_state ] ] != -yy_n )
-				{
-					yy_state = yyact[ yypgo[ yy_n ] ];
-				}
-				goto yy_stack;
-			}
-			yy_len >>= 1;
-			yyval = ( yy_pv -= yy_len )[1];	/* $$ = $1 */
-			yy_state = yypgo[ yy_n = yyr1[ yy_n ] ] +
-				*( yy_ps -= yy_len ) + 1;
-			if ( yy_state >= YYLAST ||
-				yychk[ yy_state = yyact[ yy_state ] ] != -yy_n )
-			{
-				yy_state = yyact[ yypgo[ yy_n ] ];
-			}
-		}
-					/* save until reenter driver code */
-		yystate = yy_state;
-		yyps = yy_ps;
-		yypv = yy_pv;
-	}
-	/*
-	** code supplied by user is placed in this switch
-	*/
-	switch( yytmp )
-	{
-		
-case 3:
-# line 48 "gram.y"
-{
-		drawstr(yypvt[-1].y_str);
-		if (verbose)
-			fprintf(stderr, "drawstr(\"%s\")\n", yypvt[-1].y_str);
-	  } break;
-case 4:
-# line 54 "gram.y"
-{
-		attr.drawfun = bdraw;
-		if (verbose)
-			fprintf(stderr, "output(box_cyl)\n");
-	  } break;
-case 5:
-# line 60 "gram.y"
-{
-		attr.drawfun = sdraw;
-		if (verbose)
-			fprintf(stderr, "output(cyl_sph)\n");
-	  } break;
-case 6:
-# line 66 "gram.y"
-{
-		textsize(yypvt[-3].y_flt, yypvt[-1].y_flt);
-		if (verbose)
-			fprintf(stderr, "textsize(%g, %g)\n", yypvt[-3].y_flt, yypvt[-1].y_flt);
-	  } break;
-case 7:
-# line 72 "gram.y"
-{
-		attr.col_set = 1;
-		attr.col.r = yypvt[-5].y_flt;
-		attr.col.g = yypvt[-3].y_flt;
-		attr.col.b = yypvt[-1].y_flt;
-		if (verbose)
-			fprintf(stderr, "colour(%g, %g, %g)\n", yypvt[-5].y_flt, yypvt[-3].y_flt, yypvt[-1].y_flt);
-	  } break;
-case 8:
-# line 81 "gram.y"
-{
-		attr.amb_set = 1;
-		attr.amb.r = yypvt[-5].y_flt;
-		attr.amb.g = yypvt[-3].y_flt;
-		attr.amb.b = yypvt[-1].y_flt;
-		if (verbose)
-			fprintf(stderr, "ambient(%g, %g, %g)\n", yypvt[-5].y_flt, yypvt[-3].y_flt, yypvt[-1].y_flt);
-	  } break;
-case 9:
-# line 90 "gram.y"
-{
-		attr.ref_set = 1;
-		attr.refl = yypvt[-1].y_flt;
-		if (verbose)
-			fprintf(stderr, "reflectance(%g)\n", yypvt[-1].y_flt);
-	  } break;
-case 10:
-# line 97 "gram.y"
-{
-		attr.trans_set = 1;
-		attr.trans = yypvt[-1].y_flt;
-		if (verbose)
-			fprintf(stderr, "transparency(%g)\n", yypvt[-1].y_flt);
-	  } break;
-case 11:
-# line 104 "gram.y"
-{
-		attr.mat_set = 1;
-		attr.mat.ri = yypvt[-7].y_flt;
-		attr.mat.kd = yypvt[-5].y_flt;
-		attr.mat.ks = yypvt[-3].y_flt;
-		attr.mat.ksexp = yypvt[-1].y_flt;
-		if (verbose)
-			fprintf(stderr, "material(%g, %g, %g, %g)\n", yypvt[-7].y_flt, yypvt[-5].y_flt, yypvt[-3].y_flt, yypvt[-1].y_flt);
-	  } break;
-case 12:
-# line 114 "gram.y"
-{
-		attr.radius = yypvt[-1].y_flt;
-		if (verbose)
-			fprintf(stderr, "textradius(%g)\n", yypvt[-1].y_flt);
-	  } break;
-case 13:
-# line 120 "gram.y"
-{
-		attr.centered = 1;
-		if (verbose)
-			fprintf(stderr, "centretext(true)\n");
-	  } break;
-case 14:
-# line 126 "gram.y"
-{
-		attr.centered = 0;
-		if (verbose)
-			fprintf(stderr, "centretext(false)\n");
-	  } break;
-case 15:
-# line 132 "gram.y"
-{
-		attr.fixedwidth = 1;
-		if (verbose)
-			fprintf(stderr, "fixedwidth(true)\n");
-	  } break;
-case 16:
-# line 138 "gram.y"
-{
-		attr.fixedwidth = 0;
-		if (verbose)
-			fprintf(stderr, "fixedwidth(false)\n");
-	  } break;
-case 17:
-# line 144 "gram.y"
-{
-		double	ang = yypvt[-1].y_flt;
-	
-		attr.textcos = cos(ang * D2R);
-		attr.textsin = sin(ang * D2R);
-		if (verbose)
-			fprintf(stderr, "textang(%g)\n", yypvt[-1].y_flt);
-	  } break;
-case 18:
-# line 153 "gram.y"
-{
-		font(yypvt[-1].y_str);
-		if (verbose)
-			fprintf(stderr, "font(\"%s\")\n", yypvt[-1].y_str);
-	  } break;
-case 19:
-# line 159 "gram.y"
-{
-		int	ch = (int)yypvt[-1].y_flt;
-
-		drawchar(ch);
-
-		if (verbose)
-			if (ch < 32 || ch > 127)
-				fprintf(stderr, "drawchar(%d)\n", ch);
-			else
-				fprintf(stderr, "drawchar('%c')\n", ch);
-
-	  } break;
-case 20:
-# line 172 "gram.y"
-{
-		int	n = (int)yypvt[-1].y_flt;
-
-		boxfit(yypvt[-5].y_flt, yypvt[-3].y_flt, yypvt[-1].y_flt);
-		if (verbose)
-			fprintf(stderr, "boxfit(%g, %g, %d)\n", yypvt[-5].y_flt, yypvt[-3].y_flt, n);
-	  } break;
-case 21:
-# line 180 "gram.y"
-{
-		boxtext(yypvt[-9].y_flt, yypvt[-7].y_flt, yypvt[-5].y_flt, yypvt[-3].y_flt, yypvt[-1].y_str);
-		if (verbose)
-			fprintf(stderr, "boxtext(%g, %g, %g, %g, %s)\n", yypvt[-9].y_flt, yypvt[-7].y_flt, yypvt[-5].y_flt, yypvt[-3].y_flt, yypvt[-1].y_str);
-	  } break;
-case 22:
-# line 186 "gram.y"
-{
-		move(yypvt[-5].y_flt, yypvt[-3].y_flt, yypvt[-1].y_flt);
-		if (verbose)
-			fprintf(stderr, "move(%g, %g, %g)\n", yypvt[-5].y_flt, yypvt[-3].y_flt, yypvt[-1].y_flt);
-	  } break;
-case 23:
-# line 192 "gram.y"
-{
-		rmove(yypvt[-5].y_flt, yypvt[-3].y_flt, yypvt[-1].y_flt);
-		if (verbose)
-			fprintf(stderr, "rmove(%g, %g, %g)\n", yypvt[-5].y_flt, yypvt[-3].y_flt, yypvt[-1].y_flt);
-	  } break;
-case 24:
-# line 198 "gram.y"
-{
-		attr.scal_set = 1;
-		attr.scal.x = yypvt[-5].y_flt;
-		attr.scal.y = yypvt[-3].y_flt;
-		attr.scal.z = yypvt[-1].y_flt;
-		if (verbose)
-			fprintf(stderr, "scale(%g, %g, %g)\n", yypvt[-5].y_flt, yypvt[-3].y_flt, yypvt[-1].y_flt);
-	  } break;
-case 25:
-# line 207 "gram.y"
-{
-		attr.trans_set = 1;
-		attr.tran.x = yypvt[-5].y_flt;
-		attr.tran.y = yypvt[-3].y_flt;
-		attr.tran.z = yypvt[-1].y_flt;
-		if (verbose)
-			fprintf(stderr, "translate(%g, %g, %g)\n", yypvt[-5].y_flt, yypvt[-3].y_flt, yypvt[-1].y_flt);
-	  } break;
-case 26:
-# line 216 "gram.y"
-{
-		attr.rot_set = 1;
-		attr.rot.ang = yypvt[-3].y_flt;
-		attr.rot.ax = yypvt[-1].y_flt;
-		if (verbose)
-			fprintf(stderr, "rotate(%g, %c)\n", attr.rot.ang, attr.rot.ax);
-	  } break;
-case 27:
-# line 226 "gram.y"
-{
-		yyval.y_flt = yypvt[-0].y_flt;
-	  } break;
-case 28:
-# line 230 "gram.y"
-{
-		yyval.y_flt = yypvt[-0].y_int;
-	  } break;
-case 29:
-# line 234 "gram.y"
-{
-		yyval.y_flt = yypvt[-2].y_flt + yypvt[-0].y_flt;
-	  } break;
-case 30:
-# line 238 "gram.y"
-{
-		yyval.y_flt = yypvt[-2].y_flt - yypvt[-0].y_flt;
-	  } break;
-case 31:
-# line 242 "gram.y"
-{
-		yyval.y_flt = yypvt[-2].y_flt * yypvt[-0].y_flt;
-	  } break;
-case 32:
-# line 246 "gram.y"
-{
-		yyval.y_flt = yypvt[-2].y_flt / yypvt[-0].y_flt;
-	  } break;
-case 33:
-# line 250 "gram.y"
-{
-		yyval.y_flt = -yypvt[-0].y_flt;
-	  } break;
-case 34:
-# line 254 "gram.y"
-{
-		yyval.y_flt = yypvt[-1].y_flt;
-	  } break;
-	}
-	goto yystack;		/* reset registers in driver code */
-}
diff -Nrua vort-old/text3d/gram.h vort-new/text3d/gram.h
--- vort-old/text3d/gram.h	1992-08-05 01:18:50.000000000 -0400
+++ vort-new/text3d/gram.h	1969-12-31 19:00:00.000000000 -0500
@@ -1,52 +0,0 @@
-
-typedef union {
-	float		y_flt;
-	int		y_int;
-	char		*y_str;
-} YYSTYPE;
-extern YYSTYPE yylval;
-# define FLOAT 257
-# define INTEGER 258
-# define OPTION 259
-# define STRING 260
-# define DRAWSTR 261
-# define TEXTSIZE 262
-# define COLOUR 263
-# define AMBIENT 264
-# define REFLECTANCE 265
-# define TRANSPARENCY 266
-# define MATERIAL 267
-# define TEXTRADIUS 268
-# define FIXEDWIDTH 269
-# define CENTERTEXT 270
-# define TEXTANG 271
-# define FONT 272
-# define CHAR 273
-# define DRAWCHAR 274
-# define BOXFIT 275
-# define BOXTEXT 276
-# define MOVE 277
-# define RMOVE 278
-# define SCALE 279
-# define TRANSLATE 280
-# define ROTATE 281
-# define OUTPUT 282
-# define BOX_CYL 283
-# define CYL_SPH 284
-# define LP 285
-# define RP 286
-# define LBRACE 287
-# define RBRACE 288
-# define COMMA 289
-# define ON 290
-# define OFF 291
-# define TRUE 292
-# define FALSE 293
-# define PCENT 294
-# define PLUS 295
-# define MINUS 296
-# define MULT 297
-# define DIV 298
-# define POWER 299
-# define UMINUS 300
-# define EQUALS 301
diff -Nrua vort-old/text3d/lex.c vort-new/text3d/lex.c
--- vort-old/text3d/lex.c	1993-03-03 19:20:39.000000000 -0500
+++ vort-new/text3d/lex.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,926 +0,0 @@
-# include "stdio.h"
-# define U(x) x
-# define NLSTATE yyprevious=YYNEWLINE
-# define BEGIN yybgin = yysvec + 1 +
-# define INITIAL 0
-# define YYLERR yysvec
-# define YYSTATE (yyestate-yysvec-1)
-# define YYOPTIM 1
-# define YYLMAX BUFSIZ
-# define output(c) putc(c,yyout)
-# define input() (((yytchar=yysptr>yysbuf?U(*--yysptr):getc(yyin))==10?(yylineno++,yytchar):yytchar)==EOF?0:yytchar)
-# define unput(c) {yytchar= (c);if(yytchar=='\n')yylineno--;*yysptr++=yytchar;}
-# define yymore() (yymorfg=1)
-# define ECHO fprintf(yyout, "%s",yytext)
-# define REJECT { nstr = yyreject(); goto yyfussy;}
-int yyleng; extern char yytext[];
-int yymorfg;
-extern char *yysptr, yysbuf[];
-int yytchar;
-FILE *yyin = {stdin}, *yyout = {stdout};
-extern int yylineno;
-struct yysvf { 
-	struct yywork *yystoff;
-	struct yysvf *yyother;
-	int *yystops;};
-struct yysvf *yyestate;
-extern struct yysvf yysvec[], *yybgin;
-#include <math.h>
-#include "text3d.h"
-#include "gram.h"
-
-extern int	linecount;
-extern double	atof();
-
-# define YYNEWLINE 10
-yylex(){
-int nstr; extern int yyprevious;
-while((nstr = yylook()) >= 0)
-yyfussy: switch(nstr){
-case 0:
-if(yywrap()) return(0); break;
-case 1:
-	return(OUTPUT);
-break;
-case 2:
-	return(DRAWSTR);
-break;
-case 3:
-	return(COLOUR);
-break;
-case 4:
-	return(COLOUR);
-break;
-case 5:
-return(TEXTSIZE);
-break;
-case 6:
-	return(AMBIENT);
-break;
-case 7:
-return(REFLECTANCE);
-break;
-case 8:
-return(TRANSPARENCY);
-break;
-case 9:
-return(MATERIAL);
-break;
-case 10:
-return(TEXTRADIUS);
-break;
-case 11:
-return(FIXEDWIDTH);
-break;
-case 12:
-return(CENTERTEXT);
-break;
-case 13:
-return(CENTERTEXT);
-break;
-case 14:
-	return(TEXTANG);
-break;
-case 15:
-	return(FONT);
-break;
-case 16:
-return(DRAWCHAR);
-break;
-case 17:
-	return(BOXFIT);
-break;
-case 18:
-	return(BOXTEXT);
-break;
-case 19:
-	return(MOVE);
-break;
-case 20:
-	return(RMOVE);
-break;
-case 21:
-	return(SCALE);
-break;
-case 22:
-return(TRANSLATE);
-break;
-case 23:
-	return(ROTATE);
-break;
-case 24:
-return(FIXEDWIDTH);
-break;
-case 25:
-return(CENTERTEXT);
-break;
-case 26:
-	return(TRUE);
-break;
-case 27:
-	return(FALSE);
-break;
-case 28:
-	return(CYL_SPH);
-break;
-case 29:
-	return(BOX_CYL);
-break;
-case 30:
-{
-			yylval.y_int = atoi(yytext);
-			return(INTEGER);
-		}
-break;
-case 31:
-{
-			yylval.y_flt = atof(yytext);
-			return(FLOAT);
-		}
-break;
-case 32:
-	{
-			int	braces = 1, c;
-			while ((c = input()) != '{')
-				if (c == '\n')
-					linecount++;
-
-			while (braces) {
-				c = input();
-				if (c == '\n')
-					linecount++;
-
-				if (c == '\\') {
-					c = input();
-					putchar(c);
-					if (c == '\n')
-						linecount++;
-				} else {
-					
-					if (c == '{')
-						braces++;
-					if (c == '}')
-						braces--;
-
-					if (c == EOF) {
-						fprintf(stderr, "Unterminated copy\n");
-						exit(1);
-					}
-
-					if (braces)
-						putchar(c);
-				}
-			}
-			while ((c = input()) == '\n' || c == ' ' || c == '\t' )
-				if (c == '\n')
-					linecount++;
-
-			unput(c);
-			putchar('\n');
-		}
-break;
-case 33:
-	return(PLUS);
-break;
-case 34:
-	return(MINUS);
-break;
-case 35:
-	return(DIV);
-break;
-case 36:
-	return(MULT);
-break;
-case 37:
-	return(PCENT);
-break;
-case 38:
-	return(POWER);
-break;
-case 39:
-	return(COMMA);
-break;
-case 40:
-	return(LP);
-break;
-case 41:
-	return(RP);
-break;
-case 42:
-	return(EQUALS);
-break;
-case 43:
-	{
-			int	c1, c2;
-
-			c1 = input();
-
-			if (c1 == '\\')
-				c1 = input();
-
-			if (c1 == '\n' || c1 == EOF)
-				yyerror("syntax error");
-
-			while((c2 = input()) != '\'')
-				if (c2 == '\n' || c2 == EOF)
-					yyerror("syntax error");
-					
-		 	
-			yylval.y_int = c1;
-			return(INTEGER);
-		}
-break;
-case 44:
-	{
-			char	buf[BUFSIZ], *p;
-			
-			for (p = buf; (*p = input()) != '"'; p++) {
-				if (*p == '\n' || *p == EOF) {
-					sprintf(buf, "syntax error\n", linecount);
-					yyerror(buf);
-				}
-					
-
-				if (*p == '\\') 
-					*p = input();
-			}
-
-			*p = 0;
-
-			yylval.y_str = (char *)malloc(strlen(buf) + 1);
-			strcpy(yylval.y_str, buf);
-
-			return(STRING);
-		}
-break;
-case 45:
-	{
-			return(LBRACE);
-		}
-break;
-case 46:
-	{
-			return(RBRACE);
-		}
-break;
-case 47:
-	{
-			linecount++;
-		}
-break;
-case 48:
-	{
-			;
-		}
-break;
-case 49:
-	{
-			int	c1, c2;
-			int	comline, incomment = 1;
-			char	buf[BUFSIZ];
-
-			comline = linecount;
-
-			do {
-				while ((c1 = input()) != '*' && c1 != '/' && c1 != EOF)
-					if (c1 == '\n')
-						linecount++;
-
-				c2 = input();
-				if (c2 == '\n')
-					linecount++;
-
-				if (c1 == '*' && c2 == '/')
-					incomment--;
-
-				if (c1 == '/' && c2 == '*') {
-					incomment++;
-					comline = linecount;
-				}
-
-			} while (incomment && c2 != EOF);
-
-			if (c1 == EOF || c2 == EOF) {
-				fprintf(stderr, "text3d: unterminated comment - started line %d.\n", comline);
-				exit(1);
-			}
-		}
-break;
-case -1:
-break;
-default:
-fprintf(yyout,"bad switch yylook %d",nstr);
-} return(0); }
-/* end of yylex */
-int yyvstop[] = {
-0,
-
-30,
-0,
-
-30,
-0,
-
-48,
-0,
-
-47,
-0,
-
-44,
-0,
-
-37,
-0,
-
-43,
-0,
-
-40,
-0,
-
-41,
-0,
-
-36,
-0,
-
-33,
-0,
-
-39,
-0,
-
-34,
-0,
-
-31,
-0,
-
-35,
-0,
-
-30,
-0,
-
-42,
-0,
-
-38,
-0,
-
-45,
-0,
-
-46,
-0,
-
-49,
-0,
-
-32,
-0,
-
-15,
-0,
-
-19,
-0,
-
-26,
-0,
-
-4,
-0,
-
-27,
-0,
-
-20,
-0,
-
-21,
-0,
-
-17,
-0,
-
-3,
-0,
-
-1,
-0,
-
-23,
-0,
-
-6,
-0,
-
-29,
-0,
-
-18,
-0,
-
-28,
-0,
-
-2,
-0,
-
-14,
-0,
-
-16,
-0,
-
-9,
-0,
-
-5,
-0,
-
-22,
-0,
-
-12,
-25,
-0,
-
-13,
-0,
-
-11,
-24,
-0,
-
-10,
-0,
-
-7,
-0,
-
-8,
-0,
-0};
-# define YYTYPE int
-struct yywork { YYTYPE verify, advance; } yycrank[] = {
-0,0,	0,0,	0,0,	0,0,	
-0,0,	0,0,	0,0,	0,0,	
-0,0,	0,0,	1,3,	1,4,	
-0,0,	0,0,	0,0,	0,0,	
-0,0,	0,0,	0,0,	0,0,	
-0,0,	0,0,	0,0,	0,0,	
-0,0,	0,0,	0,0,	0,0,	
-0,0,	0,0,	0,0,	0,0,	
-0,0,	1,3,	0,0,	1,5,	
-0,0,	0,0,	1,6,	0,0,	
-1,7,	1,8,	1,9,	1,10,	
-1,11,	1,12,	1,13,	1,14,	
-1,15,	1,16,	1,16,	1,16,	
-1,16,	1,16,	1,16,	1,16,	
-1,16,	1,16,	1,16,	15,31,	
-0,0,	0,0,	1,17,	14,14,	
-14,14,	14,14,	14,14,	14,14,	
-14,14,	14,14,	14,14,	14,14,	
-14,14,	16,14,	0,0,	16,16,	
-16,16,	16,16,	16,16,	16,16,	
-16,16,	16,16,	16,16,	16,16,	
-16,16,	0,0,	0,0,	0,0,	
-0,0,	0,0,	0,0,	0,0,	
-0,0,	0,0,	0,0,	1,18,	
-0,0,	0,0,	1,19,	1,20,	
-1,21,	1,22,	27,47,	1,23,	
-32,50,	37,56,	23,38,	24,41,	
-21,34,	0,0,	1,24,	19,32,	
-1,25,	20,33,	23,39,	1,26,	
-1,27,	1,28,	21,35,	22,37,	
-23,40,	24,42,	25,43,	26,44,	
-1,29,	28,48,	1,30,	33,51,	
-21,36,	34,52,	35,53,	26,45,	
-36,55,	26,46,	35,54,	38,57,	
-39,58,	40,59,	28,49,	41,60,	
-42,61,	43,62,	44,63,	45,64,	
-46,65,	47,66,	48,67,	49,68,	
-50,70,	51,71,	52,74,	53,75,	
-54,76,	55,77,	56,78,	57,79,	
-51,72,	58,80,	59,81,	60,82,	
-61,83,	62,84,	63,85,	64,86,	
-65,87,	66,88,	67,89,	49,69,	
-68,90,	69,91,	51,73,	70,92,	
-71,93,	72,94,	73,95,	74,96,	
-75,98,	77,100,	78,101,	75,99,	
-79,103,	80,104,	82,105,	84,106,	
-85,107,	86,108,	87,109,	88,110,	
-74,97,	89,111,	90,114,	92,115,	
-93,116,	94,117,	78,102,	95,118,	
-96,119,	97,120,	99,121,	100,122,	
-101,123,	102,124,	104,125,	105,126,	
-106,127,	107,128,	89,112,	89,113,	
-109,129,	111,130,	112,131,	113,132,	
-114,133,	115,135,	116,136,	118,137,	
-114,134,	119,138,	120,139,	122,140,	
-123,141,	124,142,	125,143,	126,144,	
-128,145,	130,146,	131,147,	132,148,	
-133,149,	134,150,	138,151,	139,152,	
-141,153,	143,154,	144,155,	145,156,	
-147,157,	148,158,	149,159,	150,160,	
-151,161,	152,162,	154,163,	156,164,	
-157,165,	159,166,	160,167,	161,168,	
-162,169,	163,170,	164,171,	165,172,	
-167,173,	171,174,	173,175,	175,176,	
-0,0};
-struct yysvf yysvec[] = {
-0,	0,	0,
-yycrank+1,	0,		yyvstop+1,
-yycrank+0,	yysvec+1,	yyvstop+3,
-yycrank+0,	0,		yyvstop+5,
-yycrank+0,	0,		yyvstop+7,
-yycrank+0,	0,		yyvstop+9,
-yycrank+0,	0,		yyvstop+11,
-yycrank+0,	0,		yyvstop+13,
-yycrank+0,	0,		yyvstop+15,
-yycrank+0,	0,		yyvstop+17,
-yycrank+0,	0,		yyvstop+19,
-yycrank+0,	0,		yyvstop+21,
-yycrank+0,	0,		yyvstop+23,
-yycrank+0,	0,		yyvstop+25,
-yycrank+15,	0,		yyvstop+27,
-yycrank+17,	0,		yyvstop+29,
-yycrank+27,	0,		yyvstop+31,
-yycrank+0,	0,		yyvstop+33,
-yycrank+0,	0,		yyvstop+35,
-yycrank+2,	0,		0,	
-yycrank+2,	0,		0,	
-yycrank+7,	0,		0,	
-yycrank+5,	0,		0,	
-yycrank+9,	0,		0,	
-yycrank+10,	0,		0,	
-yycrank+5,	0,		0,	
-yycrank+22,	0,		0,	
-yycrank+3,	0,		0,	
-yycrank+24,	0,		0,	
-yycrank+0,	0,		yyvstop+37,
-yycrank+0,	0,		yyvstop+39,
-yycrank+0,	0,		yyvstop+41,
-yycrank+6,	0,		0,	
-yycrank+7,	0,		0,	
-yycrank+19,	0,		0,	
-yycrank+22,	0,		0,	
-yycrank+24,	0,		0,	
-yycrank+8,	0,		0,	
-yycrank+27,	0,		0,	
-yycrank+16,	0,		0,	
-yycrank+27,	0,		0,	
-yycrank+23,	0,		0,	
-yycrank+22,	0,		0,	
-yycrank+25,	0,		0,	
-yycrank+40,	0,		0,	
-yycrank+32,	0,		0,	
-yycrank+28,	0,		0,	
-yycrank+48,	0,		0,	
-yycrank+26,	0,		0,	
-yycrank+50,	0,		0,	
-yycrank+43,	0,		0,	
-yycrank+54,	0,		0,	
-yycrank+34,	0,		0,	
-yycrank+40,	0,		0,	
-yycrank+31,	0,		0,	
-yycrank+58,	0,		0,	
-yycrank+35,	0,		0,	
-yycrank+40,	0,		0,	
-yycrank+56,	0,		0,	
-yycrank+42,	0,		0,	
-yycrank+58,	0,		0,	
-yycrank+59,	0,		0,	
-yycrank+49,	0,		0,	
-yycrank+54,	0,		0,	
-yycrank+45,	0,		0,	
-yycrank+67,	0,		0,	
-yycrank+57,	0,		0,	
-yycrank+50,	0,		0,	
-yycrank+58,	0,		0,	
-yycrank+68,	0,		0,	
-yycrank+70,	0,		0,	
-yycrank+73,	0,		0,	
-yycrank+68,	0,		0,	
-yycrank+73,	0,		0,	
-yycrank+74,	0,		0,	
-yycrank+62,	0,		0,	
-yycrank+0,	0,		yyvstop+43,
-yycrank+62,	0,		0,	
-yycrank+79,	0,		0,	
-yycrank+79,	0,		0,	
-yycrank+81,	0,		0,	
-yycrank+0,	0,		yyvstop+45,
-yycrank+68,	0,		0,	
-yycrank+0,	0,		yyvstop+47,
-yycrank+66,	0,		0,	
-yycrank+83,	0,		0,	
-yycrank+84,	0,		0,	
-yycrank+70,	0,		0,	
-yycrank+86,	0,		0,	
-yycrank+92,	0,		0,	
-yycrank+75,	0,		0,	
-yycrank+0,	0,		yyvstop+49,
-yycrank+81,	0,		0,	
-yycrank+71,	0,		0,	
-yycrank+77,	0,		0,	
-yycrank+75,	0,		0,	
-yycrank+82,	0,		0,	
-yycrank+96,	0,		0,	
-yycrank+0,	0,		yyvstop+51,
-yycrank+84,	0,		0,	
-yycrank+87,	0,		0,	
-yycrank+96,	0,		0,	
-yycrank+85,	0,		0,	
-yycrank+0,	0,		yyvstop+53,
-yycrank+83,	0,		0,	
-yycrank+98,	0,		0,	
-yycrank+88,	0,		0,	
-yycrank+106,	0,		0,	
-yycrank+0,	0,		yyvstop+55,
-yycrank+107,	0,		0,	
-yycrank+0,	0,		yyvstop+57,
-yycrank+99,	0,		0,	
-yycrank+113,	0,		0,	
-yycrank+106,	0,		0,	
-yycrank+104,	0,		0,	
-yycrank+97,	0,		0,	
-yycrank+106,	0,		0,	
-yycrank+0,	0,		yyvstop+59,
-yycrank+99,	0,		0,	
-yycrank+101,	0,		0,	
-yycrank+102,	0,		0,	
-yycrank+0,	0,		yyvstop+61,
-yycrank+115,	0,		0,	
-yycrank+123,	0,		0,	
-yycrank+107,	0,		0,	
-yycrank+117,	0,		0,	
-yycrank+126,	0,		0,	
-yycrank+0,	0,		yyvstop+63,
-yycrank+108,	0,		0,	
-yycrank+0,	0,		yyvstop+65,
-yycrank+122,	0,		0,	
-yycrank+126,	0,		0,	
-yycrank+105,	0,		0,	
-yycrank+131,	0,		0,	
-yycrank+132,	0,		0,	
-yycrank+0,	0,		yyvstop+67,
-yycrank+0,	0,		yyvstop+69,
-yycrank+0,	0,		yyvstop+71,
-yycrank+129,	0,		0,	
-yycrank+130,	0,		0,	
-yycrank+0,	0,		yyvstop+73,
-yycrank+118,	0,		0,	
-yycrank+0,	0,		yyvstop+75,
-yycrank+133,	0,		0,	
-yycrank+126,	0,		0,	
-yycrank+138,	0,		0,	
-yycrank+0,	0,		yyvstop+77,
-yycrank+131,	0,		0,	
-yycrank+136,	0,		0,	
-yycrank+122,	0,		0,	
-yycrank+125,	0,		0,	
-yycrank+120,	0,		0,	
-yycrank+121,	0,		0,	
-yycrank+0,	0,		yyvstop+79,
-yycrank+126,	0,		0,	
-yycrank+0,	0,		yyvstop+81,
-yycrank+133,	0,		0,	
-yycrank+127,	0,		0,	
-yycrank+0,	0,		yyvstop+83,
-yycrank+144,	0,		0,	
-yycrank+145,	0,		0,	
-yycrank+131,	0,		0,	
-yycrank+132,	0,		0,	
-yycrank+145,	0,		0,	
-yycrank+151,	0,		0,	
-yycrank+136,	0,		0,	
-yycrank+0,	0,		yyvstop+85,
-yycrank+142,	0,		0,	
-yycrank+0,	0,		yyvstop+87,
-yycrank+0,	0,		yyvstop+90,
-yycrank+0,	0,		yyvstop+92,
-yycrank+152,	0,		0,	
-yycrank+0,	0,		yyvstop+95,
-yycrank+155,	0,		0,	
-yycrank+0,	0,		yyvstop+97,
-yycrank+134,	0,		0,	
-yycrank+0,	0,		yyvstop+99,
-0,	0,	0};
-struct yywork *yytop = yycrank+255;
-struct yysvf *yybgin = yysvec+1;
-char yymatch[] = {
-00  ,01  ,01  ,01  ,01  ,01  ,01  ,01  ,
-01  ,011 ,01  ,01  ,01  ,01  ,01  ,01  ,
-01  ,01  ,01  ,01  ,01  ,01  ,01  ,01  ,
-01  ,01  ,01  ,01  ,01  ,01  ,01  ,01  ,
-011 ,01  ,01  ,01  ,01  ,01  ,01  ,01  ,
-01  ,01  ,01  ,01  ,01  ,01  ,01  ,01  ,
-'0' ,'0' ,'0' ,'0' ,'0' ,'0' ,'0' ,'0' ,
-'0' ,'0' ,01  ,01  ,01  ,01  ,01  ,01  ,
-01  ,01  ,01  ,01  ,01  ,01  ,01  ,01  ,
-01  ,01  ,01  ,01  ,01  ,01  ,01  ,01  ,
-01  ,01  ,01  ,01  ,01  ,01  ,01  ,01  ,
-01  ,01  ,01  ,01  ,01  ,01  ,01  ,01  ,
-01  ,01  ,01  ,01  ,01  ,01  ,01  ,01  ,
-01  ,01  ,01  ,01  ,01  ,01  ,01  ,01  ,
-01  ,01  ,01  ,01  ,01  ,01  ,01  ,01  ,
-01  ,01  ,01  ,01  ,01  ,01  ,01  ,01  ,
-0};
-char yyextra[] = {
-0,0,0,0,0,0,0,0,
-0,0,0,0,0,0,0,0,
-0,0,0,0,0,0,0,0,
-0,0,0,0,0,0,0,0,
-0,0,0,0,0,0,0,0,
-0,0,0,0,0,0,0,0,
-0,0,0,0,0,0,0,0,
-0};
-#ifndef lint
-static	char ncform_sccsid[] = "@(#)ncform 1.6 88/02/08 SMI"; /* from S5R2 1.2 */
-#endif
-
-int yylineno =1;
-# define YYU(x) x
-# define NLSTATE yyprevious=YYNEWLINE
-char yytext[YYLMAX];
-struct yysvf *yylstate [YYLMAX], **yylsp, **yyolsp;
-char yysbuf[YYLMAX];
-char *yysptr = yysbuf;
-int *yyfnd;
-extern struct yysvf *yyestate;
-int yyprevious = YYNEWLINE;
-yylook(){
-	register struct yysvf *yystate, **lsp;
-	register struct yywork *yyt;
-	struct yysvf *yyz;
-	int yych, yyfirst;
-	struct yywork *yyr;
-# ifdef LEXDEBUG
-	int debug;
-# endif
-	char *yylastch;
-	/* start off machines */
-# ifdef LEXDEBUG
-	debug = 0;
-# endif
-	yyfirst=1;
-	if (!yymorfg)
-		yylastch = yytext;
-	else {
-		yymorfg=0;
-		yylastch = yytext+yyleng;
-		}
-	for(;;){
-		lsp = yylstate;
-		yyestate = yystate = yybgin;
-		if (yyprevious==YYNEWLINE) yystate++;
-		for (;;){
-# ifdef LEXDEBUG
-			if(debug)fprintf(yyout,"state %d\n",yystate-yysvec-1);
-# endif
-			yyt = yystate->yystoff;
-			if(yyt == yycrank && !yyfirst){  /* may not be any transitions */
-				yyz = yystate->yyother;
-				if(yyz == 0)break;
-				if(yyz->yystoff == yycrank)break;
-				}
-			*yylastch++ = yych = input();
-			yyfirst=0;
-		tryagain:
-# ifdef LEXDEBUG
-			if(debug){
-				fprintf(yyout,"char ");
-				allprint(yych);
-				putchar('\n');
-				}
-# endif
-			yyr = yyt;
-			if ( (int)yyt > (int)yycrank){
-				yyt = yyr + yych;
-				if (yyt <= yytop && yyt->verify+yysvec == yystate){
-					if(yyt->advance+yysvec == YYLERR)	/* error transitions */
-						{unput(*--yylastch);break;}
-					*lsp++ = yystate = yyt->advance+yysvec;
-					goto contin;
-					}
-				}
-# ifdef YYOPTIM
-			else if((int)yyt < (int)yycrank) {		/* r < yycrank */
-				yyt = yyr = yycrank+(yycrank-yyt);
-# ifdef LEXDEBUG
-				if(debug)fprintf(yyout,"compressed state\n");
-# endif
-				yyt = yyt + yych;
-				if(yyt <= yytop && yyt->verify+yysvec == yystate){
-					if(yyt->advance+yysvec == YYLERR)	/* error transitions */
-						{unput(*--yylastch);break;}
-					*lsp++ = yystate = yyt->advance+yysvec;
-					goto contin;
-					}
-				yyt = yyr + YYU(yymatch[yych]);
-# ifdef LEXDEBUG
-				if(debug){
-					fprintf(yyout,"try fall back character ");
-					allprint(YYU(yymatch[yych]));
-					putchar('\n');
-					}
-# endif
-				if(yyt <= yytop && yyt->verify+yysvec == yystate){
-					if(yyt->advance+yysvec == YYLERR)	/* error transition */
-						{unput(*--yylastch);break;}
-					*lsp++ = yystate = yyt->advance+yysvec;
-					goto contin;
-					}
-				}
-			if ((yystate = yystate->yyother) && (yyt= yystate->yystoff) != yycrank){
-# ifdef LEXDEBUG
-				if(debug)fprintf(yyout,"fall back to state %d\n",yystate-yysvec-1);
-# endif
-				goto tryagain;
-				}
-# endif
-			else
-				{unput(*--yylastch);break;}
-		contin:
-# ifdef LEXDEBUG
-			if(debug){
-				fprintf(yyout,"state %d char ",yystate-yysvec-1);
-				allprint(yych);
-				putchar('\n');
-				}
-# endif
-			;
-			}
-# ifdef LEXDEBUG
-		if(debug){
-			fprintf(yyout,"stopped at %d with ",*(lsp-1)-yysvec-1);
-			allprint(yych);
-			putchar('\n');
-			}
-# endif
-		while (lsp-- > yylstate){
-			*yylastch-- = 0;
-			if (*lsp != 0 && (yyfnd= (*lsp)->yystops) && *yyfnd > 0){
-				yyolsp = lsp;
-				if(yyextra[*yyfnd]){		/* must backup */
-					while(yyback((*lsp)->yystops,-*yyfnd) != 1 && lsp > yylstate){
-						lsp--;
-						unput(*yylastch--);
-						}
-					}
-				yyprevious = YYU(*yylastch);
-				yylsp = lsp;
-				yyleng = yylastch-yytext+1;
-				yytext[yyleng] = 0;
-# ifdef LEXDEBUG
-				if(debug){
-					fprintf(yyout,"\nmatch ");
-					sprint(yytext);
-					fprintf(yyout," action %d\n",*yyfnd);
-					}
-# endif
-				return(*yyfnd++);
-				}
-			unput(*yylastch);
-			}
-		if (yytext[0] == 0  /* && feof(yyin) */)
-			{
-			yysptr=yysbuf;
-			return(0);
-			}
-		yyprevious = yytext[0] = input();
-		if (yyprevious>0)
-			output(yyprevious);
-		yylastch=yytext;
-# ifdef LEXDEBUG
-		if(debug)putchar('\n');
-# endif
-		}
-	}
-yyback(p, m)
-	int *p;
-{
-if (p==0) return(0);
-while (*p)
-	{
-	if (*p++ == m)
-		return(1);
-	}
-return(0);
-}
-	/* the following are only used in the lex library */
-yyinput(){
-	return(input());
-	}
-yyoutput(c)
-  int c; {
-	output(c);
-	}
-yyunput(c)
-   int c; {
-	unput(c);
-	}
diff -Nrua vort-old/text3d/lex.l vort-new/text3d/lex.l
--- vort-old/text3d/lex.l	1993-03-03 19:20:43.000000000 -0500
+++ vort-new/text3d/lex.l	2006-11-18 16:58:16.000000000 -0500
@@ -1,4 +1,5 @@
 %{
+#include <string.h>
 #include <math.h>
 #include "text3d.h"
 #include "gram.h"
diff -Nrua vort-old/text3d/Makefile vort-new/text3d/Makefile
--- vort-old/text3d/Makefile	1995-04-03 20:39:53.000000000 -0400
+++ vort-new/text3d/Makefile	2006-11-18 16:58:16.000000000 -0500
@@ -1,17 +1,29 @@
-CC=cc
 #
 #
 # Whereever you put the BINARY VOGLE HERSHEY FONTS....
 #
+.PHONY: clean clobber
+
 FONTLIB=/usr/local/lib/hershey/
 
-CFLAGS = -g -DFONTLIB=\"$(FONTLIB)\"
+CC = gcc
+CFLAGS = -DFONTLIB=\"$(FONTLIB)\"
+YACC = bison -y
+LEX = flex -l
 
 text3d:	gram.o lex.o text3d.o
-	$(CC) -o text3d text3d.o gram.o lex.o -ll -lm
+	$(CC) -o text3d text3d.o gram.o lex.o -lfl -lm
 	
+lex.o: lex.c gram.h
+
+gram.c gram.h: gram.y
+	$(YACC) -d -b $* $*.y
+	mv $*.tab.c $*.c
+	mv $*.tab.h $*.h
+
+clean:
+	rm -f *.o gram.[ch] lex.c
+
+clobber: clean
+	rm -f text3d
 
-gram.c: gram.y
-	yacc -d gram.y
-	mv y.tab.c gram.c
-	mv y.tab.h gram.h
diff -Nrua vort-old/text3d/text3d.c vort-new/text3d/text3d.c
--- vort-old/text3d/text3d.c	1992-08-05 01:18:43.000000000 -0400
+++ vort-new/text3d/text3d.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,5 +1,7 @@
 #include <fcntl.h>
 #include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
 #include <math.h>
 
 #include "text3d.h"
@@ -46,6 +48,7 @@
 float	getfontheight();
 
 extern char	*getenv();
+static int hershfont(char *fontname);
 
 /*
  * font
diff -Nrua vort-old/tools/background.c vort-new/tools/background.c
--- vort-old/tools/background.c	1992-05-25 22:51:23.000000000 -0400
+++ vort-new/tools/background.c	2006-11-18 16:58:16.000000000 -0500
@@ -8,13 +8,6 @@
 #include "vort.h"
 #include "status.h"
 
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
 
 /*
  * smalloc
diff -Nrua vort-old/tools/descrip.mms vort-new/tools/descrip.mms
--- vort-old/tools/descrip.mms	1991-02-07 19:45:45.000000000 -0500
+++ vort-new/tools/descrip.mms	1969-12-31 19:00:00.000000000 -0500
@@ -1,90 +0,0 @@
-! vort VMS make file [vort.tools]descrip.mms
-!
-
-.FIRST
- DEFINE C$INCLUDE [-.lib]
-
-!should be the default - but sometimes does NOT work
-CFLAGS = /DEFINE="VMS=1"
-
-LFLAGS =	c$include:libvort/lib, -
-		c$include:clib/opt
-
-LIB =	[-.lib]libvort.olb
-
-HEAD =	[-.lib]vort.h, -
-	[-.lib]features.h
-
-all :	gamma.exe, -
-	greyscale.exe, -
-	median.exe, -
-	mulmcut.exe, -
-	vort2ps.exe, -
-	vort2simp.exe, -
-	vortinfo.exe, -
-	nff2art.exe, -
-	vort2pcx.exe, -
-	pcx2vort.exe, -
-	imcreate.exe, -
-	impaste.exe, -
-	targ2vort.exe
-	!all vort tool files updated
-
-! the above comment about 'all tool files updated' is printed after
-! all has completed - leave it out and you get a warning from mms
-
-! not all the objects below use all the '.h' files in HEAD
-! but it is better to be safe than sorry
-
-gamma.exe :	gamma.c $(LIB) $(HEAD)
-		cc $(CFLAGS) gamma
-           	link gamma.obj, $(LFLAGS)
-
-greyscale.exe :	greyscale.c $(LIB) $(HEAD)
-		cc $(CFLAGS) greyscale
-                link greyscale.obj, $(LFLAGS)
-
-median.exe :	median.c $(LIB) $(HEAD)
-		cc $(CFLAGS) median
-        	link median.obj, $(LFLAGS)
-
-mulmcut.exe :	mulmcut.c $(LIB) $(HEAD)
-		cc $(CFLAGS) mulmcut
-		link mulmcut.obj, $(LFLAGS)
-
-vort2ps.exe :	vort2ps.c $(LIB) $(HEAD)
-		cc $(CFLAGS) vort2ps
-		link vort2ps.obj, $(LFLAGS)
-
-vort2simp.exe :	vort2simp.c $(LIB) $(HEAD)
-		cc $(CFLAGS) vort2simp
-		link vort2simp.obj, $(LFLAGS)
-
-vortinfo.exe :	vortinfo.c $(LIB) $(HEAD)
-		cc $(CFLAGS) vortinfo
-		link vortinfo.obj, $(LFLAGS)
-
-targ2vort.exe :	targ2vort.c $(LIB) $(HEAD)
-		cc $(CFLAGS) targ2vort
-		link targ2vort.obj, $(LFLAGS)
-
-nff2art.exe :	nff2art.c $(LIB) $(HEAD)
-		cc $(CFLAGS) nff2art
-		link nff2art.obj, $(LFLAGS)
-
-vort2pcx.exe :	vort2pcx.c $(LIB) $(HEAD)
-		cc $(CFLAGS) vort2pcx
-		link vort2pcx.obj, $(LFLAGS)
-
-pcx2vort.exe :	pcx2vort.c $(LIB) $(HEAD)
-		cc $(CFLAGS) pcx2vort
-		link pcx2vort.obj, $(LFLAGS)
-
-imcreate.exe :	imcreate.c $(LIB) $(HEAD)
-		cc $(CFLAGS) imcreate
-		link imcreate.obj, $(LFLAGS)
-
-impaste.exe :	impaste.c $(LIB) $(HEAD)
-		cc $(CFLAGS) impaste
-		link impaste.obj, $(LFLAGS)
-
diff -Nrua vort-old/tools/gamma.c vort-new/tools/gamma.c
--- vort-old/tools/gamma.c	1992-05-25 22:51:23.000000000 -0400
+++ vort-new/tools/gamma.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,17 +1,8 @@
 #include <stdio.h>
-#ifdef PC
 #include <stdlib.h>
-#endif
 #include <math.h>
 #include "vort.h"
 
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
 
 /*
  * a program to do simple gamma correction on images
@@ -127,7 +118,7 @@
 			alpha = (unsigned char *)malloc(w);
 			while (readrgbaline(in, red, green, blue, alpha)) {
 				gammacorrect(table, w, red, green, blue);
-				writergbaline(out, red, green, blue);
+				writergbline(out, red, green, blue);
 			}
 		} else
 			while (readrgbline(in, red, green, blue)) {
diff -Nrua vort-old/tools/greyscale.c vort-new/tools/greyscale.c
--- vort-old/tools/greyscale.c	1992-05-25 22:57:33.000000000 -0400
+++ vort-new/tools/greyscale.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,19 +1,9 @@
 #include <stdio.h>
-#ifdef PC
 #include <stdlib.h>
 #include <string.h>
-#endif
 #include "vort.h"
 #include "status.h"
 
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
-
 #define	MAX_CMAP_SIZE	256
 
 #define	COLOR_DEPTH	8
diff -Nrua vort-old/tools/imcreate.c vort-new/tools/imcreate.c
--- vort-old/tools/imcreate.c	1992-05-25 22:51:23.000000000 -0400
+++ vort-new/tools/imcreate.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,8 +1,6 @@
 #include <stdio.h>
-#ifdef PC
 #include <stdlib.h>
 #include <string.h>
-#endif
 #include "vort.h"
 #include "status.h"
 
@@ -11,14 +9,6 @@
 #define	COLOR_DEPTH	8
 #define	MAX_COLOR	256
 
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
-
 char	*usage = "usage: imcreate file w h\n";
 
 /*
diff -Nrua vort-old/tools/impaste.c vort-new/tools/impaste.c
--- vort-old/tools/impaste.c	2001-10-08 07:14:52.000000000 -0400
+++ vort-new/tools/impaste.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,8 +1,6 @@
 #include <stdio.h>
-#ifdef PC
 #include <stdlib.h>
 #include <string.h>
-#endif
 #include "vort.h"
 #include "status.h"
 
@@ -11,14 +9,6 @@
 #define	COLOR_DEPTH	8
 #define	MAX_COLOR	256
 
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
-
 char	*usage = "usage: impaste file1 x y file2 x y w h file3\n";
 
 /*
@@ -96,7 +86,7 @@
 	red = (unsigned char *)malloc(imagewidth(im2));
 	green = (unsigned char *)malloc(imagewidth(im2));
 	blue = (unsigned char *)malloc(imagewidth(im2));
-	alpha = (unsigned char *)malloc(imagewidth(im2));
+	alpha = (unsigned char *)malloc(imagewidth(im1));
 
 	h = 0;
 
diff -Nrua vort-old/tools/Makefile vort-new/tools/Makefile
--- vort-old/tools/Makefile	1995-04-03 20:38:17.000000000 -0400
+++ vort-new/tools/Makefile	2006-11-18 16:58:16.000000000 -0500
@@ -1,5 +1,4 @@
 
-CC=cc
 MFLAGS = -g
 CFLAGS = $(MFLAGS) -I../lib
 LIB = ../lib/libvort.a
@@ -85,3 +84,4 @@
 
 $(OBJS):\
 ../lib/vort.h
+
diff -Nrua vort-old/tools/makefile.msc vort-new/tools/makefile.msc
--- vort-old/tools/makefile.msc	1992-05-25 22:56:12.000000000 -0400
+++ vort-new/tools/makefile.msc	1969-12-31 19:00:00.000000000 -0500
@@ -1,46 +0,0 @@
-CC = cl
-F = -FPa
-CFLAGS = -AL -c -I..\lib -DPC -DMSC -Od -Zi $(F)
-#CFLAGS = -AL -c -I..\lib -DPC -DMSC -Ot $(F)
-LFLAGS = /ST:8192 /CO /NOE
-O = .obj
-R = .exe
-A = .lib
-
-OBJS = pcx2vort$(O) vort2pcx$(O) gamma$(O) median$(O) vort2ps$(O) vortinfo$(O) targ2pix$(O) \
-       greyscal$(O) mulmcut$(O)
-LIBS = ..\lib\libvort$(A)
-
-all: pcx2vort$(R) vort2pcx$(R) gamma$(R) median$(R) vort2ps$(R) vortinfo$(R) targ2vor$(R) \
-     greyscal$(R) mulmcut$(R)
-
-pcx2vort$(R): pcx2vort$(O) $(LIBS)
-
-vort2pcx$(R): vort2pcx$(O) $(LIBS)
-
-median$(R): median$(O) $(LIBS)
-	link $(LFLAGS) median$O ,,$*, ..\lib\libvort$(A)
-
-gamma$(R): gamma$(O) $(LIBS)
-
-greyscal$(R): greyscal$(O) $(LIBS)
-
-mulmcut$(R): mulmcut$(O) $(LIBS)
-	link $(LFLAGS) mulmcut$O+c:\c5.1\lib\setargv ,,$*, ..\lib\libvort$(A)
-
-vort2ps$(R): vort2ps$(O) $(LIBS)
-
-vortinfo$(R): vortinfo$(O) $(LIBS)
-
-targ2vor$(R): targ2vor$(O) $(LIBS)
-
-$(OBJS):\
-..\lib\vort.h
-
-.SUFFIXES:	.c $(O) $(R) .asm
-
-.c.obj:
-	$(CC) $(CFLAGS) $*.c
-
-.obj.exe:
-	link $(LFLAGS) $*,,, $(LIBS);
diff -Nrua vort-old/tools/makefile.tc vort-new/tools/makefile.tc
--- vort-old/tools/makefile.tc	1992-05-25 22:52:46.000000000 -0400
+++ vort-new/tools/makefile.tc	1969-12-31 19:00:00.000000000 -0500
@@ -1,41 +0,0 @@
-CC = bcc
-CFLAGS = -ml -I..\lib -DPC -DTC -D_STKLEN=16384 -w-rvl
-
-LIBS = ..\lib\vort.lib
-
-
-OBJS = pcx2vort.obj vort2pcx.obj gamma.obj median.obj vort2ps.obj vortinfo.obj targ2vor.obj \
-       greyscal.obj mulmcut.obj vort2ppm.obj ppm2vort.obj
-
-all: pcx2vort.exe vort2pcx.exe gamma.exe median.exe vort2ps.exe vortinfo.exe targ2vor.exe \
-     greyscal.exe mulmcut.exe vort2ppm.exe ppm2vort.exe
-
-pcx2vort.exe: pcx2vort.obj $(LIBS)
-
-vort2pcx.exe: vort2pcx.obj $(LIBS)
-
-median.exe: median.obj $(LIBS)
-
-median.obj: median.c
-
-gamma.exe: gamma.obj $(LIBS)
-
-greyscal.exe: greyscal.obj $(LIBS)
-
-mulmcut.exe: mulmcut.obj $(LIBS)
-
-vort2ps.exe: vort2ps.obj $(LIBS)
-
-vortinfo.exe: vortinfo.obj $(LIBS)
-
-targ2vor.exe: targ2vor.obj $(LIBS)
-
-vort2ppm.exe: vort2ppm.obj $(LIBS)
-
-ppm2vort.exe: ppm2vort.obj $(LIBS)
-
-.c.obj:
-	$(CC) -c $(CFLAGS) $*.c
-
-.obj.exe:
-	$(CC) $(CFLAGS) $*.obj $(LIBS)
diff -Nrua vort-old/tools/make.msc vort-new/tools/make.msc
--- vort-old/tools/make.msc	1992-05-25 22:56:12.000000000 -0400
+++ vort-new/tools/make.msc	1969-12-31 19:00:00.000000000 -0500
@@ -1,61 +0,0 @@
-CC = cl
-F = -FPa
-CFLAGS = -AL -c -I..\lib -DPC -DMSC -Ot $(F)
-LFLAGS = /ST:8192 /NOE
-
-.c.obj:
-	$(CC) $(CFLAGS) $*.c
-
-.obj.exe:
-	link $(LFLAGS) $*,,, $(LIBS);
-
-LIBS = ..\lib\vort.lib
-
-median.obj: median.c
-
-gamma.obj: gamma.c
-
-greyscal.obj: greyscal.c
-
-mulmcut.obj: mulmcut.c
-
-vort2ps.obj: vort2ps.c
-
-vort2sim.obj: vort2sim.c
-
-vort2pcx.obj: vort2pcx.c
-
-vortinfo.obj: vortinfo.c
-
-targ2vor.obj: targ2vor.c
-
-vort2ppm.obj: vort2ppm.c
-
-ppm2vort.obj: ppm2vort.c
-
-nff2art.obj: nff2art.c
-
-median.exe: median.obj $(LIBS)
-
-gamma.exe: gamma.obj $(LIBS)
-
-greyscal.exe: greyscal.obj $(LIBS)
-
-mulmcut.exe: mulmcut.obj $(LIBS)
-
-vort2ps.exe: vort2ps.obj $(LIBS)
-
-vort2sim.exe: vort2sim.obj $(LIBS)
-
-vort2pcx.exe: vort2pcx.obj $(LIBS)
-
-vortinfo.exe: vortinfo.obj $(LIBS)
-
-targ2vor.exe: targ2vor.obj $(LIBS)
-
-vort2ppm.exe: vort2ppm.obj $(LIBS)
-
-ppm2vort.exe: ppm2vort.obj $(LIBS)
-
-nff2art.exe: nff2art.obj $(LIBS)
-
diff -Nrua vort-old/tools/median.c vort-new/tools/median.c
--- vort-old/tools/median.c	1995-04-03 21:41:48.000000000 -0400
+++ vort-new/tools/median.c	2006-11-18 16:58:16.000000000 -0500
@@ -40,37 +40,22 @@
  *	Siggraph '82 proceedings, pp. 297-307
  */
 #include <stdio.h>
-#ifdef PC
 #include <stdlib.h>
 #include <ctype.h>
 #include <malloc.h>
-#endif
 
 #include "vort.h"
 #include "status.h"
 
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
 
 typedef	unsigned int	un_short;
 typedef	unsigned char	un_char;
 
 un_char	*mcalloc();
 
-#ifdef PC
-#define	HUGE		huge
-#define	HALLOC(n,s)	halloc((long)(n),s)
-typedef	long		HIST;
-#else
 #define	HUGE
 #define	HALLOC(n,s)	malloc(n*s)
 typedef	int		HIST;
-#endif
 
 #define	MAX_CMAP_SIZE	256
 #define	streq(a,b)	(strcmp(a,b) == 0)
@@ -867,7 +852,7 @@
 		tmpaptr = thisaline;
 		thisaline = nextaline;
 		nextaline = tmpaptr;
-		if (!lastline && readrgbline(in, r, g, b, nextaline) == 0) {
+		if (!lastline && readrgbaline(in, r, g, b, nextaline) == 0) {
 			fprintf(stderr, "Unexpected end of input file.\n");
 			break;
 		}
diff -Nrua vort-old/tools/mulmcut.c vort-new/tools/mulmcut.c
--- vort-old/tools/mulmcut.c	1995-04-03 21:46:05.000000000 -0400
+++ vort-new/tools/mulmcut.c	2006-11-18 16:58:16.000000000 -0500
@@ -35,51 +35,20 @@
  *	Siggraph '82 proceedings, pp. 297-307
  */
 #include <stdio.h>
-#ifdef PC
 #include <fcntl.h>
 #include <stdlib.h>
+#include <string.h>
 #include <ctype.h>
 #include <malloc.h>
-#endif
 #include "vort.h"
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
 typedef	unsigned int	un_short;
 typedef	unsigned char	un_char;
 
-#ifdef SYSV
-#define rindex          strrchr
-#endif
-
-#ifdef PC
-#define	rindex		strrchr
-#endif
-
-#ifdef VMS
-#define rindex          strrchr
-#endif
- 
-#ifdef MIPS
-#include <string.h>
-#define rindex strrchr
-#endif
-
 un_char	*mcalloc();
 
-#ifdef PC
-#define	HUGE		huge
-#define	HALLOC(n,s)	halloc((long)(n),s)
-typedef	long		HIST;
-#else
 #define	HUGE
 #define	HALLOC(n,s)	malloc(n*s)
 typedef	int		HIST;
-#endif
 
 #define	MAX_CMAP_SIZE	256
 #define	streq(a,b)	(strcmp(a,b) == 0)
@@ -88,11 +57,7 @@
 #define	MAX_COLOR	256
 
 #define	B_DEPTH		5		/* # bits/pixel to use */
-#ifdef PC
 #define	B_LEN		(1<<B_DEPTH)
-#else
-#define	B_LEN		(1<<B_DEPTH)
-#endif
 
 #define	C_DEPTH		2
 #define	C_LEN		(1<<C_DEPTH)	/* # cells/color to use */
@@ -128,8 +93,6 @@
 image	*in, *out;
 int	chatty = 0;
 
-extern	char	*rindex();
-
 un_char	*red, *green, *blue, *scanline = (un_char *)NULL;
 short	*thisline = (short *)NULL, *nextline = (short *)NULL;
 
@@ -336,7 +299,7 @@
 		imagepos(in, 0, 0);
 
 		strcpy(buf, av[inf]);
-		c = rindex(buf, '.');
+		c = strrchr(buf, '.');
 		*c = '\0';
 		strcat(buf, ".mix");
 		if (strcmp(av[inf], buf) == 0) {
diff -Nrua vort-old/tools/nff2art.c vort-new/tools/nff2art.c
--- vort-old/tools/nff2art.c	1993-07-26 22:12:17.000000000 -0400
+++ vort-new/tools/nff2art.c	2006-11-18 16:58:16.000000000 -0500
@@ -4,6 +4,7 @@
  */
 
 #include <stdio.h>
+#include <stdlib.h>
 #include <math.h>
 
 /*
diff -Nrua vort-old/tools/pcx2vort.c vort-new/tools/pcx2vort.c
--- vort-old/tools/pcx2vort.c	1994-02-17 19:30:03.000000000 -0500
+++ vort-new/tools/pcx2vort.c	2006-11-18 16:58:16.000000000 -0500
@@ -8,38 +8,15 @@
 #include <stdio.h>
 #include <time.h>
 
-#ifdef PC
 #include <stdlib.h>
-#endif
 #include "vort.h"
 
-#ifdef PC
-#define READ_BINARY_MODE	"rb"
-#else
 #define READ_BINARY_MODE	"r"
-#endif
-
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
 
 #define USAGE	"pcx2vort: usage: pcx2vort pcxfile vortfile\n"
 
-#ifdef PC
-typedef unsigned int	UINT;
-typedef unsigned char	UCHAR;
-#else
 typedef unsigned short	UINT;
 typedef unsigned char	UCHAR;
-#endif
-
-#ifdef PC
-#pragma pack(1)
-#endif
 
 /* this structure needs to be byte aligned! */
 typedef struct {
@@ -67,10 +44,6 @@
 	UCHAR	filler[60];	/* pad out to 128 bytes */
 	} PCX_HDR;
 
-#ifdef PC
-#pragma pack()
-#endif
-		
 
 main(ac, av)
 	int	ac;
@@ -246,6 +219,7 @@
 
 
 int		fail(msg)
+const char *msg;
 {
 	fprintf(stderr, "%s", msg);
 	exit(1);
diff -Nrua vort-old/tools/ppm2vort.c vort-new/tools/ppm2vort.c
--- vort-old/tools/ppm2vort.c	1993-08-24 21:46:33.000000000 -0400
+++ vort-new/tools/ppm2vort.c	2006-11-18 16:58:16.000000000 -0500
@@ -7,6 +7,7 @@
  */
 
 #include <stdio.h>
+#include <stdlib.h>
 #include "vort.h"
 
 #define ASCII	111
diff -Nrua vort-old/tools/targ2vort.c vort-new/tools/targ2vort.c
--- vort-old/tools/targ2vort.c	1992-05-25 22:57:18.000000000 -0400
+++ vort-new/tools/targ2vort.c	2006-11-18 16:58:16.000000000 -0500
@@ -8,17 +8,13 @@
  */
 
 #include <stdio.h>
-#ifdef PC
 #include <stdlib.h>
-#endif
+#include <string.h>
 #include "vort.h"
 
 #define	TRUE	1
 #define	FALSE	!TRUE
 
-#ifdef PC
-#pragma pack(1)
-#endif
 typedef	struct {
 	char		pad1[12];
 	unsigned short	pw;
@@ -26,20 +22,9 @@
 	char		bits_per_pixel;
 	char		pad2[1];
 } TGA_HEADER;
-#ifdef PC
-#pragma pack()
-#endif
 
 #define TGA_HEADER_SIZE	(12 + 2 + 2 + 1 + 1)
 
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
-
 int
 main(argc, argv)
 	int	argc;
@@ -89,11 +74,7 @@
 	}
 
 	/* open TARGA file */
-#ifdef PC
-	if ((fin = fopen(infn, "rb")) == NULL) {
-#else
 	if ((fin = fopen(infn, "r")) == NULL) {
-#endif
 		fprintf(stderr, "Can't read TARGA file: %s\n", infn);
 		exit(1);
 	}
@@ -107,22 +88,18 @@
 		exit(1);
 	}
 
-#ifndef PC
 	c = tga_header.pw & 0x00ff;
 	tga_header.pw = tga_header.pw >> 8;
 	tga_header.pw |= c << 8;
-#endif
 
 	if (fread(&tga_header.ph, sizeof(unsigned short), 1, fin) != 1) {
 		fprintf(stderr, "Can't read TARGA header: %s\n", infn);
 		exit(1);
 	}
 
-#ifndef PC
 	c = tga_header.ph & 0x00ff;
 	tga_header.ph = tga_header.ph >> 8;
 	tga_header.ph |= c << 8;
-#endif
 
 	if (fread(&tga_header.bits_per_pixel, 1, 1, fin) != 1) {
 		fprintf(stderr, "Can't read TARGA header: %s\n", infn);
diff -Nrua vort-old/tools/vort2pcx.c vort-new/tools/vort2pcx.c
--- vort-old/tools/vort2pcx.c	1992-05-25 22:51:22.000000000 -0400
+++ vort-new/tools/vort2pcx.c	2006-11-18 16:58:16.000000000 -0500
@@ -8,34 +8,16 @@
  */
 
 #include <stdio.h>
-#ifdef PC
 #include <stdlib.h>
-#endif
 #include "vort.h"
 
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
-
-#ifdef PC
-#define WRITE_BINARY_MODE	"wb"
-#else
 #define WRITE_BINARY_MODE	"w"
-#endif
 
 #define USAGE	"vort2pcx: usage: vort2pcx vortfile pcxfile\n"
 
 typedef unsigned int	UINT;
 typedef unsigned char	UCHAR;
 
-#ifdef PC
-#pragma pack(1)
-#endif
-
 /* this structure needs to be byte aligned! */
 typedef struct {
 	UCHAR	r;
@@ -62,10 +44,6 @@
 	UCHAR	filler[60];	/* pad out to 128 bytes */
 	} PCX_HDR;
 
-#ifdef PC
-#pragma pack()
-#endif
-		
 
 main(ac, av)
 	int	ac;
diff -Nrua vort-old/tools/vort2ppm.c vort-new/tools/vort2ppm.c
--- vort-old/tools/vort2ppm.c	1992-06-04 01:19:43.000000000 -0400
+++ vort-new/tools/vort2ppm.c	2006-11-18 16:58:16.000000000 -0500
@@ -4,18 +4,9 @@
  */
 
 #include <stdio.h>
+#include <stdlib.h>
 #include "vort.h"
 
-extern char	*malloc();
-
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
-
 main(argc, argv)
 	int	argc;
 	char	*argv[];
diff -Nrua vort-old/tools/vort2ps.c vort-new/tools/vort2ps.c
--- vort-old/tools/vort2ps.c	1993-01-17 23:05:38.000000000 -0500
+++ vort-new/tools/vort2ps.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,21 +1,9 @@
 #include <stdio.h>
-#ifdef PC
 #include <stdlib.h>
-#endif
 #include "vort.h"
 
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
-
 #define	STRSIZE		40		/* length of postscript string - must be even */
 
-extern double	atof();
-
 /*
  * program to read a pix image and convert it to greyscale postscript
  */
diff -Nrua vort-old/tools/vort2simp.c vort-new/tools/vort2simp.c
--- vort-old/tools/vort2simp.c	1995-04-03 21:44:10.000000000 -0400
+++ vort-new/tools/vort2simp.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,29 +1,9 @@
 #include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
 #include <time.h>
 #include "vort.h"
 
-extern char	*malloc();
-
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
-
-#ifdef PC
-extern char *strchr();
-#define	rindex strchr
-#else
-extern char	*rindex();
-#endif
-
-#ifdef SYSV
-#include <string.h>
-#define	rindex strchr
-#endif
-
 /*
  * program to convert a pix file into straight rgb and an ascii
  * header. The ascii header ends in .hdr, and the raster file
@@ -49,7 +29,7 @@
 		exit(1);
 	}
 
-	if ((p = rindex(av[1], '.')) == (char *)NULL) {
+	if ((p = strrchr(av[1], '.')) == (char *)NULL) {
 		fprintf(stderr, "pix2simp: image file name must end in .pix.\n");
 		exit(1);
 	}
diff -Nrua vort-old/tools/vort2sun.c vort-new/tools/vort2sun.c
--- vort-old/tools/vort2sun.c	1991-06-10 00:02:07.000000000 -0400
+++ vort-new/tools/vort2sun.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,4 +1,5 @@
 #include <stdio.h>
+#include <stdlib.h>
 #include <math.h>
 #include <pixrect/pixrect_hs.h>
 #include "vort.h"
diff -Nrua vort-old/tools/vortinfo.c vort-new/tools/vortinfo.c
--- vort-old/tools/vortinfo.c	1992-07-23 23:18:16.000000000 -0400
+++ vort-new/tools/vortinfo.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,15 +1,8 @@
 #include <stdio.h>
+#include <stdlib.h>
 #include <time.h>
 #include "vort.h"
 
-#ifdef TC
-#ifndef _STKLEN
-unsigned _stklen = 8192;
-#else
-unsigned _stklen = _STKLEN;
-#endif
-#endif
-
 /*
  * vortinfo
  *
diff -Nrua vort-old/vort2pc vort-new/vort2pc
--- vort-old/vort2pc	1991-03-20 20:46:00.000000000 -0500
+++ vort-new/vort2pc	1969-12-31 19:00:00.000000000 -0500
@@ -1,34 +0,0 @@
-#
-# csh script to rename vort files and directories for use
-# on a SUN PC-tool
-#
-mv ./send_beer ./sen_beer
-mv ./Makefile ./makefile
-mv ./README ./readme
-mv ./README.VMS ./readme.vms
-mv ./X11/Makefile ./X11/makefile
-mv ./X11 ./x11
-mv ./apollo/Makefile ./apollo/makefile
-mv ./art/src/README ./art/src/readme
-mv ./art/src/Makefile ./art/src/makefile
-mv ./docs/greyscale.1 ./docs/greyscal.1
-mv ./docs/greyscale.doc ./docs/greyscal.doc
-mv ./docs/targ2vort.1 ./docs/targ2vor.1
-mv ./docs/targ2vort.doc ./docs/targ2vor.doc
-mv ./docs/vort2simp.1 ./docs/vort2sim.1
-mv ./docs/vort2simp.doc ./docs/vort2sim.doc
-mv ./iris/Makefile ./iris/makefile
-mv ./lib/Makefile ./lib/makefile
-mv ./movies/README ./movies/readme
-mv ./old/README ./old/readme
-mv ./old/Makefile ./old/makefile
-mv ./sun/Makefile ./sun/makefile
-mv ./tools/Makefile ./tools/makefile
-mv ./tools/greyscale.c ./tools/greyscal.c
-mv ./tools/targ2vort.c ./tools/targ2vor.c
-mv ./tools/vort2simp.c ./tools/vort2sim.c
-mv ./tools/README ./tools/readme
-mv ./tutes/README ./tutes/readme
-mv ./text3d/README ./text3d/readme
-mv ./text3d/Makefile ./text3d/makefile
-mv ./text3d/ABC.in ./text3d/abc.in
diff -Nrua vort-old/X11/descrip.mms vort-new/X11/descrip.mms
--- vort-old/X11/descrip.mms	1991-02-07 21:42:08.000000000 -0500
+++ vort-new/X11/descrip.mms	1969-12-31 19:00:00.000000000 -0500
@@ -1,37 +0,0 @@
-! vort VAX make file [vort.x11]descrip.mms
-!
-
-.FIRST
- DEFINE C$INCLUDE [-.lib]
-
-! should be the default - but sometimes does not seem to work properly
-CFLAGS = /DEFINE="VMS=1"
-
-LFLAGS = xlib/opt, -
-	c$include:libvort/lib, -
-	c$include:clib/opt
-
-LIB =	[-.lib]libvort.olb
-
-HEAD =	[-.lib]vort.h, -
-	[-.lib]features.h
-
-all :	disp.exe, -
-	movie.exe, -
-	rdisp.exe
-	!all vort x11 files updated
-
-! the above comment about 'all files updated' is printed after
-! all has completed - leave it out and you get a warning from mms
-
-disp.exe :	disp.c $(LIB) $(HEAD)
-		cc $(CFLAGS) disp
-           	link disp.obj, $(LFLAGS)
-
-movie.exe :	movie.c $(LIB) $(HEAD)
-		cc $(CFLAGS) movie
-        	link movie.obj, $(LFLAGS)
-
-rdisp.exe :	rdisp.c $(LIB) $(HEAD)
-		cc $(CFLAGS) rdisp
-                link rdisp.obj, $(LFLAGS)
diff -Nrua vort-old/X11/disp.c vort-new/X11/disp.c
--- vort-old/X11/disp.c	1994-10-09 19:54:34.000000000 -0400
+++ vort-new/X11/disp.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,32 +1,16 @@
 #include <stdio.h>
+#include <stdlib.h>
 #include <signal.h>
+#include <string.h>
 #include <math.h>
-#ifdef VMS
-#include <decw$include/xlib.h>
-#include <decw$include/xutil.h>
-#else
+
 #include <X11/Xlib.h>
 #include <X11/Xutil.h>
 #include <X11/Xatom.h>
-#endif
-
-#ifdef VMS
-typedef unsigned char u_char;
-#include <string.h>
-#include <types.h>
-#define rindex strrchr
-#endif 
-
-#ifdef SYSV
-#include <string.h>
-#define rindex strrchr
-#endif 
 
 #include "vort.h"
 #include "status.h"
 
-extern char	*rindex();
-
 #define	CMAPSIZE	256
 #define EV_MASK         KeyPressMask|ButtonReleaseMask|ExposureMask|ButtonPressMask
 
@@ -47,39 +31,22 @@
 static int		truecolor;
 static int		half = 0;
 
-static int	(*copyfun)();
+static void	(*copyfun)(const void *src, void *dest, size_t n);
 
 /*
  * xbcopy
  *
  *	copy bytes from from to to.
  */
-xbcopy(from, to, size)
-	unsigned char	*from, *to;
-	int		size;
+static void xbcopy(from, to, size)
+	const unsigned char	*from;
+	unsigned char		*to;
+	size_t			size;
 {
-	while (size--)
+	while (size--) {
 		*to++ = carray[*from++];
-
-}
-
-#ifdef SYSV
-/*
- * bcopy
- *
- *	copy bytes from from to to.
- */
-bcopy(from, to, size)
-	unsigned char	*from, *to;
-	int		size;
-{
-	while (size--)
-		*to++ = *from++;
-
+	}
 }
-#else
-extern int	bcopy();
-#endif
 
 /*
  * program to read in a color-mapped image and display it on X11, greyscale
@@ -104,7 +71,7 @@
 	int		nv;
 
 
-        if ((myname = rindex(av[0],'/')) == NULL)
+        if ((myname = strrchr(av[0],'/')) == NULL)
                 myname = av[0];
         else
                 *myname++;
diff -Nrua vort-old/X11/movie vort-new/X11/movie
--- vort-old/X11/movie	1999-10-13 08:19:58.000000000 -0400
+++ vort-new/X11/movie	1969-12-31 19:00:00.000000000 -0500
@@ -1,76 +0,0 @@
-ELF              4   D      4    (      4   44                                       f  f           f    #           g                                 /lib/ld-linux.so.2           GNU                C   I      B              *       +          F         0   <      "          4       &             C   '       6   H   ;         /                  ?   :   A                   2          G          ,           E   -          8   )   D   .   	                          !               1                       3                   #                  $                           9           
-                                 7           5                                 @       =       >                     (                      %                                                 %        ;         A         G         Z         d   \j     v            |         \                                   ;        l9                 \        \U        L        <             )        5        A  ,U     N        ]        h  |      s         ,        e        <e        {        <        L        |               l               <:     !       9  "      @  |)      G  HS     N        U  2  "   \  I   "   c  =   "   i  {      o  L  "   v  =   "   |  !        $        l1           "     =   "     ,        l        |$                                      L        =   "     t   "     7   "        "          $       +       7        __gmon_start__ libX11.so.6 _DYNAMIC _GLOBAL_OFFSET_TABLE_ _init _fini XSetWindowColormap XChangeGC XCheckWindowEvent XCloseDisplay XSync XCopyArea XCreatePixmap XPutImage XCreateColormap XLoadFont XDisplayName XDrawRectangle XFillRectangle XLoadQueryFont XFreeColormap XFreePixmap XParseGeometry XAllocColor XGetDefault XCreateImage XDisplayPlanes XMapWindow XNextEvent XOpenDisplay XSelectInput XSetBackground XSetForeground XSetWMHints XSetStandardProperties XSetInputFocus XStoreColors XSetIconName XDrawString XUnmapWindow XMatchVisualInfo XCreateWindow libc.so.6 strcpy printf usleep pclose malloc select lseek popen rindex write atof fprintf strcat __deregister_frame_info read strncmp bcopy sprintf stderr exit fileno _IO_stdin_used __libc_start_main open __register_frame_info close free _etext _edata __bss_start _end GLIBC_2.1 GLIBC_2.0                                                                                                                    /         ii   <     ii   F        <    #    &  
-    	   B  $3  (>  ,C  0  45  8-  </  @  D   H  L  P:  T$  X1  \.  `7  d!  h  l  p  t  x4  |  9  (  @    6  +  0  A    %    =  )    D      "  2      ;        '  8      *  US    [h      t  o  jO  ] 5%     %h    %h   %h   %h   %h    %h(   %h0   % h8   p%$h@   `%(hH   P%,hP   @%0hX   0%4h`    %8hh   %<hp    %@hx   %Dh   %Hh   %Lh   %Ph   %Th   %Xh   %\h   %`h   p%dh   `%hh   P%lh   @%ph   0%th    %xh   %|h    %h   %h   %h  %h  %h  %h   %h(  %h0  %h8  p%h@  `%hH  P%hP  @%hX  0%h`   %hh  %hp   %hx  %h  %h  %h  %h  %h  %h  %h  %h  p%h  `%h  P%h  @%h  0%h       1^PTRhhQVhU= u8P 8 ut
-h2   Uv Uthhv UU   WVSj/E0t uU  }   5 h 5h`5h5h5$h5h 5h`5h5o h 5\j5fV  fT  fX  fZ              \    `    8   }:  8XUT:-  )    ufT   T,    ufX   &    T/    ufZ   T2    u   a  t& T5    uyX@8XEt$Q$ttllXtXPh@,8   T`    u      Tc    t.Ti
-    tTs    u%C8XU`C&    Tv	    u%X@8XBE\XXB8X@U95 h hh \ uj \\PJu\Rh5Dj` uhhQ`   PRh5jxPjQ55 uh 5j    x   T    D,$f=Z tE+8P,E+8P4f=T tE+8PEPUR!  `P  55duV5}uJ  t   j j55=t t(      = tj 5L   &    =t      = ~lj 5C)XX)XXd)JdRj j j j = tj 5/yX PSh  5QS  0UVSu   D0F!    H   1f~d    t& ]FhfffEFlfffEFpfffEEEP55tECFd9|R1   1u]ffEfEfEEV55<tEC   ~   T8`   D4\   e[^U0WVSEIEIqj55 5E@! (  HdMIPquh(5jt& H   1;Us  w_OMG
-EE    ME@hffEfMIlf
-ffMIpf
-ffMEQ$P$Q$UEu	`UUEu\]EEEB;UG   E   h  Kuh(5jk1O
-MGEw_}MfffMfE EMEB   r`    \   lMQW55We[^_U  WVSh558uh;5jQ>A@DA<@h558Ph @  5$5L|    d=  w  EDhPf=T ttu   LLEE)M   LL)M}    PPPP}Wlt|Et|Et|Et|Et5      }    D)+EE tB      }    D)+EE|   Ud9sPRh`5Uh9sPRh5|E  E   `E\EEEPh
-   5j 5juuuu5 505P5|Pj j j 5 h 55`   \   X   ,XP55ah55Kh  55[^_UD|   @    j hPj   @@DBj hPR  @    D j hPR  @@DBj hPR  @@x 5`5$55\5$5U55xjP5$5545\5$5MjhDPP5$55M@Tx@TDB(j hPR  v U   WVSuv  ~4  V |E9m  M9\  ~$P  9@  L5\=`W5$5NV5$55]+]SjEP5$5524V5$5W5$55SjMQ5$55UUUmU1K@]m+UDE41KShEPR5$55{=t I  ?  M9@  E90  ~$$  9  t    5\=`W5$5V5$55]+]SjMQ5$554V5$5W5$5.5SjEP5$55*UUUmU1K@]m+UDE41KSh  ;]  ;Q  ~$E  95  L   =t t  =\M`EP5$5jMQ5$55)VjW5$55P4EP5$5MQ5$55VjW5$55]m]1J@Um+]D4NVhRS	  &    E9A  M90  ~$$  9  t   5\=`W5$5V5$55]+]SjEP5$554V5$5W5$5t5SjMQ5$55pUUUmU1K@]m+UDE41KShQ  M9(  E9  V$  9  5\=`W5$5V5$5~5]+]SjMQ5$554V5$5W5$5-5SjEP5$55)UUUmU1K@]m+UDE41KShEPR5$55559551;<}<f=Z t,45~4P@DC;<|5j   V |M96  E9&  ~$  9
-  5`=\W5$5V5$55]+]SjMQ5$554V5$5W5$5@5SjEP5$55<UUUmU1K@]m+UDE41KSh  M9:  E9*  ~$  9  5`=\W5$5V5$5J5]+]SjMQ5$554V5$5KW5$55SjEP5$55UUUmU1K@]m+UDE41KSh  t& M96  E9&  ~$  9
-  5`=\W5$5QV5$55]+]SjMQ5$5554V5$5 W5$55SjEP5$55UUUmU1K@]m+UDE41KSh  M98  E9(  ~$  9  5`=\W5$5
-V5$55]+]SjMQ5$554V5$5W5$5g5SjEP5$55cUUUmU1K@]m+UDE41KShD  M9  E9	  V$  9  5`=\W5$5V5$5o5]+]SjMQ5$554V5$5pW5$55SjEP5$55UUUmU1K@]m+UDE41KShEPR5$55    =|\M`EP5$5MQ5$5,5)VjW5$55g4EP5$5/MQ5$55VjW5$55]m]1J@Um+]D4NVhRS5$55=\E`MQ5$5VEP5$55)VjW5$55<4MQ5$5EP5$55VjW5$55]m]1J@Um+]D4NVhRS5$55=\E`MQ5$5+EP5$55)VjW5$554MQ5$5EP5$55VjW5$55]m]1J@Um+]D4NVhRS5$55b=\E`MQ5$5 EP5$55)VjW5$554MQ5$5EP5$5Y5VjW5$55X]m]1J@Um+]D4NVhRS5$557=\E`MQ5$5EP5$55)VjW5$554MQ5$5EP5$5.5VjW5$55-]m]1J@Um+]D4NVhRS5$55@@x5`5$55\5$5[55xjQ5$5545\5$5RjhDPQ5$55Q@x(=t t   t[^_v UWSL<9|    }Jf=Z tFDPj RPPPj j 5$5,45{DRPPPDPj j j 445$55u(5h
-]S>1y5`5$55@@Pj5x5$5545\5$5WSDP5x5$55(f=T    <1y5`5$5!5h  DEhEEPj 5$55(5\5$5W4DEhEEPj5$55e[_U(WVSh 0    8<;E'  <]4h5 h<4  Eu<4h 5j]S$ds&5ht9<    =   fdfPfhfR    = t]]Su	SWE]C! u-5dE5dE5dEf=Z    hPEEuh;5jv j j5hW]Sj j5550(uJhG5vjOv P9uR9th`5Fjv ]K8V9}fVf=T    tCQ8<)]s<8<)4:je8<)8<)  f=Z    hPEEuh;5Yj2    j j5hW]Sj j555R8<)40(uxhG5jj5hW5 5}8<),(uh5jr    ]]f=X thHEE]C!    ,5d]S]Sf=X t)}}]S]Si  u   15d9sq]P$]P$]P$}]]m}EUm]A9r5d]S]Sf=X t)}}]S]S]S]S	  9]S  f=Z t/5hWj j j j 505$5(5(<X<;E8<)<Ph5fVu	fT  e[^_UVSMC)ue)uEU)J]Rj j j j 1e[^UVS]MUJt0CAse[^US]= uSuS]UWVS} t=`5\=\5`V5$5W5$55]+]SjEP5$554W5$5V5$5j5SjMQ5$55fUUUmU}1K@]m+UDE4}1KSEPMQR5$55?e[^_UWVSuF =     4=   	  =       &    =   \    = /    = '  t#  &    = 7  tp= ?    y  1f~$ |  V  b  FhMFl};FpM} t};CF$9|)  1f~$   VV    U}c   F$9  V&  FhMFl};FpM} t};MCM   V  Fh};EFlMEFp};E} tGM>&    F$9D  M};M};M};} tMMC} uF$9  1f~$   v V*    Fh};FlMFp};} tV  M
-t& V  CF$9|  1f~$ |  V  b  U}s  F$9L  V  Fh};FlMFp};} tVQ  MVC  MCM   V(  Fh};EFlMEFp};E} tV  MEV  =t& F$9  M};M};M};} t	M};MC} uF$9?  1f~$ 2  Vj    MVP  };VD  M} t};CF$9|  1f~$   v V
-    MV  };V  M} tV  };&    V  CF$9|i  1f~$ \  V  B  U}a   F$9,  Vf  MVZ  };VN  M} t};MCM       V  };EV  MEV  };E} tAM8F$9  M};M};M};} tMMC} uF$9Q  1f~$ C  v Vz  &  U}u   F$9  VJ  };V>  MV2  };} tV  Mt& V
-  MCM   t& V  };EV  MEV  };E} tV  MEV  5F$9}VM};M};M};} t	M};MC} uF$9t& h*  1   e[^_v Uj uuuuUuuuuuUWVS}G = /  N  = '  tZ  = 7  tv= ?    C  1f$ t*&    W  (  MFG$9|}   1f$       MFG$9u  1f$    W8    ]}3t^G$9}bW  MMFMt9&    W  MF} tG$9}MMF} uG$9v} J  1f$ =  MFG$9u(  1f$   Wu    MW[     } tMFG$9|   v 1f$    v W     ]}H   G$9   W  MW  } tMMFMtCW  W  MG$9}8MM} tMF} uG$9Ph H  1   e[^_v Uj uuPUuuu;UE= v!=  vt& =   v	t& %   v UVSu]jEPV    UU*#jEPVth d  E	M}uEe[^v UWVS}]EEjEPWth`  ]%   E 	E%   E 	E%   E 	E]Kx'ujPW+th`  KyE@e[^_USM]A    v #	Au]v UWVSu}jEPVEEPVuuh.  uSV;Et
-h  EG_e[^_UWVS]jj 3}EjEP3/s8jFP3qE(jEP3Vs83NE jEP3$jGP3)s8s<3+Ee[^_v UWVS]jj 3eEjEP3jj3E$jEP3]jCdP3E jEP3:$jGP3CdPsh3CdPsl3$CdPsp3)e[^_UWVSuEjEP6jj 6Ejj6~E$jEP6F$P@%   PF$P6EjEP6g(F&P%   PF&P6EjEP63F(P %   PF(P6n1F!t(EjEP6j j 6C   F!t*EjEP6E jEP6GF!t*EjEP6E jEP6GF!t)EjEP6fE jEP6SEjEP6=UjEP6)F!tF@EjEP6F!tFDEjEP6F!tFHEjEP6E	jEP6jv46F!t)EjEP6E jEP6|F! t$E
-jEP6`jv6~    EjEP62F*PjF*P6tEjEP6(F,PjF,P6DEjEP6F.P} jF.P6EjEP6F0PMjF0P6(E jEP6ujCP6j UR6'$jC+EP6+E@e[^_UEv UVS]jj SjEPSujhEPYtj VS1       jtu1   F<F8    F    FTF   PiFXuh 
-  EP6Wj u6+]S6|SVq  $uFTFXF\F`j v6e[^U!  WVS]} i  jtQ  F    F    F    F<F8    F    W    uF   1$Y    t
-h[  A  Ev    t"h  RV-}  ~ %   FTPFXuh  ~ uFXF\I  t& jEP6#  jhEPuzuVhSQhWSVuVh       6Si^F   jEPROtS   jhEPu`P6j 6]S6SV  $u%FTFXF\F`j v6uVh S`SR  1[^_U   VSu|jtSu1VC    C    C    C<C8    C    3CTPCXu
-h  CXC\[^UWVS}M9th`  G     G    MqA9-        $EPFPEG  t& EPFP{EfG$  &    EPFP[EfG&  &    EPFP;EfG(  &    O!EPFPe  O!EPFPO  t& O!EPFP5  O!EPFP  t&    G!tFG@   G!t2GDBG!   2GH   t& EPFP{EG4   EPFPcEGO! j u7!]S7rSW   $u~   O!EPFPhEPFPEfG*K&    EPFPEfG,.EPFPEfG.t& EPFPEfG0G   FtMAA9e[^_UWVSu}?th  E    _G9sFt*u&EPCP9EPCP*EfFdC\GG9rj u6FdPVhFdPR6FdPVl FdPR6FdPVpFdPR6e[^_v UWVS}u>th &  G8    E    ^F9sEtt%EPCPJEPCP;EG8C\FF9r8 t<w8G<t j u7w8w<7t& h`  e[^_UWVS}U: thZ  UZB9ssu;uVEPCPj u7WV7Ett#VWa&    VWuC\UBB9re[^_US]C\;C`u,sTsX3 &    CXC\S`C\ C\]v UVS]UUC   KXsT9C\uVQ3CXC\C\UC\   e[^UWVSu~ u*~ t$VXF\)PR6_ukt& vX~8 tv<F! tvhrvljvpbM~^VNuMQW6e[^_US]{ u%{ tSXC\)PR3uCsX{8 ts<C! tshslspS]Uu5jhUu5wUS=t;u]UUS    [3  o]                                       usage: %s [-p] [-t] [-f] [-u] [-d secs] [-s] [-geom geometry] [-display displayname] files
-     	[-p] means use Pixmaps not XImages.
-                           	[-t] means show titles (if any).
- 	[-u] means upsidedown.
-     	[-f] means force new colourmap creation.
-                      	[-d secs] means delay in seconds.
-                             	[-s] means syncronize display.
-                                	[-geom] (or -g or -geometry) means the standard X geometry string.
-                            	[-display] means the X display string.
- -t -u -p -f -d         Delay %d usecs between frames.
- -s -geom -geometry -g -display :  Can't open display %s.
- Geometry vort                         You need a 256 (or more) colour display device
-                 Need a PseudoColor visual type.
-     $tIOut of mem.
- fixed Couldn't get 'fixed' font.
-          Specified window width (%d) is less than image width (%d).
-     Specified window height (%d) is less than image height (%d).
- VORT  <<   Play   >>   Stop  Frame:   QUIT  %d Reading file %s
- r disp: can't open file %s.
- mem = NULL
- Unable to create ximage
- All images must be the same size you dork!
- Unable to create Pixmap
- Finished reading %d files
- 333333?zG?)\(?readrgba: bad file format.
-             readmappeda: bad file format.
-  readlongval: unable to read value.
-                             writelongval: unable to write value.
-                           readvortobj: unable to find space for object.
-                  readvortobj: unable to read object.
- VORT01                     readimage: unable to allocate space for image buffer.
- r w openimage: bad open flag.
- -         openimage: unable to allocate space for image buffer.
-  uncompress < %s                       Unable to open compressed file %s
-                              openimage: %s is not a vort file.
-                              getimagedata: object passed not an image.
-  0Pp0H                    getcolormapdata: object passed not a colourmap.
-                gettextdata: object passed not text.
-                           gettextdata: unable to allocate space for string.
-              setupimage: main object not a directory.
-                                     BRbr"2BRbr"2BRbr"2BRbr             /           (      `
-   <                                               oo   o@                                           (     d   4    d   4$   <       3          b          |                              %         q                                    3         X         r                                    
-         .         X         l                                                                                                   !                  b         v       !                                    M                                    1         h                       (;           !         g            $                                                                         B       ? !                                 %   !     =   "     S   #     j   %        &        1        2        3        4        5     	   6     0	   8     I	   9     c	   ;     	   =     	   >     	   ?     	   @     	   A     	   B     
-   C     0
-   D     I
-   E     `
-   F     y
-   G     
-   H     
-   I     
-   N        Q        R     9   S     Q   T     j   V        Y        o        r         u        {     6   |     S        o                                                        8        R     F                                   +   "     j                                    G   3                 ;        B        E     0         n            R        Y        ]     )         f                     k              P   s     h   x                       !     
-                             #        $        %        &                  "       d   4init.c /usr/src/bs/BUILD/glibc/csu/ gcc2_compiled. int:t(0,1)=r(0,1);0020000000000;0017777777777; char:t(0,2)=r(0,2);0;127; long int:t(0,3)=r(0,1);0020000000000;0017777777777; unsigned int:t(0,4)=r(0,1);0000000000000;0037777777777; long unsigned int:t(0,5)=r(0,1);0000000000000;0037777777777; long long int:t(0,6)=r(0,1);01000000000000000000000;0777777777777777777777; long long unsigned int:t(0,7)=r(0,1);0000000000000;01777777777777777777777; short int:t(0,8)=r(0,8);-32768;32767; short unsigned int:t(0,9)=r(0,9);0;65535; signed char:t(0,10)=r(0,10);-128;127; unsigned char:t(0,11)=r(0,11);0;255; float:t(0,12)=r(0,1);4;0; double:t(0,13)=r(0,1);8;0; long double:t(0,14)=r(0,1);12;0; complex int:t(0,15)=s8real:(0,1),0,32;imag:(0,1),32,32;; complex float:t(0,16)=r(0,16);4;0; complex double:t(0,17)=r(0,17);8;0; complex long double:t(0,18)=r(0,18);12;0; void:t(0,19)=(0,19) ../include/libc-symbols.h /usr/src/bs/BUILD/glibc/build-i386-linux/config.h  ../include/libintl.h ../intl/libintl.h ../include/features.h ../include/sys/cdefs.h ../misc/sys/cdefs.h /usr/lib/gcc-lib/i386-redhat-linux/egcs-2.91.66/include/stddef.h ../include/locale.h ../locale/locale.h lconv:T(10,1)=s48decimal_point:(10,2)=*(0,2),0,32;thousands_sep:(10,2),32,32;\ grouping:(10,2),64,32;int_curr_symbol:(10,2),96,32;\ currency_symbol:(10,2),128,32;mon_decimal_point:(10,2),160,32;\ mon_thousands_sep:(10,2),192,32;mon_grouping:(10,2),224,32;\ positive_sign:(10,2),256,32;negative_sign:(10,2),288,32;\ int_frac_digits:(0,2),320,8;frac_digits:(0,2),328,8;\ p_cs_precedes:(0,2),336,8;p_sep_by_space:(0,2),344,8;\ n_cs_precedes:(0,2),352,8;n_sep_by_space:(0,2),360,8;\ p_sign_posn:(0,2),368,8;n_sign_posn:(0,2),376,8;; ../include/xlocale.h ../locale/xlocale.h __locale_struct:T(13,1)=s36__locales:(13,2)=ar(0,1);0;5;(13,3)=*(13,4)=xslocale_data:,0,192;\ __ctype_b:(13,5)=*(0,9),192,32;__ctype_tolower:(13,6)=*(0,1),224,32;\ __ctype_toupper:(13,6),256,32;; __locale_t:t(13,7)=(13,8)=*(13,1) ../sysdeps/unix/sysv/linux/_G_config.h ../sysdeps/unix/sysv/linux/bits/types.h size_t:t(16,1)=(0,4) __u_char:t(15,1)=(0,11) __u_short:t(15,2)=(0,9) __u_int:t(15,3)=(0,4) __u_long:t(15,4)=(0,5) __u_quad_t:t(15,5)=(0,7) __quad_t:t(15,6)=(0,6) __int8_t:t(15,7)=(0,10) __uint8_t:t(15,8)=(0,11) __int16_t:t(15,9)=(0,8) __uint16_t:t(15,10)=(0,9) __int32_t:t(15,11)=(0,1) __uint32_t:t(15,12)=(0,4) __int64_t:t(15,13)=(0,6) __uint64_t:t(15,14)=(0,7) __qaddr_t:t(15,15)=(15,16)=*(15,6) __dev_t:t(15,17)=(15,5) __uid_t:t(15,18)=(15,3) __gid_t:t(15,19)=(15,3) __ino_t:t(15,20)=(15,4) __mode_t:t(15,21)=(15,3) __nlink_t:t(15,22)=(15,3) __off_t:t(15,23)=(0,3) __loff_t:t(15,24)=(15,6) __pid_t:t(15,25)=(0,1) __ssize_t:t(15,26)=(0,1) __rlim_t:t(15,27)=(0,3) __rlim64_t:t(15,28)=(15,6) __id_t:t(15,29)=(15,3) __fsid_t:t(15,30)=(15,31)=s8__val:(15,32)=ar(0,1);0;1;(0,1),0,64;; __daddr_t:t(15,33)=(0,1) __caddr_t:t(15,34)=(10,2) __time_t:t(15,35)=(0,3) __swblk_t:t(15,36)=(0,3) __clock_t:t(15,37)=(0,3) __fd_mask:t(15,38)=(0,5) __fd_set:t(15,39)=(15,40)=s128fds_bits:(15,41)=ar(0,1);0;31;(15,38),0,1024;; __key_t:t(15,42)=(0,1) __ipc_pid_t:t(15,43)=(0,9) __blkcnt_t:t(15,44)=(15,4) __blkcnt64_t:t(15,45)=(15,5) __fsblkcnt_t:t(15,46)=(0,3) __fsblkcnt64_t:t(15,47)=(15,6) __fsfilcnt_t:t(15,48)=(15,4) __fsfilcnt64_t:t(15,49)=(15,5) __ino64_t:t(15,50)=(15,4) __off64_t:t(15,51)=(15,24) __t_scalar_t:t(15,52)=(0,1) __t_uscalar_t:t(15,53)=(0,4) __intptr_t:t(15,54)=(0,1) ../linuxthreads/sysdeps/pthread/bits/pthreadtypes.h ../sysdeps/unix/sysv/linux/bits/sched.h __sched_param:T(18,1)=s4sched_priority:(0,1),0,32;; _pthread_fastlock:T(17,1)=s8__status:(0,3),0,32;__spinlock:(0,1),32,32;; _pthread_descr:t(17,2)=(17,3)=*(17,4)=xs_pthread_descr_struct: pthread_attr_t:t(17,5)=(17,6)=s36__detachstate:(0,1),0,32;\ __schedpolicy:(0,1),32,32;__schedparam:(18,1),64,32;\ __inheritsched:(0,1),96,32;__scope:(0,1),128,32;\ __guardsize:(16,1),160,32;__stackaddr_set:(0,1),192,32;\ __stackaddr:(17,7)=*(0,19),224,32;__stacksize:(16,1),256,32;; pthread_cond_t:t(17,8)=(17,9)=s12__c_lock:(17,1),0,64;\ __c_waiting:(17,2),64,32;; pthread_condattr_t:t(17,10)=(17,11)=s4__dummy:(0,1),0,32;; pthread_key_t:t(17,12)=(0,4) pthread_mutex_t:t(17,13)=(17,14)=s24__m_reserved:(0,1),0,32;\ __m_count:(0,1),32,32;__m_owner:(17,2),64,32;\ __m_kind:(0,1),96,32;__m_lock:(17,1),128,64;; pthread_mutexattr_t:t(17,15)=(17,16)=s4__mutexkind:(0,1),0,32;; pthread_once_t:t(17,17)=(0,1) pthread_rwlock_t:t(17,18)=(17,19)=s32__rw_lock:(17,1),0,64;\ __rw_readers:(0,1),64,32;__rw_writer:(17,2),96,32;\ __rw_read_waiting:(17,2),128,32;__rw_write_waiting:(17,2),160,32;\ __rw_kind:(0,1),192,32;__rw_pshared:(0,1),224,32;; pthread_rwlockattr_t:t(17,20)=(17,21)=s8__lockkind:(0,1),0,32;\ __pshared:(0,1),32,32;; pthread_t:t(17,22)=(0,5) wchar_t:t(19,1)=(0,3) wint_t:t(19,2)=(0,4) _G_int16_t:t(14,1)=(0,8) _G_int32_t:t(14,2)=(0,1) _G_uint16_t:t(14,3)=(0,9) _G_uint32_t:t(14,4)=(0,4) _IO_stdin_used:G(0,1)  GCC: (GNU) egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)  GCC: (GNU) egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)  GCC: (GNU) egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)  GCC: (GNU) egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)  GCC: (GNU) egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)  GCC: (GNU) egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)  GCC: (GNU) egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)  GCC: (GNU) egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)  GCC: (GNU) egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)  GCC: (GNU) egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)           01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01             01.01    .symtab .strtab .shstrtab .interp .note.ABI-tag .hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.got .rel.bss .rel.plt .init .plt .text .fini .rodata .data .eh_frame .ctors .dtors .got .dynamic .bss .stab .stabstr .comment .note                                                                         #                              1         ((  8               7         ``                ?           P                 G   o   @@                  T   o     0                c   	                       l   	                       u   	                      ~           /                           ,,                             K                          ]                             ]                             f                             f                             f                             f                             f                           g                           h  !                                h  D                             p  (                               ,  b                           b                                    V                                         y         	                                                                         (          `                    @                                   	          
-               ,                                                                                                                                                        b                                                                 4                   "               @       -         1         ?         K   @      a         t                                                     "                                                                                                                                                V       T     %  X     0  Z     ;       E       K       P  8     R         X       `       j       p       w        }  $       ,       4                     t       L              H       `       \              D       @       d       h              |                                                        x                      <     	  R       P       0       (       l     &  p     4              @       ?  @    H                     S      _              p       i       r              \       |  <        L               \j       l       0       |        x                      A    	         w            -       4  t   "   U  =   "   f  HS     m          7   "                 W       ;       $                i             I   "     ,U       <e        L      #  0     -  \      7  l      H  |     U      _  z     k  `     x        ~  {        \             2  "           O                "         
-         {      (  t     4       A        H      V  6    d       s       ~          `              e        !                @       ,                   
-  <:       (     '  L      D  /     K  \U     Z  -     i  l1      {           |)                =   "     p9       v       =   "                                            |      %       ,       B     "   R       W       f  ,      s  <        L  "     I       \       l9               X`             4       |$                              &        4        A  =   "   Q  T     a       n              }  "        `      initfini.c gcc2_compiled. init.c crtstuff.c p.2 __DTOR_LIST__ completed.3 __do_global_dtors_aux __EH_FRAME_BEGIN__ fini_dummy object.8 frame_dummy init_dummy force_to_data __CTOR_LIST__ __do_global_ctors_aux __CTOR_END__ __DTOR_END__ __FRAME_END__ movie.c one cur_frame myname tlen do_titles upsidedown usepixmaps forcecmap Sleep sync f title display theScreen depth visual rootw theGC ppm xip titles winder stopped dir cmap color black white copyfun font_h font_w w h by lx1 lx2 px1 px2 rx1 rx2 sx1 sx2 xf qx1 qx2 fnum oldh oldw xi pm window_width window_height readrgba.c readrgba readmapl.c readmappeda imageio.c ibufsize vorterr.c XFreePixmap XSetInputFocus writecolormapobj XCheckWindowEvent XDrawString getcolormapdata XSync readrgbaline XMapWindow imagebufsize drawbut _DYNAMIC getimagedata XCloseDisplay _etext __register_frame_info@@GLIBC_2.0 write@@GLIBC_2.0 usleep fileno@@GLIBC_2.0 close@@GLIBC_2.0 _fp_hw writebyte XLoadFont fprintf@@GLIBC_2.0 pclose@@GLIBC_2.1 readlongval read_files select@@GLIBC_2.0 XCreateImage XSetForeground XFreeColormap makeimage XCopyArea bcopy@@GLIBC_2.0 XStoreColors openimage finishimage writetextobj _init popen@@GLIBC_2.1 vorterror makebuttons malloc@@GLIBC_2.0 readimage trydefaultcmap gettextdata __deregister_frame_info@@GLIBC_2.0 makewindow stderr@@GLIBC_2.0 XSetWMHints vortwarning writelongval _start writeimageobj useourowncmap XParseGeometry setupimage XChangeGC check_events XSetWindowColormap XSetBackground atof@@GLIBC_2.0 XCreateColormap readmappedline strncmp@@GLIBC_2.0 __bss_start main XMatchVisualInfo setcolormap __libc_start_main@@GLIBC_2.0 xbcopy XLoadQueryFont extractlongval strcat@@GLIBC_2.0 data_start printf@@GLIBC_2.0 _fini lseek@@GLIBC_2.0 getlongsize readvortobj open@@GLIBC_2.0 XAllocColor XSetIconName XGetDefault exit@@GLIBC_2.0 XCreateWindow XNextEvent _edata _GLOBAL_OFFSET_TABLE_ free@@GLIBC_2.0 _end XDrawRectangle XSelectInput XSetStandardProperties rindex@@GLIBC_2.0 readbyte XFillRectangle XDisplayName _IO_stdin_used show_frame carray closeimage sprintf@@GLIBC_2.0 __data_start XDisplayPlanes XPutImage XCreatePixmap XUnmapWindow read@@GLIBC_2.0 readmappedaline XOpenDisplay __gmon_start__ strcpy@@GLIBC_2.0 readrgbline 
\ No newline at end of file
diff -Nrua vort-old/X11/movie.c vort-new/X11/movie.c
--- vort-old/X11/movie.c	1995-04-03 22:08:30.000000000 -0400
+++ vort-new/X11/movie.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,47 +1,26 @@
 #include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
 #include <math.h>
-#ifdef VMS
-#include <decw$include/xlib.h>
-#include <decw$include/xutil.h>
-#else
+
 #include <X11/Xlib.h>
 #include <X11/Xutil.h>
-#endif
-
-#ifdef VMS
-typedef unsigned char u_char;
-#include <string.h>
-#include <types.h>
-#define rindex strrchr
-#endif
-
-#ifdef SYSV
-#include <string.h>
-#define rindex strrchr
-#endif
 
+#include <poll.h>
 
 #include "vort.h"
 #include "status.h"
 
-#ifdef SYSV
-#include <poll.h>
-#else
-#include <sys/time.h>
-#endif
-
 int
 usleep(usec)
 unsigned long usec;
 {
-#ifdef SYSV
-        poll((struct pollfd *)0, (size_t)0, usec / 1000);
-#else
     struct timeval timeout;
     timeout.tv_usec = usec % (unsigned long) 1000000;
     timeout.tv_sec = usec / (unsigned long) 1000000;
-    select(0, (char *)0, (char *)0, (char *)0, &timeout);
-#endif
+
+    select(0, NULL, NULL, NULL, &timeout);
+
     return 0;
 }
 
@@ -52,8 +31,6 @@
 
 
 
-extern char	*rindex();
-
 #define	CMAPSIZE	250
 #define	W_MIN_WIDTH	286
 #define EV_MASK         KeyPressMask|ButtonReleaseMask|ExposureMask|ButtonPressMask
@@ -79,39 +56,22 @@
 unsigned char		carray[CMAPSIZE];
 
 static int		sync;
-static int		(*copyfun)();
+static void		(*copyfun)(const void *src, void *dest, size_t n);
 
 /*
  * xbcopy
  *
  *	copy bytes from from to to, taking into account the colourmap.
  */
-xbcopy(from, to, size)
-	unsigned char	*from, *to;
-	int		size;
+static void xbcopy(from, to, size)
+	const unsigned char	*from;
+	unsigned char		*to;
+	size_t			size;
 {
-	while (size--)
+	while (size--) {
 		*to++ = carray[*from++];
-
-}
-
-#ifdef SYSV
-/*
- * bcopy
- *
- *	copy bytes from from to to.
- */
-bcopy(from, to, size)
-	unsigned char	*from, *to;
-	int		size;
-{
-	while (size--)
-		*to++ = *from++;
-
+	}
 }
-#else
-extern int	bcopy();
-#endif
 
 /*
  * program to read in a color-mapped image and display it on X11, greyscale
@@ -128,7 +88,7 @@
 	XVisualInfo	visualinfo;
 	char		*geomstring, *displaystring;
 
-        if ((myname = rindex(av[0],'/')) == NULL)
+        if ((myname = strrchr(av[0],'/')) == NULL)
                 myname = av[0];
         else
                 *myname++;
diff -Nrua vort-old/X11/sdisp.c vort-new/X11/sdisp.c
--- vort-old/X11/sdisp.c	1994-10-09 19:54:35.000000000 -0400
+++ vort-new/X11/sdisp.c	2006-11-18 16:58:16.000000000 -0500
@@ -1,31 +1,14 @@
 #include <stdio.h>
 #include <signal.h>
 #include <math.h>
-#ifdef VMS
-#include <decw$include/xlib.h>
-#include <decw$include/xutil.h>
-#else
 #include <X11/Xlib.h>
 #include <X11/Xutil.h>
-#endif
-
-#ifdef VMS
-typedef unsigned char u_char;
-#include <string.h>
-#include <types.h>
-#define rindex strrchr
-#endif
 
-#ifdef SYSV
 #include <string.h>
-#define rindex strrchr
-#endif
 
 #include "vort.h"
 #include "status.h"
 
-extern char    *rindex();
-
 #define	CMAPSIZE	256
 #define EV_MASK         KeyPressMask|ButtonReleaseMask|ExposureMask|ButtonPressMask
 
@@ -146,7 +129,7 @@
 	FILE           *fp;
 	int             sleep_time, old_w = -1, old_h = -1;
 
-	if ((myname = rindex(av[0], '/')) == NULL)
+	if ((myname = strrchr(av[0], '/')) == NULL)
 		myname = av[0];
 	else
 		*myname++;
diff -Nrua vort-old/X11/xlib.opt vort-new/X11/xlib.opt
--- vort-old/X11/xlib.opt	1991-02-07 21:42:11.000000000 -0500
+++ vort-new/X11/xlib.opt	1969-12-31 19:00:00.000000000 -0500
@@ -1,2 +0,0 @@
-! VAX file needed to compile X11 stuff [vort.x11]
-sys$share:decw$xlibshr/share
